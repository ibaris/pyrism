<!DOCTYPE html>
<!-- Generated by Cython 0.28.2 -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>Cython: tma.pyx</title>
    <style type="text/css">

        body.cython {
            font-family: courier;
            font-size: 12;
        }

        .cython.tag {
        }

        .cython.line {
            margin: 0em
        }

        .cython.code {
            font-size: 9;
            color: #444444;
            display: none;
            margin: 0px 0px 0px 8px;
            border-left: 8px none;
        }

        .cython.line .run {
            background-color: #B0FFB0;
        }

        .cython.line .mis {
            background-color: #FFB0B0;
        }

        .cython.code.run {
            border-left: 8px solid #B0FFB0;
        }

        .cython.code.mis {
            border-left: 8px solid #FFB0B0;
        }

        .cython.code .py_c_api {
            color: red;
        }

        .cython.code .py_macro_api {
            color: #FF7000;
        }

        .cython.code .pyx_c_api {
            color: #FF3000;
        }

        .cython.code .pyx_macro_api {
            color: #FF7000;
        }

        .cython.code .refnanny {
            color: #FFA000;
        }

        .cython.code .trace {
            color: #FFA000;
        }

        .cython.code .error_goto {
            color: #FFA000;
        }

        .cython.code .coerce {
            color: #008000;
            border: 1px dotted #008000
        }

        .cython.code .py_attr {
            color: #FF0000;
            font-weight: bold;
        }

        .cython.code .c_attr {
            color: #0000FF;
        }

        .cython.code .py_call {
            color: #FF0000;
            font-weight: bold;
        }

        .cython.code .c_call {
            color: #0000FF;
        }

        .cython.score-0 {
            background-color: #FFFFff;
        }

        .cython.score-1 {
            background-color: #FFFFe7;
        }

        .cython.score-2 {
            background-color: #FFFFd4;
        }

        .cython.score-3 {
            background-color: #FFFFc4;
        }

        .cython.score-4 {
            background-color: #FFFFb6;
        }

        .cython.score-5 {
            background-color: #FFFFaa;
        }

        .cython.score-6 {
            background-color: #FFFF9f;
        }

        .cython.score-7 {
            background-color: #FFFF96;
        }

        .cython.score-8 {
            background-color: #FFFF8d;
        }

        .cython.score-9 {
            background-color: #FFFF86;
        }

        .cython.score-10 {
            background-color: #FFFF7f;
        }

        .cython.score-11 {
            background-color: #FFFF79;
        }

        .cython.score-12 {
            background-color: #FFFF73;
        }

        .cython.score-13 {
            background-color: #FFFF6e;
        }

        .cython.score-14 {
            background-color: #FFFF6a;
        }

        .cython.score-15 {
            background-color: #FFFF66;
        }

        .cython.score-16 {
            background-color: #FFFF62;
        }

        .cython.score-17 {
            background-color: #FFFF5e;
        }

        .cython.score-18 {
            background-color: #FFFF5b;
        }

        .cython.score-19 {
            background-color: #FFFF57;
        }

        .cython.score-20 {
            background-color: #FFFF55;
        }

        .cython.score-21 {
            background-color: #FFFF52;
        }

        .cython.score-22 {
            background-color: #FFFF4f;
        }

        .cython.score-23 {
            background-color: #FFFF4d;
        }

        .cython.score-24 {
            background-color: #FFFF4b;
        }

        .cython.score-25 {
            background-color: #FFFF48;
        }

        .cython.score-26 {
            background-color: #FFFF46;
        }

        .cython.score-27 {
            background-color: #FFFF44;
        }

        .cython.score-28 {
            background-color: #FFFF43;
        }

        .cython.score-29 {
            background-color: #FFFF41;
        }

        .cython.score-30 {
            background-color: #FFFF3f;
        }

        .cython.score-31 {
            background-color: #FFFF3e;
        }

        .cython.score-32 {
            background-color: #FFFF3c;
        }

        .cython.score-33 {
            background-color: #FFFF3b;
        }

        .cython.score-34 {
            background-color: #FFFF39;
        }

        .cython.score-35 {
            background-color: #FFFF38;
        }

        .cython.score-36 {
            background-color: #FFFF37;
        }

        .cython.score-37 {
            background-color: #FFFF36;
        }

        .cython.score-38 {
            background-color: #FFFF35;
        }

        .cython.score-39 {
            background-color: #FFFF34;
        }

        .cython.score-40 {
            background-color: #FFFF33;
        }

        .cython.score-41 {
            background-color: #FFFF32;
        }

        .cython.score-42 {
            background-color: #FFFF31;
        }

        .cython.score-43 {
            background-color: #FFFF30;
        }

        .cython.score-44 {
            background-color: #FFFF2f;
        }

        .cython.score-45 {
            background-color: #FFFF2e;
        }

        .cython.score-46 {
            background-color: #FFFF2d;
        }

        .cython.score-47 {
            background-color: #FFFF2c;
        }

        .cython.score-48 {
            background-color: #FFFF2b;
        }

        .cython.score-49 {
            background-color: #FFFF2b;
        }

        .cython.score-50 {
            background-color: #FFFF2a;
        }

        .cython.score-51 {
            background-color: #FFFF29;
        }

        .cython.score-52 {
            background-color: #FFFF29;
        }

        .cython.score-53 {
            background-color: #FFFF28;
        }

        .cython.score-54 {
            background-color: #FFFF27;
        }

        .cython.score-55 {
            background-color: #FFFF27;
        }

        .cython.score-56 {
            background-color: #FFFF26;
        }

        .cython.score-57 {
            background-color: #FFFF26;
        }

        .cython.score-58 {
            background-color: #FFFF25;
        }

        .cython.score-59 {
            background-color: #FFFF24;
        }

        .cython.score-60 {
            background-color: #FFFF24;
        }

        .cython.score-61 {
            background-color: #FFFF23;
        }

        .cython.score-62 {
            background-color: #FFFF23;
        }

        .cython.score-63 {
            background-color: #FFFF22;
        }

        .cython.score-64 {
            background-color: #FFFF22;
        }

        .cython.score-65 {
            background-color: #FFFF22;
        }

        .cython.score-66 {
            background-color: #FFFF21;
        }

        .cython.score-67 {
            background-color: #FFFF21;
        }

        .cython.score-68 {
            background-color: #FFFF20;
        }

        .cython.score-69 {
            background-color: #FFFF20;
        }

        .cython.score-70 {
            background-color: #FFFF1f;
        }

        .cython.score-71 {
            background-color: #FFFF1f;
        }

        .cython.score-72 {
            background-color: #FFFF1f;
        }

        .cython.score-73 {
            background-color: #FFFF1e;
        }

        .cython.score-74 {
            background-color: #FFFF1e;
        }

        .cython.score-75 {
            background-color: #FFFF1e;
        }

        .cython.score-76 {
            background-color: #FFFF1d;
        }

        .cython.score-77 {
            background-color: #FFFF1d;
        }

        .cython.score-78 {
            background-color: #FFFF1c;
        }

        .cython.score-79 {
            background-color: #FFFF1c;
        }

        .cython.score-80 {
            background-color: #FFFF1c;
        }

        .cython.score-81 {
            background-color: #FFFF1c;
        }

        .cython.score-82 {
            background-color: #FFFF1b;
        }

        .cython.score-83 {
            background-color: #FFFF1b;
        }

        .cython.score-84 {
            background-color: #FFFF1b;
        }

        .cython.score-85 {
            background-color: #FFFF1a;
        }

        .cython.score-86 {
            background-color: #FFFF1a;
        }

        .cython.score-87 {
            background-color: #FFFF1a;
        }

        .cython.score-88 {
            background-color: #FFFF1a;
        }

        .cython.score-89 {
            background-color: #FFFF19;
        }

        .cython.score-90 {
            background-color: #FFFF19;
        }

        .cython.score-91 {
            background-color: #FFFF19;
        }

        .cython.score-92 {
            background-color: #FFFF19;
        }

        .cython.score-93 {
            background-color: #FFFF18;
        }

        .cython.score-94 {
            background-color: #FFFF18;
        }

        .cython.score-95 {
            background-color: #FFFF18;
        }

        .cython.score-96 {
            background-color: #FFFF18;
        }

        .cython.score-97 {
            background-color: #FFFF17;
        }

        .cython.score-98 {
            background-color: #FFFF17;
        }

        .cython.score-99 {
            background-color: #FFFF17;
        }

        .cython.score-100 {
            background-color: #FFFF17;
        }

        .cython.score-101 {
            background-color: #FFFF16;
        }

        .cython.score-102 {
            background-color: #FFFF16;
        }

        .cython.score-103 {
            background-color: #FFFF16;
        }

        .cython.score-104 {
            background-color: #FFFF16;
        }

        .cython.score-105 {
            background-color: #FFFF16;
        }

        .cython.score-106 {
            background-color: #FFFF15;
        }

        .cython.score-107 {
            background-color: #FFFF15;
        }

        .cython.score-108 {
            background-color: #FFFF15;
        }

        .cython.score-109 {
            background-color: #FFFF15;
        }

        .cython.score-110 {
            background-color: #FFFF15;
        }

        .cython.score-111 {
            background-color: #FFFF15;
        }

        .cython.score-112 {
            background-color: #FFFF14;
        }

        .cython.score-113 {
            background-color: #FFFF14;
        }

        .cython.score-114 {
            background-color: #FFFF14;
        }

        .cython.score-115 {
            background-color: #FFFF14;
        }

        .cython.score-116 {
            background-color: #FFFF14;
        }

        .cython.score-117 {
            background-color: #FFFF14;
        }

        .cython.score-118 {
            background-color: #FFFF13;
        }

        .cython.score-119 {
            background-color: #FFFF13;
        }

        .cython.score-120 {
            background-color: #FFFF13;
        }

        .cython.score-121 {
            background-color: #FFFF13;
        }

        .cython.score-122 {
            background-color: #FFFF13;
        }

        .cython.score-123 {
            background-color: #FFFF13;
        }

        .cython.score-124 {
            background-color: #FFFF13;
        }

        .cython.score-125 {
            background-color: #FFFF12;
        }

        .cython.score-126 {
            background-color: #FFFF12;
        }

        .cython.score-127 {
            background-color: #FFFF12;
        }

        .cython.score-128 {
            background-color: #FFFF12;
        }

        .cython.score-129 {
            background-color: #FFFF12;
        }

        .cython.score-130 {
            background-color: #FFFF12;
        }

        .cython.score-131 {
            background-color: #FFFF12;
        }

        .cython.score-132 {
            background-color: #FFFF11;
        }

        .cython.score-133 {
            background-color: #FFFF11;
        }

        .cython.score-134 {
            background-color: #FFFF11;
        }

        .cython.score-135 {
            background-color: #FFFF11;
        }

        .cython.score-136 {
            background-color: #FFFF11;
        }

        .cython.score-137 {
            background-color: #FFFF11;
        }

        .cython.score-138 {
            background-color: #FFFF11;
        }

        .cython.score-139 {
            background-color: #FFFF11;
        }

        .cython.score-140 {
            background-color: #FFFF11;
        }

        .cython.score-141 {
            background-color: #FFFF10;
        }

        .cython.score-142 {
            background-color: #FFFF10;
        }

        .cython.score-143 {
            background-color: #FFFF10;
        }

        .cython.score-144 {
            background-color: #FFFF10;
        }

        .cython.score-145 {
            background-color: #FFFF10;
        }

        .cython.score-146 {
            background-color: #FFFF10;
        }

        .cython.score-147 {
            background-color: #FFFF10;
        }

        .cython.score-148 {
            background-color: #FFFF10;
        }

        .cython.score-149 {
            background-color: #FFFF10;
        }

        .cython.score-150 {
            background-color: #FFFF0f;
        }

        .cython.score-151 {
            background-color: #FFFF0f;
        }

        .cython.score-152 {
            background-color: #FFFF0f;
        }

        .cython.score-153 {
            background-color: #FFFF0f;
        }

        .cython.score-154 {
            background-color: #FFFF0f;
        }

        .cython.score-155 {
            background-color: #FFFF0f;
        }

        .cython.score-156 {
            background-color: #FFFF0f;
        }

        .cython.score-157 {
            background-color: #FFFF0f;
        }

        .cython.score-158 {
            background-color: #FFFF0f;
        }

        .cython.score-159 {
            background-color: #FFFF0f;
        }

        .cython.score-160 {
            background-color: #FFFF0f;
        }

        .cython.score-161 {
            background-color: #FFFF0e;
        }

        .cython.score-162 {
            background-color: #FFFF0e;
        }

        .cython.score-163 {
            background-color: #FFFF0e;
        }

        .cython.score-164 {
            background-color: #FFFF0e;
        }

        .cython.score-165 {
            background-color: #FFFF0e;
        }

        .cython.score-166 {
            background-color: #FFFF0e;
        }

        .cython.score-167 {
            background-color: #FFFF0e;
        }

        .cython.score-168 {
            background-color: #FFFF0e;
        }

        .cython.score-169 {
            background-color: #FFFF0e;
        }

        .cython.score-170 {
            background-color: #FFFF0e;
        }

        .cython.score-171 {
            background-color: #FFFF0e;
        }

        .cython.score-172 {
            background-color: #FFFF0e;
        }

        .cython.score-173 {
            background-color: #FFFF0d;
        }

        .cython.score-174 {
            background-color: #FFFF0d;
        }

        .cython.score-175 {
            background-color: #FFFF0d;
        }

        .cython.score-176 {
            background-color: #FFFF0d;
        }

        .cython.score-177 {
            background-color: #FFFF0d;
        }

        .cython.score-178 {
            background-color: #FFFF0d;
        }

        .cython.score-179 {
            background-color: #FFFF0d;
        }

        .cython.score-180 {
            background-color: #FFFF0d;
        }

        .cython.score-181 {
            background-color: #FFFF0d;
        }

        .cython.score-182 {
            background-color: #FFFF0d;
        }

        .cython.score-183 {
            background-color: #FFFF0d;
        }

        .cython.score-184 {
            background-color: #FFFF0d;
        }

        .cython.score-185 {
            background-color: #FFFF0d;
        }

        .cython.score-186 {
            background-color: #FFFF0d;
        }

        .cython.score-187 {
            background-color: #FFFF0c;
        }

        .cython.score-188 {
            background-color: #FFFF0c;
        }

        .cython.score-189 {
            background-color: #FFFF0c;
        }

        .cython.score-190 {
            background-color: #FFFF0c;
        }

        .cython.score-191 {
            background-color: #FFFF0c;
        }

        .cython.score-192 {
            background-color: #FFFF0c;
        }

        .cython.score-193 {
            background-color: #FFFF0c;
        }

        .cython.score-194 {
            background-color: #FFFF0c;
        }

        .cython.score-195 {
            background-color: #FFFF0c;
        }

        .cython.score-196 {
            background-color: #FFFF0c;
        }

        .cython.score-197 {
            background-color: #FFFF0c;
        }

        .cython.score-198 {
            background-color: #FFFF0c;
        }

        .cython.score-199 {
            background-color: #FFFF0c;
        }

        .cython.score-200 {
            background-color: #FFFF0c;
        }

        .cython.score-201 {
            background-color: #FFFF0c;
        }

        .cython.score-202 {
            background-color: #FFFF0c;
        }

        .cython.score-203 {
            background-color: #FFFF0b;
        }

        .cython.score-204 {
            background-color: #FFFF0b;
        }

        .cython.score-205 {
            background-color: #FFFF0b;
        }

        .cython.score-206 {
            background-color: #FFFF0b;
        }

        .cython.score-207 {
            background-color: #FFFF0b;
        }

        .cython.score-208 {
            background-color: #FFFF0b;
        }

        .cython.score-209 {
            background-color: #FFFF0b;
        }

        .cython.score-210 {
            background-color: #FFFF0b;
        }

        .cython.score-211 {
            background-color: #FFFF0b;
        }

        .cython.score-212 {
            background-color: #FFFF0b;
        }

        .cython.score-213 {
            background-color: #FFFF0b;
        }

        .cython.score-214 {
            background-color: #FFFF0b;
        }

        .cython.score-215 {
            background-color: #FFFF0b;
        }

        .cython.score-216 {
            background-color: #FFFF0b;
        }

        .cython.score-217 {
            background-color: #FFFF0b;
        }

        .cython.score-218 {
            background-color: #FFFF0b;
        }

        .cython.score-219 {
            background-color: #FFFF0b;
        }

        .cython.score-220 {
            background-color: #FFFF0b;
        }

        .cython.score-221 {
            background-color: #FFFF0b;
        }

        .cython.score-222 {
            background-color: #FFFF0a;
        }

        .cython.score-223 {
            background-color: #FFFF0a;
        }

        .cython.score-224 {
            background-color: #FFFF0a;
        }

        .cython.score-225 {
            background-color: #FFFF0a;
        }

        .cython.score-226 {
            background-color: #FFFF0a;
        }

        .cython.score-227 {
            background-color: #FFFF0a;
        }

        .cython.score-228 {
            background-color: #FFFF0a;
        }

        .cython.score-229 {
            background-color: #FFFF0a;
        }

        .cython.score-230 {
            background-color: #FFFF0a;
        }

        .cython.score-231 {
            background-color: #FFFF0a;
        }

        .cython.score-232 {
            background-color: #FFFF0a;
        }

        .cython.score-233 {
            background-color: #FFFF0a;
        }

        .cython.score-234 {
            background-color: #FFFF0a;
        }

        .cython.score-235 {
            background-color: #FFFF0a;
        }

        .cython.score-236 {
            background-color: #FFFF0a;
        }

        .cython.score-237 {
            background-color: #FFFF0a;
        }

        .cython.score-238 {
            background-color: #FFFF0a;
        }

        .cython.score-239 {
            background-color: #FFFF0a;
        }

        .cython.score-240 {
            background-color: #FFFF0a;
        }

        .cython.score-241 {
            background-color: #FFFF0a;
        }

        .cython.score-242 {
            background-color: #FFFF0a;
        }

        .cython.score-243 {
            background-color: #FFFF0a;
        }

        .cython.score-244 {
            background-color: #FFFF0a;
        }

        .cython.score-245 {
            background-color: #FFFF0a;
        }

        .cython.score-246 {
            background-color: #FFFF09;
        }

        .cython.score-247 {
            background-color: #FFFF09;
        }

        .cython.score-248 {
            background-color: #FFFF09;
        }

        .cython.score-249 {
            background-color: #FFFF09;
        }

        .cython.score-250 {
            background-color: #FFFF09;
        }

        .cython.score-251 {
            background-color: #FFFF09;
        }

        .cython.score-252 {
            background-color: #FFFF09;
        }

        .cython.score-253 {
            background-color: #FFFF09;
        }

        .cython.score-254 {
            background-color: #FFFF09;
        }

        .cython .hll {
            background-color: #ffffcc
        }

        .cython {
            background: #f8f8f8;
        }

        .cython .c {
            color: #408080;
            font-style: italic
        }

        /* Comment */
        .cython .err {
            border: 1px solid #FF0000
        }

        /* Error */
        .cython .k {
            color: #008000;
            font-weight: bold
        }

        /* Keyword */
        .cython .o {
            color: #666666
        }

        /* Operator */
        .cython .ch {
            color: #408080;
            font-style: italic
        }

        /* Comment.Hashbang */
        .cython .cm {
            color: #408080;
            font-style: italic
        }

        /* Comment.Multiline */
        .cython .cp {
            color: #BC7A00
        }

        /* Comment.Preproc */
        .cython .cpf {
            color: #408080;
            font-style: italic
        }

        /* Comment.PreprocFile */
        .cython .c1 {
            color: #408080;
            font-style: italic
        }

        /* Comment.Single */
        .cython .cs {
            color: #408080;
            font-style: italic
        }

        /* Comment.Special */
        .cython .gd {
            color: #A00000
        }

        /* Generic.Deleted */
        .cython .ge {
            font-style: italic
        }

        /* Generic.Emph */
        .cython .gr {
            color: #FF0000
        }

        /* Generic.Error */
        .cython .gh {
            color: #000080;
            font-weight: bold
        }

        /* Generic.Heading */
        .cython .gi {
            color: #00A000
        }

        /* Generic.Inserted */
        .cython .go {
            color: #888888
        }

        /* Generic.Output */
        .cython .gp {
            color: #000080;
            font-weight: bold
        }

        /* Generic.Prompt */
        .cython .gs {
            font-weight: bold
        }

        /* Generic.Strong */
        .cython .gu {
            color: #800080;
            font-weight: bold
        }

        /* Generic.Subheading */
        .cython .gt {
            color: #0044DD
        }

        /* Generic.Traceback */
        .cython .kc {
            color: #008000;
            font-weight: bold
        }

        /* Keyword.Constant */
        .cython .kd {
            color: #008000;
            font-weight: bold
        }

        /* Keyword.Declaration */
        .cython .kn {
            color: #008000;
            font-weight: bold
        }

        /* Keyword.Namespace */
        .cython .kp {
            color: #008000
        }

        /* Keyword.Pseudo */
        .cython .kr {
            color: #008000;
            font-weight: bold
        }

        /* Keyword.Reserved */
        .cython .kt {
            color: #B00040
        }

        /* Keyword.Type */
        .cython .m {
            color: #666666
        }

        /* Literal.Number */
        .cython .s {
            color: #BA2121
        }

        /* Literal.String */
        .cython .na {
            color: #7D9029
        }

        /* Name.Attribute */
        .cython .nb {
            color: #008000
        }

        /* Name.Builtin */
        .cython .nc {
            color: #0000FF;
            font-weight: bold
        }

        /* Name.Class */
        .cython .no {
            color: #880000
        }

        /* Name.Constant */
        .cython .nd {
            color: #AA22FF
        }

        /* Name.Decorator */
        .cython .ni {
            color: #999999;
            font-weight: bold
        }

        /* Name.Entity */
        .cython .ne {
            color: #D2413A;
            font-weight: bold
        }

        /* Name.Exception */
        .cython .nf {
            color: #0000FF
        }

        /* Name.Function */
        .cython .nl {
            color: #A0A000
        }

        /* Name.Label */
        .cython .nn {
            color: #0000FF;
            font-weight: bold
        }

        /* Name.Namespace */
        .cython .nt {
            color: #008000;
            font-weight: bold
        }

        /* Name.Tag */
        .cython .nv {
            color: #19177C
        }

        /* Name.Variable */
        .cython .ow {
            color: #AA22FF;
            font-weight: bold
        }

        /* Operator.Word */
        .cython .w {
            color: #bbbbbb
        }

        /* Text.Whitespace */
        .cython .mb {
            color: #666666
        }

        /* Literal.Number.Bin */
        .cython .mf {
            color: #666666
        }

        /* Literal.Number.Float */
        .cython .mh {
            color: #666666
        }

        /* Literal.Number.Hex */
        .cython .mi {
            color: #666666
        }

        /* Literal.Number.Integer */
        .cython .mo {
            color: #666666
        }

        /* Literal.Number.Oct */
        .cython .sa {
            color: #BA2121
        }

        /* Literal.String.Affix */
        .cython .sb {
            color: #BA2121
        }

        /* Literal.String.Backtick */
        .cython .sc {
            color: #BA2121
        }

        /* Literal.String.Char */
        .cython .dl {
            color: #BA2121
        }

        /* Literal.String.Delimiter */
        .cython .sd {
            color: #BA2121;
            font-style: italic
        }

        /* Literal.String.Doc */
        .cython .s2 {
            color: #BA2121
        }

        /* Literal.String.Double */
        .cython .se {
            color: #BB6622;
            font-weight: bold
        }

        /* Literal.String.Escape */
        .cython .sh {
            color: #BA2121
        }

        /* Literal.String.Heredoc */
        .cython .si {
            color: #BB6688;
            font-weight: bold
        }

        /* Literal.String.Interpol */
        .cython .sx {
            color: #008000
        }

        /* Literal.String.Other */
        .cython .sr {
            color: #BB6688
        }

        /* Literal.String.Regex */
        .cython .s1 {
            color: #BA2121
        }

        /* Literal.String.Single */
        .cython .ss {
            color: #19177C
        }

        /* Literal.String.Symbol */
        .cython .bp {
            color: #008000
        }

        /* Name.Builtin.Pseudo */
        .cython .fm {
            color: #0000FF
        }

        /* Name.Function.Magic */
        .cython .vc {
            color: #19177C
        }

        /* Name.Variable.Class */
        .cython .vg {
            color: #19177C
        }

        /* Name.Variable.Global */
        .cython .vi {
            color: #19177C
        }

        /* Name.Variable.Instance */
        .cython .vm {
            color: #19177C
        }

        /* Name.Variable.Magic */
        .cython .il {
            color: #666666
        }

        /* Literal.Number.Integer.Long */
    </style>
</head>
<body class="cython">
<p><span style="border-bottom: solid 1px grey;">Generated by Cython 0.28.2</span></p>
<p>
    <span style="background-color: #FFFF00">Yellow lines</span> hint at Python interaction.<br/>
    Click on a line that starts with a "<code>+</code>" to see the C code that Cython generated for it.
</p>
<p>Raw output: <a href="tma.c">tma.c</a></p>
<div class="cython">
    <pre class="cython line score-8"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0001</span>: <span class="c"># cython: cdivision=True</span></pre>
    <pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span
            class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_test, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0002</span>: <span class="k">from</span> <span class="nn">__future__</span> <span
            class="k">import</span> <span class="n">division</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0003</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">0004</span>: <span class="k">cimport</span> <span class="nn">numpy</span> <span
            class="k">as</span> <span class="nn">np</span></pre>
    <pre class="cython line score-8"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0005</span>: <span class="k">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span
            class="nn">np</span></pre>
    <pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_numpy, 0, -1);<span
            class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 5, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_np, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 5, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre>
    <pre class="cython line score-19"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0006</span>: <span class="k">from</span> <span class="nn">pyrism.auxil.quadrature</span> <span
            class="k">import</span> <span class="n">get_points_and_weights</span></pre>
    <pre class='cython code score-19 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span
            class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 6, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_get_points_and_weights);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_get_points_and_weights);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_s_get_points_and_weights);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_pyrism_auxil_quadrature, __pyx_t_1, -1);<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 6, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_get_points_and_weights);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 6, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_get_points_and_weights, __pyx_t_1) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 6, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0007</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">0008</span>: <span class="k">from</span> <span class="nn">libc.math</span> <span
            class="k">cimport</span> <span class="n">sin</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0009</span>: </pre>
    <pre class="cython line score-29"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0010</span>: <span class="k">from</span> <span class="nn">scipy.integrate</span> <span class="k">import</span> <span
            class="n">dblquad</span><span class="p">,</span> <span class="n">quad</span></pre>
    <pre class='cython code score-29 '>  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(2);<span
            class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 10, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_dblquad);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_dblquad);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_s_dblquad);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_quad);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_quad);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 1, __pyx_n_s_quad);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_scipy_integrate, __pyx_t_2, -1);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 10, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_1, __pyx_n_s_dblquad);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 10, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_dblquad, __pyx_t_2) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 10, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_1, __pyx_n_s_quad);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 10, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_quad, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 10, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre>
    <pre class="cython line score-29"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0011</span>: <span class="k">from</span> <span class="nn">pyrism.fortran_tm.fotm</span> <span
            class="k">import</span> <span class="n">calctmat</span><span class="p">,</span> <span
            class="n">calcampl</span></pre>
    <pre class='cython code score-29 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(2);<span
            class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 11, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_calctmat);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_calctmat);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_s_calctmat);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_calcampl);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_calcampl);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 1, __pyx_n_s_calcampl);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_pyrism_fortran_tm_fotm, __pyx_t_1, -1);<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 11, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_calctmat);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 11, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_calctmat, __pyx_t_1) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 11, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_calcampl);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 11, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_calcampl, __pyx_t_1) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 11, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre>
    <pre class="cython line score-8"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0012</span>: <span class="k">import</span> <span class="nn">sys</span></pre>
    <pre class='cython code score-8 '>  __pyx_t_2 = <span
            class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_sys, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 12, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_sys, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 12, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0013</span>: </pre>
    <pre class="cython line score-11"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0014</span>: <span class="n">DTYPE</span> <span class="o">=</span> <span class="n">np</span><span
            class="o">.</span><span class="n">complex</span></pre>
    <pre class='cython code score-11 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span
            class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 14, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_complex);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 14, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_DTYPE, __pyx_t_1) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 14, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0015</span>: <span class="k">ctypedef</span> <span class="n">np</span><span class="o">.</span><span
            class="n">complex_t</span> <span class="n">DTYPE_t</span></pre>
    <pre class='cython code score-0 '>typedef __pyx_t_5numpy_complex_t __pyx_t_6pyrism_4core_3tma_DTYPE_t;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0016</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">0017</span>: <span class="c"># ----------------------------------------------------------------------------------------------------------------------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0018</span>: <span class="c"># Todo and Comments</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0019</span>: <span class="c"># ----------------------------------------------------------------------------------------------------------------------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0020</span>: <span class="c"># TODO 21.10.18 ibaris: This is anoying. If I try to calculate nmax out of the loop, the unit tests fails.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0021</span>: <span class="c"># TODO 26.10.18 ibaris: In function IFUNC_SZ_S_VZA, IFUNC_XSEC_QS_S the definition of betaDeg caused a compiler error?</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0022</span>: <span class="c"># TODO 26.10.18 ibaris: In function IFUNC_SZ_AF_VZA, IFUNC_SZ_AF_IZA the definition of n_alpha caused a compiler error?</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0023</span>: <span class="c"># The PSD integrator is not programmed yet. Moreover, the AA orientation will be deleted.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0024</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">0025</span>: <span class="c"># ----------------------------------------------------------------------------------------------------------------------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0026</span>: <span class="c"># Set Auxiliary Variables</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0027</span>: <span class="c"># ----------------------------------------------------------------------------------------------------------------------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0028</span>: <span class="k">cdef</span> <span
            class="p">:</span></pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0029</span>:     <span class="nb">float</span> <span class="n">ddelt</span> <span
            class="o">=</span> <span class="mf">1e-3</span></pre>
    <pre class='cython code score-0 '>  __pyx_v_6pyrism_4core_3tma_ddelt = 1e-3;
</pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0030</span>:     <span class="nb">int</span> <span class="n">ndgs</span> <span
            class="o">=</span> <span class="mf">2</span></pre>
    <pre class='cython code score-0 '>  __pyx_v_6pyrism_4core_3tma_ndgs = 2;
</pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0031</span>:     <span class="nb">float</span> <span class="n">PI</span> <span
            class="o">=</span> <span class="mf">3.14159265359</span></pre>
    <pre class='cython code score-0 '>  __pyx_v_6pyrism_4core_3tma_PI = 3.14159265359;
</pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0032</span>:     <span class="nb">float</span> <span class="n">DEG_TO_RAD</span> <span
            class="o">=</span> <span class="n">PI</span> <span class="o">/</span> <span class="mf">180.0</span></pre>
    <pre class='cython code score-0 '>  __pyx_v_6pyrism_4core_3tma_DEG_TO_RAD = (((double)__pyx_v_6pyrism_4core_3tma_PI) / 180.0);
</pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0033</span>:     <span class="nb">float</span> <span class="n">RAD_TO_DEG</span> <span
            class="o">=</span> <span class="mf">180.0</span> <span class="o">/</span> <span class="n">PI</span></pre>
    <pre class='cython code score-0 '>  __pyx_v_6pyrism_4core_3tma_RAD_TO_DEG = (180.0 / ((double)__pyx_v_6pyrism_4core_3tma_PI));
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0034</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">0035</span>: <span class="c"># ----------------------------------------------------------------------------------------------------------------------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0036</span>: <span class="c"># NMAX</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0037</span>: <span class="c"># ----------------------------------------------------------------------------------------------------------------------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0038</span>: <span class="c"># Vectorized -----------------------------------------------------------------------------------------------------------</span></pre>
    <pre class="cython line score-21"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0039</span>: <span class="k">cdef</span> <span class="kt">int</span>[<span
            class="p">:]</span> <span class="n">NMAX_VEC</span><span class="p">(</span><span
            class="n">double</span><span class="p">[:]</span> <span class="n">radius</span><span
            class="p">,</span> <span class="nb">int</span> <span class="n">radius_type</span><span
            class="p">,</span> <span class="n">double</span><span class="p">[:]</span> <span class="n">wavelength</span><span
            class="p">,</span> <span class="n">double</span><span class="p">[:]</span> <span
            class="n">eps_real</span><span class="p">,</span> <span class="n">double</span><span
            class="p">[:]</span> <span class="n">eps_imag</span><span class="p">,</span></pre>
    <pre class='cython code score-21 '>static __Pyx_memviewslice __pyx_f_6pyrism_4core_3tma_NMAX_VEC(__Pyx_memviewslice __pyx_v_radius, int __pyx_v_radius_type, __Pyx_memviewslice __pyx_v_wavelength, __Pyx_memviewslice __pyx_v_eps_real, __Pyx_memviewslice __pyx_v_eps_imag, __Pyx_memviewslice __pyx_v_axis_ratio, int __pyx_v_shape, int __pyx_v_verbose) {
  Py_ssize_t __pyx_v_xmax;
  Py_ssize_t __pyx_v_x;
  PyObject *__pyx_v_result = NULL;
  __Pyx_memviewslice __pyx_v_result_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_r = { 0, 0, { 0 }, { 0 }, { 0 } };
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("NMAX_VEC", 0);
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_20);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_21);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_22);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_23);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_24);
  __pyx_r.data = NULL;
  __pyx_r.memview = NULL;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.NMAX_VEC", __pyx_clineno, __pyx_lineno, __pyx_filename);

  goto __pyx_L2;
  __pyx_L0:;
  if (unlikely(!__pyx_r.memview)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "Memoryview return value is not initialized");
  }
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_result);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_result_view, 1);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0040</span>:                      <span
            class="n">double</span><span class="p">[:]</span> <span class="n">axis_ratio</span><span class="p">,</span> <span
            class="nb">int</span> <span class="n">shape</span><span class="p">,</span> <span class="nb">int</span> <span
            class="n">verbose</span><span class="p">):</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0041</span>:     <span
            class="sd">&quot;&quot;&quot;</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0042</span>: <span class="sd">    Calculate NMAX in a vectorized function. </span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0043</span>: <span class="sd">    </span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0044</span>: <span class="sd">    Parameters</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0045</span>: <span class="sd">    ----------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0046</span>: <span
            class="sd">    radius : double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0047</span>: <span class="sd">        Equivalent particle radius in same unit as wavelength.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0048</span>: <span
            class="sd">    radius_type : int, {0, 1, 2}</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0049</span>: <span class="sd">        Specification of particle radius:</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0050</span>: <span class="sd">            * 0: radius is the equivalent volume radius (default).</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0051</span>: <span class="sd">            * 1: radius is the equivalent area radius.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0052</span>: <span class="sd">            * 2: radius is the maximum radius.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0053</span>: <span
            class="sd">    wavelength : double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0054</span>: <span class="sd">        Wavelength in same unit as radius.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0055</span>: <span class="sd">    eps_real, eps_imag : double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0056</span>: <span class="sd">        Real and imaginary part of the dielectric constant.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0057</span>: <span
            class="sd">    axis_ratio : double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0058</span>: <span class="sd">        The horizontal-to-rotational axis ratio.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0059</span>: <span class="sd">    shape : int, {-1, -2}</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0060</span>: <span
            class="sd">        Shape of the particle:</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0061</span>: <span
            class="sd">            * -1 : spheroid,</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0062</span>: <span
            class="sd">            * -2 : cylinders.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0063</span>: <span class="sd">    </span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0064</span>: <span class="sd">    Returns</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0065</span>: <span class="sd">    -------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0066</span>: <span
            class="sd">    nmax : MemoryView</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0067</span>: <span class="sd">    </span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0068</span>: <span
            class="sd">    &quot;&quot;&quot;</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0069</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">0070</span>:     <span class="k">cdef</span><span
            class="p">:</span></pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0071</span>:         <span class="n">Py_ssize_t</span> <span class="n">xmax</span> <span class="o">=</span> <span
            class="n">radius</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span
            class="mf">0</span><span class="p">]</span></pre>
    <pre class='cython code score-0 '>  __pyx_v_xmax = (__pyx_v_radius.shape[0]);
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0072</span>:         <span class="n">Py_ssize_t</span> <span
            class="n">x</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0073</span>: </pre>
    <pre class="cython line score-29"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0074</span>:     <span class="n">result</span> <span class="o">=</span> <span
            class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span
            class="n">radius</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span
            class="n">np</span><span class="o">.</span><span class="n">intc</span><span class="p">)</span></pre>
    <pre class='cython code score-29 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span
            class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 74, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros_like);<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 74, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_radius, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 74, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 74, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 74, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 74, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_intc);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 74, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 74, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, __pyx_t_1);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 74, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_result = __pyx_t_5;
  __pyx_t_5 = 0;
</pre>
    <pre class="cython line score-2"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0075</span>:     <span class="k">cdef</span> <span class="kt">int</span>[<span class="p">:]</span> <span
            class="n">result_view</span> <span class="o">=</span> <span class="n">result</span></pre>
    <pre class='cython code score-2 '>  __pyx_t_6 = <span
            class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_v_result, PyBUF_WRITABLE);<span
            class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 75, __pyx_L1_error)</span>
  __pyx_v_result_view = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0076</span>: </pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0077</span>:     <span class="k">for</span> <span class="n">x</span> <span
            class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">xmax</span><span
            class="p">):</span></pre>
    <pre class='cython code score-0 '>  __pyx_t_7 = __pyx_v_xmax;
  __pyx_t_8 = __pyx_t_7;
  for (__pyx_t_9 = 0; __pyx_t_9 &lt; __pyx_t_8; __pyx_t_9+=1) {
    __pyx_v_x = __pyx_t_9;
</pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0078</span>:         <span class="k">if</span> <span class="n">verbose</span> <span
            class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
    <pre class='cython code score-0 '>    __pyx_t_10 = ((__pyx_v_verbose == 1) != 0);
    if (__pyx_t_10) {
/* â€¦ */
    }
</pre>
    <pre class="cython line score-111"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0079</span>:             <span class="n">sys</span><span class="o">.</span><span
            class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span
            class="s">&quot;</span><span class="se">\r</span><span class="s">&quot;</span> <span
            class="o">+</span> <span class="s">&quot;Computing NMAX: {0} of {1}&quot;</span><span
            class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span
            class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mf">1</span><span class="p">),</span> <span
            class="nb">str</span><span class="p">(</span><span class="n">xmax</span><span class="p">)))</span></pre>
    <pre class='cython code score-111 '>      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_sys);<span
            class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 79, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_stdout);<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 79, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_write);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 79, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_kp_s_Computing_NMAX_0_of_1, __pyx_n_s_format);<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 79, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_4 = <span class='py_c_api'>PyInt_FromSsize_t</span>((__pyx_v_x + 1));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 79, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)(&amp;PyString_Type)), __pyx_t_4);<span
                class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 79, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_xmax);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 79, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)(&amp;PyString_Type)), __pyx_t_4);<span
                class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 79, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = NULL;
      __pyx_t_13 = 0;
      if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
        __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
        if (likely(__pyx_t_4)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
          __pyx_t_13 = 1;
        }
      }
      #if CYTHON_FAST_PYCALL
      if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_2)) {
        PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_11, __pyx_t_12};
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_13, 2+__pyx_t_13);<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 79, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      } else
      #endif
      #if CYTHON_FAST_PYCCALL
      if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_2)) {
        PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_11, __pyx_t_12};
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_13, 2+__pyx_t_13);<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 79, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      } else
      #endif
      {
        __pyx_t_14 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 79, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
        if (__pyx_t_4) {
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0, __pyx_t_4); __pyx_t_4 = NULL;
        }
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0+__pyx_t_13, __pyx_t_11);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 1+__pyx_t_13, __pyx_t_12);
        __pyx_t_11 = 0;
        __pyx_t_12 = 0;
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_14, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 79, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_kp_s_, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 79, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = NULL;
      if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
        __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
        if (likely(__pyx_t_3)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
        }
      }
      if (!__pyx_t_3) {
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_2);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 79, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      } else {
        #if CYTHON_FAST_PYCALL
        if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_1)) {
          PyObject *__pyx_temp[2] = {__pyx_t_3, __pyx_t_2};
          __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 79, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        } else
        #endif
        #if CYTHON_FAST_PYCCALL
        if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_1)) {
          PyObject *__pyx_temp[2] = {__pyx_t_3, __pyx_t_2};
          __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 79, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        } else
        #endif
        {
          __pyx_t_14 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 79, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0, __pyx_t_3); __pyx_t_3 = NULL;
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0+1, __pyx_t_2);
          __pyx_t_2 = 0;
          __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_14, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 79, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
        }
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre>
    <pre class="cython line score-25"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0080</span>:             <span class="n">sys</span><span class="o">.</span><span
            class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span></pre>
    <pre class='cython code score-25 '>      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_sys);<span
            class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 80, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_stdout);<span
                class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 80, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_14, __pyx_n_s_flush);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 80, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
      __pyx_t_14 = NULL;
      if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
        __pyx_t_14 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
        if (likely(__pyx_t_14)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_14);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
        }
      }
      if (__pyx_t_14) {
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_14);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 80, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
      } else {
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 80, __pyx_L1_error)</span>
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0081</span>: </pre>
    <pre class="cython line score-49"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0082</span>:         <span class="n">result_view</span><span class="p">[</span><span
            class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">calctmat</span><span
            class="p">(</span><span class="n">radius</span><span class="p">[</span><span class="n">x</span><span
            class="p">],</span> <span class="n">radius_type</span><span class="p">,</span> <span
            class="n">wavelength</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span
            class="n">eps_real</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span
            class="n">eps_imag</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span
            class="n">axis_ratio</span><span class="p">[</span><span class="n">x</span><span class="p">],</span></pre>
    <pre class='cython code score-49 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_calctmat);<span
            class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 82, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_15 = __pyx_v_x;
    __pyx_t_13 = -1;
    if (__pyx_t_15 &lt; 0) {
      __pyx_t_15 += __pyx_v_radius.shape[0];
      if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_13 = 0;
    } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_radius.shape[0])) __pyx_t_13 = 0;
    if (unlikely(__pyx_t_13 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
      <span class='error_goto'>__PYX_ERR(0, 82, __pyx_L1_error)</span>
    }
    __pyx_t_14 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_radius.data + __pyx_t_15 * __pyx_v_radius.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 82, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_radius_type);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 82, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_16 = __pyx_v_x;
    __pyx_t_13 = -1;
    if (__pyx_t_16 &lt; 0) {
      __pyx_t_16 += __pyx_v_wavelength.shape[0];
      if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_13 = 0;
    } else if (unlikely(__pyx_t_16 &gt;= __pyx_v_wavelength.shape[0])) __pyx_t_13 = 0;
    if (unlikely(__pyx_t_13 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
      <span class='error_goto'>__PYX_ERR(0, 82, __pyx_L1_error)</span>
    }
    __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_wavelength.data + __pyx_t_16 * __pyx_v_wavelength.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 82, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_17 = __pyx_v_x;
    __pyx_t_13 = -1;
    if (__pyx_t_17 &lt; 0) {
      __pyx_t_17 += __pyx_v_eps_real.shape[0];
      if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_13 = 0;
    } else if (unlikely(__pyx_t_17 &gt;= __pyx_v_eps_real.shape[0])) __pyx_t_13 = 0;
    if (unlikely(__pyx_t_13 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
      <span class='error_goto'>__PYX_ERR(0, 82, __pyx_L1_error)</span>
    }
    __pyx_t_12 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_eps_real.data + __pyx_t_17 * __pyx_v_eps_real.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 82, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    __pyx_t_18 = __pyx_v_x;
    __pyx_t_13 = -1;
    if (__pyx_t_18 &lt; 0) {
      __pyx_t_18 += __pyx_v_eps_imag.shape[0];
      if (unlikely(__pyx_t_18 &lt; 0)) __pyx_t_13 = 0;
    } else if (unlikely(__pyx_t_18 &gt;= __pyx_v_eps_imag.shape[0])) __pyx_t_13 = 0;
    if (unlikely(__pyx_t_13 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
      <span class='error_goto'>__PYX_ERR(0, 82, __pyx_L1_error)</span>
    }
    __pyx_t_11 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_eps_imag.data + __pyx_t_18 * __pyx_v_eps_imag.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 82, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    __pyx_t_19 = __pyx_v_x;
    __pyx_t_13 = -1;
    if (__pyx_t_19 &lt; 0) {
      __pyx_t_19 += __pyx_v_axis_ratio.shape[0];
      if (unlikely(__pyx_t_19 &lt; 0)) __pyx_t_13 = 0;
    } else if (unlikely(__pyx_t_19 &gt;= __pyx_v_axis_ratio.shape[0])) __pyx_t_13 = 0;
    if (unlikely(__pyx_t_13 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
      <span class='error_goto'>__PYX_ERR(0, 82, __pyx_L1_error)</span>
    }
    __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_axis_ratio.data + __pyx_t_19 * __pyx_v_axis_ratio.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 82, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
/* â€¦ */
    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_5); if (unlikely((__pyx_t_13 == (int)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 82, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_25 = __pyx_v_x;
    __pyx_t_26 = -1;
    if (__pyx_t_25 &lt; 0) {
      __pyx_t_25 += __pyx_v_result_view.shape[0];
      if (unlikely(__pyx_t_25 &lt; 0)) __pyx_t_26 = 0;
    } else if (unlikely(__pyx_t_25 &gt;= __pyx_v_result_view.shape[0])) __pyx_t_26 = 0;
    if (unlikely(__pyx_t_26 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_26);
      <span class='error_goto'>__PYX_ERR(0, 82, __pyx_L1_error)</span>
    }
    *((int *) ( /* dim=0 */ (__pyx_v_result_view.data + __pyx_t_25 * __pyx_v_result_view.strides[0]) )) = __pyx_t_13;
  }
</pre>
    <pre class="cython line score-69"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0083</span>:                                   <span class="n">shape</span><span class="p">,</span> <span
            class="n">ddelt</span><span class="p">,</span> <span class="n">ndgs</span><span class="p">)</span></pre>
    <pre class='cython code score-69 '>    __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_shape);<span
            class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 83, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
    __pyx_t_21 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_6pyrism_4core_3tma_ddelt);<span
                class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 83, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
    __pyx_t_22 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_6pyrism_4core_3tma_ndgs);<span
                class='error_goto'> if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 83, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_22);
    __pyx_t_23 = NULL;
    __pyx_t_13 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_23 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_23)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_23);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
        __pyx_t_13 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_1)) {
      PyObject *__pyx_temp[10] = {__pyx_t_23, __pyx_t_14, __pyx_t_2, __pyx_t_3, __pyx_t_12, __pyx_t_11, __pyx_t_4, __pyx_t_20, __pyx_t_21, __pyx_t_22};
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-__pyx_t_13, 9+__pyx_t_13);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 82, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_22); __pyx_t_22 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_1)) {
      PyObject *__pyx_temp[10] = {__pyx_t_23, __pyx_t_14, __pyx_t_2, __pyx_t_3, __pyx_t_12, __pyx_t_11, __pyx_t_4, __pyx_t_20, __pyx_t_21, __pyx_t_22};
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-__pyx_t_13, 9+__pyx_t_13);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 82, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_22); __pyx_t_22 = 0;
    } else
    #endif
    {
      __pyx_t_24 = <span class='py_c_api'>PyTuple_New</span>(9+__pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 82, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_24);
      if (__pyx_t_23) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_23); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_24, 0, __pyx_t_23); __pyx_t_23 = NULL;
      }
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_14);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_24, 0+__pyx_t_13, __pyx_t_14);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_24, 1+__pyx_t_13, __pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_24, 2+__pyx_t_13, __pyx_t_3);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_24, 3+__pyx_t_13, __pyx_t_12);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_24, 4+__pyx_t_13, __pyx_t_11);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_24, 5+__pyx_t_13, __pyx_t_4);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_20);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_24, 6+__pyx_t_13, __pyx_t_20);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_21);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_24, 7+__pyx_t_13, __pyx_t_21);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_22);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_24, 8+__pyx_t_13, __pyx_t_22);
      __pyx_t_14 = 0;
      __pyx_t_2 = 0;
      __pyx_t_3 = 0;
      __pyx_t_12 = 0;
      __pyx_t_11 = 0;
      __pyx_t_4 = 0;
      __pyx_t_20 = 0;
      __pyx_t_21 = 0;
      __pyx_t_22 = 0;
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_24, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 82, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_24); __pyx_t_24 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0084</span>:     <span class="k">if</span> <span class="n">verbose</span> <span class="o">==</span> <span
            class="mf">1</span><span class="p">:</span></pre>
    <pre class='cython code score-0 '>  __pyx_t_10 = ((__pyx_v_verbose == 1) != 0);
  if (__pyx_t_10) {
/* â€¦ */
  }
</pre>
    <pre class="cython line score-17"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0085</span>:         <span class="n">sys</span><span class="o">.</span><span
            class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span
            class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span></pre>
    <pre class='cython code score-17 '>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_sys);<span
            class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 85, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_stdout);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 85, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_write);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 85, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_tuple__3, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 85, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* â€¦ */
  __pyx_tuple__3 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s__2);<span class='error_goto'> if (unlikely(!__pyx_tuple__3)) __PYX_ERR(0, 85, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__3);
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0086</span>: </pre>
    <pre class="cython line score-2"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0087</span>:     <span class="k">return</span> <span class="n">result</span></pre>
    <pre class='cython code score-2 '>  __pyx_t_6 = <span
            class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_v_result, PyBUF_WRITABLE);<span
            class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 87, __pyx_L1_error)</span>
  __pyx_r = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
  goto __pyx_L0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0088</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">0089</span>: <span class="c"># NOT Vectorized -------------------------------------------------------------------------------------------------------</span></pre>
    <pre class="cython line score-15"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0090</span>: <span class="k">cdef</span> <span class="kt">int</span> <span
            class="nf">NMAX</span><span class="p">(</span><span class="n">double</span> <span
            class="n">radius</span><span class="p">,</span> <span class="nb">int</span> <span
            class="n">radius_type</span><span class="p">,</span> <span class="n">double</span> <span class="n">wavelength</span><span
            class="p">,</span> <span class="n">double</span> <span class="n">eps_real</span><span
            class="p">,</span> <span class="n">double</span> <span class="n">eps_imag</span><span
            class="p">,</span> <span class="n">double</span> <span class="n">axis_ratio</span><span
            class="p">,</span></pre>
    <pre class='cython code score-15 '>static int __pyx_f_6pyrism_4core_3tma_NMAX(double __pyx_v_radius, int __pyx_v_radius_type, double __pyx_v_wavelength, double __pyx_v_eps_real, double __pyx_v_eps_imag, double __pyx_v_axis_ratio, int __pyx_v_shape) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("NMAX", 0);
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("pyrism.core.tma.NMAX", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0091</span>:               <span class="nb">int</span> <span
            class="n">shape</span><span class="p">):</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0092</span>:     <span
            class="sd">&quot;&quot;&quot;</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0093</span>: <span class="sd">    Calculate NMAX.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0094</span>: <span class="sd">    </span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0095</span>: <span class="sd">    Parameters</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0096</span>: <span class="sd">    ----------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0097</span>: <span class="sd">    radius : double</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0098</span>: <span class="sd">        Equivalent particle radius in same unit as wavelength.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0099</span>: <span
            class="sd">    radius_type : int, {0, 1, 2}</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0100</span>: <span class="sd">        Specification of particle radius:</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0101</span>: <span class="sd">            * 0: radius is the equivalent volume radius (default).</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0102</span>: <span class="sd">            * 1: radius is the equivalent area radius.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0103</span>: <span class="sd">            * 2: radius is the maximum radius.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0104</span>: <span
            class="sd">    wavelength : double</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0105</span>: <span class="sd">        Wavelength in same unit as radius.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0106</span>: <span
            class="sd">    eps_real, eps_imag : double</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0107</span>: <span class="sd">        Real and imaginary part of the dielectric constant.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0108</span>: <span
            class="sd">    axis_ratio : double</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0109</span>: <span class="sd">        The horizontal-to-rotational axis ratio.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0110</span>: <span class="sd">    shape : int, {-1, -2}</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0111</span>: <span
            class="sd">        Shape of the particle:</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0112</span>: <span
            class="sd">            * -1 : spheroid,</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0113</span>: <span
            class="sd">            * -2 : cylinders.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0114</span>: <span class="sd">    </span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0115</span>: <span class="sd">    Returns</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0116</span>: <span class="sd">    -------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0117</span>: <span class="sd">    nmax : int</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0118</span>: <span class="sd">    </span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0119</span>: <span
            class="sd">    &quot;&quot;&quot;</span></pre>
    <pre class="cython line score-106"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0120</span>:     <span class="k">return</span> <span class="n">calctmat</span><span
            class="p">(</span><span class="n">radius</span><span class="p">,</span> <span
            class="n">radius_type</span><span class="p">,</span> <span class="n">wavelength</span><span
            class="p">,</span> <span class="n">eps_real</span><span class="p">,</span> <span
            class="n">eps_imag</span><span class="p">,</span> <span class="n">axis_ratio</span><span class="p">,</span> <span
            class="n">shape</span><span class="p">,</span> <span class="n">ddelt</span><span class="p">,</span> <span
            class="n">ndgs</span><span class="p">)</span></pre>
    <pre class='cython code score-106 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_calctmat);<span
            class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 120, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_radius);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 120, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_radius_type);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 120, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_wavelength);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 120, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_eps_real);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 120, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_eps_imag);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 120, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_8 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_axis_ratio);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 120, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_shape);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 120, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_10 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_6pyrism_4core_3tma_ddelt);<span
                class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 120, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_6pyrism_4core_3tma_ndgs);<span
                class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 120, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_12 = NULL;
  __pyx_t_13 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_12 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_12)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_13 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_2)) {
    PyObject *__pyx_temp[10] = {__pyx_t_12, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8, __pyx_t_9, __pyx_t_10, __pyx_t_11};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_13, 9+__pyx_t_13);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 120, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_2)) {
    PyObject *__pyx_temp[10] = {__pyx_t_12, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8, __pyx_t_9, __pyx_t_10, __pyx_t_11};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_13, 9+__pyx_t_13);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 120, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  } else
  #endif
  {
    __pyx_t_14 = <span class='py_c_api'>PyTuple_New</span>(9+__pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 120, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    if (__pyx_t_12) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0, __pyx_t_12); __pyx_t_12 = NULL;
    }
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0+__pyx_t_13, __pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 1+__pyx_t_13, __pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 2+__pyx_t_13, __pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 3+__pyx_t_13, __pyx_t_6);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 4+__pyx_t_13, __pyx_t_7);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 5+__pyx_t_13, __pyx_t_8);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 6+__pyx_t_13, __pyx_t_9);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 7+__pyx_t_13, __pyx_t_10);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 8+__pyx_t_13, __pyx_t_11);
    __pyx_t_3 = 0;
    __pyx_t_4 = 0;
    __pyx_t_5 = 0;
    __pyx_t_6 = 0;
    __pyx_t_7 = 0;
    __pyx_t_8 = 0;
    __pyx_t_9 = 0;
    __pyx_t_10 = 0;
    __pyx_t_11 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_14, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 120, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1); if (unlikely((__pyx_t_13 == (int)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 120, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_r = __pyx_t_13;
  goto __pyx_L0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0121</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">0122</span>: <span class="c"># ----------------------------------------------------------------------------------------------------------------------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0123</span>: <span
            class="c"># T-Matrix to Calculate S, Z</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0124</span>: <span class="c"># ----------------------------------------------------------------------------------------------------------------------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0125</span>: <span class="c"># Single Orientation ---------------------------------------------------------------------------------------------------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0126</span>: <span
            class="c"># ---- Vectorized ----</span></pre>
    <pre class="cython line score-28"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0127</span>: <span class="k">cdef</span> <span class="kt">tuple</span> <span
            class="nf">SZ_S_VEC</span><span class="p">(</span><span class="nb">int</span><span
            class="p">[:]</span> <span class="n">nmax</span><span class="p">,</span> <span class="n">double</span><span
            class="p">[:]</span> <span class="n">wavelength</span><span class="p">,</span> <span class="n">double</span><span
            class="p">[:]</span> <span class="n">izaDeg</span><span class="p">,</span> <span
            class="n">double</span><span class="p">[:]</span> <span class="n">vzaDeg</span><span
            class="p">,</span> <span class="n">double</span><span class="p">[:]</span> <span
            class="n">iaaDeg</span><span class="p">,</span></pre>
    <pre class='cython code score-28 '>static PyObject *__pyx_f_6pyrism_4core_3tma_SZ_S_VEC(__Pyx_memviewslice __pyx_v_nmax, __Pyx_memviewslice __pyx_v_wavelength, __Pyx_memviewslice __pyx_v_izaDeg, __Pyx_memviewslice __pyx_v_vzaDeg, __Pyx_memviewslice __pyx_v_iaaDeg, __Pyx_memviewslice __pyx_v_vaaDeg, __Pyx_memviewslice __pyx_v_alphaDeg, __Pyx_memviewslice __pyx_v_betaDeg) {
  Py_ssize_t __pyx_v_xmax;
  Py_ssize_t __pyx_v_x;
  PyArrayObject *__pyx_v_Z = 0;
  PyArrayObject *__pyx_v_S = 0;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_S;
  __Pyx_Buffer __pyx_pybuffer_S;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Z;
  __Pyx_Buffer __pyx_pybuffer_Z;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("SZ_S_VEC", 0);
  __pyx_pybuffer_Z.pybuffer.buf = NULL;
  __pyx_pybuffer_Z.refcount = 0;
  __pyx_pybuffernd_Z.data = NULL;
  __pyx_pybuffernd_Z.rcbuffer = &amp;__pyx_pybuffer_Z;
  __pyx_pybuffer_S.pybuffer.buf = NULL;
  __pyx_pybuffer_S.refcount = 0;
  __pyx_pybuffernd_S.data = NULL;
  __pyx_pybuffernd_S.rcbuffer = &amp;__pyx_pybuffer_S;
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_19);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_21);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_23);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_25);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_27);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_28);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_29);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_S.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.SZ_S_VEC", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_S.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_Z);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_S);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0128</span>:                     <span class="n">double</span><span
            class="p">[:]</span> <span class="n">vaaDeg</span><span class="p">,</span> <span
            class="n">double</span><span class="p">[:]</span> <span class="n">alphaDeg</span><span
            class="p">,</span> <span class="n">double</span><span class="p">[:]</span> <span
            class="n">betaDeg</span><span class="p">):</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0129</span>:     <span
            class="sd">&quot;&quot;&quot;</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0130</span>: <span class="sd">    Calculate the single scattering and phase matrix in a vectorized function.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0131</span>: <span class="sd">    </span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0132</span>: <span class="sd">    Parameters</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0133</span>: <span class="sd">    ----------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0134</span>: <span class="sd">    nmax : int[:] </span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0135</span>: <span
            class="sd">        Nmax parameter.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0136</span>: <span
            class="sd">    wavelength : double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0137</span>: <span class="sd">        Wavelength in same unit as radius (used by function calc_nmax).</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0138</span>: <span class="sd">    izaDeg, vzaDeg, iaaDeg, vaaDeg : double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0139</span>: <span class="sd">        Incidence (iza) and scattering (vza) zenith angle and incidence and viewing</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0140</span>: <span class="sd">        azimuth angle (ira, vra) in [DEG].</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0141</span>: <span
            class="sd">    alphaDeg, betaDeg: double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0142</span>: <span class="sd">        The Euler angles of the particle orientation in [DEG].</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0143</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">0144</span>: <span class="sd">    Returns</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0145</span>: <span class="sd">    -------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0146</span>: <span class="sd">    S, Z : tuple with double[:,:,:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0147</span>: <span class="sd">        Three dimensional scattering (S) and phase (Z) matrix.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0148</span>: <span
            class="sd">    &quot;&quot;&quot;</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0149</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">0150</span>:     <span class="k">cdef</span><span
            class="p">:</span></pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0151</span>:         <span class="n">Py_ssize_t</span> <span class="n">xmax</span> <span class="o">=</span> <span
            class="n">nmax</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span
            class="mf">0</span><span class="p">]</span></pre>
    <pre class='cython code score-0 '>  __pyx_v_xmax = (__pyx_v_nmax.shape[0]);
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0152</span>:         <span class="n">Py_ssize_t</span> <span
            class="n">x</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0153</span>:         <span class="n">np</span><span class="o">.</span><span
            class="n">ndarray</span><span class="p">[</span><span class="n">double</span><span class="p">,</span> <span
            class="n">ndim</span><span class="o">=</span><span class="mf">3</span><span class="p">]</span>  <span
            class="n">Z</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0154</span>:         <span class="n">np</span><span class="o">.</span><span
            class="n">ndarray</span><span class="p">[</span><span class="n">DTYPE_t</span><span class="p">,</span> <span
            class="n">ndim</span><span class="o">=</span><span class="mf">3</span><span class="p">]</span>  <span
            class="n">S</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0155</span>: </pre>
    <pre class="cython line score-64"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0156</span>:     <span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span
            class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">xmax</span><span
            class="p">,</span> <span class="mf">2</span><span class="p">,</span> <span class="mf">2</span><span
            class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span
            class="o">.</span><span class="n">complex</span><span class="p">)</span></pre>
    <pre class='cython code score-64 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span
            class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 156, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 156, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_xmax);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 156, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 156, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 2, __pyx_int_2);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 156, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 156, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 156, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_complex);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 156, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 156, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 156, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) <span
                class='error_goto'>__PYX_ERR(0, 156, __pyx_L1_error)</span>
  __pyx_t_6 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[2];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_S.rcbuffer-&gt;pybuffer);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_S.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_6, &amp;__Pyx_TypeInfo_nn___pyx_t_6pyrism_4core_3tma_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack);
    if (unlikely(__pyx_t_7 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_8, &amp;__pyx_t_9, &amp;__pyx_t_10);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_S.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_S, &amp;__Pyx_TypeInfo_nn___pyx_t_6pyrism_4core_3tma_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_8); Py_XDECREF(__pyx_t_9); Py_XDECREF(__pyx_t_10);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_8, __pyx_t_9, __pyx_t_10);
      }
      __pyx_t_8 = __pyx_t_9 = __pyx_t_10 = 0;
    }
    __pyx_pybuffernd_S.diminfo[0].strides = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_S.diminfo[0].shape = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_S.diminfo[1].strides = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_S.diminfo[1].shape = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_S.diminfo[2].strides = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_S.diminfo[2].shape = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.shape[2];
    if (unlikely(__pyx_t_7 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 156, __pyx_L1_error)</span>
  }
  __pyx_t_6 = 0;
  __pyx_v_S = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;
</pre>
    <pre class="cython line score-64"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0157</span>:     <span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span
            class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">xmax</span><span
            class="p">,</span> <span class="mf">4</span><span class="p">,</span> <span class="mf">4</span><span
            class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span
            class="o">.</span><span class="n">double</span><span class="p">)</span></pre>
    <pre class='cython code score-64 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span
            class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 157, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 157, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_xmax);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 157, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 157, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_int_4);
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 157, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 157, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 157, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_double);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 157, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 157, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_5, __pyx_t_1);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 157, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span
                class='error_goto'>__PYX_ERR(0, 157, __pyx_L1_error)</span>
  __pyx_t_11 = ((PyArrayObject *)__pyx_t_4);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_11, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack);
    if (unlikely(__pyx_t_7 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_10, &amp;__pyx_t_9, &amp;__pyx_t_8);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_Z, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_10); Py_XDECREF(__pyx_t_9); Py_XDECREF(__pyx_t_8);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_10, __pyx_t_9, __pyx_t_8);
      }
      __pyx_t_10 = __pyx_t_9 = __pyx_t_8 = 0;
    }
    __pyx_pybuffernd_Z.diminfo[0].strides = __pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Z.diminfo[0].shape = __pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_Z.diminfo[1].strides = __pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_Z.diminfo[1].shape = __pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_Z.diminfo[2].strides = __pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_Z.diminfo[2].shape = __pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer.shape[2];
    if (unlikely(__pyx_t_7 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 157, __pyx_L1_error)</span>
  }
  __pyx_t_11 = 0;
  __pyx_v_Z = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0158</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">0159</span>: </pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0160</span>:     <span class="k">for</span> <span class="n">x</span> <span
            class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">xmax</span><span
            class="p">):</span></pre>
    <pre class='cython code score-0 '>  __pyx_t_12 = __pyx_v_xmax;
  __pyx_t_13 = __pyx_t_12;
  for (__pyx_t_14 = 0; __pyx_t_14 &lt; __pyx_t_13; __pyx_t_14+=1) {
    __pyx_v_x = __pyx_t_14;
</pre>
    <pre class="cython line score-40"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0161</span>:         <span class="n">S</span><span class="p">[</span><span class="n">x</span><span
            class="p">],</span> <span class="n">Z</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span
            class="o">=</span> <span class="n">calcampl</span><span class="p">(</span><span class="n">nmax</span><span
            class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">wavelength</span><span
            class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">izaDeg</span><span
            class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">vzaDeg</span><span
            class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">iaaDeg</span><span
            class="p">[</span><span class="n">x</span><span class="p">],</span></pre>
    <pre class='cython code score-40 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_calcampl);<span
            class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 161, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_15 = __pyx_v_x;
    __pyx_t_7 = -1;
    if (__pyx_t_15 &lt; 0) {
      __pyx_t_15 += __pyx_v_nmax.shape[0];
      if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_7 = 0;
    } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_nmax.shape[0])) __pyx_t_7 = 0;
    if (unlikely(__pyx_t_7 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
      <span class='error_goto'>__PYX_ERR(0, 161, __pyx_L1_error)</span>
    }
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>((*((int *) ( /* dim=0 */ (__pyx_v_nmax.data + __pyx_t_15 * __pyx_v_nmax.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 161, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_16 = __pyx_v_x;
    __pyx_t_7 = -1;
    if (__pyx_t_16 &lt; 0) {
      __pyx_t_16 += __pyx_v_wavelength.shape[0];
      if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_7 = 0;
    } else if (unlikely(__pyx_t_16 &gt;= __pyx_v_wavelength.shape[0])) __pyx_t_7 = 0;
    if (unlikely(__pyx_t_7 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
      <span class='error_goto'>__PYX_ERR(0, 161, __pyx_L1_error)</span>
    }
    __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_wavelength.data + __pyx_t_16 * __pyx_v_wavelength.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 161, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_17 = __pyx_v_x;
    __pyx_t_7 = -1;
    if (__pyx_t_17 &lt; 0) {
      __pyx_t_17 += __pyx_v_izaDeg.shape[0];
      if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_7 = 0;
    } else if (unlikely(__pyx_t_17 &gt;= __pyx_v_izaDeg.shape[0])) __pyx_t_7 = 0;
    if (unlikely(__pyx_t_7 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
      <span class='error_goto'>__PYX_ERR(0, 161, __pyx_L1_error)</span>
    }
    __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_izaDeg.data + __pyx_t_17 * __pyx_v_izaDeg.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 161, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_18 = __pyx_v_x;
    __pyx_t_7 = -1;
    if (__pyx_t_18 &lt; 0) {
      __pyx_t_18 += __pyx_v_vzaDeg.shape[0];
      if (unlikely(__pyx_t_18 &lt; 0)) __pyx_t_7 = 0;
    } else if (unlikely(__pyx_t_18 &gt;= __pyx_v_vzaDeg.shape[0])) __pyx_t_7 = 0;
    if (unlikely(__pyx_t_7 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
      <span class='error_goto'>__PYX_ERR(0, 161, __pyx_L1_error)</span>
    }
    __pyx_t_19 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_vzaDeg.data + __pyx_t_18 * __pyx_v_vzaDeg.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 161, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
    __pyx_t_20 = __pyx_v_x;
    __pyx_t_7 = -1;
    if (__pyx_t_20 &lt; 0) {
      __pyx_t_20 += __pyx_v_iaaDeg.shape[0];
      if (unlikely(__pyx_t_20 &lt; 0)) __pyx_t_7 = 0;
    } else if (unlikely(__pyx_t_20 &gt;= __pyx_v_iaaDeg.shape[0])) __pyx_t_7 = 0;
    if (unlikely(__pyx_t_7 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
      <span class='error_goto'>__PYX_ERR(0, 161, __pyx_L1_error)</span>
    }
    __pyx_t_21 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_iaaDeg.data + __pyx_t_20 * __pyx_v_iaaDeg.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 161, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
/* â€¦ */
    if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(((PyObject *)__pyx_v_S), __pyx_v_x, __pyx_t_1, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 1, 1) &lt; 0)) <span
                class='error_goto'>__PYX_ERR(0, 161, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(((PyObject *)__pyx_v_Z), __pyx_v_x, __pyx_t_29, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 1, 1) &lt; 0)) <span
                class='error_goto'>__PYX_ERR(0, 161, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_29); __pyx_t_29 = 0;
  }
</pre>
    <pre class="cython line score-122"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0162</span>:                                         <span class="n">vaaDeg</span><span
            class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">alphaDeg</span><span
            class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">betaDeg</span><span
            class="p">[</span><span class="n">x</span><span class="p">])</span></pre>
    <pre class='cython code score-122 '>    __pyx_t_22 = __pyx_v_x;
    __pyx_t_7 = -1;
    if (__pyx_t_22 &lt; 0) {
      __pyx_t_22 += __pyx_v_vaaDeg.shape[0];
      if (unlikely(__pyx_t_22 &lt; 0)) __pyx_t_7 = 0;
    } else if (unlikely(__pyx_t_22 &gt;= __pyx_v_vaaDeg.shape[0])) __pyx_t_7 = 0;
    if (unlikely(__pyx_t_7 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
      <span class='error_goto'>__PYX_ERR(0, 162, __pyx_L1_error)</span>
    }
    __pyx_t_23 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_vaaDeg.data + __pyx_t_22 * __pyx_v_vaaDeg.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 162, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
    __pyx_t_24 = __pyx_v_x;
    __pyx_t_7 = -1;
    if (__pyx_t_24 &lt; 0) {
      __pyx_t_24 += __pyx_v_alphaDeg.shape[0];
      if (unlikely(__pyx_t_24 &lt; 0)) __pyx_t_7 = 0;
    } else if (unlikely(__pyx_t_24 &gt;= __pyx_v_alphaDeg.shape[0])) __pyx_t_7 = 0;
    if (unlikely(__pyx_t_7 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
      <span class='error_goto'>__PYX_ERR(0, 162, __pyx_L1_error)</span>
    }
    __pyx_t_25 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_alphaDeg.data + __pyx_t_24 * __pyx_v_alphaDeg.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 162, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_25);
    __pyx_t_26 = __pyx_v_x;
    __pyx_t_7 = -1;
    if (__pyx_t_26 &lt; 0) {
      __pyx_t_26 += __pyx_v_betaDeg.shape[0];
      if (unlikely(__pyx_t_26 &lt; 0)) __pyx_t_7 = 0;
    } else if (unlikely(__pyx_t_26 &gt;= __pyx_v_betaDeg.shape[0])) __pyx_t_7 = 0;
    if (unlikely(__pyx_t_7 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
      <span class='error_goto'>__PYX_ERR(0, 162, __pyx_L1_error)</span>
    }
    __pyx_t_27 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_betaDeg.data + __pyx_t_26 * __pyx_v_betaDeg.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_27)) __PYX_ERR(0, 162, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_27);
    __pyx_t_28 = NULL;
    __pyx_t_7 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_28 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_28)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_28);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
        __pyx_t_7 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_1)) {
      PyObject *__pyx_temp[9] = {__pyx_t_28, __pyx_t_5, __pyx_t_3, __pyx_t_2, __pyx_t_19, __pyx_t_21, __pyx_t_23, __pyx_t_25, __pyx_t_27};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-__pyx_t_7, 8+__pyx_t_7);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 161, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_28); __pyx_t_28 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_25); __pyx_t_25 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_27); __pyx_t_27 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_1)) {
      PyObject *__pyx_temp[9] = {__pyx_t_28, __pyx_t_5, __pyx_t_3, __pyx_t_2, __pyx_t_19, __pyx_t_21, __pyx_t_23, __pyx_t_25, __pyx_t_27};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-__pyx_t_7, 8+__pyx_t_7);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 161, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_28); __pyx_t_28 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_25); __pyx_t_25 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_27); __pyx_t_27 = 0;
    } else
    #endif
    {
      __pyx_t_29 = <span class='py_c_api'>PyTuple_New</span>(8+__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 161, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_29);
      if (__pyx_t_28) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_28); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_29, 0, __pyx_t_28); __pyx_t_28 = NULL;
      }
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_29, 0+__pyx_t_7, __pyx_t_5);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_29, 1+__pyx_t_7, __pyx_t_3);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_29, 2+__pyx_t_7, __pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_19);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_29, 3+__pyx_t_7, __pyx_t_19);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_21);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_29, 4+__pyx_t_7, __pyx_t_21);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_23);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_29, 5+__pyx_t_7, __pyx_t_23);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_25);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_29, 6+__pyx_t_7, __pyx_t_25);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_27);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_29, 7+__pyx_t_7, __pyx_t_27);
      __pyx_t_5 = 0;
      __pyx_t_3 = 0;
      __pyx_t_2 = 0;
      __pyx_t_19 = 0;
      __pyx_t_21 = 0;
      __pyx_t_23 = 0;
      __pyx_t_25 = 0;
      __pyx_t_27 = 0;
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_29, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 161, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_29); __pyx_t_29 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_4))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4))) {
      PyObject* sequence = __pyx_t_4;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 2)) {
        if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(0, 161, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0);
        __pyx_t_29 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1);
      } else {
        __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0);
        __pyx_t_29 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1);
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_29);
      #else
      __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 161, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_29 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 161, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_29);
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    } else {
      Py_ssize_t index = -1;
      __pyx_t_27 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_27)) __PYX_ERR(0, 161, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_27);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_30 = Py_TYPE(__pyx_t_27)-&gt;tp_iternext;
      index = 0; __pyx_t_1 = __pyx_t_30(__pyx_t_27); if (unlikely(!__pyx_t_1)) goto __pyx_L5_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      index = 1; __pyx_t_29 = __pyx_t_30(__pyx_t_27); if (unlikely(!__pyx_t_29)) goto __pyx_L5_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_29);
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_30(__pyx_t_27), 2) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 161, __pyx_L1_error)</span>
      __pyx_t_30 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_27); __pyx_t_27 = 0;
      goto __pyx_L6_unpacking_done;
      __pyx_L5_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_27); __pyx_t_27 = 0;
      __pyx_t_30 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span
                class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      <span class='error_goto'>__PYX_ERR(0, 161, __pyx_L1_error)</span>
      __pyx_L6_unpacking_done:;
    }
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0163</span>: </pre>
    <pre class="cython line score-10"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0164</span>:     <span class="k">return</span> <span class="n">S</span><span
            class="p">,</span> <span class="n">Z</span></pre>
    <pre class='cython code score-10 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 164, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_S));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_S));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, ((PyObject *)__pyx_v_S));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_Z));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_Z));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, ((PyObject *)__pyx_v_Z));
  __pyx_r = ((PyObject*)__pyx_t_4);
  __pyx_t_4 = 0;
  goto __pyx_L0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0165</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">0166</span>: <span class="c"># ---- NOT Vectorized ----</span></pre>
    <pre class="cython line score-28"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0167</span>: <span class="k">cdef</span> <span class="kt">tuple</span> <span class="nf">SZ_S</span><span
            class="p">(</span><span class="nb">int</span> <span class="n">nmax</span><span class="p">,</span> <span
            class="n">double</span> <span class="n">wavelength</span><span class="p">,</span> <span
            class="n">double</span> <span class="n">izaDeg</span><span class="p">,</span> <span class="n">double</span> <span
            class="n">vzaDeg</span><span class="p">,</span> <span class="n">double</span> <span
            class="n">iaaDeg</span><span class="p">,</span></pre>
    <pre class='cython code score-28 '>static PyObject *__pyx_f_6pyrism_4core_3tma_SZ_S(int __pyx_v_nmax, double __pyx_v_wavelength, double __pyx_v_izaDeg, double __pyx_v_vzaDeg, double __pyx_v_iaaDeg, double __pyx_v_vaaDeg, double __pyx_v_alphaDeg, double __pyx_v_betaDeg) {
  PyArrayObject *__pyx_v_Z = 0;
  PyArrayObject *__pyx_v_S = 0;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_S;
  __Pyx_Buffer __pyx_pybuffer_S;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Z;
  __Pyx_Buffer __pyx_pybuffer_Z;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("SZ_S", 0);
  __pyx_pybuffer_Z.pybuffer.buf = NULL;
  __pyx_pybuffer_Z.refcount = 0;
  __pyx_pybuffernd_Z.data = NULL;
  __pyx_pybuffernd_Z.rcbuffer = &amp;__pyx_pybuffer_Z;
  __pyx_pybuffer_S.pybuffer.buf = NULL;
  __pyx_pybuffer_S.refcount = 0;
  __pyx_pybuffernd_S.data = NULL;
  __pyx_pybuffernd_S.rcbuffer = &amp;__pyx_pybuffer_S;
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_15);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_16);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_18);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_S.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.SZ_S", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_S.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_Z);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_S);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0168</span>:                     <span class="n">double</span> <span
            class="n">vaaDeg</span><span class="p">,</span> <span class="n">double</span> <span
            class="n">alphaDeg</span><span class="p">,</span> <span class="n">double</span> <span
            class="n">betaDeg</span><span class="p">):</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0169</span>:     <span
            class="sd">&quot;&quot;&quot;</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0170</span>: <span class="sd">    Calculate the single scattering and phase matrix.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0171</span>: <span class="sd">    </span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0172</span>: <span class="sd">    Parameters</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0173</span>: <span class="sd">    ----------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0174</span>: <span class="sd">    nmax : int</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0175</span>: <span
            class="sd">        Nmax parameter.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0176</span>: <span
            class="sd">    wavelength : double</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0177</span>: <span class="sd">        Wavelength in same unit as radius (used by function calc_nmax).</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0178</span>: <span class="sd">    izaDeg, vzaDeg, iaaDeg, vaaDeg : double</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0179</span>: <span class="sd">        Incidence (iza) and scattering (vza) zenith angle and incidence and viewing</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0180</span>: <span class="sd">        azimuth angle (ira, vra) in [DEG].</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0181</span>: <span
            class="sd">    alphaDeg, betaDeg: double</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0182</span>: <span class="sd">        The Euler angles of the particle orientation in [DEG].</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0183</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">0184</span>: <span class="sd">    Returns</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0185</span>: <span class="sd">    -------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0186</span>: <span class="sd">    S, Z : tuple with double[:,:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0187</span>: <span class="sd">        Two dimensional scattering (S) and phase (Z) matrix.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0188</span>: <span
            class="sd">    &quot;&quot;&quot;</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0189</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">0190</span>:     <span class="k">cdef</span><span
            class="p">:</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0191</span>:         <span class="n">np</span><span class="o">.</span><span
            class="n">ndarray</span><span class="p">[</span><span class="n">double</span><span class="p">,</span> <span
            class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span>  <span
            class="n">Z</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0192</span>:         <span class="n">np</span><span class="o">.</span><span
            class="n">ndarray</span><span class="p">[</span><span class="n">DTYPE_t</span><span class="p">,</span> <span
            class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span>  <span
            class="n">S</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0193</span>: </pre>
    <pre class="cython line score-52"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0194</span>:     <span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span
            class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mf">2</span><span
            class="p">,</span> <span class="mf">2</span><span class="p">),</span> <span class="n">dtype</span><span
            class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex</span><span
            class="p">)</span></pre>
    <pre class='cython code score-52 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span
            class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 194, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 194, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* â€¦ */
  __pyx_tuple__4 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_2, __pyx_int_2);<span class='error_goto'> if (unlikely(!__pyx_tuple__4)) __PYX_ERR(0, 194, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__4);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 194, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 194, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_complex);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 194, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 194, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_tuple__5, __pyx_t_1);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 194, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span
                class='error_goto'>__PYX_ERR(0, 194, __pyx_L1_error)</span>
  __pyx_t_5 = ((PyArrayObject *)__pyx_t_4);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[2];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_S.rcbuffer-&gt;pybuffer);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_S.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_5, &amp;__Pyx_TypeInfo_nn___pyx_t_6pyrism_4core_3tma_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack);
    if (unlikely(__pyx_t_6 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_7, &amp;__pyx_t_8, &amp;__pyx_t_9);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_S.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_S, &amp;__Pyx_TypeInfo_nn___pyx_t_6pyrism_4core_3tma_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_7); Py_XDECREF(__pyx_t_8); Py_XDECREF(__pyx_t_9);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_7, __pyx_t_8, __pyx_t_9);
      }
      __pyx_t_7 = __pyx_t_8 = __pyx_t_9 = 0;
    }
    __pyx_pybuffernd_S.diminfo[0].strides = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_S.diminfo[0].shape = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_S.diminfo[1].strides = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_S.diminfo[1].shape = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.shape[1];
    if (unlikely(__pyx_t_6 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 194, __pyx_L1_error)</span>
  }
  __pyx_t_5 = 0;
  __pyx_v_S = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_tuple__5 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_tuple__4);<span class='error_goto'> if (unlikely(!__pyx_tuple__5)) __PYX_ERR(0, 194, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__5);
</pre>
    <pre class="cython line score-52"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0195</span>:     <span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span
            class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mf">4</span><span
            class="p">,</span> <span class="mf">4</span><span class="p">),</span> <span class="n">dtype</span><span
            class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span
            class="p">)</span></pre>
    <pre class='cython code score-52 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span
            class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 195, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_zeros);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 195, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
/* â€¦ */
  __pyx_tuple__6 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_4, __pyx_int_4);<span class='error_goto'> if (unlikely(!__pyx_tuple__6)) __PYX_ERR(0, 195, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__6);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 195, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 195, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_double);<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 195, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_3) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 195, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_tuple__7, __pyx_t_4);<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 195, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_3) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) <span
                class='error_goto'>__PYX_ERR(0, 195, __pyx_L1_error)</span>
  __pyx_t_10 = ((PyArrayObject *)__pyx_t_3);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_10, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack);
    if (unlikely(__pyx_t_6 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_9, &amp;__pyx_t_8, &amp;__pyx_t_7);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_Z, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_9); Py_XDECREF(__pyx_t_8); Py_XDECREF(__pyx_t_7);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_9, __pyx_t_8, __pyx_t_7);
      }
      __pyx_t_9 = __pyx_t_8 = __pyx_t_7 = 0;
    }
    __pyx_pybuffernd_Z.diminfo[0].strides = __pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Z.diminfo[0].shape = __pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_Z.diminfo[1].strides = __pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_Z.diminfo[1].shape = __pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer.shape[1];
    if (unlikely(__pyx_t_6 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 195, __pyx_L1_error)</span>
  }
  __pyx_t_10 = 0;
  __pyx_v_Z = ((PyArrayObject *)__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_tuple__7 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_tuple__6);<span class='error_goto'> if (unlikely(!__pyx_tuple__7)) __PYX_ERR(0, 195, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__7);
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0196</span>: </pre>
    <pre class="cython line score-182"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0197</span>:     <span class="n">S</span><span class="p">,</span> <span class="n">Z</span> <span
            class="o">=</span> <span class="n">calcampl</span><span class="p">(</span><span class="n">nmax</span><span
            class="p">,</span> <span class="n">wavelength</span><span class="p">,</span> <span
            class="n">izaDeg</span><span class="p">,</span> <span class="n">vzaDeg</span><span class="p">,</span> <span
            class="n">iaaDeg</span><span class="p">,</span> <span class="n">vaaDeg</span><span class="p">,</span> <span
            class="n">alphaDeg</span><span class="p">,</span> <span class="n">betaDeg</span><span
            class="p">)</span></pre>
    <pre class='cython code score-182 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_calcampl);<span
            class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 197, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_nmax);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 197, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_wavelength);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 197, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_11 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_izaDeg);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 197, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_12 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_vzaDeg);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 197, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  __pyx_t_13 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_iaaDeg);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 197, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  __pyx_t_14 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_vaaDeg);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 197, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
  __pyx_t_15 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_alphaDeg);<span class='error_goto'> if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 197, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
  __pyx_t_16 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_betaDeg);<span class='error_goto'> if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 197, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
  __pyx_t_17 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_17 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_17)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_17);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      __pyx_t_6 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_4)) {
    PyObject *__pyx_temp[9] = {__pyx_t_17, __pyx_t_1, __pyx_t_2, __pyx_t_11, __pyx_t_12, __pyx_t_13, __pyx_t_14, __pyx_t_15, __pyx_t_16};
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-__pyx_t_6, 8+__pyx_t_6);<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 197, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_4)) {
    PyObject *__pyx_temp[9] = {__pyx_t_17, __pyx_t_1, __pyx_t_2, __pyx_t_11, __pyx_t_12, __pyx_t_13, __pyx_t_14, __pyx_t_15, __pyx_t_16};
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-__pyx_t_6, 8+__pyx_t_6);<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 197, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
  } else
  #endif
  {
    __pyx_t_18 = <span class='py_c_api'>PyTuple_New</span>(8+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 197, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
    if (__pyx_t_17) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_17); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_18, 0, __pyx_t_17); __pyx_t_17 = NULL;
    }
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_18, 0+__pyx_t_6, __pyx_t_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_18, 1+__pyx_t_6, __pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_18, 2+__pyx_t_6, __pyx_t_11);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_18, 3+__pyx_t_6, __pyx_t_12);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_13);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_18, 4+__pyx_t_6, __pyx_t_13);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_14);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_18, 5+__pyx_t_6, __pyx_t_14);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_15);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_18, 6+__pyx_t_6, __pyx_t_15);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_16);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_18, 7+__pyx_t_6, __pyx_t_16);
    __pyx_t_1 = 0;
    __pyx_t_2 = 0;
    __pyx_t_11 = 0;
    __pyx_t_12 = 0;
    __pyx_t_13 = 0;
    __pyx_t_14 = 0;
    __pyx_t_15 = 0;
    __pyx_t_16 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_18, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 197, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3))) || (<span
                class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3))) {
    PyObject* sequence = __pyx_t_3;
    Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
    if (unlikely(size != 2)) {
      if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      <span class='error_goto'>__PYX_ERR(0, 197, __pyx_L1_error)</span>
    }
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0);
      __pyx_t_18 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1);
    } else {
      __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0);
      __pyx_t_18 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1);
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_18);
    #else
    __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 197, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_18 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 197, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_16 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 197, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_19 = Py_TYPE(__pyx_t_16)-&gt;tp_iternext;
    index = 0; __pyx_t_4 = __pyx_t_19(__pyx_t_16); if (unlikely(!__pyx_t_4)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    index = 1; __pyx_t_18 = __pyx_t_19(__pyx_t_16); if (unlikely(!__pyx_t_18)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
    if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_19(__pyx_t_16), 2) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 197, __pyx_L1_error)</span>
    __pyx_t_19 = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
    goto __pyx_L4_unpacking_done;
    __pyx_L3_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
    __pyx_t_19 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span
                class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
    <span class='error_goto'>__PYX_ERR(0, 197, __pyx_L1_error)</span>
    __pyx_L4_unpacking_done:;
  }
  if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span
                class='error_goto'>__PYX_ERR(0, 197, __pyx_L1_error)</span>
  if (!(likely(((__pyx_t_18) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_18, __pyx_ptype_5numpy_ndarray))))) <span
                class='error_goto'>__PYX_ERR(0, 197, __pyx_L1_error)</span>
  __pyx_t_5 = ((PyArrayObject *)__pyx_t_4);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[2];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_S.rcbuffer-&gt;pybuffer);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_S.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_5, &amp;__Pyx_TypeInfo_nn___pyx_t_6pyrism_4core_3tma_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack);
    if (unlikely(__pyx_t_6 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_7, &amp;__pyx_t_8, &amp;__pyx_t_9);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_S.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_S, &amp;__Pyx_TypeInfo_nn___pyx_t_6pyrism_4core_3tma_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_7); Py_XDECREF(__pyx_t_8); Py_XDECREF(__pyx_t_9);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_7, __pyx_t_8, __pyx_t_9);
      }
      __pyx_t_7 = __pyx_t_8 = __pyx_t_9 = 0;
    }
    __pyx_pybuffernd_S.diminfo[0].strides = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_S.diminfo[0].shape = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_S.diminfo[1].strides = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_S.diminfo[1].shape = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.shape[1];
    if (unlikely(__pyx_t_6 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 197, __pyx_L1_error)</span>
  }
  __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_S, ((PyArrayObject *)__pyx_t_4));
  __pyx_t_4 = 0;
  __pyx_t_10 = ((PyArrayObject *)__pyx_t_18);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_10, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack);
    if (unlikely(__pyx_t_6 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_9, &amp;__pyx_t_8, &amp;__pyx_t_7);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_Z, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_9); Py_XDECREF(__pyx_t_8); Py_XDECREF(__pyx_t_7);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_9, __pyx_t_8, __pyx_t_7);
      }
      __pyx_t_9 = __pyx_t_8 = __pyx_t_7 = 0;
    }
    __pyx_pybuffernd_Z.diminfo[0].strides = __pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Z.diminfo[0].shape = __pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_Z.diminfo[1].strides = __pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_Z.diminfo[1].shape = __pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer.shape[1];
    if (unlikely(__pyx_t_6 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 197, __pyx_L1_error)</span>
  }
  __pyx_t_10 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_Z, ((PyArrayObject *)__pyx_t_18));
  __pyx_t_18 = 0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0198</span>: </pre>
    <pre class="cython line score-10"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0199</span>:     <span class="k">return</span> <span class="n">S</span><span
            class="p">,</span> <span class="n">Z</span></pre>
    <pre class='cython code score-10 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 199, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_S));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_S));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, ((PyObject *)__pyx_v_S));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_Z));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_Z));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, ((PyObject *)__pyx_v_Z));
  __pyx_r = ((PyObject*)__pyx_t_3);
  __pyx_t_3 = 0;
  goto __pyx_L0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0200</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">0201</span>: <span class="c"># Adaptive Average Fixed Orientation -----------------------------------------------------------------------------------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0202</span>: <span
            class="c"># ---- Vectorized ----</span></pre>
    <pre class="cython line score-44"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0203</span>: <span class="k">cdef</span> <span class="kt">tuple</span> <span
            class="nf">SZ_AF_VEC</span><span class="p">(</span><span class="nb">int</span><span
            class="p">[:]</span> <span class="n">nmax</span><span class="p">,</span> <span class="n">double</span><span
            class="p">[:]</span> <span class="n">wavelength</span><span class="p">,</span> <span class="n">double</span><span
            class="p">[:]</span> <span class="n">izaDeg</span><span class="p">,</span> <span
            class="n">double</span><span class="p">[:]</span> <span class="n">vzaDeg</span><span
            class="p">,</span> <span class="n">double</span><span class="p">[:]</span> <span
            class="n">iaaDeg</span><span class="p">,</span></pre>
    <pre class='cython code score-44 '>static PyObject *__pyx_f_6pyrism_4core_3tma_SZ_AF_VEC(__Pyx_memviewslice __pyx_v_nmax, __Pyx_memviewslice __pyx_v_wavelength, __Pyx_memviewslice __pyx_v_izaDeg, __Pyx_memviewslice __pyx_v_vzaDeg, __Pyx_memviewslice __pyx_v_iaaDeg, __Pyx_memviewslice __pyx_v_vaaDeg, int __pyx_v_n_alpha, int __pyx_v_n_beta, PyObject *__pyx_v_or_pdf) {
  __Pyx_memviewslice __pyx_v_beta_p = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_beta_w = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_alpha_array = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_wavelength_array = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_izaDeg_array = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_vzaDeg_array = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_iaaDeg_array = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_vaaDeg_array = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_nmax_array = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyArrayObject *__pyx_v_Z = 0;
  PyArrayObject *__pyx_v_Z_temp = 0;
  PyArrayObject *__pyx_v_S = 0;
  PyArrayObject *__pyx_v_S_temp = 0;
  PyArrayObject *__pyx_v_Z_sum = 0;
  PyArrayObject *__pyx_v_S_sum = 0;
  Py_ssize_t __pyx_v_x;
  double __pyx_v_aw;
  double __pyx_v_item;
  __Pyx_memviewslice __pyx_v_alpha = { 0, 0, { 0 }, { 0 }, { 0 } };
  Py_ssize_t __pyx_v_xmax;
  npy_intp __pyx_v_y;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_S;
  __Pyx_Buffer __pyx_pybuffer_S;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_S_sum;
  __Pyx_Buffer __pyx_pybuffer_S_sum;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_S_temp;
  __Pyx_Buffer __pyx_pybuffer_S_temp;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Z;
  __Pyx_Buffer __pyx_pybuffer_Z;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Z_sum;
  __Pyx_Buffer __pyx_pybuffer_Z_sum;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Z_temp;
  __Pyx_Buffer __pyx_pybuffer_Z_temp;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("SZ_AF_VEC", 0);
  __pyx_pybuffer_Z.pybuffer.buf = NULL;
  __pyx_pybuffer_Z.refcount = 0;
  __pyx_pybuffernd_Z.data = NULL;
  __pyx_pybuffernd_Z.rcbuffer = &amp;__pyx_pybuffer_Z;
  __pyx_pybuffer_Z_temp.pybuffer.buf = NULL;
  __pyx_pybuffer_Z_temp.refcount = 0;
  __pyx_pybuffernd_Z_temp.data = NULL;
  __pyx_pybuffernd_Z_temp.rcbuffer = &amp;__pyx_pybuffer_Z_temp;
  __pyx_pybuffer_S.pybuffer.buf = NULL;
  __pyx_pybuffer_S.refcount = 0;
  __pyx_pybuffernd_S.data = NULL;
  __pyx_pybuffernd_S.rcbuffer = &amp;__pyx_pybuffer_S;
  __pyx_pybuffer_S_temp.pybuffer.buf = NULL;
  __pyx_pybuffer_S_temp.refcount = 0;
  __pyx_pybuffernd_S_temp.data = NULL;
  __pyx_pybuffernd_S_temp.rcbuffer = &amp;__pyx_pybuffer_S_temp;
  __pyx_pybuffer_Z_sum.pybuffer.buf = NULL;
  __pyx_pybuffer_Z_sum.refcount = 0;
  __pyx_pybuffernd_Z_sum.data = NULL;
  __pyx_pybuffernd_Z_sum.rcbuffer = &amp;__pyx_pybuffer_Z_sum;
  __pyx_pybuffer_S_sum.pybuffer.buf = NULL;
  __pyx_pybuffer_S_sum.refcount = 0;
  __pyx_pybuffernd_S_sum.data = NULL;
  __pyx_pybuffernd_S_sum.rcbuffer = &amp;__pyx_pybuffer_S_sum;
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_16, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_20);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_25);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_26);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_27, 1);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_S.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_S_sum.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_S_temp.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Z_sum.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Z_temp.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.SZ_AF_VEC", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_S.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_S_sum.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_S_temp.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Z_sum.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Z_temp.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_beta_p, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_beta_w, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_alpha_array, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_wavelength_array, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_izaDeg_array, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_vzaDeg_array, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_iaaDeg_array, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_vaaDeg_array, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_nmax_array, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_Z);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_Z_temp);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_S);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_S_temp);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_Z_sum);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_S_sum);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_alpha, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0204</span>:                      <span
            class="n">double</span><span class="p">[:]</span> <span class="n">vaaDeg</span><span
            class="p">,</span> <span class="nb">int</span> <span class="n">n_alpha</span><span class="p">,</span> <span
            class="nb">int</span> <span class="n">n_beta</span><span class="p">,</span> <span
            class="n">or_pdf</span><span class="p">):</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0205</span>:     <span
            class="sd">&quot;&quot;&quot;</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0206</span>: <span class="sd">    Calculate the variable orientation scattering and phase matrix in a vectorized function.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0207</span>: <span class="sd">    </span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0208</span>: <span class="sd">    This method uses a fast Gaussian quadrature and is suitable</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0209</span>: <span class="sd">    for most use. Uses the set particle orientation PDF, ignoring</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0210</span>: <span class="sd">    the alpha and beta attributes.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0211</span>: <span class="sd">    </span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0212</span>: <span class="sd">    Parameters</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0213</span>: <span class="sd">    ----------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0214</span>: <span class="sd">    nmax : int[:] </span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0215</span>: <span
            class="sd">        Nmax parameter.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0216</span>: <span
            class="sd">    wavelength : double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0217</span>: <span class="sd">        Wavelength in same unit as radius (used by function calc_nmax).</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0218</span>: <span class="sd">    izaDeg, vzaDeg, iaaDeg, vaaDeg : double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0219</span>: <span class="sd">        Incidence (iza) and scattering (vza) zenith angle and incidence and viewing</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0220</span>: <span class="sd">        azimuth angle (ira, vra) in [DEG].</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0221</span>: <span class="sd">    n_alpha, n_beta : int</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0222</span>: <span class="sd">        Number of integration points in the alpha and beta Euler angle.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0223</span>: <span
            class="sd">    or_pdf: callable</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0224</span>: <span class="sd">        Particle orientation Probability Density Function (PDF) for orientation averaging.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0225</span>: <span class="sd">            </span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0226</span>: <span class="sd">    Returns</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0227</span>: <span class="sd">    -------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0228</span>: <span class="sd">    S, Z : tuple with double[:,:,:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0229</span>: <span class="sd">        Three dimensional scattering (S) and phase (Z) matrix.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0230</span>: <span
            class="sd">    &quot;&quot;&quot;</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0231</span>:     <span class="k">cdef</span><span
            class="p">:</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0232</span>:         <span class="n">double</span><span
            class="p">[:]</span> <span class="n">beta_p</span><span class="p">,</span> <span
            class="n">beta_w</span><span class="p">,</span> <span class="n">alpha_array</span><span
            class="p">,</span> <span class="n">wavelength_array</span><span class="p">,</span> <span class="n">izaDeg_array</span><span
            class="p">,</span> <span class="n">vzaDeg_array</span><span class="p">,</span> <span
            class="n">iaaDeg_array</span><span class="p">,</span> <span class="n">vaaDeg_array</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0233</span>:         <span class="nb">int</span><span
            class="p">[:]</span> <span class="n">nmax_array</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0234</span>:         <span class="n">np</span><span class="o">.</span><span
            class="n">ndarray</span><span class="p">[</span><span class="n">double</span><span class="p">,</span> <span
            class="n">ndim</span><span class="o">=</span><span class="mf">3</span><span class="p">]</span>  <span
            class="n">Z</span><span class="p">,</span> <span class="n">Z_temp</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0235</span>:         <span class="n">np</span><span class="o">.</span><span
            class="n">ndarray</span><span class="p">[</span><span class="n">DTYPE_t</span><span class="p">,</span> <span
            class="n">ndim</span><span class="o">=</span><span class="mf">3</span><span class="p">]</span>  <span
            class="n">S</span><span class="p">,</span> <span class="n">S_temp</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0236</span>:         <span class="n">np</span><span class="o">.</span><span
            class="n">ndarray</span><span class="p">[</span><span class="n">double</span><span class="p">,</span> <span
            class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span>  <span
            class="n">Z_sum</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0237</span>:         <span class="n">np</span><span class="o">.</span><span
            class="n">ndarray</span><span class="p">[</span><span class="n">DTYPE_t</span><span class="p">,</span> <span
            class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span
            class="n">S_sum</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0238</span>:         <span class="n">Py_ssize_t</span> <span
            class="n">x</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0239</span>: </pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0240</span>:         <span class="n">double</span> <span class="n">aw</span> <span
            class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">n_alpha</span></pre>
    <pre class='cython code score-0 '>  __pyx_v_aw = (1.0 / ((double)__pyx_v_n_alpha));
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0241</span>:         <span class="n">double</span> <span
            class="n">item</span></pre>
    <pre class="cython line score-46"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0242</span>:         <span class="n">double</span><span class="p">[:]</span> <span
            class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span
            class="n">linspace</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span> <span
            class="mf">360</span><span class="p">,</span> <span class="n">n_alpha</span> <span class="o">+</span> <span
            class="mf">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span
            class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">)[:</span><span
            class="o">-</span><span class="mf">1</span><span class="p">]</span></pre>
    <pre class='cython code score-46 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span
            class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 242, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_linspace);<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 242, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((__pyx_v_n_alpha + 1));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 242, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 242, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_360);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_360);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_360);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 2, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 242, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 242, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_double);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 242, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 242, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, __pyx_t_1);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 242, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_t_5, 0, -1L, NULL, NULL, &amp;__pyx_slice__8, 0, 1, 1);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 242, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_6 = <span
                class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 242, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_alpha = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
/* â€¦ */
  __pyx_slice__8 = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_int_neg_1, Py_None);<span
                class='error_goto'> if (unlikely(!__pyx_slice__8)) __PYX_ERR(0, 242, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__8);
</pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0243</span>:         <span class="n">Py_ssize_t</span> <span class="n">xmax</span> <span class="o">=</span> <span
            class="n">nmax</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span
            class="mf">0</span><span class="p">]</span></pre>
    <pre class='cython code score-0 '>  __pyx_v_xmax = (__pyx_v_nmax.shape[0]);
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0244</span>: </pre>
    <pre class="cython line score-52"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0245</span>:     <span class="n">S_sum</span> <span class="o">=</span> <span
            class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span
            class="mf">2</span><span class="p">,</span> <span class="mf">2</span><span class="p">),</span> <span
            class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span
            class="n">complex</span><span class="p">)</span></pre>
    <pre class='cython code score-52 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span
            class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 245, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 245, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* â€¦ */
  __pyx_tuple__9 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_2, __pyx_int_2);<span class='error_goto'> if (unlikely(!__pyx_tuple__9)) __PYX_ERR(0, 245, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__9);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 245, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 245, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_complex);<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 245, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_2) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 245, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_tuple__10, __pyx_t_1);<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 245, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_2) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) <span
                class='error_goto'>__PYX_ERR(0, 245, __pyx_L1_error)</span>
  __pyx_t_7 = ((PyArrayObject *)__pyx_t_2);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[2];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_S_sum.rcbuffer-&gt;pybuffer);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_S_sum.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_7, &amp;__Pyx_TypeInfo_nn___pyx_t_6pyrism_4core_3tma_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack);
    if (unlikely(__pyx_t_8 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_9, &amp;__pyx_t_10, &amp;__pyx_t_11);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_S_sum.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_S_sum, &amp;__Pyx_TypeInfo_nn___pyx_t_6pyrism_4core_3tma_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_9); Py_XDECREF(__pyx_t_10); Py_XDECREF(__pyx_t_11);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_9, __pyx_t_10, __pyx_t_11);
      }
      __pyx_t_9 = __pyx_t_10 = __pyx_t_11 = 0;
    }
    __pyx_pybuffernd_S_sum.diminfo[0].strides = __pyx_pybuffernd_S_sum.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_S_sum.diminfo[0].shape = __pyx_pybuffernd_S_sum.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_S_sum.diminfo[1].strides = __pyx_pybuffernd_S_sum.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_S_sum.diminfo[1].shape = __pyx_pybuffernd_S_sum.rcbuffer-&gt;pybuffer.shape[1];
    if (unlikely(__pyx_t_8 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 245, __pyx_L1_error)</span>
  }
  __pyx_t_7 = 0;
  __pyx_v_S_sum = ((PyArrayObject *)__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_tuple__10 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_tuple__9);<span class='error_goto'> if (unlikely(!__pyx_tuple__10)) __PYX_ERR(0, 245, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__10);
</pre>
    <pre class="cython line score-38"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0246</span>:     <span class="n">Z_sum</span> <span class="o">=</span> <span
            class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span
            class="mf">4</span><span class="p">,</span> <span class="mf">4</span><span class="p">))</span></pre>
    <pre class='cython code score-38 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span
            class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 246, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 246, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* â€¦ */
  __pyx_tuple__11 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_4, __pyx_int_4);<span class='error_goto'> if (unlikely(!__pyx_tuple__11)) __PYX_ERR(0, 246, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__11);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__11);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_tuple__12, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 246, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_2) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) <span
                class='error_goto'>__PYX_ERR(0, 246, __pyx_L1_error)</span>
  __pyx_t_12 = ((PyArrayObject *)__pyx_t_2);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Z_sum.rcbuffer-&gt;pybuffer);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Z_sum.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_12, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack);
    if (unlikely(__pyx_t_8 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_11, &amp;__pyx_t_10, &amp;__pyx_t_9);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Z_sum.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_Z_sum, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_11); Py_XDECREF(__pyx_t_10); Py_XDECREF(__pyx_t_9);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_11, __pyx_t_10, __pyx_t_9);
      }
      __pyx_t_11 = __pyx_t_10 = __pyx_t_9 = 0;
    }
    __pyx_pybuffernd_Z_sum.diminfo[0].strides = __pyx_pybuffernd_Z_sum.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Z_sum.diminfo[0].shape = __pyx_pybuffernd_Z_sum.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_Z_sum.diminfo[1].strides = __pyx_pybuffernd_Z_sum.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_Z_sum.diminfo[1].shape = __pyx_pybuffernd_Z_sum.rcbuffer-&gt;pybuffer.shape[1];
    if (unlikely(__pyx_t_8 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 246, __pyx_L1_error)</span>
  }
  __pyx_t_12 = 0;
  __pyx_v_Z_sum = ((PyArrayObject *)__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_tuple__12 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_tuple__11);<span class='error_goto'> if (unlikely(!__pyx_tuple__12)) __PYX_ERR(0, 246, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__12);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__12);
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0247</span>: </pre>
    <pre class="cython line score-64"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0248</span>:     <span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span
            class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">xmax</span><span
            class="p">,</span> <span class="mf">2</span><span class="p">,</span> <span class="mf">2</span><span
            class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span
            class="o">.</span><span class="n">complex</span><span class="p">)</span></pre>
    <pre class='cython code score-64 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span
            class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 248, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 248, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_xmax);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 248, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 248, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_int_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 2, __pyx_int_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 248, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 248, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 248, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_complex);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 248, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 248, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, __pyx_t_5);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 248, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span
                class='error_goto'>__PYX_ERR(0, 248, __pyx_L1_error)</span>
  __pyx_t_13 = ((PyArrayObject *)__pyx_t_4);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[2];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_S.rcbuffer-&gt;pybuffer);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_S.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_13, &amp;__Pyx_TypeInfo_nn___pyx_t_6pyrism_4core_3tma_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack);
    if (unlikely(__pyx_t_8 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_9, &amp;__pyx_t_10, &amp;__pyx_t_11);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_S.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_S, &amp;__Pyx_TypeInfo_nn___pyx_t_6pyrism_4core_3tma_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_9); Py_XDECREF(__pyx_t_10); Py_XDECREF(__pyx_t_11);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_9, __pyx_t_10, __pyx_t_11);
      }
      __pyx_t_9 = __pyx_t_10 = __pyx_t_11 = 0;
    }
    __pyx_pybuffernd_S.diminfo[0].strides = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_S.diminfo[0].shape = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_S.diminfo[1].strides = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_S.diminfo[1].shape = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_S.diminfo[2].strides = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_S.diminfo[2].shape = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.shape[2];
    if (unlikely(__pyx_t_8 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 248, __pyx_L1_error)</span>
  }
  __pyx_t_13 = 0;
  __pyx_v_S = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;
</pre>
    <pre class="cython line score-79"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0249</span>:     <span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span
            class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">xmax</span><span
            class="p">,</span> <span class="mf">4</span><span class="p">,</span> <span class="mf">4</span><span
            class="p">))</span></pre>
    <pre class='cython code score-79 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span
            class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 249, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 249, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_xmax);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 249, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 249, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_int_4);
  __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_5) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 249, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else {
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_2)) {
      PyObject *__pyx_temp[2] = {__pyx_t_5, __pyx_t_1};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 249, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_2)) {
      PyObject *__pyx_temp[2] = {__pyx_t_5, __pyx_t_1};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 249, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    } else
    #endif
    {
      __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 249, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_5); __pyx_t_5 = NULL;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+1, __pyx_t_1);
      __pyx_t_1 = 0;
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 249, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span
                class='error_goto'>__PYX_ERR(0, 249, __pyx_L1_error)</span>
  __pyx_t_14 = ((PyArrayObject *)__pyx_t_4);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_14, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack);
    if (unlikely(__pyx_t_8 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_11, &amp;__pyx_t_10, &amp;__pyx_t_9);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_Z, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_11); Py_XDECREF(__pyx_t_10); Py_XDECREF(__pyx_t_9);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_11, __pyx_t_10, __pyx_t_9);
      }
      __pyx_t_11 = __pyx_t_10 = __pyx_t_9 = 0;
    }
    __pyx_pybuffernd_Z.diminfo[0].strides = __pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Z.diminfo[0].shape = __pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_Z.diminfo[1].strides = __pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_Z.diminfo[1].shape = __pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_Z.diminfo[2].strides = __pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_Z.diminfo[2].shape = __pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer.shape[2];
    if (unlikely(__pyx_t_8 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 249, __pyx_L1_error)</span>
  }
  __pyx_t_14 = 0;
  __pyx_v_Z = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0250</span>: </pre>
    <pre class="cython line score-78"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0251</span>:     <span class="n">beta_p</span><span class="p">,</span> <span
            class="n">beta_w</span> <span class="o">=</span> <span class="n">get_points_and_weights</span><span
            class="p">(</span><span class="n">or_pdf</span><span class="p">,</span> <span class="mf">0</span><span
            class="p">,</span> <span class="mf">180</span><span class="p">,</span> <span
            class="n">num_points</span><span class="o">=</span><span class="n">n_beta</span><span
            class="p">)</span></pre>
    <pre class='cython code score-78 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_get_points_and_weights);<span
            class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 251, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 251, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_or_pdf);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_or_pdf);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_or_pdf);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_180);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_180);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, __pyx_int_180);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 251, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_beta);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 251, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_num_points, __pyx_t_1) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 251, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_2, __pyx_t_3);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 251, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span
                class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
    PyObject* sequence = __pyx_t_1;
    Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
    if (unlikely(size != 2)) {
      if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      <span class='error_goto'>__PYX_ERR(0, 251, __pyx_L1_error)</span>
    }
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0);
      __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1);
    } else {
      __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0);
      __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1);
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    #else
    __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 251, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 251, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_4 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 251, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_15 = Py_TYPE(__pyx_t_4)-&gt;tp_iternext;
    index = 0; __pyx_t_3 = __pyx_t_15(__pyx_t_4); if (unlikely(!__pyx_t_3)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    index = 1; __pyx_t_2 = __pyx_t_15(__pyx_t_4); if (unlikely(!__pyx_t_2)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_15(__pyx_t_4), 2) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 251, __pyx_L1_error)</span>
    __pyx_t_15 = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    goto __pyx_L4_unpacking_done;
    __pyx_L3_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_15 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span
                class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
    <span class='error_goto'>__PYX_ERR(0, 251, __pyx_L1_error)</span>
    __pyx_L4_unpacking_done:;
  }
  __pyx_t_6 = <span
                class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_3, PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 251, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_16 = <span
                class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_2, PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_t_16.memview)) __PYX_ERR(0, 251, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_beta_p = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
  __pyx_v_beta_w = __pyx_t_16;
  __pyx_t_16.memview = NULL;
  __pyx_t_16.data = NULL;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0252</span>: </pre>
    <pre class="cython line score-54"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0253</span>:     <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span
            class="n">alpha</span><span class="p">:</span></pre>
    <pre class='cython code score-54 '>  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_alpha, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span
            class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 253, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) || <span
                class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
    __pyx_t_2 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_17 = 0;
    __pyx_t_18 = NULL;
  } else {
    __pyx_t_17 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 253, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_18 = Py_TYPE(__pyx_t_2)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 253, __pyx_L1_error)</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (likely(!__pyx_t_18)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
        if (__pyx_t_17 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_17); <span
                class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_17++; if (unlikely(0 &lt; 0)) <span
                class='error_goto'>__PYX_ERR(0, 253, __pyx_L1_error)</span>
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_17); __pyx_t_17++;<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 253, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        #endif
      } else {
        if (__pyx_t_17 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_2)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_17); <span
                class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_17++; if (unlikely(0 &lt; 0)) <span
                class='error_goto'>__PYX_ERR(0, 253, __pyx_L1_error)</span>
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_17); __pyx_t_17++;<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 253, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        #endif
      }
    } else {
      __pyx_t_1 = __pyx_t_18(__pyx_t_2);
      if (unlikely(!__pyx_t_1)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span
                class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span
                class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 253, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    }
    __pyx_t_19 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1); if (unlikely((__pyx_t_19 == (double)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 253, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_item = __pyx_t_19;
/* â€¦ */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre>
    <pre class="cython line score-59"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0254</span>:         <span class="n">alpha_array</span> <span class="o">=</span> <span
            class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span
            class="n">beta_p</span><span class="p">)</span> <span class="o">+</span> <span class="n">item</span></pre>
    <pre class='cython code score-59 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span
            class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 254, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros_like);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 254, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_beta_p, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 254, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_5 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_5)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      }
    }
    if (!__pyx_t_5) {
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_3);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 254, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    } else {
      #if CYTHON_FAST_PYCALL
      if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_4)) {
        PyObject *__pyx_temp[2] = {__pyx_t_5, __pyx_t_3};
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 254, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      } else
      #endif
      #if CYTHON_FAST_PYCCALL
      if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_4)) {
        PyObject *__pyx_temp[2] = {__pyx_t_5, __pyx_t_3};
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 254, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      } else
      #endif
      {
        __pyx_t_20 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 254, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_20, 0, __pyx_t_5); __pyx_t_5 = NULL;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_20, 0+1, __pyx_t_3);
        __pyx_t_3 = 0;
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_20, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 254, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
      }
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_item);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 254, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_20 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 254, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_20, PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_t_16.memview)) __PYX_ERR(0, 254, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_alpha_array, 1);
    __pyx_v_alpha_array = __pyx_t_16;
    __pyx_t_16.memview = NULL;
    __pyx_t_16.data = NULL;
</pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0255</span>:         <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span
            class="nb">range</span><span class="p">(</span><span class="n">nmax</span><span class="o">.</span><span
            class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]):</span></pre>
    <pre class='cython code score-0 '>    __pyx_t_21 = (__pyx_v_nmax.shape[0]);
    __pyx_t_22 = __pyx_t_21;
    for (__pyx_t_23 = 0; __pyx_t_23 &lt; __pyx_t_22; __pyx_t_23+=1) {
      __pyx_v_x = __pyx_t_23;
</pre>
    <pre class="cython line score-91"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0256</span>:             <span class="n">nmax_array</span> <span class="o">=</span> <span
            class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span
            class="n">beta_p</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span
            class="n">np</span><span class="o">.</span><span class="n">intc</span><span class="p">)</span> <span
            class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span
            class="p">(</span><span class="n">nmax</span><span class="p">[</span><span class="n">x</span><span
            class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span
            class="o">.</span><span class="n">intc</span><span class="p">)</span><span class="o">.</span><span
            class="n">flatten</span><span class="p">()</span></pre>
    <pre class='cython code score-91 '>      __pyx_t_20 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span
            class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 256, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_20, __pyx_n_s_zeros_like);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 256, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
      __pyx_t_20 = __pyx_memoryview_fromslice(__pyx_v_beta_p, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span
                class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 256, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
      __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 256, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_20);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_20);
      __pyx_t_20 = 0;
      __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 256, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 256, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_intc);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 256, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_20, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 256, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_1, __pyx_t_20);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 256, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 256, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_asarray);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 256, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_24 = __pyx_v_x;
      __pyx_t_8 = -1;
      if (__pyx_t_24 &lt; 0) {
        __pyx_t_24 += __pyx_v_nmax.shape[0];
        if (unlikely(__pyx_t_24 &lt; 0)) __pyx_t_8 = 0;
      } else if (unlikely(__pyx_t_24 &gt;= __pyx_v_nmax.shape[0])) __pyx_t_8 = 0;
      if (unlikely(__pyx_t_8 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
        <span class='error_goto'>__PYX_ERR(0, 256, __pyx_L1_error)</span>
      }
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>((*((int *) ( /* dim=0 */ (__pyx_v_nmax.data + __pyx_t_24 * __pyx_v_nmax.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 256, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 256, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
      __pyx_t_1 = 0;
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 256, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_25 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 256, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_25);
      __pyx_t_26 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_25, __pyx_n_s_intc);<span
                class='error_goto'> if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 256, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_26);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_25); __pyx_t_25 = 0;
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_26) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 256, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_26); __pyx_t_26 = 0;
      __pyx_t_26 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_3, __pyx_t_1);<span
                class='error_goto'> if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 256, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_26);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_26, __pyx_n_s_flatten);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 256, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_26); __pyx_t_26 = 0;
      __pyx_t_26 = NULL;
      if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
        __pyx_t_26 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
        if (likely(__pyx_t_26)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_26);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
        }
      }
      if (__pyx_t_26) {
        __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_26);<span
                class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 256, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_26); __pyx_t_26 = 0;
      } else {
        __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 256, __pyx_L1_error)</span>
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_5, __pyx_t_20);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 256, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
      __pyx_t_27 = <span
                class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_t_1, PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_t_27.memview)) __PYX_ERR(0, 256, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __PYX_XDEC_MEMVIEW(&amp;__pyx_v_nmax_array, 1);
      __pyx_v_nmax_array = __pyx_t_27;
      __pyx_t_27.memview = NULL;
      __pyx_t_27.data = NULL;
</pre>
    <pre class="cython line score-124"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0257</span>:             <span class="n">wavelength_array</span> <span class="o">=</span> <span
            class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span
            class="n">beta_p</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span
            class="o">.</span><span class="n">asarray</span><span class="p">(</span><span
            class="n">wavelength</span><span class="p">[</span><span class="n">x</span><span class="p">])</span><span
            class="o">.</span><span class="n">flatten</span><span class="p">()</span></pre>
    <pre class='cython code score-124 '>      __pyx_t_20 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span
            class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 257, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_20, __pyx_n_s_zeros_like);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 257, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
      __pyx_t_20 = __pyx_memoryview_fromslice(__pyx_v_beta_p, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span
                class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 257, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
      __pyx_t_26 = NULL;
      if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
        __pyx_t_26 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
        if (likely(__pyx_t_26)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_26);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
        }
      }
      if (!__pyx_t_26) {
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_20);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 257, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      } else {
        #if CYTHON_FAST_PYCALL
        if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_5)) {
          PyObject *__pyx_temp[2] = {__pyx_t_26, __pyx_t_20};
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 257, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_26); __pyx_t_26 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
        } else
        #endif
        #if CYTHON_FAST_PYCCALL
        if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_5)) {
          PyObject *__pyx_temp[2] = {__pyx_t_26, __pyx_t_20};
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 257, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_26); __pyx_t_26 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
        } else
        #endif
        {
          __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 257, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_26); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_26); __pyx_t_26 = NULL;
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_20);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+1, __pyx_t_20);
          __pyx_t_20 = 0;
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_3, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 257, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        }
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_20 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 257, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
      __pyx_t_26 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_20, __pyx_n_s_asarray);<span
                class='error_goto'> if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 257, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_26);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
      __pyx_t_28 = __pyx_v_x;
      __pyx_t_8 = -1;
      if (__pyx_t_28 &lt; 0) {
        __pyx_t_28 += __pyx_v_wavelength.shape[0];
        if (unlikely(__pyx_t_28 &lt; 0)) __pyx_t_8 = 0;
      } else if (unlikely(__pyx_t_28 &gt;= __pyx_v_wavelength.shape[0])) __pyx_t_8 = 0;
      if (unlikely(__pyx_t_8 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
        <span class='error_goto'>__PYX_ERR(0, 257, __pyx_L1_error)</span>
      }
      __pyx_t_20 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_wavelength.data + __pyx_t_28 * __pyx_v_wavelength.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 257, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
      __pyx_t_4 = NULL;
      if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_26))) {
        __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_26);
        if (likely(__pyx_t_4)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_26);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_26, function);
        }
      }
      if (!__pyx_t_4) {
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_26, __pyx_t_20);<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 257, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      } else {
        #if CYTHON_FAST_PYCALL
        if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_26)) {
          PyObject *__pyx_temp[2] = {__pyx_t_4, __pyx_t_20};
          __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_26, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 257, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
        } else
        #endif
        #if CYTHON_FAST_PYCCALL
        if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_26)) {
          PyObject *__pyx_temp[2] = {__pyx_t_4, __pyx_t_20};
          __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_26, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 257, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
        } else
        #endif
        {
          __pyx_t_25 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 257, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_25);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_25, 0, __pyx_t_4); __pyx_t_4 = NULL;
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_20);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_25, 0+1, __pyx_t_20);
          __pyx_t_20 = 0;
          __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_26, __pyx_t_25, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 257, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_25); __pyx_t_25 = 0;
        }
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_26); __pyx_t_26 = 0;
      __pyx_t_26 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_flatten);<span
                class='error_goto'> if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 257, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_26);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = NULL;
      if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_26))) {
        __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_26);
        if (likely(__pyx_t_3)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_26);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_26, function);
        }
      }
      if (__pyx_t_3) {
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_26, __pyx_t_3);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 257, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      } else {
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_26);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 257, __pyx_L1_error)</span>
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_26); __pyx_t_26 = 0;
      __pyx_t_26 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 257, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_26);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_26, PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_t_16.memview)) __PYX_ERR(0, 257, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_26); __pyx_t_26 = 0;
      __PYX_XDEC_MEMVIEW(&amp;__pyx_v_wavelength_array, 1);
      __pyx_v_wavelength_array = __pyx_t_16;
      __pyx_t_16.memview = NULL;
      __pyx_t_16.data = NULL;
</pre>
    <pre class="cython line score-124"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0258</span>:             <span class="n">izaDeg_array</span> <span class="o">=</span> <span
            class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span
            class="n">beta_p</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span
            class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">izaDeg</span><span
            class="p">[</span><span class="n">x</span><span class="p">])</span><span class="o">.</span><span class="n">flatten</span><span
            class="p">()</span></pre>
    <pre class='cython code score-124 '>      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span
            class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 258, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros_like);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 258, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_beta_p, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 258, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_3 = NULL;
      if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
        __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
        if (likely(__pyx_t_3)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
        }
      }
      if (!__pyx_t_3) {
        __pyx_t_26 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_5);<span
                class='error_goto'> if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 258, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_26);
      } else {
        #if CYTHON_FAST_PYCALL
        if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_1)) {
          PyObject *__pyx_temp[2] = {__pyx_t_3, __pyx_t_5};
          __pyx_t_26 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 258, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_26);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        } else
        #endif
        #if CYTHON_FAST_PYCCALL
        if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_1)) {
          PyObject *__pyx_temp[2] = {__pyx_t_3, __pyx_t_5};
          __pyx_t_26 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 258, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_26);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        } else
        #endif
        {
          __pyx_t_25 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 258, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_25);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_25, 0, __pyx_t_3); __pyx_t_3 = NULL;
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_25, 0+1, __pyx_t_5);
          __pyx_t_5 = 0;
          __pyx_t_26 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_25, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 258, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_26);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_25); __pyx_t_25 = 0;
        }
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 258, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_asarray);<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 258, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_29 = __pyx_v_x;
      __pyx_t_8 = -1;
      if (__pyx_t_29 &lt; 0) {
        __pyx_t_29 += __pyx_v_izaDeg.shape[0];
        if (unlikely(__pyx_t_29 &lt; 0)) __pyx_t_8 = 0;
      } else if (unlikely(__pyx_t_29 &gt;= __pyx_v_izaDeg.shape[0])) __pyx_t_8 = 0;
      if (unlikely(__pyx_t_8 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
        <span class='error_goto'>__PYX_ERR(0, 258, __pyx_L1_error)</span>
      }
      __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_izaDeg.data + __pyx_t_29 * __pyx_v_izaDeg.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 258, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_20 = NULL;
      if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
        __pyx_t_20 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
        if (likely(__pyx_t_20)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_20);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        }
      }
      if (!__pyx_t_20) {
        __pyx_t_25 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_5);<span
                class='error_goto'> if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 258, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_25);
      } else {
        #if CYTHON_FAST_PYCALL
        if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
          PyObject *__pyx_temp[2] = {__pyx_t_20, __pyx_t_5};
          __pyx_t_25 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 258, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_25);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        } else
        #endif
        #if CYTHON_FAST_PYCCALL
        if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
          PyObject *__pyx_temp[2] = {__pyx_t_20, __pyx_t_5};
          __pyx_t_25 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 258, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_25);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        } else
        #endif
        {
          __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 258, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_20); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_20); __pyx_t_20 = NULL;
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+1, __pyx_t_5);
          __pyx_t_5 = 0;
          __pyx_t_25 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 258, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_25);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        }
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_25, __pyx_n_s_flatten);<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 258, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_25); __pyx_t_25 = 0;
      __pyx_t_25 = NULL;
      if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
        __pyx_t_25 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
        if (likely(__pyx_t_25)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_25);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        }
      }
      if (__pyx_t_25) {
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_25);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 258, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_25); __pyx_t_25 = 0;
      } else {
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 258, __pyx_L1_error)</span>
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_26, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 258, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_26); __pyx_t_26 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_3, PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_t_16.memview)) __PYX_ERR(0, 258, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __PYX_XDEC_MEMVIEW(&amp;__pyx_v_izaDeg_array, 1);
      __pyx_v_izaDeg_array = __pyx_t_16;
      __pyx_t_16.memview = NULL;
      __pyx_t_16.data = NULL;
</pre>
    <pre class="cython line score-124"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0259</span>:             <span class="n">vzaDeg_array</span> <span class="o">=</span> <span
            class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span
            class="n">beta_p</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span
            class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">vzaDeg</span><span
            class="p">[</span><span class="n">x</span><span class="p">])</span><span class="o">.</span><span class="n">flatten</span><span
            class="p">()</span></pre>
    <pre class='cython code score-124 '>      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span
            class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 259, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_26 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros_like);<span
                class='error_goto'> if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 259, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_26);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_beta_p, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 259, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_25 = NULL;
      if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_26))) {
        __pyx_t_25 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_26);
        if (likely(__pyx_t_25)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_26);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_25);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_26, function);
        }
      }
      if (!__pyx_t_25) {
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_26, __pyx_t_1);<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 259, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      } else {
        #if CYTHON_FAST_PYCALL
        if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_26)) {
          PyObject *__pyx_temp[2] = {__pyx_t_25, __pyx_t_1};
          __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_26, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 259, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_25); __pyx_t_25 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        } else
        #endif
        #if CYTHON_FAST_PYCCALL
        if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_26)) {
          PyObject *__pyx_temp[2] = {__pyx_t_25, __pyx_t_1};
          __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_26, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 259, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_25); __pyx_t_25 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        } else
        #endif
        {
          __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 259, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_25); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_25); __pyx_t_25 = NULL;
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+1, __pyx_t_1);
          __pyx_t_1 = 0;
          __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_26, __pyx_t_4, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 259, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        }
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_26); __pyx_t_26 = 0;
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 259, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_25 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_asarray);<span
                class='error_goto'> if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 259, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_25);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_30 = __pyx_v_x;
      __pyx_t_8 = -1;
      if (__pyx_t_30 &lt; 0) {
        __pyx_t_30 += __pyx_v_vzaDeg.shape[0];
        if (unlikely(__pyx_t_30 &lt; 0)) __pyx_t_8 = 0;
      } else if (unlikely(__pyx_t_30 &gt;= __pyx_v_vzaDeg.shape[0])) __pyx_t_8 = 0;
      if (unlikely(__pyx_t_8 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
        <span class='error_goto'>__PYX_ERR(0, 259, __pyx_L1_error)</span>
      }
      __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_vzaDeg.data + __pyx_t_30 * __pyx_v_vzaDeg.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 259, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_5 = NULL;
      if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_25))) {
        __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_25);
        if (likely(__pyx_t_5)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_25);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_25, function);
        }
      }
      if (!__pyx_t_5) {
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_25, __pyx_t_1);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 259, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      } else {
        #if CYTHON_FAST_PYCALL
        if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_25)) {
          PyObject *__pyx_temp[2] = {__pyx_t_5, __pyx_t_1};
          __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_25, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 259, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        } else
        #endif
        #if CYTHON_FAST_PYCCALL
        if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_25)) {
          PyObject *__pyx_temp[2] = {__pyx_t_5, __pyx_t_1};
          __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_25, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 259, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        } else
        #endif
        {
          __pyx_t_20 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 259, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_20, 0, __pyx_t_5); __pyx_t_5 = NULL;
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_20, 0+1, __pyx_t_1);
          __pyx_t_1 = 0;
          __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_25, __pyx_t_20, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 259, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
        }
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_25); __pyx_t_25 = 0;
      __pyx_t_25 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_flatten);<span
                class='error_goto'> if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 259, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_25);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = NULL;
      if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_25))) {
        __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_25);
        if (likely(__pyx_t_4)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_25);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_25, function);
        }
      }
      if (__pyx_t_4) {
        __pyx_t_26 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_25, __pyx_t_4);<span
                class='error_goto'> if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 259, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      } else {
        __pyx_t_26 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_25);<span class='error_goto'> if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 259, __pyx_L1_error)</span>
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_26);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_25); __pyx_t_25 = 0;
      __pyx_t_25 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, __pyx_t_26);<span class='error_goto'> if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 259, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_25);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_26); __pyx_t_26 = 0;
      __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_25, PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_t_16.memview)) __PYX_ERR(0, 259, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_25); __pyx_t_25 = 0;
      __PYX_XDEC_MEMVIEW(&amp;__pyx_v_vzaDeg_array, 1);
      __pyx_v_vzaDeg_array = __pyx_t_16;
      __pyx_t_16.memview = NULL;
      __pyx_t_16.data = NULL;
</pre>
    <pre class="cython line score-124"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0260</span>:             <span class="n">iaaDeg_array</span> <span class="o">=</span> <span
            class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span
            class="n">beta_p</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span
            class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">iaaDeg</span><span
            class="p">[</span><span class="n">x</span><span class="p">])</span><span class="o">.</span><span class="n">flatten</span><span
            class="p">()</span></pre>
    <pre class='cython code score-124 '>      __pyx_t_26 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span
            class='error_goto'> if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 260, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_26);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_26, __pyx_n_s_zeros_like);<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 260, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_26); __pyx_t_26 = 0;
      __pyx_t_26 = __pyx_memoryview_fromslice(__pyx_v_beta_p, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span
                class='error_goto'> if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 260, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_26);
      __pyx_t_4 = NULL;
      if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
        __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
        if (likely(__pyx_t_4)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        }
      }
      if (!__pyx_t_4) {
        __pyx_t_25 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_26);<span
                class='error_goto'> if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 260, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_26); __pyx_t_26 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_25);
      } else {
        #if CYTHON_FAST_PYCALL
        if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
          PyObject *__pyx_temp[2] = {__pyx_t_4, __pyx_t_26};
          __pyx_t_25 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 260, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_25);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_26); __pyx_t_26 = 0;
        } else
        #endif
        #if CYTHON_FAST_PYCCALL
        if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
          PyObject *__pyx_temp[2] = {__pyx_t_4, __pyx_t_26};
          __pyx_t_25 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 260, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_25);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_26); __pyx_t_26 = 0;
        } else
        #endif
        {
          __pyx_t_20 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 260, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_20, 0, __pyx_t_4); __pyx_t_4 = NULL;
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_26);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_20, 0+1, __pyx_t_26);
          __pyx_t_26 = 0;
          __pyx_t_25 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_20, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 260, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_25);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
        }
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_26 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 260, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_26);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_26, __pyx_n_s_asarray);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 260, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_26); __pyx_t_26 = 0;
      __pyx_t_31 = __pyx_v_x;
      __pyx_t_8 = -1;
      if (__pyx_t_31 &lt; 0) {
        __pyx_t_31 += __pyx_v_iaaDeg.shape[0];
        if (unlikely(__pyx_t_31 &lt; 0)) __pyx_t_8 = 0;
      } else if (unlikely(__pyx_t_31 &gt;= __pyx_v_iaaDeg.shape[0])) __pyx_t_8 = 0;
      if (unlikely(__pyx_t_8 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
        <span class='error_goto'>__PYX_ERR(0, 260, __pyx_L1_error)</span>
      }
      __pyx_t_26 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_iaaDeg.data + __pyx_t_31 * __pyx_v_iaaDeg.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 260, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_26);
      __pyx_t_1 = NULL;
      if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
        __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
        if (likely(__pyx_t_1)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
        }
      }
      if (!__pyx_t_1) {
        __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_26);<span
                class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 260, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_26); __pyx_t_26 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
      } else {
        #if CYTHON_FAST_PYCALL
        if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_4)) {
          PyObject *__pyx_temp[2] = {__pyx_t_1, __pyx_t_26};
          __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 260, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_26); __pyx_t_26 = 0;
        } else
        #endif
        #if CYTHON_FAST_PYCCALL
        if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_4)) {
          PyObject *__pyx_temp[2] = {__pyx_t_1, __pyx_t_26};
          __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 260, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_26); __pyx_t_26 = 0;
        } else
        #endif
        {
          __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 260, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_1); __pyx_t_1 = NULL;
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_26);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+1, __pyx_t_26);
          __pyx_t_26 = 0;
          __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_5, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 260, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        }
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_20, __pyx_n_s_flatten);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 260, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
      __pyx_t_20 = NULL;
      if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
        __pyx_t_20 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
        if (likely(__pyx_t_20)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_20);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
        }
      }
      if (__pyx_t_20) {
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_20);<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 260, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
      } else {
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 260, __pyx_L1_error)</span>
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_25, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 260, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_25); __pyx_t_25 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_4, PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_t_16.memview)) __PYX_ERR(0, 260, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __PYX_XDEC_MEMVIEW(&amp;__pyx_v_iaaDeg_array, 1);
      __pyx_v_iaaDeg_array = __pyx_t_16;
      __pyx_t_16.memview = NULL;
      __pyx_t_16.data = NULL;
</pre>
    <pre class="cython line score-124"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0261</span>:             <span class="n">vaaDeg_array</span> <span class="o">=</span> <span
            class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span
            class="n">beta_p</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span
            class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">vaaDeg</span><span
            class="p">[</span><span class="n">x</span><span class="p">])</span><span class="o">.</span><span class="n">flatten</span><span
            class="p">()</span></pre>
    <pre class='cython code score-124 '>      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span
            class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 261, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_25 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros_like);<span
                class='error_goto'> if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 261, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_25);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_beta_p, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 261, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_20 = NULL;
      if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_25))) {
        __pyx_t_20 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_25);
        if (likely(__pyx_t_20)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_25);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_20);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_25, function);
        }
      }
      if (!__pyx_t_20) {
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_25, __pyx_t_3);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 261, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      } else {
        #if CYTHON_FAST_PYCALL
        if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_25)) {
          PyObject *__pyx_temp[2] = {__pyx_t_20, __pyx_t_3};
          __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_25, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 261, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        } else
        #endif
        #if CYTHON_FAST_PYCCALL
        if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_25)) {
          PyObject *__pyx_temp[2] = {__pyx_t_20, __pyx_t_3};
          __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_25, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 261, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        } else
        #endif
        {
          __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 261, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_20); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_20); __pyx_t_20 = NULL;
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+1, __pyx_t_3);
          __pyx_t_3 = 0;
          __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_25, __pyx_t_5, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 261, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        }
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_25); __pyx_t_25 = 0;
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 261, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_asarray);<span
                class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 261, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_32 = __pyx_v_x;
      __pyx_t_8 = -1;
      if (__pyx_t_32 &lt; 0) {
        __pyx_t_32 += __pyx_v_vaaDeg.shape[0];
        if (unlikely(__pyx_t_32 &lt; 0)) __pyx_t_8 = 0;
      } else if (unlikely(__pyx_t_32 &gt;= __pyx_v_vaaDeg.shape[0])) __pyx_t_8 = 0;
      if (unlikely(__pyx_t_8 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
        <span class='error_goto'>__PYX_ERR(0, 261, __pyx_L1_error)</span>
      }
      __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_vaaDeg.data + __pyx_t_32 * __pyx_v_vaaDeg.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 261, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_26 = NULL;
      if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_20))) {
        __pyx_t_26 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_20);
        if (likely(__pyx_t_26)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_20);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_26);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_20, function);
        }
      }
      if (!__pyx_t_26) {
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_20, __pyx_t_3);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 261, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      } else {
        #if CYTHON_FAST_PYCALL
        if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_20)) {
          PyObject *__pyx_temp[2] = {__pyx_t_26, __pyx_t_3};
          __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_20, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 261, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_26); __pyx_t_26 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        } else
        #endif
        #if CYTHON_FAST_PYCCALL
        if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_20)) {
          PyObject *__pyx_temp[2] = {__pyx_t_26, __pyx_t_3};
          __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_20, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 261, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_26); __pyx_t_26 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        } else
        #endif
        {
          __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 261, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_26); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_26); __pyx_t_26 = NULL;
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0+1, __pyx_t_3);
          __pyx_t_3 = 0;
          __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_20, __pyx_t_1, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 261, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        }
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
      __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_flatten);<span
                class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 261, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = NULL;
      if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_20))) {
        __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_20);
        if (likely(__pyx_t_5)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_20);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_20, function);
        }
      }
      if (__pyx_t_5) {
        __pyx_t_25 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_20, __pyx_t_5);<span
                class='error_goto'> if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 261, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      } else {
        __pyx_t_25 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_20);<span class='error_goto'> if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 261, __pyx_L1_error)</span>
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_25);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
      __pyx_t_20 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_4, __pyx_t_25);<span class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 261, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_25); __pyx_t_25 = 0;
      __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_20, PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_t_16.memview)) __PYX_ERR(0, 261, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
      __PYX_XDEC_MEMVIEW(&amp;__pyx_v_vaaDeg_array, 1);
      __pyx_v_vaaDeg_array = __pyx_t_16;
      __pyx_t_16.memview = NULL;
      __pyx_t_16.data = NULL;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0262</span>: </pre>
    <pre class="cython line score-57"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0263</span>:             <span class="n">S_temp</span><span class="p">,</span> <span class="n">Z_temp</span> <span
            class="o">=</span> <span class="n">SZ_S_VEC</span><span class="p">(</span><span
            class="n">nmax_array</span><span class="p">,</span> <span class="n">wavelength_array</span><span
            class="p">,</span> <span class="n">izaDeg_array</span><span class="p">,</span> <span
            class="n">vzaDeg_array</span><span class="p">,</span> <span class="n">iaaDeg_array</span><span
            class="p">,</span></pre>
    <pre class='cython code score-57 '>      __pyx_t_20 = __pyx_f_6pyrism_4core_3tma_SZ_S_VEC(__pyx_v_nmax_array, __pyx_v_wavelength_array, __pyx_v_izaDeg_array, __pyx_v_vzaDeg_array, __pyx_v_iaaDeg_array, __pyx_v_vaaDeg_array, __pyx_v_alpha_array, __pyx_v_beta_p);<span
            class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 263, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
      if (likely(__pyx_t_20 != Py_None)) {
        PyObject* sequence = __pyx_t_20;
        Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
        if (unlikely(size != 2)) {
          if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
          else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
          <span class='error_goto'>__PYX_ERR(0, 263, __pyx_L1_error)</span>
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_25 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0);
        __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_25);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        #else
        __pyx_t_25 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 263, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_25);
        __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 263, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        #endif
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
      } else {
        <span class='pyx_c_api'>__Pyx_RaiseNoneNotIterableError</span>(); <span class='error_goto'>__PYX_ERR(0, 263, __pyx_L1_error)</span>
      }
      if (!(likely(((__pyx_t_25) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_25, __pyx_ptype_5numpy_ndarray))))) <span
                class='error_goto'>__PYX_ERR(0, 263, __pyx_L1_error)</span>
      if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span
                class='error_goto'>__PYX_ERR(0, 263, __pyx_L1_error)</span>
      __pyx_t_13 = ((PyArrayObject *)__pyx_t_25);
      {
        __Pyx_BufFmt_StackElem __pyx_stack[2];
        <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_S_temp.rcbuffer-&gt;pybuffer);
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_S_temp.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_13, &amp;__Pyx_TypeInfo_nn___pyx_t_6pyrism_4core_3tma_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack);
        if (unlikely(__pyx_t_8 &lt; 0)) {
          <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_9, &amp;__pyx_t_10, &amp;__pyx_t_11);
          if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_S_temp.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_S_temp, &amp;__Pyx_TypeInfo_nn___pyx_t_6pyrism_4core_3tma_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack) == -1)) {
            Py_XDECREF(__pyx_t_9); Py_XDECREF(__pyx_t_10); Py_XDECREF(__pyx_t_11);
            <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
          } else {
            <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_9, __pyx_t_10, __pyx_t_11);
          }
          __pyx_t_9 = __pyx_t_10 = __pyx_t_11 = 0;
        }
        __pyx_pybuffernd_S_temp.diminfo[0].strides = __pyx_pybuffernd_S_temp.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_S_temp.diminfo[0].shape = __pyx_pybuffernd_S_temp.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_S_temp.diminfo[1].strides = __pyx_pybuffernd_S_temp.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_S_temp.diminfo[1].shape = __pyx_pybuffernd_S_temp.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_S_temp.diminfo[2].strides = __pyx_pybuffernd_S_temp.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_S_temp.diminfo[2].shape = __pyx_pybuffernd_S_temp.rcbuffer-&gt;pybuffer.shape[2];
        if (unlikely(__pyx_t_8 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 263, __pyx_L1_error)</span>
      }
      __pyx_t_13 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_S_temp, ((PyArrayObject *)__pyx_t_25));
      __pyx_t_25 = 0;
      __pyx_t_14 = ((PyArrayObject *)__pyx_t_4);
      {
        __Pyx_BufFmt_StackElem __pyx_stack[1];
        <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Z_temp.rcbuffer-&gt;pybuffer);
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Z_temp.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_14, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack);
        if (unlikely(__pyx_t_8 &lt; 0)) {
          <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_11, &amp;__pyx_t_10, &amp;__pyx_t_9);
          if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Z_temp.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_Z_temp, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack) == -1)) {
            Py_XDECREF(__pyx_t_11); Py_XDECREF(__pyx_t_10); Py_XDECREF(__pyx_t_9);
            <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
          } else {
            <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_11, __pyx_t_10, __pyx_t_9);
          }
          __pyx_t_11 = __pyx_t_10 = __pyx_t_9 = 0;
        }
        __pyx_pybuffernd_Z_temp.diminfo[0].strides = __pyx_pybuffernd_Z_temp.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Z_temp.diminfo[0].shape = __pyx_pybuffernd_Z_temp.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_Z_temp.diminfo[1].strides = __pyx_pybuffernd_Z_temp.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_Z_temp.diminfo[1].shape = __pyx_pybuffernd_Z_temp.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_Z_temp.diminfo[2].strides = __pyx_pybuffernd_Z_temp.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_Z_temp.diminfo[2].shape = __pyx_pybuffernd_Z_temp.rcbuffer-&gt;pybuffer.shape[2];
        if (unlikely(__pyx_t_8 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 263, __pyx_L1_error)</span>
      }
      __pyx_t_14 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_Z_temp, ((PyArrayObject *)__pyx_t_4));
      __pyx_t_4 = 0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0264</span>:                                       <span
            class="n">vaaDeg_array</span><span class="p">,</span> <span class="n">alpha_array</span><span
            class="p">,</span> <span class="n">beta_p</span><span class="p">)</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0265</span>: </pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0266</span>:             <span class="k">for</span> <span class="n">y</span> <span
            class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">S_temp</span><span
            class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span
            class="p">]):</span></pre>
    <pre class='cython code score-0 '>      __pyx_t_33 = (__pyx_v_S_temp-&gt;dimensions[0]);
      __pyx_t_34 = __pyx_t_33;
      for (__pyx_t_35 = 0; __pyx_t_35 &lt; __pyx_t_34; __pyx_t_35+=1) {
        __pyx_v_y = __pyx_t_35;
</pre>
    <pre class="cython line score-43"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0267</span>:                 <span class="n">S_sum</span> <span class="o">+=</span> <span
            class="n">beta_w</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span
            class="o">*</span> <span class="n">S_temp</span><span class="p">[</span><span class="n">y</span><span
            class="p">]</span></pre>
    <pre class='cython code score-43 '>        __pyx_t_36 = __pyx_v_y;
        __pyx_t_8 = -1;
        if (__pyx_t_36 &lt; 0) {
          __pyx_t_36 += __pyx_v_beta_w.shape[0];
          if (unlikely(__pyx_t_36 &lt; 0)) __pyx_t_8 = 0;
        } else if (unlikely(__pyx_t_36 &gt;= __pyx_v_beta_w.shape[0])) __pyx_t_8 = 0;
        if (unlikely(__pyx_t_8 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
          <span class='error_goto'>__PYX_ERR(0, 267, __pyx_L1_error)</span>
        }
        __pyx_t_20 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_beta_w.data + __pyx_t_36 * __pyx_v_beta_w.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 267, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(((PyObject *)__pyx_v_S_temp), __pyx_v_y, npy_intp, 1, __Pyx_PyInt_From_Py_intptr_t, 0, 1, 1);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 267, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        __pyx_t_25 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_20, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 267, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_25);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_4 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(((PyObject *)__pyx_v_S_sum), __pyx_t_25);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 267, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_25); __pyx_t_25 = 0;
        if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span
                class='error_goto'>__PYX_ERR(0, 267, __pyx_L1_error)</span>
        __pyx_t_7 = ((PyArrayObject *)__pyx_t_4);
        {
          __Pyx_BufFmt_StackElem __pyx_stack[2];
          <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_S_sum.rcbuffer-&gt;pybuffer);
          __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_S_sum.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_7, &amp;__Pyx_TypeInfo_nn___pyx_t_6pyrism_4core_3tma_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack);
          if (unlikely(__pyx_t_8 &lt; 0)) {
            <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_9, &amp;__pyx_t_10, &amp;__pyx_t_11);
            if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_S_sum.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_S_sum, &amp;__Pyx_TypeInfo_nn___pyx_t_6pyrism_4core_3tma_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
              Py_XDECREF(__pyx_t_9); Py_XDECREF(__pyx_t_10); Py_XDECREF(__pyx_t_11);
              <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
            } else {
              <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_9, __pyx_t_10, __pyx_t_11);
            }
            __pyx_t_9 = __pyx_t_10 = __pyx_t_11 = 0;
          }
          __pyx_pybuffernd_S_sum.diminfo[0].strides = __pyx_pybuffernd_S_sum.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_S_sum.diminfo[0].shape = __pyx_pybuffernd_S_sum.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_S_sum.diminfo[1].strides = __pyx_pybuffernd_S_sum.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_S_sum.diminfo[1].shape = __pyx_pybuffernd_S_sum.rcbuffer-&gt;pybuffer.shape[1];
          if (unlikely(__pyx_t_8 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 267, __pyx_L1_error)</span>
        }
        __pyx_t_7 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_S_sum, ((PyArrayObject *)__pyx_t_4));
        __pyx_t_4 = 0;
</pre>
    <pre class="cython line score-43"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0268</span>:                 <span class="n">Z_sum</span> <span class="o">+=</span> <span
            class="n">beta_w</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span
            class="o">*</span> <span class="n">Z_temp</span><span class="p">[</span><span class="n">y</span><span
            class="p">]</span></pre>
    <pre class='cython code score-43 '>        __pyx_t_37 = __pyx_v_y;
        __pyx_t_8 = -1;
        if (__pyx_t_37 &lt; 0) {
          __pyx_t_37 += __pyx_v_beta_w.shape[0];
          if (unlikely(__pyx_t_37 &lt; 0)) __pyx_t_8 = 0;
        } else if (unlikely(__pyx_t_37 &gt;= __pyx_v_beta_w.shape[0])) __pyx_t_8 = 0;
        if (unlikely(__pyx_t_8 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
          <span class='error_goto'>__PYX_ERR(0, 268, __pyx_L1_error)</span>
        }
        __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_beta_w.data + __pyx_t_37 * __pyx_v_beta_w.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 268, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        __pyx_t_25 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(((PyObject *)__pyx_v_Z_temp), __pyx_v_y, npy_intp, 1, __Pyx_PyInt_From_Py_intptr_t, 0, 1, 1);<span
                class='error_goto'> if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 268, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_25);
        __pyx_t_20 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_4, __pyx_t_25);<span class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 268, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_25); __pyx_t_25 = 0;
        __pyx_t_25 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(((PyObject *)__pyx_v_Z_sum), __pyx_t_20);<span
                class='error_goto'> if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 268, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_25);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
        if (!(likely(((__pyx_t_25) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_25, __pyx_ptype_5numpy_ndarray))))) <span
                class='error_goto'>__PYX_ERR(0, 268, __pyx_L1_error)</span>
        __pyx_t_12 = ((PyArrayObject *)__pyx_t_25);
        {
          __Pyx_BufFmt_StackElem __pyx_stack[1];
          <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Z_sum.rcbuffer-&gt;pybuffer);
          __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Z_sum.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_12, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack);
          if (unlikely(__pyx_t_8 &lt; 0)) {
            <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_11, &amp;__pyx_t_10, &amp;__pyx_t_9);
            if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Z_sum.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_Z_sum, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
              Py_XDECREF(__pyx_t_11); Py_XDECREF(__pyx_t_10); Py_XDECREF(__pyx_t_9);
              <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
            } else {
              <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_11, __pyx_t_10, __pyx_t_9);
            }
            __pyx_t_11 = __pyx_t_10 = __pyx_t_9 = 0;
          }
          __pyx_pybuffernd_Z_sum.diminfo[0].strides = __pyx_pybuffernd_Z_sum.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Z_sum.diminfo[0].shape = __pyx_pybuffernd_Z_sum.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_Z_sum.diminfo[1].strides = __pyx_pybuffernd_Z_sum.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_Z_sum.diminfo[1].shape = __pyx_pybuffernd_Z_sum.rcbuffer-&gt;pybuffer.shape[1];
          if (unlikely(__pyx_t_8 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 268, __pyx_L1_error)</span>
        }
        __pyx_t_12 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_Z_sum, ((PyArrayObject *)__pyx_t_25));
        __pyx_t_25 = 0;
      }
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0269</span>: </pre>
    <pre class="cython line score-2"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0270</span>:             <span class="n">S</span><span class="p">[</span><span
            class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">S_sum</span></pre>
    <pre class='cython code score-2 '>      if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(((PyObject *)__pyx_v_S), __pyx_v_x, ((PyObject *)__pyx_v_S_sum), Py_ssize_t, 1, PyInt_FromSsize_t, 0, 1, 1) &lt; 0)) <span
            class='error_goto'>__PYX_ERR(0, 270, __pyx_L1_error)</span>
</pre>
    <pre class="cython line score-2"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0271</span>:             <span class="n">Z</span><span class="p">[</span><span
            class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">Z_sum</span></pre>
    <pre class='cython code score-2 '>      if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(((PyObject *)__pyx_v_Z), __pyx_v_x, ((PyObject *)__pyx_v_Z_sum), Py_ssize_t, 1, PyInt_FromSsize_t, 0, 1, 1) &lt; 0)) <span
            class='error_goto'>__PYX_ERR(0, 271, __pyx_L1_error)</span>
    }
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0272</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">0273</span>:     <span class="c"># normalize to get a proper average</span></pre>
    <pre class="cython line score-80"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0274</span>:     <span class="n">S</span> <span class="o">*=</span> <span class="n">aw</span> <span
            class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span
            class="p">(</span><span class="n">beta_w</span><span class="p">)</span></pre>
    <pre class='cython code score-80 '>  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_aw);<span
            class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 274, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_20 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 274, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_20, __pyx_n_s_sum);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 274, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
  __pyx_t_20 = __pyx_memoryview_fromslice(__pyx_v_beta_w, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span
                class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 274, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  if (!__pyx_t_5) {
    __pyx_t_25 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_20);<span
                class='error_goto'> if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 274, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_25);
  } else {
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_4)) {
      PyObject *__pyx_temp[2] = {__pyx_t_5, __pyx_t_20};
      __pyx_t_25 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 274, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_25);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_4)) {
      PyObject *__pyx_temp[2] = {__pyx_t_5, __pyx_t_20};
      __pyx_t_25 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 274, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_25);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
    } else
    #endif
    {
      __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 274, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_5); __pyx_t_5 = NULL;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_20);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0+1, __pyx_t_20);
      __pyx_t_20 = 0;
      __pyx_t_25 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_1, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 274, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_25);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_2, __pyx_t_25);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 274, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_25); __pyx_t_25 = 0;
  __pyx_t_25 = <span class='py_c_api'>PyNumber_InPlaceMultiply</span>(((PyObject *)__pyx_v_S), __pyx_t_4);<span
                class='error_goto'> if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 274, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_25);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_25) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_25, __pyx_ptype_5numpy_ndarray))))) <span
                class='error_goto'>__PYX_ERR(0, 274, __pyx_L1_error)</span>
  __pyx_t_13 = ((PyArrayObject *)__pyx_t_25);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[2];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_S.rcbuffer-&gt;pybuffer);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_S.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_13, &amp;__Pyx_TypeInfo_nn___pyx_t_6pyrism_4core_3tma_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack);
    if (unlikely(__pyx_t_8 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_9, &amp;__pyx_t_10, &amp;__pyx_t_11);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_S.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_S, &amp;__Pyx_TypeInfo_nn___pyx_t_6pyrism_4core_3tma_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_9); Py_XDECREF(__pyx_t_10); Py_XDECREF(__pyx_t_11);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_9, __pyx_t_10, __pyx_t_11);
      }
      __pyx_t_9 = __pyx_t_10 = __pyx_t_11 = 0;
    }
    __pyx_pybuffernd_S.diminfo[0].strides = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_S.diminfo[0].shape = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_S.diminfo[1].strides = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_S.diminfo[1].shape = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_S.diminfo[2].strides = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_S.diminfo[2].shape = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.shape[2];
    if (unlikely(__pyx_t_8 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 274, __pyx_L1_error)</span>
  }
  __pyx_t_13 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_S, ((PyArrayObject *)__pyx_t_25));
  __pyx_t_25 = 0;
</pre>
    <pre class="cython line score-80"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0275</span>:     <span class="n">Z</span> <span class="o">*=</span> <span class="n">aw</span> <span
            class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span
            class="p">(</span><span class="n">beta_w</span><span class="p">)</span></pre>
    <pre class='cython code score-80 '>  __pyx_t_25 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_aw);<span
            class='error_goto'> if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 275, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_25);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 275, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_sum);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 275, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_beta_w, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 275, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_20 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_20 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_20)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_20);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  if (!__pyx_t_20) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 275, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else {
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_1)) {
      PyObject *__pyx_temp[2] = {__pyx_t_20, __pyx_t_2};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 275, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_1)) {
      PyObject *__pyx_temp[2] = {__pyx_t_20, __pyx_t_2};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 275, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    } else
    #endif
    {
      __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 275, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_20); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_20); __pyx_t_20 = NULL;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+1, __pyx_t_2);
      __pyx_t_2 = 0;
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_5, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 275, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_25, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 275, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_25); __pyx_t_25 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyNumber_InPlaceMultiply</span>(((PyObject *)__pyx_v_Z), __pyx_t_1);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 275, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span
                class='error_goto'>__PYX_ERR(0, 275, __pyx_L1_error)</span>
  __pyx_t_14 = ((PyArrayObject *)__pyx_t_4);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_14, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack);
    if (unlikely(__pyx_t_8 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_11, &amp;__pyx_t_10, &amp;__pyx_t_9);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_Z, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_11); Py_XDECREF(__pyx_t_10); Py_XDECREF(__pyx_t_9);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_11, __pyx_t_10, __pyx_t_9);
      }
      __pyx_t_11 = __pyx_t_10 = __pyx_t_9 = 0;
    }
    __pyx_pybuffernd_Z.diminfo[0].strides = __pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Z.diminfo[0].shape = __pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_Z.diminfo[1].strides = __pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_Z.diminfo[1].shape = __pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_Z.diminfo[2].strides = __pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_Z.diminfo[2].shape = __pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer.shape[2];
    if (unlikely(__pyx_t_8 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 275, __pyx_L1_error)</span>
  }
  __pyx_t_14 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_Z, ((PyArrayObject *)__pyx_t_4));
  __pyx_t_4 = 0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0276</span>: </pre>
    <pre class="cython line score-10"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0277</span>:     <span class="k">return</span> <span class="n">S</span><span
            class="p">,</span> <span class="n">Z</span></pre>
    <pre class='cython code score-10 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 277, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_S));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_S));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, ((PyObject *)__pyx_v_S));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_Z));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_Z));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, ((PyObject *)__pyx_v_Z));
  __pyx_r = ((PyObject*)__pyx_t_4);
  __pyx_t_4 = 0;
  goto __pyx_L0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0278</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">0279</span>: <span class="c"># NOT Vectorized</span></pre>
    <pre class="cython line score-45"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0280</span>: <span class="k">cdef</span> <span class="kt">tuple</span> <span
            class="nf">SZ_AF</span><span class="p">(</span><span class="nb">int</span> <span class="n">nmax</span><span
            class="p">,</span> <span class="n">double</span> <span class="n">wavelength</span><span
            class="p">,</span> <span class="n">double</span> <span class="n">izaDeg</span><span class="p">,</span> <span
            class="n">double</span> <span class="n">vzaDeg</span><span class="p">,</span> <span class="n">double</span> <span
            class="n">iaaDeg</span><span class="p">,</span> <span class="n">double</span> <span
            class="n">vaaDeg</span><span class="p">,</span> <span class="nb">int</span> <span
            class="n">n_alpha</span><span class="p">,</span></pre>
    <pre class='cython code score-45 '>static PyObject *__pyx_f_6pyrism_4core_3tma_SZ_AF(int __pyx_v_nmax, double __pyx_v_wavelength, double __pyx_v_izaDeg, double __pyx_v_vzaDeg, double __pyx_v_iaaDeg, double __pyx_v_vaaDeg, int __pyx_v_n_alpha, int __pyx_v_n_beta, PyObject *__pyx_v_or_pdf) {
  __Pyx_memviewslice __pyx_v_beta_p = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_beta_w = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_alpha_array = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_wavelength_array = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_izaDeg_array = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_vzaDeg_array = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_iaaDeg_array = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_vaaDeg_array = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_nmax_array = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyArrayObject *__pyx_v_Z = 0;
  PyArrayObject *__pyx_v_Z_temp = 0;
  PyArrayObject *__pyx_v_S = 0;
  PyArrayObject *__pyx_v_S_temp = 0;
  PyArrayObject *__pyx_v_Z_sum = 0;
  PyArrayObject *__pyx_v_S_sum = 0;
  Py_ssize_t __pyx_v_x;
  Py_ssize_t __pyx_v_y;
  double __pyx_v_aw;
  __Pyx_memviewslice __pyx_v_alpha = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_item = NULL;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_S;
  __Pyx_Buffer __pyx_pybuffer_S;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_S_sum;
  __Pyx_Buffer __pyx_pybuffer_S_sum;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_S_temp;
  __Pyx_Buffer __pyx_pybuffer_S_temp;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Z;
  __Pyx_Buffer __pyx_pybuffer_Z;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Z_sum;
  __Pyx_Buffer __pyx_pybuffer_Z_sum;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Z_temp;
  __Pyx_Buffer __pyx_pybuffer_Z_temp;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("SZ_AF", 0);
  __pyx_pybuffer_Z.pybuffer.buf = NULL;
  __pyx_pybuffer_Z.refcount = 0;
  __pyx_pybuffernd_Z.data = NULL;
  __pyx_pybuffernd_Z.rcbuffer = &amp;__pyx_pybuffer_Z;
  __pyx_pybuffer_Z_temp.pybuffer.buf = NULL;
  __pyx_pybuffer_Z_temp.refcount = 0;
  __pyx_pybuffernd_Z_temp.data = NULL;
  __pyx_pybuffernd_Z_temp.rcbuffer = &amp;__pyx_pybuffer_Z_temp;
  __pyx_pybuffer_S.pybuffer.buf = NULL;
  __pyx_pybuffer_S.refcount = 0;
  __pyx_pybuffernd_S.data = NULL;
  __pyx_pybuffernd_S.rcbuffer = &amp;__pyx_pybuffer_S;
  __pyx_pybuffer_S_temp.pybuffer.buf = NULL;
  __pyx_pybuffer_S_temp.refcount = 0;
  __pyx_pybuffernd_S_temp.data = NULL;
  __pyx_pybuffernd_S_temp.rcbuffer = &amp;__pyx_pybuffer_S_temp;
  __pyx_pybuffer_Z_sum.pybuffer.buf = NULL;
  __pyx_pybuffer_Z_sum.refcount = 0;
  __pyx_pybuffernd_Z_sum.data = NULL;
  __pyx_pybuffernd_Z_sum.rcbuffer = &amp;__pyx_pybuffer_Z_sum;
  __pyx_pybuffer_S_sum.pybuffer.buf = NULL;
  __pyx_pybuffer_S_sum.refcount = 0;
  __pyx_pybuffernd_S_sum.data = NULL;
  __pyx_pybuffernd_S_sum.rcbuffer = &amp;__pyx_pybuffer_S_sum;
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_16, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_19);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_20);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_21);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_22, 1);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_S.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_S_sum.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_S_temp.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Z_sum.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Z_temp.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.SZ_AF", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_S.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_S_sum.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_S_temp.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Z_sum.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Z_temp.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_beta_p, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_beta_w, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_alpha_array, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_wavelength_array, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_izaDeg_array, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_vzaDeg_array, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_iaaDeg_array, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_vaaDeg_array, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_nmax_array, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_Z);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_Z_temp);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_S);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_S_temp);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_Z_sum);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_S_sum);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_alpha, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_item);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0281</span>:                  <span
            class="nb">int</span> <span class="n">n_beta</span><span class="p">,</span> <span
            class="n">or_pdf</span><span class="p">):</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0282</span>:     <span
            class="sd">&quot;&quot;&quot;</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0283</span>: <span class="sd">    Calculate the variable orientation scattering and phase matrix.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0284</span>: <span class="sd">    </span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0285</span>: <span class="sd">    This method uses a fast Gaussian quadrature and is suitable</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0286</span>: <span class="sd">    for most use. Uses the set particle orientation PDF, ignoring</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0287</span>: <span class="sd">    the alpha and beta attributes.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0288</span>: <span class="sd">    </span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0289</span>: <span class="sd">    Parameters</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0290</span>: <span class="sd">    ----------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0291</span>: <span class="sd">    nmax : int</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0292</span>: <span
            class="sd">        Nmax parameter.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0293</span>: <span
            class="sd">    wavelength : double</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0294</span>: <span class="sd">        Wavelength in same unit as radius (used by function calc_nmax).</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0295</span>: <span class="sd">    izaDeg, vzaDeg, iaaDeg, vaaDeg : double</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0296</span>: <span class="sd">        Incidence (iza) and scattering (vza) zenith angle and incidence and viewing</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0297</span>: <span class="sd">        azimuth angle (ira, vra) in [DEG].</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0298</span>: <span class="sd">    n_alpha, n_beta : int</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0299</span>: <span class="sd">        Number of integration points in the alpha and beta Euler angle.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0300</span>: <span
            class="sd">    or_pdf: callable</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0301</span>: <span class="sd">        Particle orientation Probability Density Function (PDF) for orientation averaging.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0302</span>: <span class="sd">            </span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0303</span>: <span class="sd">    Returns</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0304</span>: <span class="sd">    -------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0305</span>: <span class="sd">    S, Z : tuple with double[:,:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0306</span>: <span class="sd">        Twoe dimensional scattering (S) and phase (Z) matrix.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0307</span>: <span
            class="sd">    &quot;&quot;&quot;</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0308</span>:     <span class="k">cdef</span><span
            class="p">:</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0309</span>:         <span class="n">double</span><span
            class="p">[:]</span> <span class="n">beta_p</span><span class="p">,</span> <span
            class="n">beta_w</span><span class="p">,</span> <span class="n">alpha_array</span><span
            class="p">,</span> <span class="n">wavelength_array</span><span class="p">,</span> <span class="n">izaDeg_array</span><span
            class="p">,</span> <span class="n">vzaDeg_array</span><span class="p">,</span> <span
            class="n">iaaDeg_array</span><span class="p">,</span> <span class="n">vaaDeg_array</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0310</span>:         <span class="nb">int</span><span
            class="p">[:]</span> <span class="n">nmax_array</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0311</span>:         <span class="n">np</span><span class="o">.</span><span
            class="n">ndarray</span><span class="p">[</span><span class="n">double</span><span class="p">,</span> <span
            class="n">ndim</span><span class="o">=</span><span class="mf">3</span><span class="p">]</span>  <span
            class="n">Z</span><span class="p">,</span> <span class="n">Z_temp</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0312</span>:         <span class="n">np</span><span class="o">.</span><span
            class="n">ndarray</span><span class="p">[</span><span class="n">DTYPE_t</span><span class="p">,</span> <span
            class="n">ndim</span><span class="o">=</span><span class="mf">3</span><span class="p">]</span>  <span
            class="n">S</span><span class="p">,</span> <span class="n">S_temp</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0313</span>:         <span class="n">np</span><span class="o">.</span><span
            class="n">ndarray</span><span class="p">[</span><span class="n">double</span><span class="p">,</span> <span
            class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span>  <span
            class="n">Z_sum</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0314</span>:         <span class="n">np</span><span class="o">.</span><span
            class="n">ndarray</span><span class="p">[</span><span class="n">DTYPE_t</span><span class="p">,</span> <span
            class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span
            class="n">S_sum</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0315</span>:         <span class="n">Py_ssize_t</span> <span
            class="n">x</span><span class="p">,</span> <span class="n">y</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0316</span>: </pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0317</span>:         <span class="n">double</span> <span class="n">aw</span> <span
            class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">n_alpha</span></pre>
    <pre class='cython code score-0 '>  __pyx_v_aw = (1.0 / ((double)__pyx_v_n_alpha));
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0318</span>:         <span class="n">double</span> <span
            class="n">alpha_item</span></pre>
    <pre class="cython line score-46"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0319</span>:         <span class="n">double</span><span class="p">[:]</span> <span
            class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span
            class="n">linspace</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span> <span
            class="mf">360</span><span class="p">,</span> <span class="n">n_alpha</span> <span class="o">+</span> <span
            class="mf">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span
            class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">)[:</span><span
            class="o">-</span><span class="mf">1</span><span class="p">]</span></pre>
    <pre class='cython code score-46 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span
            class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 319, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_linspace);<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 319, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((__pyx_v_n_alpha + 1));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 319, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 319, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_360);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_360);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_360);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 2, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 319, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 319, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_double);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 319, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 319, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, __pyx_t_1);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 319, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_t_5, 0, -1L, NULL, NULL, &amp;__pyx_slice__13, 0, 1, 1);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 319, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_6 = <span
                class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 319, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_alpha = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
/* â€¦ */
  __pyx_slice__13 = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_int_neg_1, Py_None);<span
                class='error_goto'> if (unlikely(!__pyx_slice__13)) __PYX_ERR(0, 319, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__13);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__13);
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0320</span>: </pre>
    <pre class="cython line score-52"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0321</span>:     <span class="n">S_sum</span> <span class="o">=</span> <span
            class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span
            class="mf">2</span><span class="p">,</span> <span class="mf">2</span><span class="p">),</span> <span
            class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span
            class="n">complex</span><span class="p">)</span></pre>
    <pre class='cython code score-52 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span
            class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 321, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 321, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* â€¦ */
  __pyx_tuple__14 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_2, __pyx_int_2);<span class='error_goto'> if (unlikely(!__pyx_tuple__14)) __PYX_ERR(0, 321, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__14);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__14);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 321, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 321, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_complex);<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 321, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_2) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 321, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_tuple__15, __pyx_t_1);<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 321, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_2) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) <span
                class='error_goto'>__PYX_ERR(0, 321, __pyx_L1_error)</span>
  __pyx_t_7 = ((PyArrayObject *)__pyx_t_2);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[2];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_S_sum.rcbuffer-&gt;pybuffer);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_S_sum.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_7, &amp;__Pyx_TypeInfo_nn___pyx_t_6pyrism_4core_3tma_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack);
    if (unlikely(__pyx_t_8 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_9, &amp;__pyx_t_10, &amp;__pyx_t_11);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_S_sum.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_S_sum, &amp;__Pyx_TypeInfo_nn___pyx_t_6pyrism_4core_3tma_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_9); Py_XDECREF(__pyx_t_10); Py_XDECREF(__pyx_t_11);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_9, __pyx_t_10, __pyx_t_11);
      }
      __pyx_t_9 = __pyx_t_10 = __pyx_t_11 = 0;
    }
    __pyx_pybuffernd_S_sum.diminfo[0].strides = __pyx_pybuffernd_S_sum.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_S_sum.diminfo[0].shape = __pyx_pybuffernd_S_sum.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_S_sum.diminfo[1].strides = __pyx_pybuffernd_S_sum.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_S_sum.diminfo[1].shape = __pyx_pybuffernd_S_sum.rcbuffer-&gt;pybuffer.shape[1];
    if (unlikely(__pyx_t_8 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 321, __pyx_L1_error)</span>
  }
  __pyx_t_7 = 0;
  __pyx_v_S_sum = ((PyArrayObject *)__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_tuple__15 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_tuple__14);<span class='error_goto'> if (unlikely(!__pyx_tuple__15)) __PYX_ERR(0, 321, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__15);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__15);
</pre>
    <pre class="cython line score-38"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0322</span>:     <span class="n">Z_sum</span> <span class="o">=</span> <span
            class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span
            class="mf">4</span><span class="p">,</span> <span class="mf">4</span><span class="p">))</span></pre>
    <pre class='cython code score-38 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span
            class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 322, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 322, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* â€¦ */
  __pyx_tuple__16 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_4, __pyx_int_4);<span class='error_goto'> if (unlikely(!__pyx_tuple__16)) __PYX_ERR(0, 322, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__16);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__16);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_tuple__17, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 322, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_2) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) <span
                class='error_goto'>__PYX_ERR(0, 322, __pyx_L1_error)</span>
  __pyx_t_12 = ((PyArrayObject *)__pyx_t_2);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Z_sum.rcbuffer-&gt;pybuffer);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Z_sum.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_12, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack);
    if (unlikely(__pyx_t_8 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_11, &amp;__pyx_t_10, &amp;__pyx_t_9);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Z_sum.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_Z_sum, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_11); Py_XDECREF(__pyx_t_10); Py_XDECREF(__pyx_t_9);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_11, __pyx_t_10, __pyx_t_9);
      }
      __pyx_t_11 = __pyx_t_10 = __pyx_t_9 = 0;
    }
    __pyx_pybuffernd_Z_sum.diminfo[0].strides = __pyx_pybuffernd_Z_sum.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Z_sum.diminfo[0].shape = __pyx_pybuffernd_Z_sum.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_Z_sum.diminfo[1].strides = __pyx_pybuffernd_Z_sum.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_Z_sum.diminfo[1].shape = __pyx_pybuffernd_Z_sum.rcbuffer-&gt;pybuffer.shape[1];
    if (unlikely(__pyx_t_8 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 322, __pyx_L1_error)</span>
  }
  __pyx_t_12 = 0;
  __pyx_v_Z_sum = ((PyArrayObject *)__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_tuple__17 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_tuple__16);<span class='error_goto'> if (unlikely(!__pyx_tuple__17)) __PYX_ERR(0, 322, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__17);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__17);
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0323</span>: </pre>
    <pre class="cython line score-52"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0324</span>:     <span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span
            class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mf">1</span><span
            class="p">,</span> <span class="mf">2</span><span class="p">,</span> <span class="mf">2</span><span
            class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span
            class="o">.</span><span class="n">complex</span><span class="p">)</span></pre>
    <pre class='cython code score-52 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span
            class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 324, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 324, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* â€¦ */
  __pyx_tuple__18 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_int_1, __pyx_int_2, __pyx_int_2);<span
                class='error_goto'> if (unlikely(!__pyx_tuple__18)) __PYX_ERR(0, 324, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__18);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__18);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 324, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 324, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_complex);<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 324, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_3) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 324, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_tuple__19, __pyx_t_2);<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 324, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (!(likely(((__pyx_t_3) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) <span
                class='error_goto'>__PYX_ERR(0, 324, __pyx_L1_error)</span>
  __pyx_t_13 = ((PyArrayObject *)__pyx_t_3);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[2];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_S.rcbuffer-&gt;pybuffer);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_S.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_13, &amp;__Pyx_TypeInfo_nn___pyx_t_6pyrism_4core_3tma_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack);
    if (unlikely(__pyx_t_8 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_9, &amp;__pyx_t_10, &amp;__pyx_t_11);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_S.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_S, &amp;__Pyx_TypeInfo_nn___pyx_t_6pyrism_4core_3tma_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_9); Py_XDECREF(__pyx_t_10); Py_XDECREF(__pyx_t_11);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_9, __pyx_t_10, __pyx_t_11);
      }
      __pyx_t_9 = __pyx_t_10 = __pyx_t_11 = 0;
    }
    __pyx_pybuffernd_S.diminfo[0].strides = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_S.diminfo[0].shape = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_S.diminfo[1].strides = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_S.diminfo[1].shape = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_S.diminfo[2].strides = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_S.diminfo[2].shape = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.shape[2];
    if (unlikely(__pyx_t_8 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 324, __pyx_L1_error)</span>
  }
  __pyx_t_13 = 0;
  __pyx_v_S = ((PyArrayObject *)__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_tuple__19 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_tuple__18);<span class='error_goto'> if (unlikely(!__pyx_tuple__19)) __PYX_ERR(0, 324, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__19);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__19);
</pre>
    <pre class="cython line score-38"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0325</span>:     <span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span
            class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mf">1</span><span
            class="p">,</span> <span class="mf">4</span><span class="p">,</span> <span class="mf">4</span><span
            class="p">))</span></pre>
    <pre class='cython code score-38 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span
            class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 325, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros);<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 325, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
/* â€¦ */
  __pyx_tuple__20 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_int_1, __pyx_int_4, __pyx_int_4);<span
                class='error_goto'> if (unlikely(!__pyx_tuple__20)) __PYX_ERR(0, 325, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__20);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__20);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_tuple__21, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 325, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (!(likely(((__pyx_t_3) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) <span
                class='error_goto'>__PYX_ERR(0, 325, __pyx_L1_error)</span>
  __pyx_t_14 = ((PyArrayObject *)__pyx_t_3);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_14, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack);
    if (unlikely(__pyx_t_8 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_11, &amp;__pyx_t_10, &amp;__pyx_t_9);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_Z, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_11); Py_XDECREF(__pyx_t_10); Py_XDECREF(__pyx_t_9);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_11, __pyx_t_10, __pyx_t_9);
      }
      __pyx_t_11 = __pyx_t_10 = __pyx_t_9 = 0;
    }
    __pyx_pybuffernd_Z.diminfo[0].strides = __pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Z.diminfo[0].shape = __pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_Z.diminfo[1].strides = __pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_Z.diminfo[1].shape = __pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_Z.diminfo[2].strides = __pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_Z.diminfo[2].shape = __pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer.shape[2];
    if (unlikely(__pyx_t_8 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 325, __pyx_L1_error)</span>
  }
  __pyx_t_14 = 0;
  __pyx_v_Z = ((PyArrayObject *)__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_tuple__21 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_tuple__20);<span class='error_goto'> if (unlikely(!__pyx_tuple__21)) __PYX_ERR(0, 325, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__21);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__21);
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0326</span>: </pre>
    <pre class="cython line score-78"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0327</span>:     <span class="n">beta_p</span><span class="p">,</span> <span
            class="n">beta_w</span> <span class="o">=</span> <span class="n">get_points_and_weights</span><span
            class="p">(</span><span class="n">or_pdf</span><span class="p">,</span> <span class="mf">0</span><span
            class="p">,</span> <span class="mf">180</span><span class="p">,</span> <span
            class="n">num_points</span><span class="o">=</span><span class="n">n_beta</span><span
            class="p">)</span></pre>
    <pre class='cython code score-78 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_get_points_and_weights);<span
            class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 327, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 327, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_or_pdf);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_or_pdf);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_or_pdf);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_180);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_180);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, __pyx_int_180);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 327, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_beta);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 327, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_num_points, __pyx_t_5) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 327, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_2, __pyx_t_1);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 327, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_5))) || (<span
                class='py_c_api'>PyList_CheckExact</span>(__pyx_t_5))) {
    PyObject* sequence = __pyx_t_5;
    Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
    if (unlikely(size != 2)) {
      if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      <span class='error_goto'>__PYX_ERR(0, 327, __pyx_L1_error)</span>
    }
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0);
      __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1);
    } else {
      __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0);
      __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1);
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    #else
    __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 327, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 327, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 327, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_15 = Py_TYPE(__pyx_t_3)-&gt;tp_iternext;
    index = 0; __pyx_t_1 = __pyx_t_15(__pyx_t_3); if (unlikely(!__pyx_t_1)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    index = 1; __pyx_t_2 = __pyx_t_15(__pyx_t_3); if (unlikely(!__pyx_t_2)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_15(__pyx_t_3), 2) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 327, __pyx_L1_error)</span>
    __pyx_t_15 = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    goto __pyx_L4_unpacking_done;
    __pyx_L3_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_15 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span
                class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
    <span class='error_goto'>__PYX_ERR(0, 327, __pyx_L1_error)</span>
    __pyx_L4_unpacking_done:;
  }
  __pyx_t_6 = <span
                class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 327, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_16 = <span
                class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_2, PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_t_16.memview)) __PYX_ERR(0, 327, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_beta_p = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
  __pyx_v_beta_w = __pyx_t_16;
  __pyx_t_16.memview = NULL;
  __pyx_t_16.data = NULL;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0328</span>: </pre>
    <pre class="cython line score-44"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0329</span>:     <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span
            class="n">alpha</span><span class="p">:</span></pre>
    <pre class='cython code score-44 '>  __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_alpha, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span
            class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 329, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_5)) || <span
                class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_5)) {
    __pyx_t_2 = __pyx_t_5; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_17 = 0;
    __pyx_t_18 = NULL;
  } else {
    __pyx_t_17 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 329, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_18 = Py_TYPE(__pyx_t_2)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 329, __pyx_L1_error)</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  for (;;) {
    if (likely(!__pyx_t_18)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
        if (__pyx_t_17 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_5 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_17); <span
                class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_17++; if (unlikely(0 &lt; 0)) <span
                class='error_goto'>__PYX_ERR(0, 329, __pyx_L1_error)</span>
        #else
        __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_17); __pyx_t_17++;<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 329, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        #endif
      } else {
        if (__pyx_t_17 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_2)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_17); <span
                class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_17++; if (unlikely(0 &lt; 0)) <span
                class='error_goto'>__PYX_ERR(0, 329, __pyx_L1_error)</span>
        #else
        __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_17); __pyx_t_17++;<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 329, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        #endif
      }
    } else {
      __pyx_t_5 = __pyx_t_18(__pyx_t_2);
      if (unlikely(!__pyx_t_5)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span
                class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span
                class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 329, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_item, __pyx_t_5);
    __pyx_t_5 = 0;
/* â€¦ */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre>
    <pre class="cython line score-53"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0330</span>:         <span class="n">alpha_array</span> <span class="o">=</span> <span
            class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span
            class="n">beta_p</span><span class="p">)</span> <span class="o">+</span> <span class="n">item</span></pre>
    <pre class='cython code score-53 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span
            class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 330, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros_like);<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 330, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_beta_p, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 330, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_4 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      }
    }
    if (!__pyx_t_4) {
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_1);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 330, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    } else {
      #if CYTHON_FAST_PYCALL
      if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
        PyObject *__pyx_temp[2] = {__pyx_t_4, __pyx_t_1};
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 330, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      } else
      #endif
      #if CYTHON_FAST_PYCCALL
      if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
        PyObject *__pyx_temp[2] = {__pyx_t_4, __pyx_t_1};
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 330, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      } else
      #endif
      {
        __pyx_t_19 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 330, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 0, __pyx_t_4); __pyx_t_4 = NULL;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 0+1, __pyx_t_1);
        __pyx_t_1 = 0;
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_19, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 330, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
      }
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_5, __pyx_v_item);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 330, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_16 = <span
                class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_3, PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_t_16.memview)) __PYX_ERR(0, 330, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_alpha_array, 1);
    __pyx_v_alpha_array = __pyx_t_16;
    __pyx_t_16.memview = NULL;
    __pyx_t_16.data = NULL;
</pre>
    <pre class="cython line score-89"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0331</span>:         <span class="n">nmax_array</span> <span class="o">=</span> <span
            class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span
            class="n">beta_p</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span
            class="n">np</span><span class="o">.</span><span class="n">intc</span><span class="p">)</span> <span
            class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span
            class="p">(</span><span class="n">nmax</span><span class="p">,</span> <span class="n">dtype</span><span
            class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">intc</span><span
            class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span></pre>
    <pre class='cython code score-89 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span
            class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 331, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros_like);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 331, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_beta_p, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 331, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_19 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 331, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 0, __pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 331, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 331, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_intc);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 331, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 331, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_19, __pyx_t_3);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 331, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_19 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 331, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_19, __pyx_n_s_asarray);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 331, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
    __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_nmax);<span class='error_goto'> if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 331, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 331, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_19);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_19);
    __pyx_t_19 = 0;
    __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 331, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
    __pyx_t_20 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 331, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
    __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_20, __pyx_n_s_intc);<span
                class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 331, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_19, __pyx_n_s_dtype, __pyx_t_21) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 331, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
    __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_1, __pyx_t_19);<span
                class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 331, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
    __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_21, __pyx_n_s_flatten);<span
                class='error_goto'> if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 331, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
    __pyx_t_21 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_19))) {
      __pyx_t_21 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_19);
      if (likely(__pyx_t_21)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_19);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_21);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_19, function);
      }
    }
    if (__pyx_t_21) {
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_19, __pyx_t_21);<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 331, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
    } else {
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_19);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 331, __pyx_L1_error)</span>
    }
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
    __pyx_t_19 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 331, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_22 = <span
                class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_t_19, PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_t_22.memview)) __PYX_ERR(0, 331, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_nmax_array, 1);
    __pyx_v_nmax_array = __pyx_t_22;
    __pyx_t_22.memview = NULL;
    __pyx_t_22.data = NULL;
</pre>
    <pre class="cython line score-122"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0332</span>:         <span class="n">wavelength_array</span> <span class="o">=</span> <span
            class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span
            class="n">beta_p</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span
            class="o">.</span><span class="n">asarray</span><span class="p">(</span><span
            class="n">wavelength</span><span class="p">)</span><span class="o">.</span><span
            class="n">flatten</span><span class="p">()</span></pre>
    <pre class='cython code score-122 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span
            class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 332, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros_like);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 332, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_beta_p, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 332, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_21 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_21 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_21)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_21);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      }
    }
    if (!__pyx_t_21) {
      __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_3);<span
                class='error_goto'> if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 332, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
    } else {
      #if CYTHON_FAST_PYCALL
      if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_4)) {
        PyObject *__pyx_temp[2] = {__pyx_t_21, __pyx_t_3};
        __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 332, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      } else
      #endif
      #if CYTHON_FAST_PYCCALL
      if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_4)) {
        PyObject *__pyx_temp[2] = {__pyx_t_21, __pyx_t_3};
        __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 332, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      } else
      #endif
      {
        __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 332, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_21); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_21); __pyx_t_21 = NULL;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0+1, __pyx_t_3);
        __pyx_t_3 = 0;
        __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_1, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 332, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      }
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 332, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_asarray);<span
                class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 332, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_wavelength);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 332, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_5 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_21))) {
      __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_21);
      if (likely(__pyx_t_5)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_21);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_21, function);
      }
    }
    if (!__pyx_t_5) {
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_21, __pyx_t_3);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 332, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    } else {
      #if CYTHON_FAST_PYCALL
      if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_21)) {
        PyObject *__pyx_temp[2] = {__pyx_t_5, __pyx_t_3};
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_21, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 332, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      } else
      #endif
      #if CYTHON_FAST_PYCCALL
      if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_21)) {
        PyObject *__pyx_temp[2] = {__pyx_t_5, __pyx_t_3};
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_21, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 332, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      } else
      #endif
      {
        __pyx_t_20 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 332, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_20, 0, __pyx_t_5); __pyx_t_5 = NULL;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_20, 0+1, __pyx_t_3);
        __pyx_t_3 = 0;
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_21, __pyx_t_20, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 332, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
      }
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
    __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_flatten);<span
                class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 332, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_21))) {
      __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_21);
      if (likely(__pyx_t_1)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_21);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_21, function);
      }
    }
    if (__pyx_t_1) {
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_21, __pyx_t_1);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 332, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    } else {
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_21);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 332, __pyx_L1_error)</span>
    }
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
    __pyx_t_21 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_19, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 332, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_21, PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_t_16.memview)) __PYX_ERR(0, 332, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_wavelength_array, 1);
    __pyx_v_wavelength_array = __pyx_t_16;
    __pyx_t_16.memview = NULL;
    __pyx_t_16.data = NULL;
</pre>
    <pre class="cython line score-122"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0333</span>:         <span class="n">izaDeg_array</span> <span class="o">=</span> <span class="n">np</span><span
            class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span
            class="n">beta_p</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span
            class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">izaDeg</span><span
            class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span></pre>
    <pre class='cython code score-122 '>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span
            class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 333, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_zeros_like);<span
                class='error_goto'> if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 333, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_beta_p, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 333, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_1 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_19))) {
      __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_19);
      if (likely(__pyx_t_1)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_19);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_19, function);
      }
    }
    if (!__pyx_t_1) {
      __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_19, __pyx_t_4);<span
                class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 333, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
    } else {
      #if CYTHON_FAST_PYCALL
      if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_19)) {
        PyObject *__pyx_temp[2] = {__pyx_t_1, __pyx_t_4};
        __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_19, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 333, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      } else
      #endif
      #if CYTHON_FAST_PYCCALL
      if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_19)) {
        PyObject *__pyx_temp[2] = {__pyx_t_1, __pyx_t_4};
        __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_19, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 333, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      } else
      #endif
      {
        __pyx_t_20 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 333, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_20, 0, __pyx_t_1); __pyx_t_1 = NULL;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_20, 0+1, __pyx_t_4);
        __pyx_t_4 = 0;
        __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_19, __pyx_t_20, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 333, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
      }
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 333, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_asarray);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 333, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_izaDeg);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 333, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_3 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      }
    }
    if (!__pyx_t_3) {
      __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_4);<span
                class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 333, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
    } else {
      #if CYTHON_FAST_PYCALL
      if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_1)) {
        PyObject *__pyx_temp[2] = {__pyx_t_3, __pyx_t_4};
        __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 333, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      } else
      #endif
      #if CYTHON_FAST_PYCCALL
      if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_1)) {
        PyObject *__pyx_temp[2] = {__pyx_t_3, __pyx_t_4};
        __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 333, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      } else
      #endif
      {
        __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 333, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_3); __pyx_t_3 = NULL;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+1, __pyx_t_4);
        __pyx_t_4 = 0;
        __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_5, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 333, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      }
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_20, __pyx_n_s_flatten);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 333, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
    __pyx_t_20 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_20 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_20)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_20);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      }
    }
    if (__pyx_t_20) {
      __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_20);<span
                class='error_goto'> if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 333, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
    } else {
      __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 333, __pyx_L1_error)</span>
    }
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_21, __pyx_t_19);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 333, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
    __pyx_t_16 = <span
                class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_t_16.memview)) __PYX_ERR(0, 333, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_izaDeg_array, 1);
    __pyx_v_izaDeg_array = __pyx_t_16;
    __pyx_t_16.memview = NULL;
    __pyx_t_16.data = NULL;
</pre>
    <pre class="cython line score-122"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0334</span>:         <span class="n">vzaDeg_array</span> <span class="o">=</span> <span class="n">np</span><span
            class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span
            class="n">beta_p</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span
            class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">vzaDeg</span><span
            class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span></pre>
    <pre class='cython code score-122 '>    __pyx_t_19 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span
            class='error_goto'> if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 334, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
    __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_19, __pyx_n_s_zeros_like);<span
                class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 334, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
    __pyx_t_19 = __pyx_memoryview_fromslice(__pyx_v_beta_p, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span
                class='error_goto'> if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 334, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
    __pyx_t_20 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_21))) {
      __pyx_t_20 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_21);
      if (likely(__pyx_t_20)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_21);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_20);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_21, function);
      }
    }
    if (!__pyx_t_20) {
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_21, __pyx_t_19);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 334, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    } else {
      #if CYTHON_FAST_PYCALL
      if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_21)) {
        PyObject *__pyx_temp[2] = {__pyx_t_20, __pyx_t_19};
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_21, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 334, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
      } else
      #endif
      #if CYTHON_FAST_PYCCALL
      if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_21)) {
        PyObject *__pyx_temp[2] = {__pyx_t_20, __pyx_t_19};
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_21, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 334, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
      } else
      #endif
      {
        __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 334, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_20); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_20); __pyx_t_20 = NULL;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_19);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+1, __pyx_t_19);
        __pyx_t_19 = 0;
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_21, __pyx_t_5, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 334, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      }
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
    __pyx_t_19 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 334, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
    __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_19, __pyx_n_s_asarray);<span
                class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 334, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
    __pyx_t_19 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_vzaDeg);<span class='error_goto'> if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 334, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
    __pyx_t_4 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_20))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_20);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_20);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_20, function);
      }
    }
    if (!__pyx_t_4) {
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_20, __pyx_t_19);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 334, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    } else {
      #if CYTHON_FAST_PYCALL
      if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_20)) {
        PyObject *__pyx_temp[2] = {__pyx_t_4, __pyx_t_19};
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_20, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 334, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
      } else
      #endif
      #if CYTHON_FAST_PYCCALL
      if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_20)) {
        PyObject *__pyx_temp[2] = {__pyx_t_4, __pyx_t_19};
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_20, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 334, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
      } else
      #endif
      {
        __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 334, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_4); __pyx_t_4 = NULL;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_19);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+1, __pyx_t_19);
        __pyx_t_19 = 0;
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_20, __pyx_t_3, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 334, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      }
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
    __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_flatten);<span
                class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 334, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_20))) {
      __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_20);
      if (likely(__pyx_t_5)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_20);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_20, function);
      }
    }
    if (__pyx_t_5) {
      __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_20, __pyx_t_5);<span
                class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 334, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    } else {
      __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_20);<span class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 334, __pyx_L1_error)</span>
    }
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
    __pyx_t_20 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_t_21);<span class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 334, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
    __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_20, PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_t_16.memview)) __PYX_ERR(0, 334, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_vzaDeg_array, 1);
    __pyx_v_vzaDeg_array = __pyx_t_16;
    __pyx_t_16.memview = NULL;
    __pyx_t_16.data = NULL;
</pre>
    <pre class="cython line score-122"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0335</span>:         <span class="n">iaaDeg_array</span> <span class="o">=</span> <span class="n">np</span><span
            class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span
            class="n">beta_p</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span
            class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">iaaDeg</span><span
            class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span></pre>
    <pre class='cython code score-122 '>    __pyx_t_21 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span
            class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 335, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_21, __pyx_n_s_zeros_like);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 335, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
    __pyx_t_21 = __pyx_memoryview_fromslice(__pyx_v_beta_p, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span
                class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 335, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
    __pyx_t_5 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_5)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      }
    }
    if (!__pyx_t_5) {
      __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_21);<span
                class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 335, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
    } else {
      #if CYTHON_FAST_PYCALL
      if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_1)) {
        PyObject *__pyx_temp[2] = {__pyx_t_5, __pyx_t_21};
        __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 335, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
      } else
      #endif
      #if CYTHON_FAST_PYCCALL
      if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_1)) {
        PyObject *__pyx_temp[2] = {__pyx_t_5, __pyx_t_21};
        __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 335, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
      } else
      #endif
      {
        __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 335, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_5); __pyx_t_5 = NULL;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_21);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+1, __pyx_t_21);
        __pyx_t_21 = 0;
        __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 335, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      }
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_21 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 335, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_21, __pyx_n_s_asarray);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 335, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
    __pyx_t_21 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_iaaDeg);<span class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 335, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
    __pyx_t_19 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_19 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_19)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_19);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      }
    }
    if (!__pyx_t_19) {
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_21);<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 335, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    } else {
      #if CYTHON_FAST_PYCALL
      if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_5)) {
        PyObject *__pyx_temp[2] = {__pyx_t_19, __pyx_t_21};
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 335, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
      } else
      #endif
      #if CYTHON_FAST_PYCCALL
      if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_5)) {
        PyObject *__pyx_temp[2] = {__pyx_t_19, __pyx_t_21};
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 335, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
      } else
      #endif
      {
        __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 335, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_19); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_19); __pyx_t_19 = NULL;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_21);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+1, __pyx_t_21);
        __pyx_t_21 = 0;
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_4, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 335, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      }
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_flatten);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 335, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      }
    }
    if (__pyx_t_3) {
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_3);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 335, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    } else {
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 335, __pyx_L1_error)</span>
    }
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_20, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 335, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_16 = <span
                class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_5, PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_t_16.memview)) __PYX_ERR(0, 335, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_iaaDeg_array, 1);
    __pyx_v_iaaDeg_array = __pyx_t_16;
    __pyx_t_16.memview = NULL;
    __pyx_t_16.data = NULL;
</pre>
    <pre class="cython line score-122"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0336</span>:         <span class="n">vaaDeg_array</span> <span class="o">=</span> <span class="n">np</span><span
            class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span
            class="n">beta_p</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span
            class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">vaaDeg</span><span
            class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span></pre>
    <pre class='cython code score-122 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span
            class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 336, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros_like);<span
                class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 336, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_beta_p, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 336, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_20))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_20);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_20);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_20, function);
      }
    }
    if (!__pyx_t_3) {
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_20, __pyx_t_1);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 336, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    } else {
      #if CYTHON_FAST_PYCALL
      if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_20)) {
        PyObject *__pyx_temp[2] = {__pyx_t_3, __pyx_t_1};
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_20, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 336, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      } else
      #endif
      #if CYTHON_FAST_PYCCALL
      if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_20)) {
        PyObject *__pyx_temp[2] = {__pyx_t_3, __pyx_t_1};
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_20, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 336, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      } else
      #endif
      {
        __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 336, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3); __pyx_t_3 = NULL;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+1, __pyx_t_1);
        __pyx_t_1 = 0;
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_20, __pyx_t_4, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 336, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      }
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 336, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_asarray);<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 336, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_vaaDeg);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 336, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_21 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_21 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_21)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_21);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      }
    }
    if (!__pyx_t_21) {
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_1);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 336, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    } else {
      #if CYTHON_FAST_PYCALL
      if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
        PyObject *__pyx_temp[2] = {__pyx_t_21, __pyx_t_1};
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 336, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      } else
      #endif
      #if CYTHON_FAST_PYCCALL
      if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
        PyObject *__pyx_temp[2] = {__pyx_t_21, __pyx_t_1};
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 336, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      } else
      #endif
      {
        __pyx_t_19 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 336, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_21); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 0, __pyx_t_21); __pyx_t_21 = NULL;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 0+1, __pyx_t_1);
        __pyx_t_1 = 0;
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_19, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 336, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
      }
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_flatten);<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 336, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      }
    }
    if (__pyx_t_4) {
      __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_4);<span
                class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 336, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    } else {
      __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 336, __pyx_L1_error)</span>
    }
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_5, __pyx_t_20);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 336, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
    __pyx_t_16 = <span
                class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_3, PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_t_16.memview)) __PYX_ERR(0, 336, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_vaaDeg_array, 1);
    __pyx_v_vaaDeg_array = __pyx_t_16;
    __pyx_t_16.memview = NULL;
    __pyx_t_16.data = NULL;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0337</span>: </pre>
    <pre class="cython line score-57"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0338</span>:         <span class="n">S_temp</span><span class="p">,</span> <span
            class="n">Z_temp</span> <span class="o">=</span> <span class="n">SZ_S_VEC</span><span
            class="p">(</span><span class="n">nmax_array</span><span class="p">,</span> <span
            class="n">wavelength_array</span><span class="p">,</span> <span class="n">izaDeg_array</span><span
            class="p">,</span> <span class="n">vzaDeg_array</span><span class="p">,</span> <span
            class="n">iaaDeg_array</span><span class="p">,</span></pre>
    <pre class='cython code score-57 '>    __pyx_t_3 = __pyx_f_6pyrism_4core_3tma_SZ_S_VEC(__pyx_v_nmax_array, __pyx_v_wavelength_array, __pyx_v_izaDeg_array, __pyx_v_vzaDeg_array, __pyx_v_iaaDeg_array, __pyx_v_vaaDeg_array, __pyx_v_alpha_array, __pyx_v_beta_p);<span
            class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 338, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (likely(__pyx_t_3 != Py_None)) {
      PyObject* sequence = __pyx_t_3;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 2)) {
        if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(0, 338, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      __pyx_t_20 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0);
      __pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_20);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      #else
      __pyx_t_20 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 338, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
      __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 338, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    } else {
      <span class='pyx_c_api'>__Pyx_RaiseNoneNotIterableError</span>(); <span class='error_goto'>__PYX_ERR(0, 338, __pyx_L1_error)</span>
    }
    if (!(likely(((__pyx_t_20) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_20, __pyx_ptype_5numpy_ndarray))))) <span
                class='error_goto'>__PYX_ERR(0, 338, __pyx_L1_error)</span>
    if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) <span
                class='error_goto'>__PYX_ERR(0, 338, __pyx_L1_error)</span>
    __pyx_t_13 = ((PyArrayObject *)__pyx_t_20);
    {
      __Pyx_BufFmt_StackElem __pyx_stack[2];
      <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_S_temp.rcbuffer-&gt;pybuffer);
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_S_temp.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_13, &amp;__Pyx_TypeInfo_nn___pyx_t_6pyrism_4core_3tma_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack);
      if (unlikely(__pyx_t_8 &lt; 0)) {
        <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_9, &amp;__pyx_t_10, &amp;__pyx_t_11);
        if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_S_temp.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_S_temp, &amp;__Pyx_TypeInfo_nn___pyx_t_6pyrism_4core_3tma_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack) == -1)) {
          Py_XDECREF(__pyx_t_9); Py_XDECREF(__pyx_t_10); Py_XDECREF(__pyx_t_11);
          <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
        } else {
          <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_9, __pyx_t_10, __pyx_t_11);
        }
        __pyx_t_9 = __pyx_t_10 = __pyx_t_11 = 0;
      }
      __pyx_pybuffernd_S_temp.diminfo[0].strides = __pyx_pybuffernd_S_temp.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_S_temp.diminfo[0].shape = __pyx_pybuffernd_S_temp.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_S_temp.diminfo[1].strides = __pyx_pybuffernd_S_temp.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_S_temp.diminfo[1].shape = __pyx_pybuffernd_S_temp.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_S_temp.diminfo[2].strides = __pyx_pybuffernd_S_temp.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_S_temp.diminfo[2].shape = __pyx_pybuffernd_S_temp.rcbuffer-&gt;pybuffer.shape[2];
      if (unlikely(__pyx_t_8 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 338, __pyx_L1_error)</span>
    }
    __pyx_t_13 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_S_temp, ((PyArrayObject *)__pyx_t_20));
    __pyx_t_20 = 0;
    __pyx_t_14 = ((PyArrayObject *)__pyx_t_5);
    {
      __Pyx_BufFmt_StackElem __pyx_stack[1];
      <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Z_temp.rcbuffer-&gt;pybuffer);
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Z_temp.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_14, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack);
      if (unlikely(__pyx_t_8 &lt; 0)) {
        <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_11, &amp;__pyx_t_10, &amp;__pyx_t_9);
        if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Z_temp.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_Z_temp, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack) == -1)) {
          Py_XDECREF(__pyx_t_11); Py_XDECREF(__pyx_t_10); Py_XDECREF(__pyx_t_9);
          <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
        } else {
          <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_11, __pyx_t_10, __pyx_t_9);
        }
        __pyx_t_11 = __pyx_t_10 = __pyx_t_9 = 0;
      }
      __pyx_pybuffernd_Z_temp.diminfo[0].strides = __pyx_pybuffernd_Z_temp.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Z_temp.diminfo[0].shape = __pyx_pybuffernd_Z_temp.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_Z_temp.diminfo[1].strides = __pyx_pybuffernd_Z_temp.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_Z_temp.diminfo[1].shape = __pyx_pybuffernd_Z_temp.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_Z_temp.diminfo[2].strides = __pyx_pybuffernd_Z_temp.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_Z_temp.diminfo[2].shape = __pyx_pybuffernd_Z_temp.rcbuffer-&gt;pybuffer.shape[2];
      if (unlikely(__pyx_t_8 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 338, __pyx_L1_error)</span>
    }
    __pyx_t_14 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_Z_temp, ((PyArrayObject *)__pyx_t_5));
    __pyx_t_5 = 0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0339</span>:                                   <span
            class="n">vaaDeg_array</span><span class="p">,</span> <span class="n">alpha_array</span><span
            class="p">,</span> <span class="n">beta_p</span><span class="p">)</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0340</span>: </pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0341</span>:         <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span
            class="nb">range</span><span class="p">(</span><span class="n">S_temp</span><span class="o">.</span><span
            class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]):</span></pre>
    <pre class='cython code score-0 '>    __pyx_t_23 = (__pyx_v_S_temp-&gt;dimensions[0]);
    __pyx_t_24 = __pyx_t_23;
    for (__pyx_t_25 = 0; __pyx_t_25 &lt; __pyx_t_24; __pyx_t_25+=1) {
      __pyx_v_y = __pyx_t_25;
</pre>
    <pre class="cython line score-43"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0342</span>:             <span class="n">S_sum</span> <span class="o">+=</span> <span class="n">beta_w</span><span
            class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">*</span> <span class="n">S_temp</span><span
            class="p">[</span><span class="n">y</span><span class="p">]</span></pre>
    <pre class='cython code score-43 '>      __pyx_t_26 = __pyx_v_y;
      __pyx_t_8 = -1;
      if (__pyx_t_26 &lt; 0) {
        __pyx_t_26 += __pyx_v_beta_w.shape[0];
        if (unlikely(__pyx_t_26 &lt; 0)) __pyx_t_8 = 0;
      } else if (unlikely(__pyx_t_26 &gt;= __pyx_v_beta_w.shape[0])) __pyx_t_8 = 0;
      if (unlikely(__pyx_t_8 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
        <span class='error_goto'>__PYX_ERR(0, 342, __pyx_L1_error)</span>
      }
      __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_beta_w.data + __pyx_t_26 * __pyx_v_beta_w.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 342, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(((PyObject *)__pyx_v_S_temp), __pyx_v_y, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 1, 1);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 342, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_20 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_3, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 342, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(((PyObject *)__pyx_v_S_sum), __pyx_t_20);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 342, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
      if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) <span
                class='error_goto'>__PYX_ERR(0, 342, __pyx_L1_error)</span>
      __pyx_t_7 = ((PyArrayObject *)__pyx_t_5);
      {
        __Pyx_BufFmt_StackElem __pyx_stack[2];
        <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_S_sum.rcbuffer-&gt;pybuffer);
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_S_sum.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_7, &amp;__Pyx_TypeInfo_nn___pyx_t_6pyrism_4core_3tma_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack);
        if (unlikely(__pyx_t_8 &lt; 0)) {
          <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_9, &amp;__pyx_t_10, &amp;__pyx_t_11);
          if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_S_sum.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_S_sum, &amp;__Pyx_TypeInfo_nn___pyx_t_6pyrism_4core_3tma_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
            Py_XDECREF(__pyx_t_9); Py_XDECREF(__pyx_t_10); Py_XDECREF(__pyx_t_11);
            <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
          } else {
            <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_9, __pyx_t_10, __pyx_t_11);
          }
          __pyx_t_9 = __pyx_t_10 = __pyx_t_11 = 0;
        }
        __pyx_pybuffernd_S_sum.diminfo[0].strides = __pyx_pybuffernd_S_sum.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_S_sum.diminfo[0].shape = __pyx_pybuffernd_S_sum.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_S_sum.diminfo[1].strides = __pyx_pybuffernd_S_sum.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_S_sum.diminfo[1].shape = __pyx_pybuffernd_S_sum.rcbuffer-&gt;pybuffer.shape[1];
        if (unlikely(__pyx_t_8 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 342, __pyx_L1_error)</span>
      }
      __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_S_sum, ((PyArrayObject *)__pyx_t_5));
      __pyx_t_5 = 0;
</pre>
    <pre class="cython line score-43"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0343</span>:             <span class="n">Z_sum</span> <span class="o">+=</span> <span class="n">beta_w</span><span
            class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">*</span> <span class="n">Z_temp</span><span
            class="p">[</span><span class="n">y</span><span class="p">]</span></pre>
    <pre class='cython code score-43 '>      __pyx_t_27 = __pyx_v_y;
      __pyx_t_8 = -1;
      if (__pyx_t_27 &lt; 0) {
        __pyx_t_27 += __pyx_v_beta_w.shape[0];
        if (unlikely(__pyx_t_27 &lt; 0)) __pyx_t_8 = 0;
      } else if (unlikely(__pyx_t_27 &gt;= __pyx_v_beta_w.shape[0])) __pyx_t_8 = 0;
      if (unlikely(__pyx_t_8 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
        <span class='error_goto'>__PYX_ERR(0, 343, __pyx_L1_error)</span>
      }
      __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_beta_w.data + __pyx_t_27 * __pyx_v_beta_w.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 343, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_20 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(((PyObject *)__pyx_v_Z_temp), __pyx_v_y, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 1, 1);<span
                class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 343, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
      __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_5, __pyx_t_20);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 343, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
      __pyx_t_20 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(((PyObject *)__pyx_v_Z_sum), __pyx_t_3);<span
                class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 343, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (!(likely(((__pyx_t_20) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_20, __pyx_ptype_5numpy_ndarray))))) <span
                class='error_goto'>__PYX_ERR(0, 343, __pyx_L1_error)</span>
      __pyx_t_12 = ((PyArrayObject *)__pyx_t_20);
      {
        __Pyx_BufFmt_StackElem __pyx_stack[1];
        <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Z_sum.rcbuffer-&gt;pybuffer);
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Z_sum.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_12, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack);
        if (unlikely(__pyx_t_8 &lt; 0)) {
          <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_11, &amp;__pyx_t_10, &amp;__pyx_t_9);
          if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Z_sum.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_Z_sum, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
            Py_XDECREF(__pyx_t_11); Py_XDECREF(__pyx_t_10); Py_XDECREF(__pyx_t_9);
            <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
          } else {
            <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_11, __pyx_t_10, __pyx_t_9);
          }
          __pyx_t_11 = __pyx_t_10 = __pyx_t_9 = 0;
        }
        __pyx_pybuffernd_Z_sum.diminfo[0].strides = __pyx_pybuffernd_Z_sum.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Z_sum.diminfo[0].shape = __pyx_pybuffernd_Z_sum.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_Z_sum.diminfo[1].strides = __pyx_pybuffernd_Z_sum.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_Z_sum.diminfo[1].shape = __pyx_pybuffernd_Z_sum.rcbuffer-&gt;pybuffer.shape[1];
        if (unlikely(__pyx_t_8 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 343, __pyx_L1_error)</span>
      }
      __pyx_t_12 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_Z_sum, ((PyArrayObject *)__pyx_t_20));
      __pyx_t_20 = 0;
    }
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0344</span>: </pre>
    <pre class="cython line score-2"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0345</span>:         <span class="n">S</span><span class="p">[</span><span class="n">x</span><span
            class="p">]</span> <span class="o">=</span> <span class="n">S_sum</span></pre>
    <pre class='cython code score-2 '>    if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(((PyObject *)__pyx_v_S), __pyx_v_x, ((PyObject *)__pyx_v_S_sum), Py_ssize_t, 1, PyInt_FromSsize_t, 0, 1, 1) &lt; 0)) <span
            class='error_goto'>__PYX_ERR(0, 345, __pyx_L1_error)</span>
</pre>
    <pre class="cython line score-2"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0346</span>:         <span class="n">Z</span><span class="p">[</span><span class="n">x</span><span
            class="p">]</span> <span class="o">=</span> <span class="n">Z_sum</span></pre>
    <pre class='cython code score-2 '>    if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(((PyObject *)__pyx_v_Z), __pyx_v_x, ((PyObject *)__pyx_v_Z_sum), Py_ssize_t, 1, PyInt_FromSsize_t, 0, 1, 1) &lt; 0)) <span
            class='error_goto'>__PYX_ERR(0, 346, __pyx_L1_error)</span>
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0347</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">0348</span>:     <span class="c"># normalize to get a proper average</span></pre>
    <pre class="cython line score-80"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0349</span>:     <span class="n">S</span> <span class="o">*=</span> <span class="n">aw</span> <span
            class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span
            class="p">(</span><span class="n">beta_w</span><span class="p">)</span></pre>
    <pre class='cython code score-80 '>  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_aw);<span
            class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 349, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 349, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_sum);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 349, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_beta_w, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 349, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  if (!__pyx_t_4) {
    __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_3);<span
                class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 349, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
  } else {
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_5)) {
      PyObject *__pyx_temp[2] = {__pyx_t_4, __pyx_t_3};
      __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 349, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_5)) {
      PyObject *__pyx_temp[2] = {__pyx_t_4, __pyx_t_3};
      __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 349, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    } else
    #endif
    {
      __pyx_t_19 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 349, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 0, __pyx_t_4); __pyx_t_4 = NULL;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 0+1, __pyx_t_3);
      __pyx_t_3 = 0;
      __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_19, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 349, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_2, __pyx_t_20);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 349, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
  __pyx_t_20 = <span class='py_c_api'>PyNumber_InPlaceMultiply</span>(((PyObject *)__pyx_v_S), __pyx_t_5);<span
                class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 349, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_20) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_20, __pyx_ptype_5numpy_ndarray))))) <span
                class='error_goto'>__PYX_ERR(0, 349, __pyx_L1_error)</span>
  __pyx_t_13 = ((PyArrayObject *)__pyx_t_20);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[2];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_S.rcbuffer-&gt;pybuffer);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_S.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_13, &amp;__Pyx_TypeInfo_nn___pyx_t_6pyrism_4core_3tma_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack);
    if (unlikely(__pyx_t_8 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_9, &amp;__pyx_t_10, &amp;__pyx_t_11);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_S.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_S, &amp;__Pyx_TypeInfo_nn___pyx_t_6pyrism_4core_3tma_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_9); Py_XDECREF(__pyx_t_10); Py_XDECREF(__pyx_t_11);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_9, __pyx_t_10, __pyx_t_11);
      }
      __pyx_t_9 = __pyx_t_10 = __pyx_t_11 = 0;
    }
    __pyx_pybuffernd_S.diminfo[0].strides = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_S.diminfo[0].shape = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_S.diminfo[1].strides = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_S.diminfo[1].shape = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_S.diminfo[2].strides = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_S.diminfo[2].shape = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.shape[2];
    if (unlikely(__pyx_t_8 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 349, __pyx_L1_error)</span>
  }
  __pyx_t_13 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_S, ((PyArrayObject *)__pyx_t_20));
  __pyx_t_20 = 0;
</pre>
    <pre class="cython line score-80"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0350</span>:     <span class="n">Z</span> <span class="o">*=</span> <span class="n">aw</span> <span
            class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span
            class="p">(</span><span class="n">beta_w</span><span class="p">)</span></pre>
    <pre class='cython code score-80 '>  __pyx_t_20 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_aw);<span
            class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 350, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 350, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_sum);<span
                class='error_goto'> if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 350, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_beta_w, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 350, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_19))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_19);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_19);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_19, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_19, __pyx_t_2);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 350, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  } else {
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_19)) {
      PyObject *__pyx_temp[2] = {__pyx_t_3, __pyx_t_2};
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_19, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 350, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_19)) {
      PyObject *__pyx_temp[2] = {__pyx_t_3, __pyx_t_2};
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_19, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 350, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    } else
    #endif
    {
      __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 350, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3); __pyx_t_3 = NULL;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+1, __pyx_t_2);
      __pyx_t_2 = 0;
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_19, __pyx_t_4, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 350, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
  __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_20, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 350, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyNumber_InPlaceMultiply</span>(((PyObject *)__pyx_v_Z), __pyx_t_19);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 350, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) <span
                class='error_goto'>__PYX_ERR(0, 350, __pyx_L1_error)</span>
  __pyx_t_14 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_14, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack);
    if (unlikely(__pyx_t_8 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_11, &amp;__pyx_t_10, &amp;__pyx_t_9);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_Z, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_11); Py_XDECREF(__pyx_t_10); Py_XDECREF(__pyx_t_9);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_11, __pyx_t_10, __pyx_t_9);
      }
      __pyx_t_11 = __pyx_t_10 = __pyx_t_9 = 0;
    }
    __pyx_pybuffernd_Z.diminfo[0].strides = __pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Z.diminfo[0].shape = __pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_Z.diminfo[1].strides = __pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_Z.diminfo[1].shape = __pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer.shape[1]; __pyx_pybuffernd_Z.diminfo[2].strides = __pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer.strides[2]; __pyx_pybuffernd_Z.diminfo[2].shape = __pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer.shape[2];
    if (unlikely(__pyx_t_8 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 350, __pyx_L1_error)</span>
  }
  __pyx_t_14 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_Z, ((PyArrayObject *)__pyx_t_5));
  __pyx_t_5 = 0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0351</span>: </pre>
    <pre class="cython line score-12"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0352</span>:     <span class="k">return</span> <span class="n">S</span><span
            class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="n">Z</span><span
            class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
    <pre class='cython code score-12 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(((PyObject *)__pyx_v_S), 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 352, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_19 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(((PyObject *)__pyx_v_Z), 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span
                class='error_goto'> if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 352, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
  __pyx_t_20 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 352, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_20, 0, __pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_19);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_20, 1, __pyx_t_19);
  __pyx_t_5 = 0;
  __pyx_t_19 = 0;
  __pyx_r = ((PyObject*)__pyx_t_20);
  __pyx_t_20 = 0;
  goto __pyx_L0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0353</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">0354</span>: <span class="c"># ----------------------------------------------------------------------------------------------------------------------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0355</span>: <span class="c"># Integrate SINGLE ORIENTATED Scattering and Phase Matrix</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0356</span>: <span class="c"># ----------------------------------------------------------------------------------------------------------------------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0357</span>: <span class="c"># Auxiliary Functions --------------------------------------------------------------------------------------------------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0358</span>: <span class="c"># Functions that can be used with scipy.integrate.dblquad</span></pre>
    <pre class="cython line score-19"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0359</span>: <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">IFUNC_SZ_S_IZA</span><span
            class="p">(</span><span class="n">double</span> <span class="n">iza</span><span class="p">,</span> <span
            class="n">double</span> <span class="n">iaa</span><span class="p">,</span> <span class="nb">int</span> <span
            class="n">nmax</span><span class="p">,</span> <span class="n">double</span> <span
            class="n">wavelength</span><span class="p">,</span> <span class="n">double</span> <span
            class="n">vzaDeg</span><span class="p">,</span> <span class="n">double</span> <span
            class="n">vaaDeg</span><span class="p">,</span></pre>
    <pre class='cython code score-19 '>static double __pyx_f_6pyrism_4core_3tma_IFUNC_SZ_S_IZA(double __pyx_v_iza, double __pyx_v_iaa, int __pyx_v_nmax, double __pyx_v_wavelength, double __pyx_v_vzaDeg, double __pyx_v_vaaDeg, double __pyx_v_alphaDeg, double __pyx_v_betaDeg, int __pyx_v_i) {
  double __pyx_v_izaDeg;
  double __pyx_v_iaaDeg;
  PyArrayObject *__pyx_v_Z = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_S = 0;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_S;
  __Pyx_Buffer __pyx_pybuffer_S;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Z;
  __Pyx_Buffer __pyx_pybuffer_Z;
  double __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("IFUNC_SZ_S_IZA", 0);
  __pyx_pybuffer_Z.pybuffer.buf = NULL;
  __pyx_pybuffer_Z.refcount = 0;
  __pyx_pybuffernd_Z.data = NULL;
  __pyx_pybuffernd_Z.rcbuffer = &amp;__pyx_pybuffer_Z;
  __pyx_pybuffer_S.pybuffer.buf = NULL;
  __pyx_pybuffer_S.refcount = 0;
  __pyx_pybuffernd_S.data = NULL;
  __pyx_pybuffernd_S.rcbuffer = &amp;__pyx_pybuffer_S;
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_S.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("pyrism.core.tma.IFUNC_SZ_S_IZA", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_S.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_Z);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_S);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0360</span>:                         <span
            class="n">double</span> <span class="n">alphaDeg</span><span class="p">,</span> <span
            class="n">double</span> <span class="n">betaDeg</span><span class="p">,</span> <span
            class="nb">int</span> <span class="n">i</span><span class="p">):</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0361</span>:     <span class="sd">&quot;&quot;&quot;Integrate Z in Incidence Direction</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0362</span>: <span class="sd">    </span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0363</span>: <span class="sd">    Callable function for scipy.integrate.dblquad for integration of the phase matrix in incidence direction.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0364</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">0365</span>: <span class="sd">    Parameters</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0366</span>: <span class="sd">    ----------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0367</span>: <span class="sd">    nmax : int[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0368</span>: <span
            class="sd">        Nmax parameter.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0369</span>: <span
            class="sd">    wavelength : double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0370</span>: <span class="sd">        Wavelength in same unit as radius (used by function calc_nmax).</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0371</span>: <span class="sd">    izaDeg, vzaDeg, iaaDeg, vaaDeg : double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0372</span>: <span class="sd">        Incidence (iza) and scattering (vza) zenith angle and incidence and viewing</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0373</span>: <span class="sd">        azimuth angle (ira, vra) in [DEG].</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0374</span>: <span
            class="sd">    alphaDeg, betaDeg: double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0375</span>: <span class="sd">        The Euler angles of the particle orientation in [DEG].</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0376</span>: <span class="sd">    i : int</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0377</span>: <span class="sd">        Number between 0 and 15 which defines the matrix element that will be integrated.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0378</span>: <span class="sd">        </span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0379</span>: <span class="sd">    Returns</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0380</span>: <span class="sd">    -------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0381</span>: <span class="sd">    Z : double</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0382</span>: <span class="sd">        Integrated phase matrix element.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0383</span>: <span
            class="sd">    &quot;&quot;&quot;</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0384</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">0385</span>:     <span class="k">cdef</span><span
            class="p">:</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0386</span>:         <span class="n">double</span> <span
            class="n">izaDeg</span><span class="p">,</span> <span class="n">iaaDeg</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0387</span>:         <span class="n">np</span><span class="o">.</span><span
            class="n">ndarray</span><span class="p">[</span><span class="n">double</span><span class="p">,</span> <span
            class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span>  <span
            class="n">Z</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0388</span>:         <span class="n">np</span><span class="o">.</span><span
            class="n">ndarray</span><span class="p">[</span><span class="n">DTYPE_t</span><span class="p">,</span> <span
            class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span>  <span
            class="n">S</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0389</span>: </pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0390</span>:     <span class="n">izaDeg</span><span class="p">,</span> <span
            class="n">iaaDeg</span> <span class="o">=</span> <span class="n">iza</span> <span class="o">*</span> <span
            class="n">RAD_TO_DEG</span><span class="p">,</span> <span class="n">iaa</span> <span
            class="o">*</span> <span class="n">RAD_TO_DEG</span></pre>
    <pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_iza * __pyx_v_6pyrism_4core_3tma_RAD_TO_DEG);
  __pyx_t_2 = (__pyx_v_iaa * __pyx_v_6pyrism_4core_3tma_RAD_TO_DEG);
  __pyx_v_izaDeg = __pyx_t_1;
  __pyx_v_iaaDeg = __pyx_t_2;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0391</span>: </pre>
    <pre class="cython line score-55"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0392</span>:     <span class="n">S</span><span class="p">,</span> <span class="n">Z</span> <span
            class="o">=</span> <span class="n">SZ_S</span><span class="p">(</span><span class="n">nmax</span><span
            class="p">,</span> <span class="n">wavelength</span><span class="p">,</span> <span
            class="n">izaDeg</span><span class="p">,</span> <span class="n">vzaDeg</span><span class="p">,</span> <span
            class="n">iaaDeg</span><span class="p">,</span> <span class="n">vaaDeg</span><span class="p">,</span> <span
            class="n">alphaDeg</span><span class="p">,</span> <span class="n">betaDeg</span><span
            class="p">)</span></pre>
    <pre class='cython code score-55 '>  __pyx_t_3 = __pyx_f_6pyrism_4core_3tma_SZ_S(__pyx_v_nmax, __pyx_v_wavelength, __pyx_v_izaDeg, __pyx_v_vzaDeg, __pyx_v_iaaDeg, __pyx_v_vaaDeg, __pyx_v_alphaDeg, __pyx_v_betaDeg);<span
            class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 392, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (likely(__pyx_t_3 != Py_None)) {
    PyObject* sequence = __pyx_t_3;
    Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
    if (unlikely(size != 2)) {
      if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      <span class='error_goto'>__PYX_ERR(0, 392, __pyx_L1_error)</span>
    }
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0);
    __pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
    #else
    __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 392, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 392, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  } else {
    <span class='pyx_c_api'>__Pyx_RaiseNoneNotIterableError</span>(); <span class='error_goto'>__PYX_ERR(0, 392, __pyx_L1_error)</span>
  }
  if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span
                class='error_goto'>__PYX_ERR(0, 392, __pyx_L1_error)</span>
  if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) <span
                class='error_goto'>__PYX_ERR(0, 392, __pyx_L1_error)</span>
  __pyx_t_6 = ((PyArrayObject *)__pyx_t_4);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[2];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_S.rcbuffer-&gt;pybuffer);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_S.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_6, &amp;__Pyx_TypeInfo_nn___pyx_t_6pyrism_4core_3tma_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack);
    if (unlikely(__pyx_t_7 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_8, &amp;__pyx_t_9, &amp;__pyx_t_10);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_S.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_S, &amp;__Pyx_TypeInfo_nn___pyx_t_6pyrism_4core_3tma_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_8); Py_XDECREF(__pyx_t_9); Py_XDECREF(__pyx_t_10);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_8, __pyx_t_9, __pyx_t_10);
      }
      __pyx_t_8 = __pyx_t_9 = __pyx_t_10 = 0;
    }
    __pyx_pybuffernd_S.diminfo[0].strides = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_S.diminfo[0].shape = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_S.diminfo[1].strides = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_S.diminfo[1].shape = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.shape[1];
    if (unlikely(__pyx_t_7 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 392, __pyx_L1_error)</span>
  }
  __pyx_t_6 = 0;
  __pyx_v_S = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_11 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_11, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack);
    if (unlikely(__pyx_t_7 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_10, &amp;__pyx_t_9, &amp;__pyx_t_8);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_Z, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_10); Py_XDECREF(__pyx_t_9); Py_XDECREF(__pyx_t_8);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_10, __pyx_t_9, __pyx_t_8);
      }
      __pyx_t_10 = __pyx_t_9 = __pyx_t_8 = 0;
    }
    __pyx_pybuffernd_Z.diminfo[0].strides = __pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Z.diminfo[0].shape = __pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_Z.diminfo[1].strides = __pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_Z.diminfo[1].shape = __pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer.shape[1];
    if (unlikely(__pyx_t_7 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 392, __pyx_L1_error)</span>
  }
  __pyx_t_11 = 0;
  __pyx_v_Z = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0393</span>: </pre>
    <pre class="cython line score-44"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0394</span>:     <span class="k">return</span> <span class="n">Z</span><span
            class="o">.</span><span class="n">flatten</span><span class="p">()[</span><span class="n">i</span><span
            class="p">]</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span
            class="n">iza</span><span class="p">)</span></pre>
    <pre class='cython code score-44 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_Z), __pyx_n_s_flatten);<span
            class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 394, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  if (__pyx_t_4) {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 394, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  } else {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 394, __pyx_L1_error)</span>
  }
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_3, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 1, 1);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 394, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(sin(__pyx_v_iza));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 394, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_5, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 394, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_2 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_4); if (unlikely((__pyx_t_2 == (double)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 394, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_r = __pyx_t_2;
  goto __pyx_L0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0395</span>: </pre>
    <pre class="cython line score-19"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0396</span>: <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">IFUNC_SZ_S_VZA</span><span
            class="p">(</span><span class="n">double</span> <span class="n">vza</span><span class="p">,</span> <span
            class="n">double</span> <span class="n">vaa</span><span class="p">,</span> <span class="nb">int</span> <span
            class="n">nmax</span><span class="p">,</span> <span class="n">double</span> <span
            class="n">wavelength</span><span class="p">,</span> <span class="n">double</span> <span
            class="n">izaDeg</span><span class="p">,</span> <span class="n">double</span> <span
            class="n">iaaDeg</span><span class="p">,</span></pre>
    <pre class='cython code score-19 '>static double __pyx_f_6pyrism_4core_3tma_IFUNC_SZ_S_VZA(double __pyx_v_vza, double __pyx_v_vaa, int __pyx_v_nmax, double __pyx_v_wavelength, double __pyx_v_izaDeg, double __pyx_v_iaaDeg, double __pyx_v_alphaDeg, PyObject *__pyx_v_betaDeg, int __pyx_v_i) {
  double __pyx_v_vzaDeg;
  double __pyx_v_vaaDeg;
  PyArrayObject *__pyx_v_Z = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_S = 0;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_S;
  __Pyx_Buffer __pyx_pybuffer_S;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Z;
  __Pyx_Buffer __pyx_pybuffer_Z;
  double __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("IFUNC_SZ_S_VZA", 0);
  __pyx_pybuffer_Z.pybuffer.buf = NULL;
  __pyx_pybuffer_Z.refcount = 0;
  __pyx_pybuffernd_Z.data = NULL;
  __pyx_pybuffernd_Z.rcbuffer = &amp;__pyx_pybuffer_Z;
  __pyx_pybuffer_S.pybuffer.buf = NULL;
  __pyx_pybuffer_S.refcount = 0;
  __pyx_pybuffernd_S.data = NULL;
  __pyx_pybuffernd_S.rcbuffer = &amp;__pyx_pybuffer_S;
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_S.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("pyrism.core.tma.IFUNC_SZ_S_VZA", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_S.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_Z);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_S);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0397</span>:                            <span
            class="n">double</span> <span class="n">alphaDeg</span><span class="p">,</span> <span
            class="n">betaDeg</span><span class="p">,</span> <span class="nb">int</span> <span class="n">i</span><span
            class="p">):</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0398</span>:     <span class="sd">&quot;&quot;&quot;Integrate Z in Viewing Direction</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0399</span>: <span class="sd">    </span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0400</span>: <span class="sd">    Callable function for scipy.integrate.dblquad for integration of the phase matrix in viewing direction.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0401</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">0402</span>: <span class="sd">    Parameters</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0403</span>: <span class="sd">    ----------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0404</span>: <span class="sd">    nmax : int[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0405</span>: <span
            class="sd">        Nmax parameter.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0406</span>: <span
            class="sd">    wavelength : double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0407</span>: <span class="sd">        Wavelength in same unit as radius (used by function calc_nmax).</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0408</span>: <span class="sd">    izaDeg, vzaDeg, iaaDeg, vaaDeg : double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0409</span>: <span class="sd">        Incidence (iza) and scattering (vza) zenith angle and incidence and viewing</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0410</span>: <span class="sd">        azimuth angle (ira, vra) in [DEG].</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0411</span>: <span
            class="sd">    alphaDeg, betaDeg: double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0412</span>: <span class="sd">        The Euler angles of the particle orientation in [DEG].</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0413</span>: <span class="sd">    i : int</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0414</span>: <span class="sd">        Number between 0 and 15 which defines the matrix element that will be integrated.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0415</span>: <span class="sd">        </span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0416</span>: <span class="sd">    Returns</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0417</span>: <span class="sd">    -------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0418</span>: <span class="sd">    Z : double</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0419</span>: <span class="sd">        Integrated phase matrix element.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0420</span>: <span
            class="sd">    &quot;&quot;&quot;</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0421</span>:     <span class="k">cdef</span><span
            class="p">:</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0422</span>:         <span class="n">double</span> <span
            class="n">vzaDeg</span><span class="p">,</span> <span class="n">vaaDeg</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0423</span>:         <span class="n">np</span><span class="o">.</span><span
            class="n">ndarray</span><span class="p">[</span><span class="n">double</span><span class="p">,</span> <span
            class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span>  <span
            class="n">Z</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0424</span>:         <span class="n">np</span><span class="o">.</span><span
            class="n">ndarray</span><span class="p">[</span><span class="n">DTYPE_t</span><span class="p">,</span> <span
            class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span>  <span
            class="n">S</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0425</span>: </pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0426</span>:     <span class="n">vzaDeg</span><span class="p">,</span> <span
            class="n">vaaDeg</span> <span class="o">=</span> <span class="n">vza</span> <span class="o">*</span> <span
            class="n">RAD_TO_DEG</span><span class="p">,</span> <span class="n">vaa</span> <span
            class="o">*</span> <span class="n">RAD_TO_DEG</span></pre>
    <pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_vza * __pyx_v_6pyrism_4core_3tma_RAD_TO_DEG);
  __pyx_t_2 = (__pyx_v_vaa * __pyx_v_6pyrism_4core_3tma_RAD_TO_DEG);
  __pyx_v_vzaDeg = __pyx_t_1;
  __pyx_v_vaaDeg = __pyx_t_2;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0427</span>: </pre>
    <pre class="cython line score-65"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0428</span>:     <span class="n">S</span><span class="p">,</span> <span class="n">Z</span> <span
            class="o">=</span> <span class="n">SZ_S</span><span class="p">(</span><span class="n">nmax</span><span
            class="p">,</span> <span class="n">wavelength</span><span class="p">,</span> <span
            class="n">izaDeg</span><span class="p">,</span> <span class="n">vzaDeg</span><span class="p">,</span> <span
            class="n">iaaDeg</span><span class="p">,</span> <span class="n">vaaDeg</span><span class="p">,</span> <span
            class="n">alphaDeg</span><span class="p">,</span> <span class="n">betaDeg</span><span
            class="p">)</span></pre>
    <pre class='cython code score-65 '>  __pyx_t_2 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_v_betaDeg); if (unlikely((__pyx_t_2 == (double)-1) &amp;&amp; <span
            class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 428, __pyx_L1_error)</span>
  __pyx_t_3 = __pyx_f_6pyrism_4core_3tma_SZ_S(__pyx_v_nmax, __pyx_v_wavelength, __pyx_v_izaDeg, __pyx_v_vzaDeg, __pyx_v_iaaDeg, __pyx_v_vaaDeg, __pyx_v_alphaDeg, __pyx_t_2);<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 428, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (likely(__pyx_t_3 != Py_None)) {
    PyObject* sequence = __pyx_t_3;
    Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
    if (unlikely(size != 2)) {
      if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      <span class='error_goto'>__PYX_ERR(0, 428, __pyx_L1_error)</span>
    }
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0);
    __pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
    #else
    __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 428, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 428, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  } else {
    <span class='pyx_c_api'>__Pyx_RaiseNoneNotIterableError</span>(); <span class='error_goto'>__PYX_ERR(0, 428, __pyx_L1_error)</span>
  }
  if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span
                class='error_goto'>__PYX_ERR(0, 428, __pyx_L1_error)</span>
  if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) <span
                class='error_goto'>__PYX_ERR(0, 428, __pyx_L1_error)</span>
  __pyx_t_6 = ((PyArrayObject *)__pyx_t_4);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[2];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_S.rcbuffer-&gt;pybuffer);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_S.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_6, &amp;__Pyx_TypeInfo_nn___pyx_t_6pyrism_4core_3tma_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack);
    if (unlikely(__pyx_t_7 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_8, &amp;__pyx_t_9, &amp;__pyx_t_10);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_S.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_S, &amp;__Pyx_TypeInfo_nn___pyx_t_6pyrism_4core_3tma_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_8); Py_XDECREF(__pyx_t_9); Py_XDECREF(__pyx_t_10);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_8, __pyx_t_9, __pyx_t_10);
      }
      __pyx_t_8 = __pyx_t_9 = __pyx_t_10 = 0;
    }
    __pyx_pybuffernd_S.diminfo[0].strides = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_S.diminfo[0].shape = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_S.diminfo[1].strides = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_S.diminfo[1].shape = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.shape[1];
    if (unlikely(__pyx_t_7 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 428, __pyx_L1_error)</span>
  }
  __pyx_t_6 = 0;
  __pyx_v_S = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_11 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_11, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack);
    if (unlikely(__pyx_t_7 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_10, &amp;__pyx_t_9, &amp;__pyx_t_8);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_Z, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_10); Py_XDECREF(__pyx_t_9); Py_XDECREF(__pyx_t_8);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_10, __pyx_t_9, __pyx_t_8);
      }
      __pyx_t_10 = __pyx_t_9 = __pyx_t_8 = 0;
    }
    __pyx_pybuffernd_Z.diminfo[0].strides = __pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Z.diminfo[0].shape = __pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_Z.diminfo[1].strides = __pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_Z.diminfo[1].shape = __pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer.shape[1];
    if (unlikely(__pyx_t_7 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 428, __pyx_L1_error)</span>
  }
  __pyx_t_11 = 0;
  __pyx_v_Z = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0429</span>: </pre>
    <pre class="cython line score-44"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0430</span>:     <span class="k">return</span> <span class="n">Z</span><span
            class="o">.</span><span class="n">flatten</span><span class="p">()[</span><span class="n">i</span><span
            class="p">]</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span
            class="n">vza</span><span class="p">)</span></pre>
    <pre class='cython code score-44 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_Z), __pyx_n_s_flatten);<span
            class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 430, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  if (__pyx_t_4) {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 430, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  } else {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 430, __pyx_L1_error)</span>
  }
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_3, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 1, 1);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 430, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(sin(__pyx_v_vza));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 430, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_5, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 430, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_2 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_4); if (unlikely((__pyx_t_2 == (double)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 430, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_r = __pyx_t_2;
  goto __pyx_L0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0431</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">0432</span>: <span class="c"># Double Integral Functions --------------------------------------------------------------------------------------------</span></pre>
    <pre class="cython line score-19"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0433</span>: <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:,:]</span> <span
            class="n">DBLQUAD_Z_S_IZA</span><span class="p">(</span><span class="nb">int</span><span
            class="p">[:]</span> <span class="n">nmax</span><span class="p">,</span> <span class="n">double</span><span
            class="p">[:]</span> <span class="n">wavelength</span><span class="p">,</span> <span class="n">double</span><span
            class="p">[:]</span> <span class="n">vzaDeg</span><span class="p">,</span> <span
            class="n">double</span><span class="p">[:]</span> <span class="n">vaaDeg</span><span
            class="p">,</span> <span class="n">double</span><span class="p">[:]</span> <span
            class="n">alphaDeg</span><span class="p">,</span></pre>
    <pre class='cython code score-19 '>static __Pyx_memviewslice __pyx_f_6pyrism_4core_3tma_DBLQUAD_Z_S_IZA(__Pyx_memviewslice __pyx_v_nmax, __Pyx_memviewslice __pyx_v_wavelength, __Pyx_memviewslice __pyx_v_vzaDeg, __Pyx_memviewslice __pyx_v_vaaDeg, __Pyx_memviewslice __pyx_v_alphaDeg, __Pyx_memviewslice __pyx_v_betaDeg) {
  Py_ssize_t __pyx_v_x;
  Py_ssize_t __pyx_v_i;
  Py_ssize_t __pyx_v_xmax;
  PyObject *__pyx_v_Z = NULL;
  __Pyx_memviewslice __pyx_v_Z_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_r = { 0, 0, { 0 }, { 0 }, { 0 } };
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("DBLQUAD_Z_S_IZA", 0);
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_19);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_21);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_22);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_23);
  __pyx_r.data = NULL;
  __pyx_r.memview = NULL;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.DBLQUAD_Z_S_IZA", __pyx_clineno, __pyx_lineno, __pyx_filename);

  goto __pyx_L2;
  __pyx_L0:;
  if (unlikely(!__pyx_r.memview)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "Memoryview return value is not initialized");
  }
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_Z);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_Z_view, 1);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0434</span>:                                  <span class="n">double</span><span
            class="p">[:]</span> <span class="n">betaDeg</span><span class="p">):</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0435</span>:     <span
            class="sd">&quot;&quot;&quot;</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0436</span>: <span class="sd">    Integrate the phase matrix over a half sphere in incidence direction.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0437</span>: <span class="sd">    </span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0438</span>: <span class="sd">    Parameters</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0439</span>: <span class="sd">    ----------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0440</span>: <span class="sd">    nmax : int[:] </span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0441</span>: <span
            class="sd">        Nmax parameter.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0442</span>: <span
            class="sd">    wavelength : double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0443</span>: <span class="sd">        Wavelength in same unit as radius (used by function calc_nmax).</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0444</span>: <span
            class="sd">    vzaDeg, vaaDeg : double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0445</span>: <span class="sd">        Scattering (vza) zenith and azimuth angle (vaa) in [DEG].</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0446</span>: <span
            class="sd">    alphaDeg, betaDeg: double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0447</span>: <span class="sd">        The Euler angles of the particle orientation in [DEG].</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0448</span>: <span class="sd">        </span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0449</span>: <span class="sd">    Returns</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0450</span>: <span class="sd">    -------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0451</span>: <span
            class="sd">    Z : MemoryView, double[:,:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0452</span>: <span class="sd">        Two dimensional integrated phase matrix.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0453</span>: <span class="sd">    </span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0454</span>: <span class="sd">    Note</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0455</span>: <span class="sd">    ----</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0456</span>: <span class="sd">    The output is a array with shape (nmax.shape[0], 16). To put it in a matrix form one must reshape it like</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0457</span>: <span class="sd">    np.reshape(Z, (nmax.shape[0], 4, 4)).</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0458</span>: <span
            class="sd">    &quot;&quot;&quot;</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0459</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">0460</span>:     <span class="k">cdef</span><span
            class="p">:</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0461</span>:         <span class="n">Py_ssize_t</span> <span
            class="n">x</span><span class="p">,</span> <span class="n">i</span></pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0462</span>:         <span class="n">Py_ssize_t</span> <span class="n">xmax</span> <span class="o">=</span> <span
            class="n">nmax</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span
            class="mf">0</span><span class="p">]</span></pre>
    <pre class='cython code score-0 '>  __pyx_v_xmax = (__pyx_v_nmax.shape[0]);
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0463</span>: </pre>
    <pre class="cython line score-42"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0464</span>:     <span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span
            class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">xmax</span><span
            class="p">,</span> <span class="mf">16</span><span class="p">),</span> <span class="n">dtype</span><span
            class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span
            class="p">)</span></pre>
    <pre class='cython code score-42 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span
            class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 464, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 464, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_xmax);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 464, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 464, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_16);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_16);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_16);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 464, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 464, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 464, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_double);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 464, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 464, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 464, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_Z = __pyx_t_5;
  __pyx_t_5 = 0;
</pre>
    <pre class="cython line score-2"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0465</span>:     <span class="k">cdef</span> <span class="kt">double</span>[<span
            class="p">:,:]</span> <span class="n">Z_view</span> <span class="o">=</span> <span class="n">Z</span></pre>
    <pre class='cython code score-2 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_Z, PyBUF_WRITABLE);<span
            class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 465, __pyx_L1_error)</span>
  __pyx_v_Z_view = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0466</span>: </pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0467</span>:     <span class="k">for</span> <span class="n">x</span> <span
            class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">xmax</span><span
            class="p">):</span></pre>
    <pre class='cython code score-0 '>  __pyx_t_7 = __pyx_v_xmax;
  __pyx_t_8 = __pyx_t_7;
  for (__pyx_t_9 = 0; __pyx_t_9 &lt; __pyx_t_8; __pyx_t_9+=1) {
    __pyx_v_x = __pyx_t_9;
</pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0468</span>:             <span class="k">for</span> <span class="n">i</span> <span
            class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">16</span><span
            class="p">):</span></pre>
    <pre class='cython code score-0 '>    for (__pyx_t_10 = 0; __pyx_t_10 &lt; 16; __pyx_t_10+=1) {
      __pyx_v_i = __pyx_t_10;
</pre>
    <pre class="cython line score-40"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0469</span>:                 <span class="n">Z_view</span><span class="p">[</span><span
            class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span
            class="n">dblquad</span><span class="p">(</span><span class="n">IFUNC_SZ_S_IZA</span><span
            class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">2</span> <span
            class="o">*</span> <span class="n">PI</span><span class="p">,</span> <span class="k">lambda</span> <span
            class="n">x</span><span class="p">:</span> <span class="mf">0</span><span class="p">,</span> <span
            class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">PI</span><span
            class="p">,</span></pre>
    <pre class='cython code score-40 '>/* Python wrapper */
static PyObject *__pyx_pw_6pyrism_4core_3tma_15DBLQUAD_Z_S_IZA_lambda(PyObject *__pyx_self, PyObject *__pyx_v_x); /*proto*/
static PyMethodDef __pyx_mdef_6pyrism_4core_3tma_15DBLQUAD_Z_S_IZA_lambda = {"lambda", (PyCFunction)__pyx_pw_6pyrism_4core_3tma_15DBLQUAD_Z_S_IZA_lambda, METH_O, 0};
static PyObject *__pyx_pw_6pyrism_4core_3tma_15DBLQUAD_Z_S_IZA_lambda(PyObject *__pyx_self, PyObject *__pyx_v_x) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("lambda (wrapper)", 0);
  __pyx_r = __pyx_lambda_funcdef_lambda(__pyx_self, ((PyObject *)__pyx_v_x));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_lambda_funcdef_lambda(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_x) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("lambda", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  __pyx_r = __pyx_int_0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6pyrism_4core_3tma_15DBLQUAD_Z_S_IZA_1lambda1(PyObject *__pyx_self, PyObject *__pyx_v_x); /*proto*/
static PyMethodDef __pyx_mdef_6pyrism_4core_3tma_15DBLQUAD_Z_S_IZA_1lambda1 = {"lambda1", (PyCFunction)__pyx_pw_6pyrism_4core_3tma_15DBLQUAD_Z_S_IZA_1lambda1, METH_O, 0};
static PyObject *__pyx_pw_6pyrism_4core_3tma_15DBLQUAD_Z_S_IZA_1lambda1(PyObject *__pyx_self, PyObject *__pyx_v_x) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("lambda1 (wrapper)", 0);
  __pyx_r = __pyx_lambda_funcdef_lambda1(__pyx_self, ((PyObject *)__pyx_v_x));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_lambda_funcdef_lambda1(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_x) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("lambda1", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_6pyrism_4core_3tma_PI);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 469, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.DBLQUAD_Z_S_IZA.lambda1", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* â€¦ */
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_dblquad);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 469, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_3 = __Pyx_CFunc_double____double____double____int____double____double____double____double____double____int___to_py(__pyx_f_6pyrism_4core_3tma_IFUNC_SZ_S_IZA);<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 469, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((2.0 * __pyx_v_6pyrism_4core_3tma_PI));<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 469, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_6pyrism_4core_3tma_15DBLQUAD_Z_S_IZA_lambda, 0, __pyx_n_s_DBLQUAD_Z_S_IZA_locals_lambda, NULL, __pyx_n_s_pyrism_core_tma, __pyx_d, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 469, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_6pyrism_4core_3tma_15DBLQUAD_Z_S_IZA_1lambda1, 0, __pyx_n_s_DBLQUAD_Z_S_IZA_locals_lambda, NULL, __pyx_n_s_pyrism_core_tma, __pyx_d, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 469, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 469, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 1, __pyx_int_0);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 2, __pyx_t_1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 3, __pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 4, __pyx_t_4);
      __pyx_t_3 = 0;
      __pyx_t_1 = 0;
      __pyx_t_2 = 0;
      __pyx_t_4 = 0;
/* â€¦ */
      __pyx_t_23 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_11, __pyx_t_4);<span
                class='error_goto'> if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 469, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
/* â€¦ */
      __pyx_t_25 = __pyx_v_x;
      __pyx_t_26 = __pyx_v_i;
      __pyx_t_13 = -1;
      if (__pyx_t_25 &lt; 0) {
        __pyx_t_25 += __pyx_v_Z_view.shape[0];
        if (unlikely(__pyx_t_25 &lt; 0)) __pyx_t_13 = 0;
      } else if (unlikely(__pyx_t_25 &gt;= __pyx_v_Z_view.shape[0])) __pyx_t_13 = 0;
      if (__pyx_t_26 &lt; 0) {
        __pyx_t_26 += __pyx_v_Z_view.shape[1];
        if (unlikely(__pyx_t_26 &lt; 0)) __pyx_t_13 = 1;
      } else if (unlikely(__pyx_t_26 &gt;= __pyx_v_Z_view.shape[1])) __pyx_t_13 = 1;
      if (unlikely(__pyx_t_13 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
        <span class='error_goto'>__PYX_ERR(0, 469, __pyx_L1_error)</span>
      }
      *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_Z_view.data + __pyx_t_25 * __pyx_v_Z_view.strides[0]) ) + __pyx_t_26 * __pyx_v_Z_view.strides[1]) )) = __pyx_t_24;
    }
  }
</pre>
    <pre class="cython line score-59"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0470</span>:                                        <span class="n">args</span><span
            class="o">=</span><span class="p">(</span><span class="n">nmax</span><span class="p">[</span><span
            class="n">x</span><span class="p">],</span> <span class="n">wavelength</span><span class="p">[</span><span
            class="n">x</span><span class="p">],</span> <span class="n">vzaDeg</span><span class="p">[</span><span
            class="n">x</span><span class="p">],</span> <span class="n">vaaDeg</span><span class="p">[</span><span
            class="n">x</span><span class="p">],</span> <span class="n">alphaDeg</span><span class="p">[</span><span
            class="n">x</span><span class="p">],</span> <span class="n">betaDeg</span><span class="p">[</span><span
            class="n">x</span><span class="p">],</span></pre>
    <pre class='cython code score-59 '>      __pyx_t_4 = <span
            class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 470, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_12 = __pyx_v_x;
      __pyx_t_13 = -1;
      if (__pyx_t_12 &lt; 0) {
        __pyx_t_12 += __pyx_v_nmax.shape[0];
        if (unlikely(__pyx_t_12 &lt; 0)) __pyx_t_13 = 0;
      } else if (unlikely(__pyx_t_12 &gt;= __pyx_v_nmax.shape[0])) __pyx_t_13 = 0;
      if (unlikely(__pyx_t_13 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
        <span class='error_goto'>__PYX_ERR(0, 470, __pyx_L1_error)</span>
      }
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>((*((int *) ( /* dim=0 */ (__pyx_v_nmax.data + __pyx_t_12 * __pyx_v_nmax.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 470, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_14 = __pyx_v_x;
      __pyx_t_13 = -1;
      if (__pyx_t_14 &lt; 0) {
        __pyx_t_14 += __pyx_v_wavelength.shape[0];
        if (unlikely(__pyx_t_14 &lt; 0)) __pyx_t_13 = 0;
      } else if (unlikely(__pyx_t_14 &gt;= __pyx_v_wavelength.shape[0])) __pyx_t_13 = 0;
      if (unlikely(__pyx_t_13 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
        <span class='error_goto'>__PYX_ERR(0, 470, __pyx_L1_error)</span>
      }
      __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_wavelength.data + __pyx_t_14 * __pyx_v_wavelength.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 470, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_15 = __pyx_v_x;
      __pyx_t_13 = -1;
      if (__pyx_t_15 &lt; 0) {
        __pyx_t_15 += __pyx_v_vzaDeg.shape[0];
        if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_13 = 0;
      } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_vzaDeg.shape[0])) __pyx_t_13 = 0;
      if (unlikely(__pyx_t_13 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
        <span class='error_goto'>__PYX_ERR(0, 470, __pyx_L1_error)</span>
      }
      __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_vzaDeg.data + __pyx_t_15 * __pyx_v_vzaDeg.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 470, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_16 = __pyx_v_x;
      __pyx_t_13 = -1;
      if (__pyx_t_16 &lt; 0) {
        __pyx_t_16 += __pyx_v_vaaDeg.shape[0];
        if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_13 = 0;
      } else if (unlikely(__pyx_t_16 &gt;= __pyx_v_vaaDeg.shape[0])) __pyx_t_13 = 0;
      if (unlikely(__pyx_t_13 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
        <span class='error_goto'>__PYX_ERR(0, 470, __pyx_L1_error)</span>
      }
      __pyx_t_17 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_vaaDeg.data + __pyx_t_16 * __pyx_v_vaaDeg.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 470, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
      __pyx_t_18 = __pyx_v_x;
      __pyx_t_13 = -1;
      if (__pyx_t_18 &lt; 0) {
        __pyx_t_18 += __pyx_v_alphaDeg.shape[0];
        if (unlikely(__pyx_t_18 &lt; 0)) __pyx_t_13 = 0;
      } else if (unlikely(__pyx_t_18 &gt;= __pyx_v_alphaDeg.shape[0])) __pyx_t_13 = 0;
      if (unlikely(__pyx_t_13 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
        <span class='error_goto'>__PYX_ERR(0, 470, __pyx_L1_error)</span>
      }
      __pyx_t_19 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_alphaDeg.data + __pyx_t_18 * __pyx_v_alphaDeg.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 470, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
      __pyx_t_20 = __pyx_v_x;
      __pyx_t_13 = -1;
      if (__pyx_t_20 &lt; 0) {
        __pyx_t_20 += __pyx_v_betaDeg.shape[0];
        if (unlikely(__pyx_t_20 &lt; 0)) __pyx_t_13 = 0;
      } else if (unlikely(__pyx_t_20 &gt;= __pyx_v_betaDeg.shape[0])) __pyx_t_13 = 0;
      if (unlikely(__pyx_t_13 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
        <span class='error_goto'>__PYX_ERR(0, 470, __pyx_L1_error)</span>
      }
      __pyx_t_21 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_betaDeg.data + __pyx_t_20 * __pyx_v_betaDeg.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 470, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
/* â€¦ */
      __pyx_t_23 = <span class='py_c_api'>PyTuple_New</span>(7);<span class='error_goto'> if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 470, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_23, 0, __pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_23, 1, __pyx_t_1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_23, 2, __pyx_t_3);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_17);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_23, 3, __pyx_t_17);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_19);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_23, 4, __pyx_t_19);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_21);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_23, 5, __pyx_t_21);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_22);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_23, 6, __pyx_t_22);
      __pyx_t_2 = 0;
      __pyx_t_1 = 0;
      __pyx_t_3 = 0;
      __pyx_t_17 = 0;
      __pyx_t_19 = 0;
      __pyx_t_21 = 0;
      __pyx_t_22 = 0;
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_args, __pyx_t_23) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 470, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
</pre>
    <pre class="cython line score-19"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0471</span>:                                              <span class="n">i</span><span class="p">))[</span><span
            class="mf">0</span><span class="p">]</span></pre>
    <pre class='cython code score-19 '>      __pyx_t_22 = <span
            class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 471, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_22);
/* â€¦ */
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_23, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 471, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
      __pyx_t_24 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_4); if (unlikely((__pyx_t_24 == (double)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 471, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0472</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">0473</span>: </pre>
    <pre class="cython line score-2"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0474</span>:     <span class="k">return</span> <span class="n">Z</span></pre>
    <pre class='cython code score-2 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_Z, PyBUF_WRITABLE);<span
            class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 474, __pyx_L1_error)</span>
  __pyx_r = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
  goto __pyx_L0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0475</span>: </pre>
    <pre class="cython line score-19"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0476</span>: <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:,:]</span> <span
            class="n">DBLQUAD_Z_S_VZA</span><span class="p">(</span><span class="nb">int</span><span
            class="p">[:]</span> <span class="n">nmax</span><span class="p">,</span> <span class="n">double</span><span
            class="p">[:]</span> <span class="n">wavelength</span><span class="p">,</span> <span class="n">double</span><span
            class="p">[:]</span> <span class="n">izaDeg</span><span class="p">,</span> <span
            class="n">double</span><span class="p">[:]</span> <span class="n">iaaDeg</span><span
            class="p">,</span> <span class="n">double</span><span class="p">[:]</span> <span
            class="n">alphaDeg</span><span class="p">,</span></pre>
    <pre class='cython code score-19 '>static __Pyx_memviewslice __pyx_f_6pyrism_4core_3tma_DBLQUAD_Z_S_VZA(__Pyx_memviewslice __pyx_v_nmax, __Pyx_memviewslice __pyx_v_wavelength, __Pyx_memviewslice __pyx_v_izaDeg, __Pyx_memviewslice __pyx_v_iaaDeg, __Pyx_memviewslice __pyx_v_alphaDeg, __Pyx_memviewslice __pyx_v_betaDeg) {
  Py_ssize_t __pyx_v_x;
  Py_ssize_t __pyx_v_i;
  Py_ssize_t __pyx_v_xmax;
  PyObject *__pyx_v_Z = NULL;
  __Pyx_memviewslice __pyx_v_Z_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_r = { 0, 0, { 0 }, { 0 }, { 0 } };
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("DBLQUAD_Z_S_VZA", 0);
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_19);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_21);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_22);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_23);
  __pyx_r.data = NULL;
  __pyx_r.memview = NULL;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.DBLQUAD_Z_S_VZA", __pyx_clineno, __pyx_lineno, __pyx_filename);

  goto __pyx_L2;
  __pyx_L0:;
  if (unlikely(!__pyx_r.memview)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "Memoryview return value is not initialized");
  }
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_Z);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_Z_view, 1);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0477</span>:                                  <span class="n">double</span><span
            class="p">[:]</span> <span class="n">betaDeg</span><span class="p">):</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0478</span>:     <span
            class="sd">&quot;&quot;&quot;</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0479</span>: <span class="sd">    Integrate the phase matrix over a half sphere in vieving direction.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0480</span>: <span class="sd">    </span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0481</span>: <span class="sd">    Parameters</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0482</span>: <span class="sd">    ----------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0483</span>: <span class="sd">    nmax : int[:] </span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0484</span>: <span
            class="sd">        Nmax parameter.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0485</span>: <span
            class="sd">    wavelength : double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0486</span>: <span class="sd">        Wavelength in same unit as radius (used by function calc_nmax).</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0487</span>: <span
            class="sd">    izaDeg, iaaDeg : double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0488</span>: <span class="sd">        Incidence (iza) zenith and azimuth angle (iaa) in [DEG].</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0489</span>: <span
            class="sd">    alphaDeg, betaDeg: double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0490</span>: <span class="sd">        The Euler angles of the particle orientation in [DEG].</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0491</span>: <span class="sd">        </span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0492</span>: <span class="sd">    Returns</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0493</span>: <span class="sd">    -------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0494</span>: <span
            class="sd">    Z : MemoryView, double[:,:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0495</span>: <span class="sd">        Two dimensional integrated phase matrix.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0496</span>: <span class="sd">    </span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0497</span>: <span class="sd">    Note</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0498</span>: <span class="sd">    ----</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0499</span>: <span class="sd">    The output is a array with shape (nmax.shape[0], 16). To put it in a matrix form one must reshape it like</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0500</span>: <span class="sd">    np.reshape(Z, (nmax.shape[0], 4, 4)).</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0501</span>: <span
            class="sd">    &quot;&quot;&quot;</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0502</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">0503</span>:     <span class="k">cdef</span><span
            class="p">:</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0504</span>:         <span class="n">Py_ssize_t</span> <span
            class="n">x</span><span class="p">,</span> <span class="n">i</span></pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0505</span>:         <span class="n">Py_ssize_t</span> <span class="n">xmax</span> <span class="o">=</span> <span
            class="n">nmax</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span
            class="mf">0</span><span class="p">]</span></pre>
    <pre class='cython code score-0 '>  __pyx_v_xmax = (__pyx_v_nmax.shape[0]);
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0506</span>: </pre>
    <pre class="cython line score-42"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0507</span>:     <span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span
            class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">xmax</span><span
            class="p">,</span> <span class="mf">16</span><span class="p">),</span> <span class="n">dtype</span><span
            class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span
            class="p">)</span></pre>
    <pre class='cython code score-42 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span
            class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 507, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 507, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_xmax);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 507, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 507, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_16);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_16);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_16);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 507, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 507, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 507, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_double);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 507, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 507, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 507, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_Z = __pyx_t_5;
  __pyx_t_5 = 0;
</pre>
    <pre class="cython line score-2"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0508</span>:     <span class="k">cdef</span> <span class="kt">double</span>[<span
            class="p">:,:]</span> <span class="n">Z_view</span> <span class="o">=</span> <span class="n">Z</span></pre>
    <pre class='cython code score-2 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_Z, PyBUF_WRITABLE);<span
            class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 508, __pyx_L1_error)</span>
  __pyx_v_Z_view = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0509</span>: </pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0510</span>:     <span class="k">for</span> <span class="n">x</span> <span
            class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">xmax</span><span
            class="p">):</span></pre>
    <pre class='cython code score-0 '>  __pyx_t_7 = __pyx_v_xmax;
  __pyx_t_8 = __pyx_t_7;
  for (__pyx_t_9 = 0; __pyx_t_9 &lt; __pyx_t_8; __pyx_t_9+=1) {
    __pyx_v_x = __pyx_t_9;
</pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0511</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span
            class="nb">range</span><span class="p">(</span><span class="mf">16</span><span class="p">):</span></pre>
    <pre class='cython code score-0 '>    for (__pyx_t_10 = 0; __pyx_t_10 &lt; 16; __pyx_t_10+=1) {
      __pyx_v_i = __pyx_t_10;
</pre>
    <pre class="cython line score-40"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0512</span>:             <span class="n">Z_view</span><span class="p">[</span><span
            class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span
            class="n">dblquad</span><span class="p">(</span><span class="n">IFUNC_SZ_S_VZA</span><span
            class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">2</span> <span
            class="o">*</span> <span class="n">PI</span><span class="p">,</span> <span class="k">lambda</span> <span
            class="n">x</span><span class="p">:</span> <span class="mf">0</span><span class="p">,</span> <span
            class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">PI</span><span
            class="p">,</span></pre>
    <pre class='cython code score-40 '>/* Python wrapper */
static PyObject *__pyx_pw_6pyrism_4core_3tma_15DBLQUAD_Z_S_VZA_lambda2(PyObject *__pyx_self, PyObject *__pyx_v_x); /*proto*/
static PyMethodDef __pyx_mdef_6pyrism_4core_3tma_15DBLQUAD_Z_S_VZA_lambda2 = {"lambda2", (PyCFunction)__pyx_pw_6pyrism_4core_3tma_15DBLQUAD_Z_S_VZA_lambda2, METH_O, 0};
static PyObject *__pyx_pw_6pyrism_4core_3tma_15DBLQUAD_Z_S_VZA_lambda2(PyObject *__pyx_self, PyObject *__pyx_v_x) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("lambda2 (wrapper)", 0);
  __pyx_r = __pyx_lambda_funcdef_lambda2(__pyx_self, ((PyObject *)__pyx_v_x));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_lambda_funcdef_lambda2(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_x) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("lambda2", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  __pyx_r = __pyx_int_0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6pyrism_4core_3tma_15DBLQUAD_Z_S_VZA_1lambda3(PyObject *__pyx_self, PyObject *__pyx_v_x); /*proto*/
static PyMethodDef __pyx_mdef_6pyrism_4core_3tma_15DBLQUAD_Z_S_VZA_1lambda3 = {"lambda3", (PyCFunction)__pyx_pw_6pyrism_4core_3tma_15DBLQUAD_Z_S_VZA_1lambda3, METH_O, 0};
static PyObject *__pyx_pw_6pyrism_4core_3tma_15DBLQUAD_Z_S_VZA_1lambda3(PyObject *__pyx_self, PyObject *__pyx_v_x) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("lambda3 (wrapper)", 0);
  __pyx_r = __pyx_lambda_funcdef_lambda3(__pyx_self, ((PyObject *)__pyx_v_x));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_lambda_funcdef_lambda3(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_x) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("lambda3", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_6pyrism_4core_3tma_PI);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 512, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.DBLQUAD_Z_S_VZA.lambda3", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* â€¦ */
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_dblquad);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 512, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_3 = __Pyx_CFunc_double____double____double____int____double____double____double____double____object____int___to_py(__pyx_f_6pyrism_4core_3tma_IFUNC_SZ_S_VZA);<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 512, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((2.0 * __pyx_v_6pyrism_4core_3tma_PI));<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 512, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_6pyrism_4core_3tma_15DBLQUAD_Z_S_VZA_lambda2, 0, __pyx_n_s_DBLQUAD_Z_S_VZA_locals_lambda, NULL, __pyx_n_s_pyrism_core_tma, __pyx_d, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 512, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_6pyrism_4core_3tma_15DBLQUAD_Z_S_VZA_1lambda3, 0, __pyx_n_s_DBLQUAD_Z_S_VZA_locals_lambda, NULL, __pyx_n_s_pyrism_core_tma, __pyx_d, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 512, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 512, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 1, __pyx_int_0);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 2, __pyx_t_1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 3, __pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 4, __pyx_t_4);
      __pyx_t_3 = 0;
      __pyx_t_1 = 0;
      __pyx_t_2 = 0;
      __pyx_t_4 = 0;
/* â€¦ */
      __pyx_t_23 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_11, __pyx_t_4);<span
                class='error_goto'> if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 512, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
/* â€¦ */
      __pyx_t_25 = __pyx_v_x;
      __pyx_t_26 = __pyx_v_i;
      __pyx_t_13 = -1;
      if (__pyx_t_25 &lt; 0) {
        __pyx_t_25 += __pyx_v_Z_view.shape[0];
        if (unlikely(__pyx_t_25 &lt; 0)) __pyx_t_13 = 0;
      } else if (unlikely(__pyx_t_25 &gt;= __pyx_v_Z_view.shape[0])) __pyx_t_13 = 0;
      if (__pyx_t_26 &lt; 0) {
        __pyx_t_26 += __pyx_v_Z_view.shape[1];
        if (unlikely(__pyx_t_26 &lt; 0)) __pyx_t_13 = 1;
      } else if (unlikely(__pyx_t_26 &gt;= __pyx_v_Z_view.shape[1])) __pyx_t_13 = 1;
      if (unlikely(__pyx_t_13 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
        <span class='error_goto'>__PYX_ERR(0, 512, __pyx_L1_error)</span>
      }
      *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_Z_view.data + __pyx_t_25 * __pyx_v_Z_view.strides[0]) ) + __pyx_t_26 * __pyx_v_Z_view.strides[1]) )) = __pyx_t_24;
    }
  }
</pre>
    <pre class="cython line score-59"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0513</span>:                                    <span class="n">args</span><span class="o">=</span><span
            class="p">(</span><span class="n">nmax</span><span class="p">[</span><span class="n">x</span><span
            class="p">],</span> <span class="n">wavelength</span><span class="p">[</span><span class="n">x</span><span
            class="p">],</span> <span class="n">izaDeg</span><span class="p">[</span><span class="n">x</span><span
            class="p">],</span> <span class="n">iaaDeg</span><span class="p">[</span><span class="n">x</span><span
            class="p">],</span> <span class="n">alphaDeg</span><span class="p">[</span><span class="n">x</span><span
            class="p">],</span> <span class="n">betaDeg</span><span class="p">[</span><span class="n">x</span><span
            class="p">],</span></pre>
    <pre class='cython code score-59 '>      __pyx_t_4 = <span
            class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 513, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_12 = __pyx_v_x;
      __pyx_t_13 = -1;
      if (__pyx_t_12 &lt; 0) {
        __pyx_t_12 += __pyx_v_nmax.shape[0];
        if (unlikely(__pyx_t_12 &lt; 0)) __pyx_t_13 = 0;
      } else if (unlikely(__pyx_t_12 &gt;= __pyx_v_nmax.shape[0])) __pyx_t_13 = 0;
      if (unlikely(__pyx_t_13 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
        <span class='error_goto'>__PYX_ERR(0, 513, __pyx_L1_error)</span>
      }
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>((*((int *) ( /* dim=0 */ (__pyx_v_nmax.data + __pyx_t_12 * __pyx_v_nmax.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 513, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_14 = __pyx_v_x;
      __pyx_t_13 = -1;
      if (__pyx_t_14 &lt; 0) {
        __pyx_t_14 += __pyx_v_wavelength.shape[0];
        if (unlikely(__pyx_t_14 &lt; 0)) __pyx_t_13 = 0;
      } else if (unlikely(__pyx_t_14 &gt;= __pyx_v_wavelength.shape[0])) __pyx_t_13 = 0;
      if (unlikely(__pyx_t_13 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
        <span class='error_goto'>__PYX_ERR(0, 513, __pyx_L1_error)</span>
      }
      __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_wavelength.data + __pyx_t_14 * __pyx_v_wavelength.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 513, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_15 = __pyx_v_x;
      __pyx_t_13 = -1;
      if (__pyx_t_15 &lt; 0) {
        __pyx_t_15 += __pyx_v_izaDeg.shape[0];
        if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_13 = 0;
      } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_izaDeg.shape[0])) __pyx_t_13 = 0;
      if (unlikely(__pyx_t_13 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
        <span class='error_goto'>__PYX_ERR(0, 513, __pyx_L1_error)</span>
      }
      __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_izaDeg.data + __pyx_t_15 * __pyx_v_izaDeg.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 513, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_16 = __pyx_v_x;
      __pyx_t_13 = -1;
      if (__pyx_t_16 &lt; 0) {
        __pyx_t_16 += __pyx_v_iaaDeg.shape[0];
        if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_13 = 0;
      } else if (unlikely(__pyx_t_16 &gt;= __pyx_v_iaaDeg.shape[0])) __pyx_t_13 = 0;
      if (unlikely(__pyx_t_13 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
        <span class='error_goto'>__PYX_ERR(0, 513, __pyx_L1_error)</span>
      }
      __pyx_t_17 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_iaaDeg.data + __pyx_t_16 * __pyx_v_iaaDeg.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 513, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
      __pyx_t_18 = __pyx_v_x;
      __pyx_t_13 = -1;
      if (__pyx_t_18 &lt; 0) {
        __pyx_t_18 += __pyx_v_alphaDeg.shape[0];
        if (unlikely(__pyx_t_18 &lt; 0)) __pyx_t_13 = 0;
      } else if (unlikely(__pyx_t_18 &gt;= __pyx_v_alphaDeg.shape[0])) __pyx_t_13 = 0;
      if (unlikely(__pyx_t_13 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
        <span class='error_goto'>__PYX_ERR(0, 513, __pyx_L1_error)</span>
      }
      __pyx_t_19 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_alphaDeg.data + __pyx_t_18 * __pyx_v_alphaDeg.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 513, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
      __pyx_t_20 = __pyx_v_x;
      __pyx_t_13 = -1;
      if (__pyx_t_20 &lt; 0) {
        __pyx_t_20 += __pyx_v_betaDeg.shape[0];
        if (unlikely(__pyx_t_20 &lt; 0)) __pyx_t_13 = 0;
      } else if (unlikely(__pyx_t_20 &gt;= __pyx_v_betaDeg.shape[0])) __pyx_t_13 = 0;
      if (unlikely(__pyx_t_13 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
        <span class='error_goto'>__PYX_ERR(0, 513, __pyx_L1_error)</span>
      }
      __pyx_t_21 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_betaDeg.data + __pyx_t_20 * __pyx_v_betaDeg.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 513, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
/* â€¦ */
      __pyx_t_23 = <span class='py_c_api'>PyTuple_New</span>(7);<span class='error_goto'> if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 513, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_23, 0, __pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_23, 1, __pyx_t_1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_23, 2, __pyx_t_3);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_17);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_23, 3, __pyx_t_17);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_19);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_23, 4, __pyx_t_19);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_21);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_23, 5, __pyx_t_21);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_22);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_23, 6, __pyx_t_22);
      __pyx_t_2 = 0;
      __pyx_t_1 = 0;
      __pyx_t_3 = 0;
      __pyx_t_17 = 0;
      __pyx_t_19 = 0;
      __pyx_t_21 = 0;
      __pyx_t_22 = 0;
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_args, __pyx_t_23) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 513, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
</pre>
    <pre class="cython line score-19"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0514</span>:                                          <span class="n">i</span><span
            class="p">))[</span><span class="mf">0</span><span class="p">]</span></pre>
    <pre class='cython code score-19 '>      __pyx_t_22 = <span
            class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 514, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_22);
/* â€¦ */
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_23, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 514, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
      __pyx_t_24 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_4); if (unlikely((__pyx_t_24 == (double)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 514, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0515</span>: </pre>
    <pre class="cython line score-2"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0516</span>:     <span class="k">return</span> <span class="n">Z</span></pre>
    <pre class='cython code score-2 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_Z, PyBUF_WRITABLE);<span
            class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 516, __pyx_L1_error)</span>
  __pyx_r = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
  goto __pyx_L0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0517</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">0518</span>: <span class="c"># ----------------------------------------------------------------------------------------------------------------------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0519</span>: <span class="c"># Integrate AVERAGED FIXED ORIENTATED Scattering and Phase Matrix</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0520</span>: <span class="c"># ----------------------------------------------------------------------------------------------------------------------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0521</span>: <span class="c"># Auxiliary Functions --------------------------------------------------------------------------------------------------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0522</span>: <span class="c"># Functions that can be used with scipy.integrate.dblquad</span></pre>
    <pre class="cython line score-19"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0523</span>: <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">IFUNC_SZ_AF_IZA</span><span
            class="p">(</span><span class="n">double</span> <span class="n">iza</span><span class="p">,</span> <span
            class="n">double</span> <span class="n">iaa</span><span class="p">,</span> <span class="nb">int</span> <span
            class="n">nmax</span><span class="p">,</span> <span class="n">double</span> <span
            class="n">wavelength</span><span class="p">,</span> <span class="n">double</span> <span
            class="n">vzaDeg</span><span class="p">,</span> <span class="n">double</span> <span
            class="n">vaaDeg</span><span class="p">,</span></pre>
    <pre class='cython code score-19 '>static double __pyx_f_6pyrism_4core_3tma_IFUNC_SZ_AF_IZA(double __pyx_v_iza, double __pyx_v_iaa, int __pyx_v_nmax, double __pyx_v_wavelength, double __pyx_v_vzaDeg, double __pyx_v_vaaDeg, int __pyx_v_n_alpha, int __pyx_v_n_beta, PyObject *__pyx_v_or_pdf, int __pyx_v_i) {
  double __pyx_v_izaDeg;
  double __pyx_v_iaaDeg;
  PyArrayObject *__pyx_v_Z = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_S = 0;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_S;
  __Pyx_Buffer __pyx_pybuffer_S;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Z;
  __Pyx_Buffer __pyx_pybuffer_Z;
  double __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("IFUNC_SZ_AF_IZA", 0);
  __pyx_pybuffer_Z.pybuffer.buf = NULL;
  __pyx_pybuffer_Z.refcount = 0;
  __pyx_pybuffernd_Z.data = NULL;
  __pyx_pybuffernd_Z.rcbuffer = &amp;__pyx_pybuffer_Z;
  __pyx_pybuffer_S.pybuffer.buf = NULL;
  __pyx_pybuffer_S.refcount = 0;
  __pyx_pybuffernd_S.data = NULL;
  __pyx_pybuffernd_S.rcbuffer = &amp;__pyx_pybuffer_S;
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_S.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("pyrism.core.tma.IFUNC_SZ_AF_IZA", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_S.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_Z);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_S);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0524</span>:                             <span
            class="nb">int</span> <span class="n">n_alpha</span><span class="p">,</span> <span
            class="nb">int</span> <span class="n">n_beta</span><span class="p">,</span> <span
            class="n">or_pdf</span><span class="p">,</span> <span class="nb">int</span> <span class="n">i</span><span
            class="p">):</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0525</span>:     <span class="sd">&quot;&quot;&quot;Integrate Z in Incidence Direction</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0526</span>: <span class="sd">    </span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0527</span>: <span class="sd">    Callable function for scipy.integrate.dblquad for integration of the phase matrix in incidence direction.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0528</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">0529</span>: <span class="sd">    Parameters</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0530</span>: <span class="sd">    ----------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0531</span>: <span class="sd">    nmax : int</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0532</span>: <span
            class="sd">        Nmax parameter.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0533</span>: <span
            class="sd">    wavelength : double</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0534</span>: <span class="sd">        Wavelength in same unit as radius (used by function calc_nmax).</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0535</span>: <span class="sd">    izaDeg, vzaDeg, iaaDeg, vaaDeg : double</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0536</span>: <span class="sd">        Incidence (iza) and scattering (vza) zenith angle and incidence and viewing</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0537</span>: <span class="sd">        azimuth angle (ira, vra) in [DEG].</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0538</span>: <span class="sd">    n_alpha, n_beta : int</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0539</span>: <span class="sd">        Number of integration points in the alpha and beta Euler angle.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0540</span>: <span
            class="sd">    or_pdf: callable</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0541</span>: <span class="sd">        Particle orientation Probability Density Function (PDF) for orientation averaging.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0542</span>: <span class="sd">    i : int</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0543</span>: <span class="sd">        Number between 0 and 15 which defines the matrix element that will be integrated.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0544</span>: <span class="sd">        </span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0545</span>: <span class="sd">    Returns</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0546</span>: <span class="sd">    -------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0547</span>: <span class="sd">    Z : double</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0548</span>: <span class="sd">        Integrated phase matrix element.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0549</span>: <span
            class="sd">    &quot;&quot;&quot;</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0550</span>:     <span class="k">cdef</span><span
            class="p">:</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0551</span>:         <span class="n">double</span> <span
            class="n">izaDeg</span><span class="p">,</span> <span class="n">iaaDeg</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0552</span>:         <span class="n">np</span><span class="o">.</span><span
            class="n">ndarray</span><span class="p">[</span><span class="n">double</span><span class="p">,</span> <span
            class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span>  <span
            class="n">Z</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0553</span>:         <span class="n">np</span><span class="o">.</span><span
            class="n">ndarray</span><span class="p">[</span><span class="n">DTYPE_t</span><span class="p">,</span> <span
            class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span>  <span
            class="n">S</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0554</span>: </pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0555</span>:     <span class="n">izaDeg</span><span class="p">,</span> <span
            class="n">iaaDeg</span> <span class="o">=</span> <span class="n">iza</span> <span class="o">*</span> <span
            class="n">RAD_TO_DEG</span><span class="p">,</span> <span class="n">iaa</span> <span
            class="o">*</span> <span class="n">RAD_TO_DEG</span></pre>
    <pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_iza * __pyx_v_6pyrism_4core_3tma_RAD_TO_DEG);
  __pyx_t_2 = (__pyx_v_iaa * __pyx_v_6pyrism_4core_3tma_RAD_TO_DEG);
  __pyx_v_izaDeg = __pyx_t_1;
  __pyx_v_iaaDeg = __pyx_t_2;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0556</span>: </pre>
    <pre class="cython line score-55"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0557</span>:     <span class="n">S</span><span class="p">,</span> <span class="n">Z</span> <span
            class="o">=</span> <span class="n">SZ_AF</span><span class="p">(</span><span class="n">nmax</span><span
            class="p">,</span> <span class="n">wavelength</span><span class="p">,</span> <span
            class="n">izaDeg</span><span class="p">,</span> <span class="n">vzaDeg</span><span class="p">,</span> <span
            class="n">iaaDeg</span><span class="p">,</span> <span class="n">vaaDeg</span><span class="p">,</span> <span
            class="n">n_alpha</span><span class="p">,</span> <span class="n">n_beta</span><span class="p">,</span> <span
            class="n">or_pdf</span><span class="p">)</span></pre>
    <pre class='cython code score-55 '>  __pyx_t_3 = __pyx_f_6pyrism_4core_3tma_SZ_AF(__pyx_v_nmax, __pyx_v_wavelength, __pyx_v_izaDeg, __pyx_v_vzaDeg, __pyx_v_iaaDeg, __pyx_v_vaaDeg, __pyx_v_n_alpha, __pyx_v_n_beta, __pyx_v_or_pdf);<span
            class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 557, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (likely(__pyx_t_3 != Py_None)) {
    PyObject* sequence = __pyx_t_3;
    Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
    if (unlikely(size != 2)) {
      if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      <span class='error_goto'>__PYX_ERR(0, 557, __pyx_L1_error)</span>
    }
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0);
    __pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
    #else
    __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 557, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 557, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  } else {
    <span class='pyx_c_api'>__Pyx_RaiseNoneNotIterableError</span>(); <span class='error_goto'>__PYX_ERR(0, 557, __pyx_L1_error)</span>
  }
  if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span
                class='error_goto'>__PYX_ERR(0, 557, __pyx_L1_error)</span>
  if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) <span
                class='error_goto'>__PYX_ERR(0, 557, __pyx_L1_error)</span>
  __pyx_t_6 = ((PyArrayObject *)__pyx_t_4);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[2];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_S.rcbuffer-&gt;pybuffer);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_S.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_6, &amp;__Pyx_TypeInfo_nn___pyx_t_6pyrism_4core_3tma_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack);
    if (unlikely(__pyx_t_7 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_8, &amp;__pyx_t_9, &amp;__pyx_t_10);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_S.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_S, &amp;__Pyx_TypeInfo_nn___pyx_t_6pyrism_4core_3tma_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_8); Py_XDECREF(__pyx_t_9); Py_XDECREF(__pyx_t_10);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_8, __pyx_t_9, __pyx_t_10);
      }
      __pyx_t_8 = __pyx_t_9 = __pyx_t_10 = 0;
    }
    __pyx_pybuffernd_S.diminfo[0].strides = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_S.diminfo[0].shape = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_S.diminfo[1].strides = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_S.diminfo[1].shape = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.shape[1];
    if (unlikely(__pyx_t_7 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 557, __pyx_L1_error)</span>
  }
  __pyx_t_6 = 0;
  __pyx_v_S = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_11 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_11, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack);
    if (unlikely(__pyx_t_7 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_10, &amp;__pyx_t_9, &amp;__pyx_t_8);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_Z, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_10); Py_XDECREF(__pyx_t_9); Py_XDECREF(__pyx_t_8);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_10, __pyx_t_9, __pyx_t_8);
      }
      __pyx_t_10 = __pyx_t_9 = __pyx_t_8 = 0;
    }
    __pyx_pybuffernd_Z.diminfo[0].strides = __pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Z.diminfo[0].shape = __pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_Z.diminfo[1].strides = __pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_Z.diminfo[1].shape = __pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer.shape[1];
    if (unlikely(__pyx_t_7 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 557, __pyx_L1_error)</span>
  }
  __pyx_t_11 = 0;
  __pyx_v_Z = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0558</span>: </pre>
    <pre class="cython line score-44"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0559</span>:     <span class="k">return</span> <span class="n">Z</span><span
            class="o">.</span><span class="n">flatten</span><span class="p">()[</span><span class="n">i</span><span
            class="p">]</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span
            class="n">iza</span><span class="p">)</span></pre>
    <pre class='cython code score-44 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_Z), __pyx_n_s_flatten);<span
            class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 559, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  if (__pyx_t_4) {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 559, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  } else {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 559, __pyx_L1_error)</span>
  }
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_3, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 1, 1);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 559, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(sin(__pyx_v_iza));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 559, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_5, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 559, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_2 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_4); if (unlikely((__pyx_t_2 == (double)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 559, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_r = __pyx_t_2;
  goto __pyx_L0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0560</span>: </pre>
    <pre class="cython line score-19"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0561</span>: <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">IFUNC_SZ_AF_VZA</span><span
            class="p">(</span><span class="n">double</span> <span class="n">vza</span><span class="p">,</span> <span
            class="n">double</span> <span class="n">vaa</span><span class="p">,</span> <span class="nb">int</span> <span
            class="n">nmax</span><span class="p">,</span> <span class="n">double</span> <span
            class="n">wavelength</span><span class="p">,</span> <span class="n">double</span> <span
            class="n">izaDeg</span><span class="p">,</span> <span class="n">double</span> <span
            class="n">iaaDeg</span><span class="p">,</span></pre>
    <pre class='cython code score-19 '>static double __pyx_f_6pyrism_4core_3tma_IFUNC_SZ_AF_VZA(double __pyx_v_vza, double __pyx_v_vaa, int __pyx_v_nmax, double __pyx_v_wavelength, double __pyx_v_izaDeg, double __pyx_v_iaaDeg, PyObject *__pyx_v_n_alpha, int __pyx_v_n_beta, PyObject *__pyx_v_or_pdf, int __pyx_v_i) {
  double __pyx_v_vzaDeg;
  double __pyx_v_vaaDeg;
  PyArrayObject *__pyx_v_Z = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_S = 0;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_S;
  __Pyx_Buffer __pyx_pybuffer_S;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Z;
  __Pyx_Buffer __pyx_pybuffer_Z;
  double __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("IFUNC_SZ_AF_VZA", 0);
  __pyx_pybuffer_Z.pybuffer.buf = NULL;
  __pyx_pybuffer_Z.refcount = 0;
  __pyx_pybuffernd_Z.data = NULL;
  __pyx_pybuffernd_Z.rcbuffer = &amp;__pyx_pybuffer_Z;
  __pyx_pybuffer_S.pybuffer.buf = NULL;
  __pyx_pybuffer_S.refcount = 0;
  __pyx_pybuffernd_S.data = NULL;
  __pyx_pybuffernd_S.rcbuffer = &amp;__pyx_pybuffer_S;
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_S.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("pyrism.core.tma.IFUNC_SZ_AF_VZA", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_S.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_Z);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_S);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0562</span>:                             <span class="n">n_alpha</span><span
            class="p">,</span> <span class="nb">int</span> <span class="n">n_beta</span><span class="p">,</span> <span
            class="n">or_pdf</span><span class="p">,</span> <span class="nb">int</span> <span class="n">i</span><span
            class="p">):</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0563</span>:     <span class="sd">&quot;&quot;&quot;Integrate Z in Viewing Direction</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0564</span>: <span class="sd">    </span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0565</span>: <span class="sd">    Callable function for scipy.integrate.dblquad for integration of the phase matrix in viewing direction.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0566</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">0567</span>: <span class="sd">    Parameters</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0568</span>: <span class="sd">    ----------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0569</span>: <span class="sd">    nmax : int</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0570</span>: <span
            class="sd">        Nmax parameter.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0571</span>: <span
            class="sd">    wavelength : double</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0572</span>: <span class="sd">        Wavelength in same unit as radius (used by function calc_nmax).</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0573</span>: <span class="sd">    izaDeg, vzaDeg, iaaDeg, vaaDeg : double</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0574</span>: <span class="sd">        Incidence (iza) and scattering (vza) zenith angle and incidence and viewing</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0575</span>: <span class="sd">        azimuth angle (ira, vra) in [DEG].</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0576</span>: <span class="sd">    n_alpha, n_beta : int</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0577</span>: <span class="sd">        Number of integration points in the alpha and beta Euler angle.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0578</span>: <span
            class="sd">    or_pdf: callable</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0579</span>: <span class="sd">        Particle orientation Probability Density Function (PDF) for orientation averaging.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0580</span>: <span class="sd">    i : int</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0581</span>: <span class="sd">        Number between 0 and 15 which defines the matrix element that will be integrated.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0582</span>: <span class="sd">        </span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0583</span>: <span class="sd">    Returns</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0584</span>: <span class="sd">    -------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0585</span>: <span class="sd">    Z : double</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0586</span>: <span class="sd">        Integrated phase matrix element.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0587</span>: <span
            class="sd">    &quot;&quot;&quot;</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0588</span>:     <span class="k">cdef</span><span
            class="p">:</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0589</span>:         <span class="n">double</span> <span
            class="n">vzaDeg</span><span class="p">,</span> <span class="n">vaaDeg</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0590</span>:         <span class="n">np</span><span class="o">.</span><span
            class="n">ndarray</span><span class="p">[</span><span class="n">double</span><span class="p">,</span> <span
            class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span>  <span
            class="n">Z</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0591</span>:         <span class="n">np</span><span class="o">.</span><span
            class="n">ndarray</span><span class="p">[</span><span class="n">DTYPE_t</span><span class="p">,</span> <span
            class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span>  <span
            class="n">S</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0592</span>: </pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0593</span>:     <span class="n">vzaDeg</span><span class="p">,</span> <span
            class="n">vaaDeg</span> <span class="o">=</span> <span class="n">vza</span> <span class="o">*</span> <span
            class="n">RAD_TO_DEG</span><span class="p">,</span> <span class="n">vaa</span> <span
            class="o">*</span> <span class="n">RAD_TO_DEG</span></pre>
    <pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_vza * __pyx_v_6pyrism_4core_3tma_RAD_TO_DEG);
  __pyx_t_2 = (__pyx_v_vaa * __pyx_v_6pyrism_4core_3tma_RAD_TO_DEG);
  __pyx_v_vzaDeg = __pyx_t_1;
  __pyx_v_vaaDeg = __pyx_t_2;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0594</span>: </pre>
    <pre class="cython line score-62"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0595</span>:     <span class="n">S</span><span class="p">,</span> <span class="n">Z</span> <span
            class="o">=</span> <span class="n">SZ_AF</span><span class="p">(</span><span class="n">nmax</span><span
            class="p">,</span> <span class="n">wavelength</span><span class="p">,</span> <span
            class="n">izaDeg</span><span class="p">,</span> <span class="n">vzaDeg</span><span class="p">,</span> <span
            class="n">iaaDeg</span><span class="p">,</span> <span class="n">vaaDeg</span><span class="p">,</span> <span
            class="n">n_alpha</span><span class="p">,</span> <span class="n">n_beta</span><span class="p">,</span> <span
            class="n">or_pdf</span><span class="p">)</span></pre>
    <pre class='cython code score-62 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_v_n_alpha); if (unlikely((__pyx_t_3 == (int)-1) &amp;&amp; <span
            class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 595, __pyx_L1_error)</span>
  __pyx_t_4 = __pyx_f_6pyrism_4core_3tma_SZ_AF(__pyx_v_nmax, __pyx_v_wavelength, __pyx_v_izaDeg, __pyx_v_vzaDeg, __pyx_v_iaaDeg, __pyx_v_vaaDeg, __pyx_t_3, __pyx_v_n_beta, __pyx_v_or_pdf);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 595, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (likely(__pyx_t_4 != Py_None)) {
    PyObject* sequence = __pyx_t_4;
    Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
    if (unlikely(size != 2)) {
      if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      <span class='error_goto'>__PYX_ERR(0, 595, __pyx_L1_error)</span>
    }
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    __pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0);
    __pyx_t_6 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
    #else
    __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 595, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_6 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 595, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  } else {
    <span class='pyx_c_api'>__Pyx_RaiseNoneNotIterableError</span>(); <span class='error_goto'>__PYX_ERR(0, 595, __pyx_L1_error)</span>
  }
  if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) <span
                class='error_goto'>__PYX_ERR(0, 595, __pyx_L1_error)</span>
  if (!(likely(((__pyx_t_6) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) <span
                class='error_goto'>__PYX_ERR(0, 595, __pyx_L1_error)</span>
  __pyx_t_7 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[2];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_S.rcbuffer-&gt;pybuffer);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_S.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_7, &amp;__Pyx_TypeInfo_nn___pyx_t_6pyrism_4core_3tma_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack);
    if (unlikely(__pyx_t_3 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_8, &amp;__pyx_t_9, &amp;__pyx_t_10);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_S.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_S, &amp;__Pyx_TypeInfo_nn___pyx_t_6pyrism_4core_3tma_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_8); Py_XDECREF(__pyx_t_9); Py_XDECREF(__pyx_t_10);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_8, __pyx_t_9, __pyx_t_10);
      }
      __pyx_t_8 = __pyx_t_9 = __pyx_t_10 = 0;
    }
    __pyx_pybuffernd_S.diminfo[0].strides = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_S.diminfo[0].shape = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_S.diminfo[1].strides = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_S.diminfo[1].shape = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.shape[1];
    if (unlikely(__pyx_t_3 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 595, __pyx_L1_error)</span>
  }
  __pyx_t_7 = 0;
  __pyx_v_S = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_11 = ((PyArrayObject *)__pyx_t_6);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_11, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack);
    if (unlikely(__pyx_t_3 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_10, &amp;__pyx_t_9, &amp;__pyx_t_8);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_Z, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_10); Py_XDECREF(__pyx_t_9); Py_XDECREF(__pyx_t_8);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_10, __pyx_t_9, __pyx_t_8);
      }
      __pyx_t_10 = __pyx_t_9 = __pyx_t_8 = 0;
    }
    __pyx_pybuffernd_Z.diminfo[0].strides = __pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Z.diminfo[0].shape = __pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_Z.diminfo[1].strides = __pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_Z.diminfo[1].shape = __pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer.shape[1];
    if (unlikely(__pyx_t_3 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 595, __pyx_L1_error)</span>
  }
  __pyx_t_11 = 0;
  __pyx_v_Z = ((PyArrayObject *)__pyx_t_6);
  __pyx_t_6 = 0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0596</span>: </pre>
    <pre class="cython line score-44"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0597</span>:     <span class="k">return</span> <span class="n">Z</span><span
            class="o">.</span><span class="n">flatten</span><span class="p">()[</span><span class="n">i</span><span
            class="p">]</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span
            class="n">vza</span><span class="p">)</span></pre>
    <pre class='cython code score-44 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_Z), __pyx_n_s_flatten);<span
            class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 597, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
    }
  }
  if (__pyx_t_5) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 597, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  } else {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 597, __pyx_L1_error)</span>
  }
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_4, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 1, 1);<span
                class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 597, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(sin(__pyx_v_vza));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 597, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_6, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 597, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_2 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_5); if (unlikely((__pyx_t_2 == (double)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 597, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_r = __pyx_t_2;
  goto __pyx_L0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0598</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">0599</span>: <span class="c"># Double Integral Functions --------------------------------------------------------------------------------------------</span></pre>
    <pre class="cython line score-19"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0600</span>: <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:,:]</span> <span
            class="n">DBLQUAD_Z_AF_IZA</span><span class="p">(</span><span class="nb">int</span><span
            class="p">[:]</span> <span class="n">nmax</span><span class="p">,</span> <span class="n">double</span><span
            class="p">[:]</span> <span class="n">wavelength</span><span class="p">,</span> <span class="n">double</span><span
            class="p">[:]</span> <span class="n">vzaDeg</span><span class="p">,</span> <span
            class="n">double</span><span class="p">[:]</span> <span class="n">vaaDeg</span><span
            class="p">,</span></pre>
    <pre class='cython code score-19 '>static __Pyx_memviewslice __pyx_f_6pyrism_4core_3tma_DBLQUAD_Z_AF_IZA(__Pyx_memviewslice __pyx_v_nmax, __Pyx_memviewslice __pyx_v_wavelength, __Pyx_memviewslice __pyx_v_vzaDeg, __Pyx_memviewslice __pyx_v_vaaDeg, int __pyx_v_n_alpha, int __pyx_v_n_beta, PyObject *__pyx_v_or_pdf) {
  Py_ssize_t __pyx_v_x;
  Py_ssize_t __pyx_v_i;
  Py_ssize_t __pyx_v_xmax;
  PyObject *__pyx_v_Z = NULL;
  __Pyx_memviewslice __pyx_v_Z_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_r = { 0, 0, { 0 }, { 0 }, { 0 } };
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("DBLQUAD_Z_AF_IZA", 0);
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_18);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_19);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_20);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_21);
  __pyx_r.data = NULL;
  __pyx_r.memview = NULL;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.DBLQUAD_Z_AF_IZA", __pyx_clineno, __pyx_lineno, __pyx_filename);

  goto __pyx_L2;
  __pyx_L0:;
  if (unlikely(!__pyx_r.memview)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "Memoryview return value is not initialized");
  }
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_Z);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_Z_view, 1);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0601</span>:                                   <span
            class="nb">int</span> <span class="n">n_alpha</span><span class="p">,</span> <span
            class="nb">int</span> <span class="n">n_beta</span><span class="p">,</span> <span
            class="n">or_pdf</span><span class="p">):</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0602</span>:     <span
            class="sd">&quot;&quot;&quot;</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0603</span>: <span class="sd">    Integrate the phase matrix over a half sphere in incidence direction.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0604</span>: <span class="sd">    </span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0605</span>: <span class="sd">    Parameters</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0606</span>: <span class="sd">    ----------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0607</span>: <span class="sd">    nmax : int[:] </span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0608</span>: <span
            class="sd">        Nmax parameter.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0609</span>: <span
            class="sd">    wavelength : double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0610</span>: <span class="sd">        Wavelength in same unit as radius (used by function calc_nmax).</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0611</span>: <span
            class="sd">    vzaDeg, vaaDeg : double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0612</span>: <span class="sd">        Scattering (vza) zenith and azimuth angle (vaa) in [DEG].</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0613</span>: <span class="sd">    n_alpha, n_beta : int</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0614</span>: <span class="sd">        Number of integration points in the alpha and beta Euler angle.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0615</span>: <span
            class="sd">    or_pdf: callable</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0616</span>: <span class="sd">        Particle orientation Probability Density Function (PDF) for orientation averaging.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0617</span>: <span class="sd">        </span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0618</span>: <span class="sd">    Returns</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0619</span>: <span class="sd">    -------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0620</span>: <span
            class="sd">    Z : MemoryView, double[:,:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0621</span>: <span class="sd">        Two dimensional integrated phase matrix.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0622</span>: <span class="sd">    </span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0623</span>: <span class="sd">    Note</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0624</span>: <span class="sd">    ----</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0625</span>: <span class="sd">    The output is a array with shape (nmax.shape[0], 16). To put it in a matrix form one must reshape it like</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0626</span>: <span class="sd">    np.reshape(Z, (nmax.shape[0], 4, 4)).</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0627</span>: <span
            class="sd">    &quot;&quot;&quot;</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0628</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">0629</span>:     <span class="k">cdef</span><span
            class="p">:</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0630</span>:         <span class="n">Py_ssize_t</span> <span
            class="n">x</span><span class="p">,</span> <span class="n">i</span></pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0631</span>:         <span class="n">Py_ssize_t</span> <span class="n">xmax</span> <span class="o">=</span> <span
            class="n">nmax</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span
            class="mf">0</span><span class="p">]</span></pre>
    <pre class='cython code score-0 '>  __pyx_v_xmax = (__pyx_v_nmax.shape[0]);
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0632</span>: </pre>
    <pre class="cython line score-42"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0633</span>:     <span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span
            class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">xmax</span><span
            class="p">,</span> <span class="mf">16</span><span class="p">),</span> <span class="n">dtype</span><span
            class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span
            class="p">)</span></pre>
    <pre class='cython code score-42 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span
            class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 633, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 633, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_xmax);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 633, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 633, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_16);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_16);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_16);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 633, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 633, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 633, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_double);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 633, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 633, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 633, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_Z = __pyx_t_5;
  __pyx_t_5 = 0;
</pre>
    <pre class="cython line score-2"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0634</span>:     <span class="k">cdef</span> <span class="kt">double</span>[<span
            class="p">:,:]</span> <span class="n">Z_view</span> <span class="o">=</span> <span class="n">Z</span></pre>
    <pre class='cython code score-2 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_Z, PyBUF_WRITABLE);<span
            class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 634, __pyx_L1_error)</span>
  __pyx_v_Z_view = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0635</span>: </pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0636</span>:     <span class="k">for</span> <span class="n">x</span> <span
            class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">xmax</span><span
            class="p">):</span></pre>
    <pre class='cython code score-0 '>  __pyx_t_7 = __pyx_v_xmax;
  __pyx_t_8 = __pyx_t_7;
  for (__pyx_t_9 = 0; __pyx_t_9 &lt; __pyx_t_8; __pyx_t_9+=1) {
    __pyx_v_x = __pyx_t_9;
</pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0637</span>:             <span class="k">for</span> <span class="n">i</span> <span
            class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">16</span><span
            class="p">):</span></pre>
    <pre class='cython code score-0 '>    for (__pyx_t_10 = 0; __pyx_t_10 &lt; 16; __pyx_t_10+=1) {
      __pyx_v_i = __pyx_t_10;
</pre>
    <pre class="cython line score-40"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0638</span>:                 <span class="n">Z_view</span><span class="p">[</span><span
            class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span
            class="n">dblquad</span><span class="p">(</span><span class="n">IFUNC_SZ_AF_IZA</span><span
            class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">2</span> <span
            class="o">*</span> <span class="n">PI</span><span class="p">,</span> <span class="k">lambda</span> <span
            class="n">x</span><span class="p">:</span> <span class="mf">0</span><span class="p">,</span> <span
            class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">PI</span><span
            class="p">,</span></pre>
    <pre class='cython code score-40 '>/* Python wrapper */
static PyObject *__pyx_pw_6pyrism_4core_3tma_16DBLQUAD_Z_AF_IZA_lambda4(PyObject *__pyx_self, PyObject *__pyx_v_x); /*proto*/
static PyMethodDef __pyx_mdef_6pyrism_4core_3tma_16DBLQUAD_Z_AF_IZA_lambda4 = {"lambda4", (PyCFunction)__pyx_pw_6pyrism_4core_3tma_16DBLQUAD_Z_AF_IZA_lambda4, METH_O, 0};
static PyObject *__pyx_pw_6pyrism_4core_3tma_16DBLQUAD_Z_AF_IZA_lambda4(PyObject *__pyx_self, PyObject *__pyx_v_x) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("lambda4 (wrapper)", 0);
  __pyx_r = __pyx_lambda_funcdef_lambda4(__pyx_self, ((PyObject *)__pyx_v_x));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_lambda_funcdef_lambda4(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_x) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("lambda4", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  __pyx_r = __pyx_int_0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6pyrism_4core_3tma_16DBLQUAD_Z_AF_IZA_1lambda5(PyObject *__pyx_self, PyObject *__pyx_v_x); /*proto*/
static PyMethodDef __pyx_mdef_6pyrism_4core_3tma_16DBLQUAD_Z_AF_IZA_1lambda5 = {"lambda5", (PyCFunction)__pyx_pw_6pyrism_4core_3tma_16DBLQUAD_Z_AF_IZA_1lambda5, METH_O, 0};
static PyObject *__pyx_pw_6pyrism_4core_3tma_16DBLQUAD_Z_AF_IZA_1lambda5(PyObject *__pyx_self, PyObject *__pyx_v_x) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("lambda5 (wrapper)", 0);
  __pyx_r = __pyx_lambda_funcdef_lambda5(__pyx_self, ((PyObject *)__pyx_v_x));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_lambda_funcdef_lambda5(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_x) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("lambda5", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_6pyrism_4core_3tma_PI);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 638, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.DBLQUAD_Z_AF_IZA.lambda5", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* â€¦ */
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_dblquad);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 638, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_3 = __Pyx_CFunc_double____double____double____int____double____double____double____int____int____object____int___to_py(__pyx_f_6pyrism_4core_3tma_IFUNC_SZ_AF_IZA);<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 638, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((2.0 * __pyx_v_6pyrism_4core_3tma_PI));<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 638, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_6pyrism_4core_3tma_16DBLQUAD_Z_AF_IZA_lambda4, 0, __pyx_n_s_DBLQUAD_Z_AF_IZA_locals_lambda, NULL, __pyx_n_s_pyrism_core_tma, __pyx_d, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 638, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_6pyrism_4core_3tma_16DBLQUAD_Z_AF_IZA_1lambda5, 0, __pyx_n_s_DBLQUAD_Z_AF_IZA_locals_lambda, NULL, __pyx_n_s_pyrism_core_tma, __pyx_d, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 638, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 638, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 1, __pyx_int_0);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 2, __pyx_t_1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 3, __pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 4, __pyx_t_4);
      __pyx_t_3 = 0;
      __pyx_t_1 = 0;
      __pyx_t_2 = 0;
      __pyx_t_4 = 0;
/* â€¦ */
      __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_11, __pyx_t_4);<span
                class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 638, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
/* â€¦ */
      __pyx_t_23 = __pyx_v_x;
      __pyx_t_24 = __pyx_v_i;
      __pyx_t_13 = -1;
      if (__pyx_t_23 &lt; 0) {
        __pyx_t_23 += __pyx_v_Z_view.shape[0];
        if (unlikely(__pyx_t_23 &lt; 0)) __pyx_t_13 = 0;
      } else if (unlikely(__pyx_t_23 &gt;= __pyx_v_Z_view.shape[0])) __pyx_t_13 = 0;
      if (__pyx_t_24 &lt; 0) {
        __pyx_t_24 += __pyx_v_Z_view.shape[1];
        if (unlikely(__pyx_t_24 &lt; 0)) __pyx_t_13 = 1;
      } else if (unlikely(__pyx_t_24 &gt;= __pyx_v_Z_view.shape[1])) __pyx_t_13 = 1;
      if (unlikely(__pyx_t_13 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
        <span class='error_goto'>__PYX_ERR(0, 638, __pyx_L1_error)</span>
      }
      *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_Z_view.data + __pyx_t_23 * __pyx_v_Z_view.strides[0]) ) + __pyx_t_24 * __pyx_v_Z_view.strides[1]) )) = __pyx_t_22;
    }
  }
</pre>
    <pre class="cython line score-51"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0639</span>:                                        <span class="n">args</span><span
            class="o">=</span><span class="p">(</span><span class="n">nmax</span><span class="p">[</span><span
            class="n">x</span><span class="p">],</span> <span class="n">wavelength</span><span class="p">[</span><span
            class="n">x</span><span class="p">],</span> <span class="n">vzaDeg</span><span class="p">[</span><span
            class="n">x</span><span class="p">],</span> <span class="n">vaaDeg</span><span class="p">[</span><span
            class="n">x</span><span class="p">],</span> <span class="n">n_alpha</span><span class="p">,</span> <span
            class="n">n_beta</span><span class="p">,</span> <span class="n">or_pdf</span><span class="p">,</span></pre>
    <pre class='cython code score-51 '>      __pyx_t_4 = <span
            class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 639, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_12 = __pyx_v_x;
      __pyx_t_13 = -1;
      if (__pyx_t_12 &lt; 0) {
        __pyx_t_12 += __pyx_v_nmax.shape[0];
        if (unlikely(__pyx_t_12 &lt; 0)) __pyx_t_13 = 0;
      } else if (unlikely(__pyx_t_12 &gt;= __pyx_v_nmax.shape[0])) __pyx_t_13 = 0;
      if (unlikely(__pyx_t_13 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
        <span class='error_goto'>__PYX_ERR(0, 639, __pyx_L1_error)</span>
      }
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>((*((int *) ( /* dim=0 */ (__pyx_v_nmax.data + __pyx_t_12 * __pyx_v_nmax.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 639, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_14 = __pyx_v_x;
      __pyx_t_13 = -1;
      if (__pyx_t_14 &lt; 0) {
        __pyx_t_14 += __pyx_v_wavelength.shape[0];
        if (unlikely(__pyx_t_14 &lt; 0)) __pyx_t_13 = 0;
      } else if (unlikely(__pyx_t_14 &gt;= __pyx_v_wavelength.shape[0])) __pyx_t_13 = 0;
      if (unlikely(__pyx_t_13 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
        <span class='error_goto'>__PYX_ERR(0, 639, __pyx_L1_error)</span>
      }
      __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_wavelength.data + __pyx_t_14 * __pyx_v_wavelength.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 639, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_15 = __pyx_v_x;
      __pyx_t_13 = -1;
      if (__pyx_t_15 &lt; 0) {
        __pyx_t_15 += __pyx_v_vzaDeg.shape[0];
        if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_13 = 0;
      } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_vzaDeg.shape[0])) __pyx_t_13 = 0;
      if (unlikely(__pyx_t_13 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
        <span class='error_goto'>__PYX_ERR(0, 639, __pyx_L1_error)</span>
      }
      __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_vzaDeg.data + __pyx_t_15 * __pyx_v_vzaDeg.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 639, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_16 = __pyx_v_x;
      __pyx_t_13 = -1;
      if (__pyx_t_16 &lt; 0) {
        __pyx_t_16 += __pyx_v_vaaDeg.shape[0];
        if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_13 = 0;
      } else if (unlikely(__pyx_t_16 &gt;= __pyx_v_vaaDeg.shape[0])) __pyx_t_13 = 0;
      if (unlikely(__pyx_t_13 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
        <span class='error_goto'>__PYX_ERR(0, 639, __pyx_L1_error)</span>
      }
      __pyx_t_17 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_vaaDeg.data + __pyx_t_16 * __pyx_v_vaaDeg.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 639, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
      __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_alpha);<span class='error_goto'> if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 639, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
      __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_beta);<span class='error_goto'> if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 639, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
/* â€¦ */
      __pyx_t_21 = <span class='py_c_api'>PyTuple_New</span>(8);<span class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 639, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 0, __pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 1, __pyx_t_1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 2, __pyx_t_3);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_17);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 3, __pyx_t_17);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_18);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 4, __pyx_t_18);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_19);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 5, __pyx_t_19);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_or_pdf);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_or_pdf);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 6, __pyx_v_or_pdf);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_20);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 7, __pyx_t_20);
      __pyx_t_2 = 0;
      __pyx_t_1 = 0;
      __pyx_t_3 = 0;
      __pyx_t_17 = 0;
      __pyx_t_18 = 0;
      __pyx_t_19 = 0;
      __pyx_t_20 = 0;
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_args, __pyx_t_21) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 639, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
</pre>
    <pre class="cython line score-19"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0640</span>:                                              <span class="n">i</span><span class="p">))[</span><span
            class="mf">0</span><span class="p">]</span></pre>
    <pre class='cython code score-19 '>      __pyx_t_20 = <span
            class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 640, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
/* â€¦ */
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_21, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 640, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
      __pyx_t_22 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_4); if (unlikely((__pyx_t_22 == (double)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 640, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0641</span>: </pre>
    <pre class="cython line score-2"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0642</span>:     <span class="k">return</span> <span class="n">Z</span></pre>
    <pre class='cython code score-2 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_Z, PyBUF_WRITABLE);<span
            class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 642, __pyx_L1_error)</span>
  __pyx_r = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
  goto __pyx_L0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0643</span>: </pre>
    <pre class="cython line score-19"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0644</span>: <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:,:]</span> <span
            class="n">DBLQUAD_Z_AF_VZA</span><span class="p">(</span><span class="nb">int</span><span
            class="p">[:]</span> <span class="n">nmax</span><span class="p">,</span> <span class="n">double</span><span
            class="p">[:]</span> <span class="n">wavelength</span><span class="p">,</span> <span class="n">double</span><span
            class="p">[:]</span> <span class="n">izaDeg</span><span class="p">,</span> <span
            class="n">double</span><span class="p">[:]</span> <span class="n">iaaDeg</span><span
            class="p">,</span></pre>
    <pre class='cython code score-19 '>static __Pyx_memviewslice __pyx_f_6pyrism_4core_3tma_DBLQUAD_Z_AF_VZA(__Pyx_memviewslice __pyx_v_nmax, __Pyx_memviewslice __pyx_v_wavelength, __Pyx_memviewslice __pyx_v_izaDeg, __Pyx_memviewslice __pyx_v_iaaDeg, int __pyx_v_n_alpha, int __pyx_v_n_beta, PyObject *__pyx_v_or_pdf) {
  Py_ssize_t __pyx_v_x;
  Py_ssize_t __pyx_v_i;
  Py_ssize_t __pyx_v_xmax;
  PyObject *__pyx_v_Z = NULL;
  __Pyx_memviewslice __pyx_v_Z_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_r = { 0, 0, { 0 }, { 0 }, { 0 } };
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("DBLQUAD_Z_AF_VZA", 0);
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_18);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_19);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_20);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_21);
  __pyx_r.data = NULL;
  __pyx_r.memview = NULL;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.DBLQUAD_Z_AF_VZA", __pyx_clineno, __pyx_lineno, __pyx_filename);

  goto __pyx_L2;
  __pyx_L0:;
  if (unlikely(!__pyx_r.memview)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "Memoryview return value is not initialized");
  }
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_Z);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_Z_view, 1);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0645</span>:                                   <span
            class="nb">int</span> <span class="n">n_alpha</span><span class="p">,</span> <span
            class="nb">int</span> <span class="n">n_beta</span><span class="p">,</span> <span
            class="n">or_pdf</span><span class="p">):</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0646</span>:     <span
            class="sd">&quot;&quot;&quot;</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0647</span>: <span class="sd">    Integrate the phase matrix over a half sphere in vieving direction.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0648</span>: <span class="sd">    </span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0649</span>: <span class="sd">    Parameters</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0650</span>: <span class="sd">    ----------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0651</span>: <span class="sd">    nmax : int[:] </span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0652</span>: <span
            class="sd">        Nmax parameter.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0653</span>: <span
            class="sd">    wavelength : double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0654</span>: <span class="sd">        Wavelength in same unit as radius (used by function calc_nmax).</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0655</span>: <span
            class="sd">    izaDeg, iaaDeg : double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0656</span>: <span class="sd">        Incidence (iza) zenith and azimuth angle (iaa) in [DEG].</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0657</span>: <span class="sd">    n_alpha, n_beta : int</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0658</span>: <span class="sd">        Number of integration points in the alpha and beta Euler angle.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0659</span>: <span
            class="sd">    or_pdf: callable</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0660</span>: <span class="sd">        Particle orientation Probability Density Function (PDF) for orientation averaging.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0661</span>: <span class="sd">        </span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0662</span>: <span class="sd">    Returns</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0663</span>: <span class="sd">    -------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0664</span>: <span
            class="sd">    Z : MemoryView, double[:,:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0665</span>: <span class="sd">        Two dimensional integrated phase matrix.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0666</span>: <span class="sd">    </span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0667</span>: <span class="sd">    Note</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0668</span>: <span class="sd">    ----</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0669</span>: <span class="sd">    The output is a array with shape (nmax.shape[0], 16). To put it in a matrix form one must reshape it like</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0670</span>: <span class="sd">    np.reshape(Z, (nmax.shape[0], 4, 4)).</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0671</span>: <span
            class="sd">    &quot;&quot;&quot;</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0672</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">0673</span>:     <span class="k">cdef</span><span
            class="p">:</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0674</span>:         <span class="n">Py_ssize_t</span> <span
            class="n">x</span><span class="p">,</span> <span class="n">i</span></pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0675</span>:         <span class="n">Py_ssize_t</span> <span class="n">xmax</span> <span class="o">=</span> <span
            class="n">nmax</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span
            class="mf">0</span><span class="p">]</span></pre>
    <pre class='cython code score-0 '>  __pyx_v_xmax = (__pyx_v_nmax.shape[0]);
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0676</span>: </pre>
    <pre class="cython line score-42"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0677</span>:     <span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span
            class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">xmax</span><span
            class="p">,</span> <span class="mf">16</span><span class="p">),</span> <span class="n">dtype</span><span
            class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span
            class="p">)</span></pre>
    <pre class='cython code score-42 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span
            class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 677, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 677, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_xmax);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 677, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 677, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_16);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_16);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_16);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 677, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 677, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 677, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_double);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 677, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 677, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 677, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_Z = __pyx_t_5;
  __pyx_t_5 = 0;
</pre>
    <pre class="cython line score-2"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0678</span>:     <span class="k">cdef</span> <span class="kt">double</span>[<span
            class="p">:,:]</span> <span class="n">Z_view</span> <span class="o">=</span> <span class="n">Z</span></pre>
    <pre class='cython code score-2 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_Z, PyBUF_WRITABLE);<span
            class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 678, __pyx_L1_error)</span>
  __pyx_v_Z_view = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0679</span>: </pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0680</span>:     <span class="k">for</span> <span class="n">x</span> <span
            class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">xmax</span><span
            class="p">):</span></pre>
    <pre class='cython code score-0 '>  __pyx_t_7 = __pyx_v_xmax;
  __pyx_t_8 = __pyx_t_7;
  for (__pyx_t_9 = 0; __pyx_t_9 &lt; __pyx_t_8; __pyx_t_9+=1) {
    __pyx_v_x = __pyx_t_9;
</pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0681</span>:             <span class="k">for</span> <span class="n">i</span> <span
            class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">16</span><span
            class="p">):</span></pre>
    <pre class='cython code score-0 '>    for (__pyx_t_10 = 0; __pyx_t_10 &lt; 16; __pyx_t_10+=1) {
      __pyx_v_i = __pyx_t_10;
</pre>
    <pre class="cython line score-40"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0682</span>:                 <span class="n">Z_view</span><span class="p">[</span><span
            class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span
            class="n">dblquad</span><span class="p">(</span><span class="n">IFUNC_SZ_AF_VZA</span><span
            class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">2</span> <span
            class="o">*</span> <span class="n">PI</span><span class="p">,</span> <span class="k">lambda</span> <span
            class="n">x</span><span class="p">:</span> <span class="mf">0</span><span class="p">,</span> <span
            class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">PI</span><span
            class="p">,</span></pre>
    <pre class='cython code score-40 '>/* Python wrapper */
static PyObject *__pyx_pw_6pyrism_4core_3tma_16DBLQUAD_Z_AF_VZA_lambda6(PyObject *__pyx_self, PyObject *__pyx_v_x); /*proto*/
static PyMethodDef __pyx_mdef_6pyrism_4core_3tma_16DBLQUAD_Z_AF_VZA_lambda6 = {"lambda6", (PyCFunction)__pyx_pw_6pyrism_4core_3tma_16DBLQUAD_Z_AF_VZA_lambda6, METH_O, 0};
static PyObject *__pyx_pw_6pyrism_4core_3tma_16DBLQUAD_Z_AF_VZA_lambda6(PyObject *__pyx_self, PyObject *__pyx_v_x) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("lambda6 (wrapper)", 0);
  __pyx_r = __pyx_lambda_funcdef_lambda6(__pyx_self, ((PyObject *)__pyx_v_x));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_lambda_funcdef_lambda6(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_x) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("lambda6", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  __pyx_r = __pyx_int_0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6pyrism_4core_3tma_16DBLQUAD_Z_AF_VZA_1lambda7(PyObject *__pyx_self, PyObject *__pyx_v_x); /*proto*/
static PyMethodDef __pyx_mdef_6pyrism_4core_3tma_16DBLQUAD_Z_AF_VZA_1lambda7 = {"lambda7", (PyCFunction)__pyx_pw_6pyrism_4core_3tma_16DBLQUAD_Z_AF_VZA_1lambda7, METH_O, 0};
static PyObject *__pyx_pw_6pyrism_4core_3tma_16DBLQUAD_Z_AF_VZA_1lambda7(PyObject *__pyx_self, PyObject *__pyx_v_x) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("lambda7 (wrapper)", 0);
  __pyx_r = __pyx_lambda_funcdef_lambda7(__pyx_self, ((PyObject *)__pyx_v_x));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_lambda_funcdef_lambda7(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_x) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("lambda7", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_6pyrism_4core_3tma_PI);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 682, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.DBLQUAD_Z_AF_VZA.lambda7", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* â€¦ */
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_dblquad);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 682, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_3 = __Pyx_CFunc_double____double____double____int____double____double____double____object____int____object____int___to_py(__pyx_f_6pyrism_4core_3tma_IFUNC_SZ_AF_VZA);<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 682, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((2.0 * __pyx_v_6pyrism_4core_3tma_PI));<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 682, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_6pyrism_4core_3tma_16DBLQUAD_Z_AF_VZA_lambda6, 0, __pyx_n_s_DBLQUAD_Z_AF_VZA_locals_lambda, NULL, __pyx_n_s_pyrism_core_tma, __pyx_d, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 682, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_6pyrism_4core_3tma_16DBLQUAD_Z_AF_VZA_1lambda7, 0, __pyx_n_s_DBLQUAD_Z_AF_VZA_locals_lambda, NULL, __pyx_n_s_pyrism_core_tma, __pyx_d, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 682, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 682, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 1, __pyx_int_0);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 2, __pyx_t_1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 3, __pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 4, __pyx_t_4);
      __pyx_t_3 = 0;
      __pyx_t_1 = 0;
      __pyx_t_2 = 0;
      __pyx_t_4 = 0;
/* â€¦ */
      __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_11, __pyx_t_4);<span
                class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 682, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
/* â€¦ */
      __pyx_t_23 = __pyx_v_x;
      __pyx_t_24 = __pyx_v_i;
      __pyx_t_13 = -1;
      if (__pyx_t_23 &lt; 0) {
        __pyx_t_23 += __pyx_v_Z_view.shape[0];
        if (unlikely(__pyx_t_23 &lt; 0)) __pyx_t_13 = 0;
      } else if (unlikely(__pyx_t_23 &gt;= __pyx_v_Z_view.shape[0])) __pyx_t_13 = 0;
      if (__pyx_t_24 &lt; 0) {
        __pyx_t_24 += __pyx_v_Z_view.shape[1];
        if (unlikely(__pyx_t_24 &lt; 0)) __pyx_t_13 = 1;
      } else if (unlikely(__pyx_t_24 &gt;= __pyx_v_Z_view.shape[1])) __pyx_t_13 = 1;
      if (unlikely(__pyx_t_13 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
        <span class='error_goto'>__PYX_ERR(0, 682, __pyx_L1_error)</span>
      }
      *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_Z_view.data + __pyx_t_23 * __pyx_v_Z_view.strides[0]) ) + __pyx_t_24 * __pyx_v_Z_view.strides[1]) )) = __pyx_t_22;
    }
  }
</pre>
    <pre class="cython line score-51"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0683</span>:                                        <span class="n">args</span><span
            class="o">=</span><span class="p">(</span><span class="n">nmax</span><span class="p">[</span><span
            class="n">x</span><span class="p">],</span> <span class="n">wavelength</span><span class="p">[</span><span
            class="n">x</span><span class="p">],</span> <span class="n">izaDeg</span><span class="p">[</span><span
            class="n">x</span><span class="p">],</span> <span class="n">iaaDeg</span><span class="p">[</span><span
            class="n">x</span><span class="p">],</span> <span class="n">n_alpha</span><span class="p">,</span> <span
            class="n">n_beta</span><span class="p">,</span> <span class="n">or_pdf</span><span class="p">,</span></pre>
    <pre class='cython code score-51 '>      __pyx_t_4 = <span
            class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 683, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_12 = __pyx_v_x;
      __pyx_t_13 = -1;
      if (__pyx_t_12 &lt; 0) {
        __pyx_t_12 += __pyx_v_nmax.shape[0];
        if (unlikely(__pyx_t_12 &lt; 0)) __pyx_t_13 = 0;
      } else if (unlikely(__pyx_t_12 &gt;= __pyx_v_nmax.shape[0])) __pyx_t_13 = 0;
      if (unlikely(__pyx_t_13 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
        <span class='error_goto'>__PYX_ERR(0, 683, __pyx_L1_error)</span>
      }
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>((*((int *) ( /* dim=0 */ (__pyx_v_nmax.data + __pyx_t_12 * __pyx_v_nmax.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 683, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_14 = __pyx_v_x;
      __pyx_t_13 = -1;
      if (__pyx_t_14 &lt; 0) {
        __pyx_t_14 += __pyx_v_wavelength.shape[0];
        if (unlikely(__pyx_t_14 &lt; 0)) __pyx_t_13 = 0;
      } else if (unlikely(__pyx_t_14 &gt;= __pyx_v_wavelength.shape[0])) __pyx_t_13 = 0;
      if (unlikely(__pyx_t_13 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
        <span class='error_goto'>__PYX_ERR(0, 683, __pyx_L1_error)</span>
      }
      __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_wavelength.data + __pyx_t_14 * __pyx_v_wavelength.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 683, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_15 = __pyx_v_x;
      __pyx_t_13 = -1;
      if (__pyx_t_15 &lt; 0) {
        __pyx_t_15 += __pyx_v_izaDeg.shape[0];
        if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_13 = 0;
      } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_izaDeg.shape[0])) __pyx_t_13 = 0;
      if (unlikely(__pyx_t_13 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
        <span class='error_goto'>__PYX_ERR(0, 683, __pyx_L1_error)</span>
      }
      __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_izaDeg.data + __pyx_t_15 * __pyx_v_izaDeg.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 683, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_16 = __pyx_v_x;
      __pyx_t_13 = -1;
      if (__pyx_t_16 &lt; 0) {
        __pyx_t_16 += __pyx_v_iaaDeg.shape[0];
        if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_13 = 0;
      } else if (unlikely(__pyx_t_16 &gt;= __pyx_v_iaaDeg.shape[0])) __pyx_t_13 = 0;
      if (unlikely(__pyx_t_13 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
        <span class='error_goto'>__PYX_ERR(0, 683, __pyx_L1_error)</span>
      }
      __pyx_t_17 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_iaaDeg.data + __pyx_t_16 * __pyx_v_iaaDeg.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 683, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
      __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_alpha);<span class='error_goto'> if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 683, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
      __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_beta);<span class='error_goto'> if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 683, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
/* â€¦ */
      __pyx_t_21 = <span class='py_c_api'>PyTuple_New</span>(8);<span class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 683, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 0, __pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 1, __pyx_t_1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 2, __pyx_t_3);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_17);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 3, __pyx_t_17);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_18);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 4, __pyx_t_18);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_19);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 5, __pyx_t_19);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_or_pdf);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_or_pdf);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 6, __pyx_v_or_pdf);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_20);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 7, __pyx_t_20);
      __pyx_t_2 = 0;
      __pyx_t_1 = 0;
      __pyx_t_3 = 0;
      __pyx_t_17 = 0;
      __pyx_t_18 = 0;
      __pyx_t_19 = 0;
      __pyx_t_20 = 0;
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_args, __pyx_t_21) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 683, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
</pre>
    <pre class="cython line score-19"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0684</span>:                                              <span class="n">i</span><span class="p">))[</span><span
            class="mf">0</span><span class="p">]</span></pre>
    <pre class='cython code score-19 '>      __pyx_t_20 = <span
            class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 684, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
/* â€¦ */
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_21, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 684, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
      __pyx_t_22 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_4); if (unlikely((__pyx_t_22 == (double)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 684, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0685</span>: </pre>
    <pre class="cython line score-2"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0686</span>:     <span class="k">return</span> <span class="n">Z</span></pre>
    <pre class='cython code score-2 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_Z, PyBUF_WRITABLE);<span
            class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 686, __pyx_L1_error)</span>
  __pyx_r = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
  goto __pyx_L0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0687</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">0688</span>: <span class="c"># ----------------------------------------------------------------------------------------------------------------------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0689</span>: <span class="c"># Scattering and Asymetriy Cross Section for SINGLE ORIENTATION</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0690</span>: <span class="c"># ----------------------------------------------------------------------------------------------------------------------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0691</span>: <span class="c"># Auxiliary Functions --------------------------------------------------------------------------------------------------</span></pre>
    <pre class="cython line score-33"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0692</span>: <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">IFUNC_XSEC_QS_S</span><span
            class="p">(</span><span class="n">double</span> <span class="n">vza</span><span class="p">,</span> <span
            class="n">double</span> <span class="n">vaa</span><span class="p">,</span> <span class="nb">int</span> <span
            class="n">nmax</span><span class="p">,</span> <span class="n">double</span> <span
            class="n">wavelength</span><span class="p">,</span> <span class="n">double</span> <span
            class="n">izaDeg</span><span class="p">,</span> <span class="n">double</span> <span
            class="n">iaaDeg</span><span class="p">,</span></pre>
    <pre class='cython code score-33 '>static double __pyx_f_6pyrism_4core_3tma_IFUNC_XSEC_QS_S(double __pyx_v_vza, double __pyx_v_vaa, int __pyx_v_nmax, double __pyx_v_wavelength, double __pyx_v_izaDeg, double __pyx_v_iaaDeg, double __pyx_v_alphaDeg, PyObject *__pyx_v_betaDeg, int __pyx_v_i, int __pyx_v_cos_T_sin_t) {
  double __pyx_v_vzaDeg;
  double __pyx_v_vaaDeg;
  double __pyx_v_cos_t0;
  double __pyx_v_sin_t0;
  double __pyx_v_multi;
  PyArrayObject *__pyx_v_Z = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_S = 0;
  PyArrayObject *__pyx_v_Zf = 0;
  PyArrayObject *__pyx_v_I = 0;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_I;
  __Pyx_Buffer __pyx_pybuffer_I;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_S;
  __Pyx_Buffer __pyx_pybuffer_S;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Z;
  __Pyx_Buffer __pyx_pybuffer_Z;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Zf;
  __Pyx_Buffer __pyx_pybuffer_Zf;
  double __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("IFUNC_XSEC_QS_S", 0);
  __pyx_pybuffer_Z.pybuffer.buf = NULL;
  __pyx_pybuffer_Z.refcount = 0;
  __pyx_pybuffernd_Z.data = NULL;
  __pyx_pybuffernd_Z.rcbuffer = &amp;__pyx_pybuffer_Z;
  __pyx_pybuffer_S.pybuffer.buf = NULL;
  __pyx_pybuffer_S.refcount = 0;
  __pyx_pybuffernd_S.data = NULL;
  __pyx_pybuffernd_S.rcbuffer = &amp;__pyx_pybuffer_S;
  __pyx_pybuffer_Zf.pybuffer.buf = NULL;
  __pyx_pybuffer_Zf.refcount = 0;
  __pyx_pybuffernd_Zf.data = NULL;
  __pyx_pybuffernd_Zf.rcbuffer = &amp;__pyx_pybuffer_Zf;
  __pyx_pybuffer_I.pybuffer.buf = NULL;
  __pyx_pybuffer_I.refcount = 0;
  __pyx_pybuffernd_I.data = NULL;
  __pyx_pybuffernd_I.rcbuffer = &amp;__pyx_pybuffer_I;
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_21);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_22);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_23);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_I.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_S.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Zf.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("pyrism.core.tma.IFUNC_XSEC_QS_S", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_I.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_S.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Zf.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_Z);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_S);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_Zf);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_I);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0693</span>:                             <span class="n">double</span> <span
            class="n">alphaDeg</span><span class="p">,</span> <span class="n">betaDeg</span><span
            class="p">,</span> <span class="nb">int</span> <span class="n">i</span><span class="p">,</span> <span
            class="nb">int</span> <span class="n">cos_T_sin_t</span><span class="p">):</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0694</span>:     <span class="sd">&quot;&quot;&quot;Integrate Z in Viewing Direction</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0695</span>: <span class="sd">    </span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0696</span>: <span class="sd">    Callable function for scipy.integrate.dblquad for integration of the phase matrix in viewing direction.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0697</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">0698</span>: <span class="sd">    Parameters</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0699</span>: <span class="sd">    ----------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0700</span>: <span class="sd">    nmax : int</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0701</span>: <span
            class="sd">        Nmax parameter.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0702</span>: <span
            class="sd">    wavelength : double</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0703</span>: <span class="sd">        Wavelength in same unit as radius (used by function calc_nmax).</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0704</span>: <span class="sd">    izaDeg, vzaDeg, iaaDeg, vaaDeg : double</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0705</span>: <span class="sd">        Incidence (iza) and scattering (vza) zenith angle and incidence and viewing</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0706</span>: <span class="sd">        azimuth angle (ira, vra) in [DEG].</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0707</span>: <span
            class="sd">    alphaDeg, betaDeg: double</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0708</span>: <span class="sd">        The Euler angles of the particle orientation in [DEG].</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0709</span>: <span class="sd">    i : int</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0710</span>: <span class="sd">        Number between 0 and 15 which defines the matrix element that will be integrated.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0711</span>: <span
            class="sd">    cos_T_sin_t : int</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0712</span>: <span class="sd">        True for the calculation of the asymetry factor. This adds another term as sin(vza) to the end of the </span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0713</span>: <span
            class="sd">        integration.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0714</span>: <span class="sd">        </span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0715</span>: <span class="sd">    Returns</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0716</span>: <span class="sd">    -------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0717</span>: <span class="sd">    Z : double</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0718</span>: <span class="sd">        Integrated phase matrix element.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0719</span>: <span
            class="sd">    &quot;&quot;&quot;</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0720</span>:     <span class="k">cdef</span><span
            class="p">:</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0721</span>:         <span class="n">double</span> <span
            class="n">vzaDeg</span><span class="p">,</span> <span class="n">vaaDeg</span><span class="p">,</span> <span
            class="n">cos_t0</span><span class="p">,</span> <span class="n">sin_t0</span><span class="p">,</span> <span
            class="n">multi</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0722</span>:         <span class="n">np</span><span class="o">.</span><span
            class="n">ndarray</span><span class="p">[</span><span class="n">double</span><span class="p">,</span> <span
            class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span>  <span
            class="n">Z</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0723</span>:         <span class="n">np</span><span class="o">.</span><span
            class="n">ndarray</span><span class="p">[</span><span class="n">DTYPE_t</span><span class="p">,</span> <span
            class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span>  <span
            class="n">S</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0724</span>:         <span class="n">np</span><span class="o">.</span><span
            class="n">ndarray</span><span class="p">[</span><span class="n">double</span><span class="p">,</span> <span
            class="n">ndim</span><span class="o">=</span><span class="mf">1</span><span class="p">]</span>  <span
            class="n">Zf</span><span class="p">,</span> <span class="n">I</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0725</span>: </pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0726</span>:     <span class="n">vzaDeg</span><span class="p">,</span> <span
            class="n">vaaDeg</span> <span class="o">=</span> <span class="n">vza</span> <span class="o">*</span> <span
            class="n">RAD_TO_DEG</span><span class="p">,</span> <span class="n">vaa</span> <span
            class="o">*</span> <span class="n">RAD_TO_DEG</span></pre>
    <pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_vza * __pyx_v_6pyrism_4core_3tma_RAD_TO_DEG);
  __pyx_t_2 = (__pyx_v_vaa * __pyx_v_6pyrism_4core_3tma_RAD_TO_DEG);
  __pyx_v_vzaDeg = __pyx_t_1;
  __pyx_v_vaaDeg = __pyx_t_2;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0727</span>: </pre>
    <pre class="cython line score-65"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0728</span>:     <span class="n">S</span><span class="p">,</span> <span class="n">Z</span> <span
            class="o">=</span> <span class="n">SZ_S</span><span class="p">(</span><span class="n">nmax</span><span
            class="p">,</span> <span class="n">wavelength</span><span class="p">,</span> <span
            class="n">izaDeg</span><span class="p">,</span> <span class="n">vzaDeg</span><span class="p">,</span> <span
            class="n">iaaDeg</span><span class="p">,</span> <span class="n">vaaDeg</span><span class="p">,</span> <span
            class="n">alphaDeg</span><span class="p">,</span> <span class="n">betaDeg</span><span
            class="p">)</span></pre>
    <pre class='cython code score-65 '>  __pyx_t_2 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_v_betaDeg); if (unlikely((__pyx_t_2 == (double)-1) &amp;&amp; <span
            class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 728, __pyx_L1_error)</span>
  __pyx_t_3 = __pyx_f_6pyrism_4core_3tma_SZ_S(__pyx_v_nmax, __pyx_v_wavelength, __pyx_v_izaDeg, __pyx_v_vzaDeg, __pyx_v_iaaDeg, __pyx_v_vaaDeg, __pyx_v_alphaDeg, __pyx_t_2);<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 728, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (likely(__pyx_t_3 != Py_None)) {
    PyObject* sequence = __pyx_t_3;
    Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
    if (unlikely(size != 2)) {
      if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      <span class='error_goto'>__PYX_ERR(0, 728, __pyx_L1_error)</span>
    }
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0);
    __pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
    #else
    __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 728, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 728, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  } else {
    <span class='pyx_c_api'>__Pyx_RaiseNoneNotIterableError</span>(); <span class='error_goto'>__PYX_ERR(0, 728, __pyx_L1_error)</span>
  }
  if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span
                class='error_goto'>__PYX_ERR(0, 728, __pyx_L1_error)</span>
  if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) <span
                class='error_goto'>__PYX_ERR(0, 728, __pyx_L1_error)</span>
  __pyx_t_6 = ((PyArrayObject *)__pyx_t_4);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[2];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_S.rcbuffer-&gt;pybuffer);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_S.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_6, &amp;__Pyx_TypeInfo_nn___pyx_t_6pyrism_4core_3tma_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack);
    if (unlikely(__pyx_t_7 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_8, &amp;__pyx_t_9, &amp;__pyx_t_10);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_S.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_S, &amp;__Pyx_TypeInfo_nn___pyx_t_6pyrism_4core_3tma_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_8); Py_XDECREF(__pyx_t_9); Py_XDECREF(__pyx_t_10);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_8, __pyx_t_9, __pyx_t_10);
      }
      __pyx_t_8 = __pyx_t_9 = __pyx_t_10 = 0;
    }
    __pyx_pybuffernd_S.diminfo[0].strides = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_S.diminfo[0].shape = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_S.diminfo[1].strides = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_S.diminfo[1].shape = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.shape[1];
    if (unlikely(__pyx_t_7 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 728, __pyx_L1_error)</span>
  }
  __pyx_t_6 = 0;
  __pyx_v_S = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_11 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_11, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack);
    if (unlikely(__pyx_t_7 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_10, &amp;__pyx_t_9, &amp;__pyx_t_8);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_Z, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_10); Py_XDECREF(__pyx_t_9); Py_XDECREF(__pyx_t_8);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_10, __pyx_t_9, __pyx_t_8);
      }
      __pyx_t_10 = __pyx_t_9 = __pyx_t_8 = 0;
    }
    __pyx_pybuffernd_Z.diminfo[0].strides = __pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Z.diminfo[0].shape = __pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_Z.diminfo[1].strides = __pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_Z.diminfo[1].shape = __pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer.shape[1];
    if (unlikely(__pyx_t_7 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 728, __pyx_L1_error)</span>
  }
  __pyx_t_11 = 0;
  __pyx_v_Z = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0729</span>: </pre>
    <pre class="cython line score-38"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0730</span>:     <span class="n">Zf</span> <span class="o">=</span> <span class="n">Z</span><span
            class="o">.</span><span class="n">flatten</span><span class="p">()</span></pre>
    <pre class='cython code score-38 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_Z), __pyx_n_s_flatten);<span
            class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 730, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  if (__pyx_t_4) {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 730, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  } else {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 730, __pyx_L1_error)</span>
  }
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_3) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) <span
                class='error_goto'>__PYX_ERR(0, 730, __pyx_L1_error)</span>
  __pyx_t_12 = ((PyArrayObject *)__pyx_t_3);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Zf.rcbuffer-&gt;pybuffer);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Zf.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_12, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_7 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_8, &amp;__pyx_t_9, &amp;__pyx_t_10);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Zf.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_Zf, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_8); Py_XDECREF(__pyx_t_9); Py_XDECREF(__pyx_t_10);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_8, __pyx_t_9, __pyx_t_10);
      }
      __pyx_t_8 = __pyx_t_9 = __pyx_t_10 = 0;
    }
    __pyx_pybuffernd_Zf.diminfo[0].strides = __pyx_pybuffernd_Zf.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Zf.diminfo[0].shape = __pyx_pybuffernd_Zf.rcbuffer-&gt;pybuffer.shape[0];
    if (unlikely(__pyx_t_7 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 730, __pyx_L1_error)</span>
  }
  __pyx_t_12 = 0;
  __pyx_v_Zf = ((PyArrayObject *)__pyx_t_3);
  __pyx_t_3 = 0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0731</span>: </pre>
    <pre class="cython line score-47"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0732</span>:     <span class="n">I</span> <span class="o">=</span> <span class="n">np</span><span
            class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mf">2</span><span
            class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span
            class="o">.</span><span class="n">double</span><span class="p">)</span></pre>
    <pre class='cython code score-47 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span
            class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 732, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 732, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 732, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 732, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_double);<span
                class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 732, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_13) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 732, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_tuple__22, __pyx_t_3);<span
                class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 732, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_13) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_13, __pyx_ptype_5numpy_ndarray))))) <span
                class='error_goto'>__PYX_ERR(0, 732, __pyx_L1_error)</span>
  __pyx_t_12 = ((PyArrayObject *)__pyx_t_13);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_I.rcbuffer-&gt;pybuffer);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_I.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_12, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_7 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_10, &amp;__pyx_t_9, &amp;__pyx_t_8);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_I.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_I, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_10); Py_XDECREF(__pyx_t_9); Py_XDECREF(__pyx_t_8);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_10, __pyx_t_9, __pyx_t_8);
      }
      __pyx_t_10 = __pyx_t_9 = __pyx_t_8 = 0;
    }
    __pyx_pybuffernd_I.diminfo[0].strides = __pyx_pybuffernd_I.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_I.diminfo[0].shape = __pyx_pybuffernd_I.rcbuffer-&gt;pybuffer.shape[0];
    if (unlikely(__pyx_t_7 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 732, __pyx_L1_error)</span>
  }
  __pyx_t_12 = 0;
  __pyx_v_I = ((PyArrayObject *)__pyx_t_13);
  __pyx_t_13 = 0;
/* â€¦ */
  __pyx_tuple__22 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_int_2);<span class='error_goto'> if (unlikely(!__pyx_tuple__22)) __PYX_ERR(0, 732, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__22);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__22);
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0733</span>: </pre>
    <pre class="cython line score-6"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0734</span>:     <span class="n">I</span><span class="p">[</span><span class="mf">0</span><span
            class="p">]</span> <span class="o">=</span> <span class="n">Zf</span><span class="p">[</span><span
            class="mf">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">Zf</span><span
            class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
    <pre class='cython code score-6 '>  __pyx_t_14 = 0;
  __pyx_t_7 = -1;
  if (__pyx_t_14 &lt; 0) {
    __pyx_t_14 += __pyx_pybuffernd_Zf.diminfo[0].shape;
    if (unlikely(__pyx_t_14 &lt; 0)) __pyx_t_7 = 0;
  } else if (unlikely(__pyx_t_14 &gt;= __pyx_pybuffernd_Zf.diminfo[0].shape)) __pyx_t_7 = 0;
  if (unlikely(__pyx_t_7 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
    <span class='error_goto'>__PYX_ERR(0, 734, __pyx_L1_error)</span>
  }
  __pyx_t_15 = 1;
  __pyx_t_7 = -1;
  if (__pyx_t_15 &lt; 0) {
    __pyx_t_15 += __pyx_pybuffernd_Zf.diminfo[0].shape;
    if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_7 = 0;
  } else if (unlikely(__pyx_t_15 &gt;= __pyx_pybuffernd_Zf.diminfo[0].shape)) __pyx_t_7 = 0;
  if (unlikely(__pyx_t_7 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
    <span class='error_goto'>__PYX_ERR(0, 734, __pyx_L1_error)</span>
  }
  __pyx_t_16 = 0;
  __pyx_t_7 = -1;
  if (__pyx_t_16 &lt; 0) {
    __pyx_t_16 += __pyx_pybuffernd_I.diminfo[0].shape;
    if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_7 = 0;
  } else if (unlikely(__pyx_t_16 &gt;= __pyx_pybuffernd_I.diminfo[0].shape)) __pyx_t_7 = 0;
  if (unlikely(__pyx_t_7 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
    <span class='error_goto'>__PYX_ERR(0, 734, __pyx_L1_error)</span>
  }
  *__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_I.rcbuffer-&gt;pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_I.diminfo[0].strides) = ((*__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_Zf.rcbuffer-&gt;pybuffer.buf, __pyx_t_14, __pyx_pybuffernd_Zf.diminfo[0].strides)) + (*__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_Zf.rcbuffer-&gt;pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_Zf.diminfo[0].strides)));
</pre>
    <pre class="cython line score-6"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0735</span>:     <span class="n">I</span><span class="p">[</span><span class="mf">1</span><span
            class="p">]</span> <span class="o">=</span> <span class="n">Zf</span><span class="p">[</span><span
            class="mf">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">Zf</span><span
            class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
    <pre class='cython code score-6 '>  __pyx_t_17 = 0;
  __pyx_t_7 = -1;
  if (__pyx_t_17 &lt; 0) {
    __pyx_t_17 += __pyx_pybuffernd_Zf.diminfo[0].shape;
    if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_7 = 0;
  } else if (unlikely(__pyx_t_17 &gt;= __pyx_pybuffernd_Zf.diminfo[0].shape)) __pyx_t_7 = 0;
  if (unlikely(__pyx_t_7 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
    <span class='error_goto'>__PYX_ERR(0, 735, __pyx_L1_error)</span>
  }
  __pyx_t_18 = 1;
  __pyx_t_7 = -1;
  if (__pyx_t_18 &lt; 0) {
    __pyx_t_18 += __pyx_pybuffernd_Zf.diminfo[0].shape;
    if (unlikely(__pyx_t_18 &lt; 0)) __pyx_t_7 = 0;
  } else if (unlikely(__pyx_t_18 &gt;= __pyx_pybuffernd_Zf.diminfo[0].shape)) __pyx_t_7 = 0;
  if (unlikely(__pyx_t_7 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
    <span class='error_goto'>__PYX_ERR(0, 735, __pyx_L1_error)</span>
  }
  __pyx_t_19 = 1;
  __pyx_t_7 = -1;
  if (__pyx_t_19 &lt; 0) {
    __pyx_t_19 += __pyx_pybuffernd_I.diminfo[0].shape;
    if (unlikely(__pyx_t_19 &lt; 0)) __pyx_t_7 = 0;
  } else if (unlikely(__pyx_t_19 &gt;= __pyx_pybuffernd_I.diminfo[0].shape)) __pyx_t_7 = 0;
  if (unlikely(__pyx_t_7 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
    <span class='error_goto'>__PYX_ERR(0, 735, __pyx_L1_error)</span>
  }
  *__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_I.rcbuffer-&gt;pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_I.diminfo[0].strides) = ((*__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_Zf.rcbuffer-&gt;pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_Zf.diminfo[0].strides)) - (*__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_Zf.rcbuffer-&gt;pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_Zf.diminfo[0].strides)));
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0736</span>: </pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0737</span>:     <span class="k">if</span> <span class="n">cos_T_sin_t</span><span
            class="p">:</span></pre>
    <pre class='cython code score-0 '>  __pyx_t_20 = (__pyx_v_cos_T_sin_t != 0);
  if (__pyx_t_20) {
/* â€¦ */
    goto __pyx_L3;
  }
</pre>
    <pre class="cython line score-60"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0738</span>:         <span class="n">cos_t0</span> <span class="o">=</span> <span
            class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span
            class="n">izaDeg</span> <span class="o">*</span> <span class="n">DEG_TO_RAD</span><span
            class="p">)</span></pre>
    <pre class='cython code score-60 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span
            class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 738, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_cos);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 738, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_izaDeg * __pyx_v_6pyrism_4core_3tma_DEG_TO_RAD));<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 738, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      }
    }
    if (!__pyx_t_4) {
      __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_3);<span
                class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 738, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    } else {
      #if CYTHON_FAST_PYCALL
      if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_5)) {
        PyObject *__pyx_temp[2] = {__pyx_t_4, __pyx_t_3};
        __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 738, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      } else
      #endif
      #if CYTHON_FAST_PYCCALL
      if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_5)) {
        PyObject *__pyx_temp[2] = {__pyx_t_4, __pyx_t_3};
        __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 738, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      } else
      #endif
      {
        __pyx_t_21 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 738, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 0, __pyx_t_4); __pyx_t_4 = NULL;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 0+1, __pyx_t_3);
        __pyx_t_3 = 0;
        __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_21, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 738, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
      }
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_2 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_13); if (unlikely((__pyx_t_2 == (double)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 738, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    __pyx_v_cos_t0 = __pyx_t_2;
</pre>
    <pre class="cython line score-60"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0739</span>:         <span class="n">sin_t0</span> <span class="o">=</span> <span
            class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span
            class="n">izaDeg</span> <span class="o">*</span> <span class="n">DEG_TO_RAD</span><span
            class="p">)</span></pre>
    <pre class='cython code score-60 '>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span
            class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 739, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_sin);<span
                class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 739, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_izaDeg * __pyx_v_6pyrism_4core_3tma_DEG_TO_RAD));<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 739, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_3 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_21))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_21);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_21);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_21, function);
      }
    }
    if (!__pyx_t_3) {
      __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_21, __pyx_t_5);<span
                class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 739, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    } else {
      #if CYTHON_FAST_PYCALL
      if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_21)) {
        PyObject *__pyx_temp[2] = {__pyx_t_3, __pyx_t_5};
        __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_21, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 739, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      } else
      #endif
      #if CYTHON_FAST_PYCCALL
      if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_21)) {
        PyObject *__pyx_temp[2] = {__pyx_t_3, __pyx_t_5};
        __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_21, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 739, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      } else
      #endif
      {
        __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 739, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3); __pyx_t_3 = NULL;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+1, __pyx_t_5);
        __pyx_t_5 = 0;
        __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_21, __pyx_t_4, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 739, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      }
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
    __pyx_t_2 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_13); if (unlikely((__pyx_t_2 == (double)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 739, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    __pyx_v_sin_t0 = __pyx_t_2;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0740</span>: </pre>
    <pre class="cython line score-85"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0741</span>:         <span class="n">multi</span> <span class="o">=</span> <span
            class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span
            class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mf">2</span> <span
            class="o">*</span> <span class="n">vza</span><span class="p">)</span> <span class="o">*</span> <span
            class="n">cos_t0</span> <span class="o">+</span></pre>
    <pre class='cython code score-85 '>    __pyx_t_21 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span
            class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 741, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_21, __pyx_n_s_sin);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 741, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
    __pyx_t_21 = <span class='py_c_api'>PyFloat_FromDouble</span>((2.0 * __pyx_v_vza));<span class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 741, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
    __pyx_t_5 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_5)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      }
    }
    if (!__pyx_t_5) {
      __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_21);<span
                class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 741, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    } else {
      #if CYTHON_FAST_PYCALL
      if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_4)) {
        PyObject *__pyx_temp[2] = {__pyx_t_5, __pyx_t_21};
        __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 741, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
      } else
      #endif
      #if CYTHON_FAST_PYCCALL
      if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_4)) {
        PyObject *__pyx_temp[2] = {__pyx_t_5, __pyx_t_21};
        __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 741, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
      } else
      #endif
      {
        __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 741, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_5); __pyx_t_5 = NULL;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_21);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+1, __pyx_t_21);
        __pyx_t_21 = 0;
        __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_3, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 741, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      }
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_cos_t0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 741, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_13, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 741, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
/* â€¦ */
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, __pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 741, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    __pyx_t_13 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_float_0_5, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 741, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_2 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_13); if (unlikely((__pyx_t_2 == (double)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 741, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    __pyx_v_multi = __pyx_t_2;
</pre>
    <pre class="cython line score-120"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0742</span>:                        <span class="p">(</span><span class="mf">1</span> <span
            class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span
            class="p">(</span><span class="mf">2</span> <span class="o">*</span> <span class="n">vza</span><span
            class="p">))</span> <span class="o">*</span> <span class="n">sin_t0</span> <span class="o">*</span> <span
            class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">((</span><span
            class="n">iaaDeg</span> <span class="o">*</span> <span class="n">DEG_TO_RAD</span><span
            class="p">)</span> <span class="o">-</span> <span class="n">vaa</span><span class="p">))</span></pre>
    <pre class='cython code score-120 '>    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span
            class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 742, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_13, __pyx_n_s_cos);<span
                class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 742, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    __pyx_t_13 = <span class='py_c_api'>PyFloat_FromDouble</span>((2.0 * __pyx_v_vza));<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 742, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    __pyx_t_5 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_21))) {
      __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_21);
      if (likely(__pyx_t_5)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_21);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_21, function);
      }
    }
    if (!__pyx_t_5) {
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_21, __pyx_t_13);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 742, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    } else {
      #if CYTHON_FAST_PYCALL
      if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_21)) {
        PyObject *__pyx_temp[2] = {__pyx_t_5, __pyx_t_13};
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_21, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 742, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
      } else
      #endif
      #if CYTHON_FAST_PYCCALL
      if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_21)) {
        PyObject *__pyx_temp[2] = {__pyx_t_5, __pyx_t_13};
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_21, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 742, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
      } else
      #endif
      {
        __pyx_t_22 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 742, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_22);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_22, 0, __pyx_t_5); __pyx_t_5 = NULL;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_13);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_22, 0+1, __pyx_t_13);
        __pyx_t_13 = 0;
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_21, __pyx_t_22, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 742, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_22); __pyx_t_22 = 0;
      }
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
    __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractCObj</span>(__pyx_int_1, __pyx_t_4, 1, 0);<span
                class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 742, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_sin_t0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 742, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_22 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_21, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 742, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_22);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_21 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 742, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_21, __pyx_n_s_cos);<span
                class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 742, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
    __pyx_t_21 = <span class='py_c_api'>PyFloat_FromDouble</span>(((__pyx_v_iaaDeg * __pyx_v_6pyrism_4core_3tma_DEG_TO_RAD) - __pyx_v_vaa));<span
                class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 742, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
    __pyx_t_5 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_13))) {
      __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_13);
      if (likely(__pyx_t_5)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_13);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_13, function);
      }
    }
    if (!__pyx_t_5) {
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_13, __pyx_t_21);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 742, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    } else {
      #if CYTHON_FAST_PYCALL
      if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_13)) {
        PyObject *__pyx_temp[2] = {__pyx_t_5, __pyx_t_21};
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_13, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 742, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
      } else
      #endif
      #if CYTHON_FAST_PYCCALL
      if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_13)) {
        PyObject *__pyx_temp[2] = {__pyx_t_5, __pyx_t_21};
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_13, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 742, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
      } else
      #endif
      {
        __pyx_t_23 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 742, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_23, 0, __pyx_t_5); __pyx_t_5 = NULL;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_21);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_23, 0+1, __pyx_t_21);
        __pyx_t_21 = 0;
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_13, __pyx_t_23, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 742, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
      }
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    __pyx_t_13 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_22, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 742, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_22); __pyx_t_22 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0743</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">0744</span>:     <span class="k">else</span><span
            class="p">:</span></pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0745</span>:         <span class="n">multi</span> <span class="o">=</span> <span
            class="n">sin</span><span class="p">(</span><span class="n">vza</span><span class="p">)</span></pre>
    <pre class='cython code score-0 '>  /*else*/ {
    __pyx_v_multi = sin(__pyx_v_vza);
  }
  __pyx_L3:;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0746</span>: </pre>
    <pre class="cython line score-2"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0747</span>:     <span class="k">return</span> <span class="n">I</span><span
            class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">multi</span></pre>
    <pre class='cython code score-2 '>  __pyx_t_24 = __pyx_v_i;
  __pyx_t_7 = -1;
  if (__pyx_t_24 &lt; 0) {
    __pyx_t_24 += __pyx_pybuffernd_I.diminfo[0].shape;
    if (unlikely(__pyx_t_24 &lt; 0)) __pyx_t_7 = 0;
  } else if (unlikely(__pyx_t_24 &gt;= __pyx_pybuffernd_I.diminfo[0].shape)) __pyx_t_7 = 0;
  if (unlikely(__pyx_t_7 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
    <span class='error_goto'>__PYX_ERR(0, 747, __pyx_L1_error)</span>
  }
  __pyx_r = ((*__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_I.rcbuffer-&gt;pybuffer.buf, __pyx_t_24, __pyx_pybuffernd_I.diminfo[0].strides)) * __pyx_v_multi);
  goto __pyx_L0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0748</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">0749</span>: <span class="c"># Scattering and Asymmetry for Single Orientation ----------------------------------------------------------------------</span></pre>
    <pre class="cython line score-19"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0750</span>: <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:,:]</span> <span
            class="n">XSEC_QS_S</span><span class="p">(</span><span class="nb">int</span><span
            class="p">[:]</span> <span class="n">nmax</span><span class="p">,</span> <span class="n">double</span><span
            class="p">[:]</span> <span class="n">wavelength</span><span class="p">,</span> <span class="n">double</span><span
            class="p">[:]</span> <span class="n">izaDeg</span><span class="p">,</span> <span
            class="n">double</span><span class="p">[:]</span> <span class="n">iaaDeg</span><span
            class="p">,</span> <span class="n">double</span><span class="p">[:]</span> <span
            class="n">alphaDeg</span><span class="p">,</span></pre>
    <pre class='cython code score-19 '>static __Pyx_memviewslice __pyx_f_6pyrism_4core_3tma_XSEC_QS_S(__Pyx_memviewslice __pyx_v_nmax, __Pyx_memviewslice __pyx_v_wavelength, __Pyx_memviewslice __pyx_v_izaDeg, __Pyx_memviewslice __pyx_v_iaaDeg, __Pyx_memviewslice __pyx_v_alphaDeg, __Pyx_memviewslice __pyx_v_betaDeg, int __pyx_v_verbose) {
  int __pyx_v_i;
  Py_ssize_t __pyx_v_x;
  Py_ssize_t __pyx_v_xmax;
  PyObject *__pyx_v_QS = NULL;
  __Pyx_memviewslice __pyx_v_QS_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_r = { 0, 0, { 0 }, { 0 }, { 0 } };
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("XSEC_QS_S", 0);
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_22);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_23);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_24);
  __pyx_r.data = NULL;
  __pyx_r.memview = NULL;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.XSEC_QS_S", __pyx_clineno, __pyx_lineno, __pyx_filename);

  goto __pyx_L2;
  __pyx_L0:;
  if (unlikely(!__pyx_r.memview)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "Memoryview return value is not initialized");
  }
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_QS);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_QS_view, 1);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0751</span>:                            <span
            class="n">double</span><span class="p">[:]</span> <span class="n">betaDeg</span><span
            class="p">,</span> <span class="nb">int</span> <span class="n">verbose</span><span class="p">):</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0752</span>:     <span class="sd">&quot;&quot;&quot;Scattering Cross Section for single orientation.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0753</span>: <span class="sd">    </span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0754</span>: <span class="sd">    Parameters</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0755</span>: <span class="sd">    ----------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0756</span>: <span class="sd">    nmax : int[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0757</span>: <span
            class="sd">        Nmax parameter.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0758</span>: <span
            class="sd">    wavelength : double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0759</span>: <span class="sd">        Wavelength in same unit as radius (used by function calc_nmax).</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0760</span>: <span class="sd">    izaDeg, vzaDeg, iaaDeg, vaaDeg : double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0761</span>: <span class="sd">        Incidence (iza) and scattering (vza) zenith angle and incidence and viewing</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0762</span>: <span class="sd">        azimuth angle (ira, vra) in [DEG].</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0763</span>: <span
            class="sd">    alphaDeg, betaDeg: double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0764</span>: <span class="sd">        The Euler angles of the particle orientation in [DEG].</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0765</span>: <span class="sd">        </span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0766</span>: <span class="sd">    Returns</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0767</span>: <span class="sd">    -------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0768</span>: <span
            class="sd">    Qs : double[:,:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0769</span>: <span class="sd">        Two dimensional scattering cross section.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0770</span>: <span
            class="sd">    &quot;&quot;&quot;</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0771</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">0772</span>:     <span class="k">cdef</span><span
            class="p">:</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0773</span>:         <span class="nb">int</span> <span
            class="n">i</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0774</span>:         <span class="n">Py_ssize_t</span> <span
            class="n">x</span></pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0775</span>:         <span class="n">Py_ssize_t</span> <span class="n">xmax</span> <span class="o">=</span> <span
            class="n">nmax</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span
            class="mf">0</span><span class="p">]</span></pre>
    <pre class='cython code score-0 '>  __pyx_v_xmax = (__pyx_v_nmax.shape[0]);
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0776</span>: </pre>
    <pre class="cython line score-42"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0777</span>:     <span class="n">QS</span> <span class="o">=</span> <span class="n">np</span><span
            class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">xmax</span><span
            class="p">,</span> <span class="mf">2</span><span class="p">),</span> <span class="n">dtype</span><span
            class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span
            class="p">)</span></pre>
    <pre class='cython code score-42 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span
            class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 777, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 777, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_xmax);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 777, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 777, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_2);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 777, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 777, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 777, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_double);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 777, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 777, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 777, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_QS = __pyx_t_5;
  __pyx_t_5 = 0;
</pre>
    <pre class="cython line score-2"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0778</span>:     <span class="k">cdef</span> <span class="kt">double</span>[<span
            class="p">:,:]</span> <span class="n">QS_view</span> <span class="o">=</span> <span
            class="n">QS</span></pre>
    <pre class='cython code score-2 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_QS, PyBUF_WRITABLE);<span
            class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 778, __pyx_L1_error)</span>
  __pyx_v_QS_view = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0779</span>: </pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0780</span>:     <span class="k">for</span> <span class="n">x</span> <span
            class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">xmax</span><span
            class="p">):</span></pre>
    <pre class='cython code score-0 '>  __pyx_t_7 = __pyx_v_xmax;
  __pyx_t_8 = __pyx_t_7;
  for (__pyx_t_9 = 0; __pyx_t_9 &lt; __pyx_t_8; __pyx_t_9+=1) {
    __pyx_v_x = __pyx_t_9;
</pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0781</span>:         <span class="k">if</span> <span class="n">verbose</span> <span
            class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
    <pre class='cython code score-0 '>    __pyx_t_10 = ((__pyx_v_verbose == 1) != 0);
    if (__pyx_t_10) {
/* â€¦ */
    }
</pre>
    <pre class="cython line score-111"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0782</span>:             <span class="n">sys</span><span class="o">.</span><span
            class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span
            class="s">&quot;</span><span class="se">\r</span><span class="s">&quot;</span> <span
            class="o">+</span> <span class="s">&quot;Computing Scattering Cross Section for Single Orientation: {0} of {1}&quot;</span><span
            class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span
            class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mf">1</span><span class="p">),</span> <span
            class="nb">str</span><span class="p">(</span><span class="n">xmax</span><span class="p">)))</span></pre>
    <pre class='cython code score-111 '>      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_sys);<span
            class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 782, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_stdout);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 782, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_write);<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 782, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_kp_s_Computing_Scattering_Cross_Secti, __pyx_n_s_format);<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 782, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_4 = <span class='py_c_api'>PyInt_FromSsize_t</span>((__pyx_v_x + 1));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 782, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)(&amp;PyString_Type)), __pyx_t_4);<span
                class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 782, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_xmax);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 782, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)(&amp;PyString_Type)), __pyx_t_4);<span
                class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 782, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = NULL;
      __pyx_t_13 = 0;
      if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
        __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
        if (likely(__pyx_t_4)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
          __pyx_t_13 = 1;
        }
      }
      #if CYTHON_FAST_PYCALL
      if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_2)) {
        PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_11, __pyx_t_12};
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_13, 2+__pyx_t_13);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 782, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      } else
      #endif
      #if CYTHON_FAST_PYCCALL
      if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_2)) {
        PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_11, __pyx_t_12};
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_13, 2+__pyx_t_13);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 782, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      } else
      #endif
      {
        __pyx_t_14 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 782, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
        if (__pyx_t_4) {
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0, __pyx_t_4); __pyx_t_4 = NULL;
        }
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0+__pyx_t_13, __pyx_t_11);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 1+__pyx_t_13, __pyx_t_12);
        __pyx_t_11 = 0;
        __pyx_t_12 = 0;
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_14, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 782, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_kp_s_, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 782, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = NULL;
      if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
        __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
        if (likely(__pyx_t_1)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        }
      }
      if (!__pyx_t_1) {
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_2);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 782, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      } else {
        #if CYTHON_FAST_PYCALL
        if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
          PyObject *__pyx_temp[2] = {__pyx_t_1, __pyx_t_2};
          __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 782, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        } else
        #endif
        #if CYTHON_FAST_PYCCALL
        if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
          PyObject *__pyx_temp[2] = {__pyx_t_1, __pyx_t_2};
          __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 782, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        } else
        #endif
        {
          __pyx_t_14 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 782, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0, __pyx_t_1); __pyx_t_1 = NULL;
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0+1, __pyx_t_2);
          __pyx_t_2 = 0;
          __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_14, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 782, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
        }
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre>
    <pre class="cython line score-25"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0783</span>:             <span class="n">sys</span><span class="o">.</span><span
            class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span></pre>
    <pre class='cython code score-25 '>      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_sys);<span
            class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 783, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_stdout);<span
                class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 783, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_14, __pyx_n_s_flush);<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 783, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
      __pyx_t_14 = NULL;
      if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
        __pyx_t_14 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
        if (likely(__pyx_t_14)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_14);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        }
      }
      if (__pyx_t_14) {
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_14);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 783, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
      } else {
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 783, __pyx_L1_error)</span>
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0784</span>: </pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0785</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span
            class="nb">range</span><span class="p">(</span><span class="mf">2</span><span class="p">):</span></pre>
    <pre class='cython code score-0 '>    for (__pyx_t_13 = 0; __pyx_t_13 &lt; 2; __pyx_t_13+=1) {
      __pyx_v_i = __pyx_t_13;
</pre>
    <pre class="cython line score-40"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0786</span>:             <span class="n">QS_view</span><span class="p">[</span><span
            class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span
            class="n">dblquad</span><span class="p">(</span><span class="n">IFUNC_XSEC_QS_S</span><span
            class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">2</span> <span
            class="o">*</span> <span class="n">PI</span><span class="p">,</span> <span class="k">lambda</span> <span
            class="n">x</span><span class="p">:</span> <span class="mf">0</span><span class="p">,</span> <span
            class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">PI</span><span
            class="p">,</span></pre>
    <pre class='cython code score-40 '>/* Python wrapper */
static PyObject *__pyx_pw_6pyrism_4core_3tma_9XSEC_QS_S_lambda8(PyObject *__pyx_self, PyObject *__pyx_v_x); /*proto*/
static PyMethodDef __pyx_mdef_6pyrism_4core_3tma_9XSEC_QS_S_lambda8 = {"lambda8", (PyCFunction)__pyx_pw_6pyrism_4core_3tma_9XSEC_QS_S_lambda8, METH_O, 0};
static PyObject *__pyx_pw_6pyrism_4core_3tma_9XSEC_QS_S_lambda8(PyObject *__pyx_self, PyObject *__pyx_v_x) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("lambda8 (wrapper)", 0);
  __pyx_r = __pyx_lambda_funcdef_lambda8(__pyx_self, ((PyObject *)__pyx_v_x));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_lambda_funcdef_lambda8(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_x) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("lambda8", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  __pyx_r = __pyx_int_0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6pyrism_4core_3tma_9XSEC_QS_S_1lambda9(PyObject *__pyx_self, PyObject *__pyx_v_x); /*proto*/
static PyMethodDef __pyx_mdef_6pyrism_4core_3tma_9XSEC_QS_S_1lambda9 = {"lambda9", (PyCFunction)__pyx_pw_6pyrism_4core_3tma_9XSEC_QS_S_1lambda9, METH_O, 0};
static PyObject *__pyx_pw_6pyrism_4core_3tma_9XSEC_QS_S_1lambda9(PyObject *__pyx_self, PyObject *__pyx_v_x) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("lambda9 (wrapper)", 0);
  __pyx_r = __pyx_lambda_funcdef_lambda9(__pyx_self, ((PyObject *)__pyx_v_x));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_lambda_funcdef_lambda9(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_x) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("lambda9", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_6pyrism_4core_3tma_PI);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 786, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.XSEC_QS_S.lambda9", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* â€¦ */
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_dblquad);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 786, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_3 = __Pyx_CFunc_double____double____double____int____double____double____double____double____object____int____int___to_py(__pyx_f_6pyrism_4core_3tma_IFUNC_XSEC_QS_S);<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 786, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_14 = <span class='py_c_api'>PyFloat_FromDouble</span>((2.0 * __pyx_v_6pyrism_4core_3tma_PI));<span
                class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 786, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_6pyrism_4core_3tma_9XSEC_QS_S_lambda8, 0, __pyx_n_s_XSEC_QS_S_locals_lambda, NULL, __pyx_n_s_pyrism_core_tma, __pyx_d, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 786, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_6pyrism_4core_3tma_9XSEC_QS_S_1lambda9, 0, __pyx_n_s_XSEC_QS_S_locals_lambda, NULL, __pyx_n_s_pyrism_core_tma, __pyx_d, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 786, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 786, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 1, __pyx_int_0);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_14);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 2, __pyx_t_14);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 3, __pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 4, __pyx_t_1);
      __pyx_t_3 = 0;
      __pyx_t_14 = 0;
      __pyx_t_2 = 0;
      __pyx_t_1 = 0;
/* â€¦ */
      __pyx_t_24 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_12, __pyx_t_1);<span
                class='error_goto'> if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 786, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_24);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* â€¦ */
      __pyx_t_26 = __pyx_v_x;
      __pyx_t_27 = __pyx_v_i;
      __pyx_t_16 = -1;
      if (__pyx_t_26 &lt; 0) {
        __pyx_t_26 += __pyx_v_QS_view.shape[0];
        if (unlikely(__pyx_t_26 &lt; 0)) __pyx_t_16 = 0;
      } else if (unlikely(__pyx_t_26 &gt;= __pyx_v_QS_view.shape[0])) __pyx_t_16 = 0;
      if (__pyx_t_27 &lt; 0) {
        __pyx_t_27 += __pyx_v_QS_view.shape[1];
        if (unlikely(__pyx_t_27 &lt; 0)) __pyx_t_16 = 1;
      } else if (unlikely(__pyx_t_27 &gt;= __pyx_v_QS_view.shape[1])) __pyx_t_16 = 1;
      if (unlikely(__pyx_t_16 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
        <span class='error_goto'>__PYX_ERR(0, 786, __pyx_L1_error)</span>
      }
      *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_QS_view.data + __pyx_t_26 * __pyx_v_QS_view.strides[0]) ) + __pyx_t_27 * __pyx_v_QS_view.strides[1]) )) = __pyx_t_25;
    }
  }
</pre>
    <pre class="cython line score-61"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0787</span>:                                            <span class="n">args</span><span class="o">=</span><span
            class="p">(</span><span class="n">nmax</span><span class="p">[</span><span class="n">x</span><span
            class="p">],</span> <span class="n">wavelength</span><span class="p">[</span><span class="n">x</span><span
            class="p">],</span> <span class="n">izaDeg</span><span class="p">[</span><span class="n">x</span><span
            class="p">],</span> <span class="n">iaaDeg</span><span class="p">[</span><span class="n">x</span><span
            class="p">],</span> <span class="n">alphaDeg</span><span class="p">[</span><span class="n">x</span><span
            class="p">],</span> <span class="n">betaDeg</span><span class="p">[</span><span class="n">x</span><span
            class="p">],</span></pre>
    <pre class='cython code score-61 '>      __pyx_t_1 = <span
            class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 787, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_15 = __pyx_v_x;
      __pyx_t_16 = -1;
      if (__pyx_t_15 &lt; 0) {
        __pyx_t_15 += __pyx_v_nmax.shape[0];
        if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_16 = 0;
      } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_nmax.shape[0])) __pyx_t_16 = 0;
      if (unlikely(__pyx_t_16 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
        <span class='error_goto'>__PYX_ERR(0, 787, __pyx_L1_error)</span>
      }
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>((*((int *) ( /* dim=0 */ (__pyx_v_nmax.data + __pyx_t_15 * __pyx_v_nmax.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 787, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_17 = __pyx_v_x;
      __pyx_t_16 = -1;
      if (__pyx_t_17 &lt; 0) {
        __pyx_t_17 += __pyx_v_wavelength.shape[0];
        if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_16 = 0;
      } else if (unlikely(__pyx_t_17 &gt;= __pyx_v_wavelength.shape[0])) __pyx_t_16 = 0;
      if (unlikely(__pyx_t_16 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
        <span class='error_goto'>__PYX_ERR(0, 787, __pyx_L1_error)</span>
      }
      __pyx_t_14 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_wavelength.data + __pyx_t_17 * __pyx_v_wavelength.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 787, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      __pyx_t_18 = __pyx_v_x;
      __pyx_t_16 = -1;
      if (__pyx_t_18 &lt; 0) {
        __pyx_t_18 += __pyx_v_izaDeg.shape[0];
        if (unlikely(__pyx_t_18 &lt; 0)) __pyx_t_16 = 0;
      } else if (unlikely(__pyx_t_18 &gt;= __pyx_v_izaDeg.shape[0])) __pyx_t_16 = 0;
      if (unlikely(__pyx_t_16 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
        <span class='error_goto'>__PYX_ERR(0, 787, __pyx_L1_error)</span>
      }
      __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_izaDeg.data + __pyx_t_18 * __pyx_v_izaDeg.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 787, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_19 = __pyx_v_x;
      __pyx_t_16 = -1;
      if (__pyx_t_19 &lt; 0) {
        __pyx_t_19 += __pyx_v_iaaDeg.shape[0];
        if (unlikely(__pyx_t_19 &lt; 0)) __pyx_t_16 = 0;
      } else if (unlikely(__pyx_t_19 &gt;= __pyx_v_iaaDeg.shape[0])) __pyx_t_16 = 0;
      if (unlikely(__pyx_t_16 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
        <span class='error_goto'>__PYX_ERR(0, 787, __pyx_L1_error)</span>
      }
      __pyx_t_11 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_iaaDeg.data + __pyx_t_19 * __pyx_v_iaaDeg.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 787, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      __pyx_t_20 = __pyx_v_x;
      __pyx_t_16 = -1;
      if (__pyx_t_20 &lt; 0) {
        __pyx_t_20 += __pyx_v_alphaDeg.shape[0];
        if (unlikely(__pyx_t_20 &lt; 0)) __pyx_t_16 = 0;
      } else if (unlikely(__pyx_t_20 &gt;= __pyx_v_alphaDeg.shape[0])) __pyx_t_16 = 0;
      if (unlikely(__pyx_t_16 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
        <span class='error_goto'>__PYX_ERR(0, 787, __pyx_L1_error)</span>
      }
      __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_alphaDeg.data + __pyx_t_20 * __pyx_v_alphaDeg.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 787, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_21 = __pyx_v_x;
      __pyx_t_16 = -1;
      if (__pyx_t_21 &lt; 0) {
        __pyx_t_21 += __pyx_v_betaDeg.shape[0];
        if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_16 = 0;
      } else if (unlikely(__pyx_t_21 &gt;= __pyx_v_betaDeg.shape[0])) __pyx_t_16 = 0;
      if (unlikely(__pyx_t_16 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
        <span class='error_goto'>__PYX_ERR(0, 787, __pyx_L1_error)</span>
      }
      __pyx_t_22 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_betaDeg.data + __pyx_t_21 * __pyx_v_betaDeg.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 787, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_22);
/* â€¦ */
      __pyx_t_24 = <span class='py_c_api'>PyTuple_New</span>(8);<span class='error_goto'> if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 787, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_24);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_24, 0, __pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_14);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_24, 1, __pyx_t_14);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_24, 2, __pyx_t_3);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_24, 3, __pyx_t_11);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_24, 4, __pyx_t_4);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_22);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_24, 5, __pyx_t_22);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_23);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_24, 6, __pyx_t_23);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_24, 7, __pyx_int_0);
      __pyx_t_2 = 0;
      __pyx_t_14 = 0;
      __pyx_t_3 = 0;
      __pyx_t_11 = 0;
      __pyx_t_4 = 0;
      __pyx_t_22 = 0;
      __pyx_t_23 = 0;
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_args, __pyx_t_24) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 787, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_24); __pyx_t_24 = 0;
</pre>
    <pre class="cython line score-16"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0788</span>:                                                  <span class="n">i</span><span
            class="p">,</span> <span class="mf">0</span><span class="p">))[</span><span class="mf">0</span><span
            class="p">]</span></pre>
    <pre class='cython code score-16 '>      __pyx_t_23 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_i);<span
            class='error_goto'> if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 788, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
/* â€¦ */
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_24, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 788, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_24); __pyx_t_24 = 0;
      __pyx_t_25 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1); if (unlikely((__pyx_t_25 == (double)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 788, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0789</span>: </pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0790</span>:     <span class="k">if</span> <span class="n">verbose</span> <span class="o">==</span> <span
            class="mf">1</span><span class="p">:</span></pre>
    <pre class='cython code score-0 '>  __pyx_t_10 = ((__pyx_v_verbose == 1) != 0);
  if (__pyx_t_10) {
/* â€¦ */
  }
</pre>
    <pre class="cython line score-17"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0791</span>:         <span class="n">sys</span><span class="o">.</span><span
            class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span
            class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span></pre>
    <pre class='cython code score-17 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_sys);<span
            class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 791, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_24 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_stdout);<span
                class='error_goto'> if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 791, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_24);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_24, __pyx_n_s_write);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 791, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_24); __pyx_t_24 = 0;
    __pyx_t_24 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_tuple__23, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 791, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_24);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_24); __pyx_t_24 = 0;
/* â€¦ */
  __pyx_tuple__23 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s__2);<span class='error_goto'> if (unlikely(!__pyx_tuple__23)) __PYX_ERR(0, 791, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__23);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__23);
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0792</span>: </pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0793</span>:     <span class="k">return</span> <span class="n">QS_view</span></pre>
    <pre class='cython code score-0 '>  __PYX_INC_MEMVIEW(&amp;__pyx_v_QS_view, 0);
  __pyx_r = __pyx_v_QS_view;
  goto __pyx_L0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0794</span>: </pre>
    <pre class="cython line score-19"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0795</span>: <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:,:]</span> <span
            class="n">XSEC_ASY_S</span><span class="p">(</span><span class="nb">int</span><span
            class="p">[:]</span> <span class="n">nmax</span><span class="p">,</span> <span class="n">double</span><span
            class="p">[:]</span> <span class="n">wavelength</span><span class="p">,</span> <span class="n">double</span><span
            class="p">[:]</span> <span class="n">izaDeg</span><span class="p">,</span> <span
            class="n">double</span><span class="p">[:]</span> <span class="n">iaaDeg</span><span
            class="p">,</span> <span class="n">double</span><span class="p">[:]</span> <span
            class="n">alphaDeg</span><span class="p">,</span></pre>
    <pre class='cython code score-19 '>static __Pyx_memviewslice __pyx_f_6pyrism_4core_3tma_XSEC_ASY_S(__Pyx_memviewslice __pyx_v_nmax, __Pyx_memviewslice __pyx_v_wavelength, __Pyx_memviewslice __pyx_v_izaDeg, __Pyx_memviewslice __pyx_v_iaaDeg, __Pyx_memviewslice __pyx_v_alphaDeg, __Pyx_memviewslice __pyx_v_betaDeg, int __pyx_v_verbose) {
  int __pyx_v_i;
  Py_ssize_t __pyx_v_x;
  Py_ssize_t __pyx_v_xmax;
  PyObject *__pyx_v_QS = NULL;
  __Pyx_memviewslice __pyx_v_QS_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_r = { 0, 0, { 0 }, { 0 }, { 0 } };
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("XSEC_ASY_S", 0);
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_22);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_23);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_24);
  __pyx_r.data = NULL;
  __pyx_r.memview = NULL;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.XSEC_ASY_S", __pyx_clineno, __pyx_lineno, __pyx_filename);

  goto __pyx_L2;
  __pyx_L0:;
  if (unlikely(!__pyx_r.memview)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "Memoryview return value is not initialized");
  }
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_QS);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_QS_view, 1);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0796</span>:                             <span class="n">double</span><span
            class="p">[:]</span> <span class="n">betaDeg</span><span class="p">,</span> <span
            class="nb">int</span> <span class="n">verbose</span><span class="p">):</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0797</span>:     <span class="sd">&quot;&quot;&quot;Asymetry Cross Section for single orientation.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0798</span>: <span class="sd">    </span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0799</span>: <span class="sd">    Parameters</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0800</span>: <span class="sd">    ----------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0801</span>: <span class="sd">    nmax : int[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0802</span>: <span
            class="sd">        Nmax parameter.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0803</span>: <span
            class="sd">    wavelength : double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0804</span>: <span class="sd">        Wavelength in same unit as radius (used by function calc_nmax).</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0805</span>: <span class="sd">    izaDeg, vzaDeg, iaaDeg, vaaDeg : double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0806</span>: <span class="sd">        Incidence (iza) and scattering (vza) zenith angle and incidence and viewing</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0807</span>: <span class="sd">        azimuth angle (ira, vra) in [DEG].</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0808</span>: <span
            class="sd">    alphaDeg, betaDeg: double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0809</span>: <span class="sd">        The Euler angles of the particle orientation in [DEG].</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0810</span>: <span class="sd">        </span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0811</span>: <span class="sd">    Returns</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0812</span>: <span class="sd">    -------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0813</span>: <span
            class="sd">    Qas : double[:,:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0814</span>: <span class="sd">        Two dimensional asymmetry cross section.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0815</span>: <span class="sd">        </span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0816</span>: <span class="sd">    Note</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0817</span>: <span class="sd">    ----</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0818</span>: <span class="sd">    To obtain the asymetry factor the output of this function must be divided through the scattering cross section.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0819</span>: <span
            class="sd">    &quot;&quot;&quot;</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0820</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">0821</span>:     <span class="k">cdef</span><span
            class="p">:</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0822</span>:         <span class="nb">int</span> <span
            class="n">i</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0823</span>:         <span class="n">Py_ssize_t</span> <span
            class="n">x</span></pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0824</span>:         <span class="n">Py_ssize_t</span> <span class="n">xmax</span> <span class="o">=</span> <span
            class="n">nmax</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span
            class="mf">0</span><span class="p">]</span></pre>
    <pre class='cython code score-0 '>  __pyx_v_xmax = (__pyx_v_nmax.shape[0]);
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0825</span>: </pre>
    <pre class="cython line score-42"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0826</span>:     <span class="n">QS</span> <span class="o">=</span> <span class="n">np</span><span
            class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">xmax</span><span
            class="p">,</span> <span class="mf">2</span><span class="p">),</span> <span class="n">dtype</span><span
            class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span
            class="p">)</span></pre>
    <pre class='cython code score-42 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span
            class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 826, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 826, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_xmax);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 826, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 826, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_2);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 826, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 826, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 826, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_double);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 826, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 826, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 826, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_QS = __pyx_t_5;
  __pyx_t_5 = 0;
</pre>
    <pre class="cython line score-2"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0827</span>:     <span class="k">cdef</span> <span class="kt">double</span>[<span
            class="p">:,:]</span> <span class="n">QS_view</span> <span class="o">=</span> <span
            class="n">QS</span></pre>
    <pre class='cython code score-2 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_QS, PyBUF_WRITABLE);<span
            class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 827, __pyx_L1_error)</span>
  __pyx_v_QS_view = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0828</span>: </pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0829</span>:     <span class="k">for</span> <span class="n">x</span> <span
            class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">xmax</span><span
            class="p">):</span></pre>
    <pre class='cython code score-0 '>  __pyx_t_7 = __pyx_v_xmax;
  __pyx_t_8 = __pyx_t_7;
  for (__pyx_t_9 = 0; __pyx_t_9 &lt; __pyx_t_8; __pyx_t_9+=1) {
    __pyx_v_x = __pyx_t_9;
</pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0830</span>:         <span class="k">if</span> <span class="n">verbose</span> <span
            class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
    <pre class='cython code score-0 '>    __pyx_t_10 = ((__pyx_v_verbose == 1) != 0);
    if (__pyx_t_10) {
/* â€¦ */
    }
</pre>
    <pre class="cython line score-111"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0831</span>:             <span class="n">sys</span><span class="o">.</span><span
            class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span
            class="s">&quot;</span><span class="se">\r</span><span class="s">&quot;</span> <span
            class="o">+</span> <span class="s">&quot;Computing Asymmetry Cross Section for Single Orientation: {0} of {1}&quot;</span><span
            class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span
            class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mf">1</span><span class="p">),</span> <span
            class="nb">str</span><span class="p">(</span><span class="n">xmax</span><span class="p">)))</span></pre>
    <pre class='cython code score-111 '>      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_sys);<span
            class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 831, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_stdout);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 831, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_write);<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 831, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_kp_s_Computing_Asymmetry_Cross_Sectio, __pyx_n_s_format);<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 831, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_4 = <span class='py_c_api'>PyInt_FromSsize_t</span>((__pyx_v_x + 1));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 831, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)(&amp;PyString_Type)), __pyx_t_4);<span
                class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 831, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_xmax);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 831, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)(&amp;PyString_Type)), __pyx_t_4);<span
                class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 831, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = NULL;
      __pyx_t_13 = 0;
      if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
        __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
        if (likely(__pyx_t_4)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
          __pyx_t_13 = 1;
        }
      }
      #if CYTHON_FAST_PYCALL
      if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_2)) {
        PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_11, __pyx_t_12};
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_13, 2+__pyx_t_13);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 831, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      } else
      #endif
      #if CYTHON_FAST_PYCCALL
      if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_2)) {
        PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_11, __pyx_t_12};
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_13, 2+__pyx_t_13);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 831, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      } else
      #endif
      {
        __pyx_t_14 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 831, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
        if (__pyx_t_4) {
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0, __pyx_t_4); __pyx_t_4 = NULL;
        }
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0+__pyx_t_13, __pyx_t_11);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 1+__pyx_t_13, __pyx_t_12);
        __pyx_t_11 = 0;
        __pyx_t_12 = 0;
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_14, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 831, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_kp_s_, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 831, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = NULL;
      if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
        __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
        if (likely(__pyx_t_1)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        }
      }
      if (!__pyx_t_1) {
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_2);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 831, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      } else {
        #if CYTHON_FAST_PYCALL
        if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
          PyObject *__pyx_temp[2] = {__pyx_t_1, __pyx_t_2};
          __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 831, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        } else
        #endif
        #if CYTHON_FAST_PYCCALL
        if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
          PyObject *__pyx_temp[2] = {__pyx_t_1, __pyx_t_2};
          __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 831, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        } else
        #endif
        {
          __pyx_t_14 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 831, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0, __pyx_t_1); __pyx_t_1 = NULL;
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0+1, __pyx_t_2);
          __pyx_t_2 = 0;
          __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_14, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 831, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
        }
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre>
    <pre class="cython line score-25"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0832</span>:             <span class="n">sys</span><span class="o">.</span><span
            class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span></pre>
    <pre class='cython code score-25 '>      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_sys);<span
            class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 832, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_stdout);<span
                class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 832, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_14, __pyx_n_s_flush);<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 832, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
      __pyx_t_14 = NULL;
      if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
        __pyx_t_14 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
        if (likely(__pyx_t_14)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_14);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        }
      }
      if (__pyx_t_14) {
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_14);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 832, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
      } else {
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 832, __pyx_L1_error)</span>
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0833</span>: </pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0834</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span
            class="nb">range</span><span class="p">(</span><span class="mf">2</span><span class="p">):</span></pre>
    <pre class='cython code score-0 '>    for (__pyx_t_13 = 0; __pyx_t_13 &lt; 2; __pyx_t_13+=1) {
      __pyx_v_i = __pyx_t_13;
</pre>
    <pre class="cython line score-40"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0835</span>:             <span class="n">QS_view</span><span class="p">[</span><span
            class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span
            class="n">dblquad</span><span class="p">(</span><span class="n">IFUNC_XSEC_QS_S</span><span
            class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">2</span> <span
            class="o">*</span> <span class="n">PI</span><span class="p">,</span> <span class="k">lambda</span> <span
            class="n">x</span><span class="p">:</span> <span class="mf">0</span><span class="p">,</span> <span
            class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">PI</span><span
            class="p">,</span></pre>
    <pre class='cython code score-40 '>/* Python wrapper */
static PyObject *__pyx_pw_6pyrism_4core_3tma_10XSEC_ASY_S_lambda10(PyObject *__pyx_self, PyObject *__pyx_v_x); /*proto*/
static PyMethodDef __pyx_mdef_6pyrism_4core_3tma_10XSEC_ASY_S_lambda10 = {"lambda10", (PyCFunction)__pyx_pw_6pyrism_4core_3tma_10XSEC_ASY_S_lambda10, METH_O, 0};
static PyObject *__pyx_pw_6pyrism_4core_3tma_10XSEC_ASY_S_lambda10(PyObject *__pyx_self, PyObject *__pyx_v_x) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("lambda10 (wrapper)", 0);
  __pyx_r = __pyx_lambda_funcdef_lambda10(__pyx_self, ((PyObject *)__pyx_v_x));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_lambda_funcdef_lambda10(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_x) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("lambda10", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  __pyx_r = __pyx_int_0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6pyrism_4core_3tma_10XSEC_ASY_S_1lambda11(PyObject *__pyx_self, PyObject *__pyx_v_x); /*proto*/
static PyMethodDef __pyx_mdef_6pyrism_4core_3tma_10XSEC_ASY_S_1lambda11 = {"lambda11", (PyCFunction)__pyx_pw_6pyrism_4core_3tma_10XSEC_ASY_S_1lambda11, METH_O, 0};
static PyObject *__pyx_pw_6pyrism_4core_3tma_10XSEC_ASY_S_1lambda11(PyObject *__pyx_self, PyObject *__pyx_v_x) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("lambda11 (wrapper)", 0);
  __pyx_r = __pyx_lambda_funcdef_lambda11(__pyx_self, ((PyObject *)__pyx_v_x));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_lambda_funcdef_lambda11(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_x) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("lambda11", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_6pyrism_4core_3tma_PI);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 835, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.XSEC_ASY_S.lambda11", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* â€¦ */
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_dblquad);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 835, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_3 = __Pyx_CFunc_double____double____double____int____double____double____double____double____object____int____int___to_py(__pyx_f_6pyrism_4core_3tma_IFUNC_XSEC_QS_S);<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 835, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_14 = <span class='py_c_api'>PyFloat_FromDouble</span>((2.0 * __pyx_v_6pyrism_4core_3tma_PI));<span
                class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 835, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_6pyrism_4core_3tma_10XSEC_ASY_S_lambda10, 0, __pyx_n_s_XSEC_ASY_S_locals_lambda, NULL, __pyx_n_s_pyrism_core_tma, __pyx_d, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 835, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_6pyrism_4core_3tma_10XSEC_ASY_S_1lambda11, 0, __pyx_n_s_XSEC_ASY_S_locals_lambda, NULL, __pyx_n_s_pyrism_core_tma, __pyx_d, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 835, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 835, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 1, __pyx_int_0);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_14);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 2, __pyx_t_14);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 3, __pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 4, __pyx_t_1);
      __pyx_t_3 = 0;
      __pyx_t_14 = 0;
      __pyx_t_2 = 0;
      __pyx_t_1 = 0;
/* â€¦ */
      __pyx_t_24 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_12, __pyx_t_1);<span
                class='error_goto'> if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 835, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_24);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* â€¦ */
      __pyx_t_26 = __pyx_v_x;
      __pyx_t_27 = __pyx_v_i;
      __pyx_t_16 = -1;
      if (__pyx_t_26 &lt; 0) {
        __pyx_t_26 += __pyx_v_QS_view.shape[0];
        if (unlikely(__pyx_t_26 &lt; 0)) __pyx_t_16 = 0;
      } else if (unlikely(__pyx_t_26 &gt;= __pyx_v_QS_view.shape[0])) __pyx_t_16 = 0;
      if (__pyx_t_27 &lt; 0) {
        __pyx_t_27 += __pyx_v_QS_view.shape[1];
        if (unlikely(__pyx_t_27 &lt; 0)) __pyx_t_16 = 1;
      } else if (unlikely(__pyx_t_27 &gt;= __pyx_v_QS_view.shape[1])) __pyx_t_16 = 1;
      if (unlikely(__pyx_t_16 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
        <span class='error_goto'>__PYX_ERR(0, 835, __pyx_L1_error)</span>
      }
      *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_QS_view.data + __pyx_t_26 * __pyx_v_QS_view.strides[0]) ) + __pyx_t_27 * __pyx_v_QS_view.strides[1]) )) = __pyx_t_25;
    }
  }
</pre>
    <pre class="cython line score-61"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0836</span>:                                            <span class="n">args</span><span class="o">=</span><span
            class="p">(</span><span class="n">nmax</span><span class="p">[</span><span class="n">x</span><span
            class="p">],</span> <span class="n">wavelength</span><span class="p">[</span><span class="n">x</span><span
            class="p">],</span> <span class="n">izaDeg</span><span class="p">[</span><span class="n">x</span><span
            class="p">],</span> <span class="n">iaaDeg</span><span class="p">[</span><span class="n">x</span><span
            class="p">],</span> <span class="n">alphaDeg</span><span class="p">[</span><span class="n">x</span><span
            class="p">],</span> <span class="n">betaDeg</span><span class="p">[</span><span class="n">x</span><span
            class="p">],</span></pre>
    <pre class='cython code score-61 '>      __pyx_t_1 = <span
            class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 836, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_15 = __pyx_v_x;
      __pyx_t_16 = -1;
      if (__pyx_t_15 &lt; 0) {
        __pyx_t_15 += __pyx_v_nmax.shape[0];
        if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_16 = 0;
      } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_nmax.shape[0])) __pyx_t_16 = 0;
      if (unlikely(__pyx_t_16 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
        <span class='error_goto'>__PYX_ERR(0, 836, __pyx_L1_error)</span>
      }
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>((*((int *) ( /* dim=0 */ (__pyx_v_nmax.data + __pyx_t_15 * __pyx_v_nmax.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 836, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_17 = __pyx_v_x;
      __pyx_t_16 = -1;
      if (__pyx_t_17 &lt; 0) {
        __pyx_t_17 += __pyx_v_wavelength.shape[0];
        if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_16 = 0;
      } else if (unlikely(__pyx_t_17 &gt;= __pyx_v_wavelength.shape[0])) __pyx_t_16 = 0;
      if (unlikely(__pyx_t_16 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
        <span class='error_goto'>__PYX_ERR(0, 836, __pyx_L1_error)</span>
      }
      __pyx_t_14 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_wavelength.data + __pyx_t_17 * __pyx_v_wavelength.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 836, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      __pyx_t_18 = __pyx_v_x;
      __pyx_t_16 = -1;
      if (__pyx_t_18 &lt; 0) {
        __pyx_t_18 += __pyx_v_izaDeg.shape[0];
        if (unlikely(__pyx_t_18 &lt; 0)) __pyx_t_16 = 0;
      } else if (unlikely(__pyx_t_18 &gt;= __pyx_v_izaDeg.shape[0])) __pyx_t_16 = 0;
      if (unlikely(__pyx_t_16 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
        <span class='error_goto'>__PYX_ERR(0, 836, __pyx_L1_error)</span>
      }
      __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_izaDeg.data + __pyx_t_18 * __pyx_v_izaDeg.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 836, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_19 = __pyx_v_x;
      __pyx_t_16 = -1;
      if (__pyx_t_19 &lt; 0) {
        __pyx_t_19 += __pyx_v_iaaDeg.shape[0];
        if (unlikely(__pyx_t_19 &lt; 0)) __pyx_t_16 = 0;
      } else if (unlikely(__pyx_t_19 &gt;= __pyx_v_iaaDeg.shape[0])) __pyx_t_16 = 0;
      if (unlikely(__pyx_t_16 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
        <span class='error_goto'>__PYX_ERR(0, 836, __pyx_L1_error)</span>
      }
      __pyx_t_11 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_iaaDeg.data + __pyx_t_19 * __pyx_v_iaaDeg.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 836, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      __pyx_t_20 = __pyx_v_x;
      __pyx_t_16 = -1;
      if (__pyx_t_20 &lt; 0) {
        __pyx_t_20 += __pyx_v_alphaDeg.shape[0];
        if (unlikely(__pyx_t_20 &lt; 0)) __pyx_t_16 = 0;
      } else if (unlikely(__pyx_t_20 &gt;= __pyx_v_alphaDeg.shape[0])) __pyx_t_16 = 0;
      if (unlikely(__pyx_t_16 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
        <span class='error_goto'>__PYX_ERR(0, 836, __pyx_L1_error)</span>
      }
      __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_alphaDeg.data + __pyx_t_20 * __pyx_v_alphaDeg.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 836, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_21 = __pyx_v_x;
      __pyx_t_16 = -1;
      if (__pyx_t_21 &lt; 0) {
        __pyx_t_21 += __pyx_v_betaDeg.shape[0];
        if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_16 = 0;
      } else if (unlikely(__pyx_t_21 &gt;= __pyx_v_betaDeg.shape[0])) __pyx_t_16 = 0;
      if (unlikely(__pyx_t_16 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
        <span class='error_goto'>__PYX_ERR(0, 836, __pyx_L1_error)</span>
      }
      __pyx_t_22 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_betaDeg.data + __pyx_t_21 * __pyx_v_betaDeg.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 836, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_22);
/* â€¦ */
      __pyx_t_24 = <span class='py_c_api'>PyTuple_New</span>(8);<span class='error_goto'> if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 836, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_24);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_24, 0, __pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_14);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_24, 1, __pyx_t_14);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_24, 2, __pyx_t_3);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_24, 3, __pyx_t_11);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_24, 4, __pyx_t_4);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_22);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_24, 5, __pyx_t_22);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_23);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_24, 6, __pyx_t_23);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_24, 7, __pyx_int_1);
      __pyx_t_2 = 0;
      __pyx_t_14 = 0;
      __pyx_t_3 = 0;
      __pyx_t_11 = 0;
      __pyx_t_4 = 0;
      __pyx_t_22 = 0;
      __pyx_t_23 = 0;
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_args, __pyx_t_24) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 836, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_24); __pyx_t_24 = 0;
</pre>
    <pre class="cython line score-16"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0837</span>:                                                  <span class="n">i</span><span
            class="p">,</span> <span class="mf">1</span><span class="p">))[</span><span class="mf">0</span><span
            class="p">]</span></pre>
    <pre class='cython code score-16 '>      __pyx_t_23 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_i);<span
            class='error_goto'> if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 837, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
/* â€¦ */
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_24, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 837, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_24); __pyx_t_24 = 0;
      __pyx_t_25 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1); if (unlikely((__pyx_t_25 == (double)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 837, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0838</span>: </pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0839</span>:     <span class="k">if</span> <span class="n">verbose</span> <span class="o">==</span> <span
            class="mf">1</span><span class="p">:</span></pre>
    <pre class='cython code score-0 '>  __pyx_t_10 = ((__pyx_v_verbose == 1) != 0);
  if (__pyx_t_10) {
/* â€¦ */
  }
</pre>
    <pre class="cython line score-17"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0840</span>:         <span class="n">sys</span><span class="o">.</span><span
            class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span
            class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span></pre>
    <pre class='cython code score-17 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_sys);<span
            class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 840, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_24 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_stdout);<span
                class='error_goto'> if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 840, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_24);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_24, __pyx_n_s_write);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 840, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_24); __pyx_t_24 = 0;
    __pyx_t_24 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_tuple__24, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 840, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_24);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_24); __pyx_t_24 = 0;
/* â€¦ */
  __pyx_tuple__24 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s__2);<span class='error_goto'> if (unlikely(!__pyx_tuple__24)) __PYX_ERR(0, 840, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__24);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__24);
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0841</span>: </pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0842</span>:     <span class="k">return</span> <span class="n">QS_view</span></pre>
    <pre class='cython code score-0 '>  __PYX_INC_MEMVIEW(&amp;__pyx_v_QS_view, 0);
  __pyx_r = __pyx_v_QS_view;
  goto __pyx_L0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0843</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">0844</span>: <span class="c"># ----------------------------------------------------------------------------------------------------------------------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0845</span>: <span class="c"># Scattering and Asymetriy Cross Section for AVERAGED FIXED ORIENTATION</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0846</span>: <span class="c"># ----------------------------------------------------------------------------------------------------------------------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0847</span>: <span class="c"># Auxiliary Functions --------------------------------------------------------------------------------------------------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0848</span>: <span
            class="c"># Averaged Fixed Orientation</span></pre>
    <pre class="cython line score-33"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0849</span>: <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">IFUNC_XSEC_QS_AF</span><span
            class="p">(</span><span class="n">double</span> <span class="n">vza</span><span class="p">,</span> <span
            class="n">double</span> <span class="n">vaa</span><span class="p">,</span> <span class="nb">int</span> <span
            class="n">nmax</span><span class="p">,</span> <span class="n">double</span> <span
            class="n">wavelength</span><span class="p">,</span> <span class="n">double</span> <span
            class="n">izaDeg</span><span class="p">,</span> <span class="n">double</span> <span
            class="n">iaaDeg</span><span class="p">,</span></pre>
    <pre class='cython code score-33 '>static double __pyx_f_6pyrism_4core_3tma_IFUNC_XSEC_QS_AF(double __pyx_v_vza, double __pyx_v_vaa, int __pyx_v_nmax, double __pyx_v_wavelength, double __pyx_v_izaDeg, double __pyx_v_iaaDeg, int __pyx_v_n_alpha, int __pyx_v_n_beta, PyObject *__pyx_v_or_pdf, int __pyx_v_i, int __pyx_v_cos_T_sin_t) {
  double __pyx_v_vzaDeg;
  double __pyx_v_vaaDeg;
  double __pyx_v_cos_t0;
  double __pyx_v_sin_t0;
  double __pyx_v_multi;
  PyArrayObject *__pyx_v_Z = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_S = 0;
  PyArrayObject *__pyx_v_Zf = 0;
  PyArrayObject *__pyx_v_I = 0;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_I;
  __Pyx_Buffer __pyx_pybuffer_I;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_S;
  __Pyx_Buffer __pyx_pybuffer_S;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Z;
  __Pyx_Buffer __pyx_pybuffer_Z;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Zf;
  __Pyx_Buffer __pyx_pybuffer_Zf;
  double __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("IFUNC_XSEC_QS_AF", 0);
  __pyx_pybuffer_Z.pybuffer.buf = NULL;
  __pyx_pybuffer_Z.refcount = 0;
  __pyx_pybuffernd_Z.data = NULL;
  __pyx_pybuffernd_Z.rcbuffer = &amp;__pyx_pybuffer_Z;
  __pyx_pybuffer_S.pybuffer.buf = NULL;
  __pyx_pybuffer_S.refcount = 0;
  __pyx_pybuffernd_S.data = NULL;
  __pyx_pybuffernd_S.rcbuffer = &amp;__pyx_pybuffer_S;
  __pyx_pybuffer_Zf.pybuffer.buf = NULL;
  __pyx_pybuffer_Zf.refcount = 0;
  __pyx_pybuffernd_Zf.data = NULL;
  __pyx_pybuffernd_Zf.rcbuffer = &amp;__pyx_pybuffer_Zf;
  __pyx_pybuffer_I.pybuffer.buf = NULL;
  __pyx_pybuffer_I.refcount = 0;
  __pyx_pybuffernd_I.data = NULL;
  __pyx_pybuffernd_I.rcbuffer = &amp;__pyx_pybuffer_I;
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_21);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_22);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_23);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_I.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_S.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Zf.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("pyrism.core.tma.IFUNC_XSEC_QS_AF", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_I.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_S.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Zf.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_Z);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_S);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_Zf);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_I);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0850</span>:                             <span
            class="nb">int</span> <span class="n">n_alpha</span><span class="p">,</span> <span
            class="nb">int</span> <span class="n">n_beta</span><span class="p">,</span> <span
            class="n">or_pdf</span><span class="p">,</span> <span class="nb">int</span> <span class="n">i</span><span
            class="p">,</span> <span class="nb">int</span> <span class="n">cos_T_sin_t</span><span
            class="p">):</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0851</span>:     <span class="sd">&quot;&quot;&quot;Integrate Z in Viewing Direction</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0852</span>: <span class="sd">    </span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0853</span>: <span class="sd">    Callable function for scipy.integrate.dblquad for integration of the phase matrix in viewing direction.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0854</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">0855</span>: <span class="sd">    Parameters</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0856</span>: <span class="sd">    ----------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0857</span>: <span class="sd">    nmax : int</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0858</span>: <span
            class="sd">        Nmax parameter.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0859</span>: <span
            class="sd">    wavelength : double</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0860</span>: <span class="sd">        Wavelength in same unit as radius (used by function calc_nmax).</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0861</span>: <span class="sd">    izaDeg, vzaDeg, iaaDeg, vaaDeg : double</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0862</span>: <span class="sd">        Incidence (iza) and scattering (vza) zenith angle and incidence and viewing</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0863</span>: <span class="sd">        azimuth angle (ira, vra) in [DEG].</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0864</span>: <span class="sd">    n_alpha, n_beta : int</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0865</span>: <span class="sd">        Number of integration points in the alpha and beta Euler angle.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0866</span>: <span
            class="sd">    or_pdf: callable</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0867</span>: <span class="sd">        Particle orientation Probability Density Function (PDF) for orientation averaging.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0868</span>: <span class="sd">    i : int</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0869</span>: <span class="sd">        Number between 0 and 15 which defines the matrix element that will be integrated.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0870</span>: <span
            class="sd">    cos_T_sin_t : int</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0871</span>: <span class="sd">        True for the calculation of the asymetry factor. This adds another term as sin(vza) to the end of the </span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0872</span>: <span
            class="sd">        integration.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0873</span>: <span class="sd">        </span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0874</span>: <span class="sd">    Returns</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0875</span>: <span class="sd">    -------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0876</span>: <span class="sd">    Z : double</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0877</span>: <span class="sd">        Integrated phase matrix element.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0878</span>: <span
            class="sd">    &quot;&quot;&quot;</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0879</span>:     <span class="k">cdef</span><span
            class="p">:</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0880</span>:         <span class="n">double</span> <span
            class="n">vzaDeg</span><span class="p">,</span> <span class="n">vaaDeg</span><span class="p">,</span> <span
            class="n">cos_t0</span><span class="p">,</span> <span class="n">sin_t0</span><span class="p">,</span> <span
            class="n">multi</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0881</span>:         <span class="n">np</span><span class="o">.</span><span
            class="n">ndarray</span><span class="p">[</span><span class="n">double</span><span class="p">,</span> <span
            class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span>  <span
            class="n">Z</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0882</span>:         <span class="n">np</span><span class="o">.</span><span
            class="n">ndarray</span><span class="p">[</span><span class="n">DTYPE_t</span><span class="p">,</span> <span
            class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span>  <span
            class="n">S</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0883</span>:         <span class="n">np</span><span class="o">.</span><span
            class="n">ndarray</span><span class="p">[</span><span class="n">double</span><span class="p">,</span> <span
            class="n">ndim</span><span class="o">=</span><span class="mf">1</span><span class="p">]</span>  <span
            class="n">Zf</span><span class="p">,</span> <span class="n">I</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0884</span>: </pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0885</span>:     <span class="n">vzaDeg</span><span class="p">,</span> <span
            class="n">vaaDeg</span> <span class="o">=</span> <span class="n">vza</span> <span class="o">*</span> <span
            class="n">RAD_TO_DEG</span><span class="p">,</span> <span class="n">vaa</span> <span
            class="o">*</span> <span class="n">RAD_TO_DEG</span></pre>
    <pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_vza * __pyx_v_6pyrism_4core_3tma_RAD_TO_DEG);
  __pyx_t_2 = (__pyx_v_vaa * __pyx_v_6pyrism_4core_3tma_RAD_TO_DEG);
  __pyx_v_vzaDeg = __pyx_t_1;
  __pyx_v_vaaDeg = __pyx_t_2;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0886</span>: </pre>
    <pre class="cython line score-55"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0887</span>:     <span class="n">S</span><span class="p">,</span> <span class="n">Z</span> <span
            class="o">=</span> <span class="n">SZ_AF</span><span class="p">(</span><span class="n">nmax</span><span
            class="p">,</span> <span class="n">wavelength</span><span class="p">,</span> <span
            class="n">izaDeg</span><span class="p">,</span> <span class="n">vzaDeg</span><span class="p">,</span> <span
            class="n">iaaDeg</span><span class="p">,</span> <span class="n">vaaDeg</span><span class="p">,</span> <span
            class="n">n_alpha</span><span class="p">,</span> <span class="n">n_beta</span><span class="p">,</span> <span
            class="n">or_pdf</span><span class="p">)</span></pre>
    <pre class='cython code score-55 '>  __pyx_t_3 = __pyx_f_6pyrism_4core_3tma_SZ_AF(__pyx_v_nmax, __pyx_v_wavelength, __pyx_v_izaDeg, __pyx_v_vzaDeg, __pyx_v_iaaDeg, __pyx_v_vaaDeg, __pyx_v_n_alpha, __pyx_v_n_beta, __pyx_v_or_pdf);<span
            class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 887, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (likely(__pyx_t_3 != Py_None)) {
    PyObject* sequence = __pyx_t_3;
    Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
    if (unlikely(size != 2)) {
      if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      <span class='error_goto'>__PYX_ERR(0, 887, __pyx_L1_error)</span>
    }
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0);
    __pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
    #else
    __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 887, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 887, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  } else {
    <span class='pyx_c_api'>__Pyx_RaiseNoneNotIterableError</span>(); <span class='error_goto'>__PYX_ERR(0, 887, __pyx_L1_error)</span>
  }
  if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span
                class='error_goto'>__PYX_ERR(0, 887, __pyx_L1_error)</span>
  if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) <span
                class='error_goto'>__PYX_ERR(0, 887, __pyx_L1_error)</span>
  __pyx_t_6 = ((PyArrayObject *)__pyx_t_4);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[2];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_S.rcbuffer-&gt;pybuffer);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_S.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_6, &amp;__Pyx_TypeInfo_nn___pyx_t_6pyrism_4core_3tma_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack);
    if (unlikely(__pyx_t_7 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_8, &amp;__pyx_t_9, &amp;__pyx_t_10);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_S.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_S, &amp;__Pyx_TypeInfo_nn___pyx_t_6pyrism_4core_3tma_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_8); Py_XDECREF(__pyx_t_9); Py_XDECREF(__pyx_t_10);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_8, __pyx_t_9, __pyx_t_10);
      }
      __pyx_t_8 = __pyx_t_9 = __pyx_t_10 = 0;
    }
    __pyx_pybuffernd_S.diminfo[0].strides = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_S.diminfo[0].shape = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_S.diminfo[1].strides = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_S.diminfo[1].shape = __pyx_pybuffernd_S.rcbuffer-&gt;pybuffer.shape[1];
    if (unlikely(__pyx_t_7 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 887, __pyx_L1_error)</span>
  }
  __pyx_t_6 = 0;
  __pyx_v_S = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_11 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_11, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack);
    if (unlikely(__pyx_t_7 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_10, &amp;__pyx_t_9, &amp;__pyx_t_8);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_Z, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_10); Py_XDECREF(__pyx_t_9); Py_XDECREF(__pyx_t_8);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_10, __pyx_t_9, __pyx_t_8);
      }
      __pyx_t_10 = __pyx_t_9 = __pyx_t_8 = 0;
    }
    __pyx_pybuffernd_Z.diminfo[0].strides = __pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Z.diminfo[0].shape = __pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_Z.diminfo[1].strides = __pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_Z.diminfo[1].shape = __pyx_pybuffernd_Z.rcbuffer-&gt;pybuffer.shape[1];
    if (unlikely(__pyx_t_7 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 887, __pyx_L1_error)</span>
  }
  __pyx_t_11 = 0;
  __pyx_v_Z = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0888</span>: </pre>
    <pre class="cython line score-38"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0889</span>:     <span class="n">Zf</span> <span class="o">=</span> <span class="n">Z</span><span
            class="o">.</span><span class="n">flatten</span><span class="p">()</span></pre>
    <pre class='cython code score-38 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_Z), __pyx_n_s_flatten);<span
            class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 889, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  if (__pyx_t_4) {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 889, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  } else {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 889, __pyx_L1_error)</span>
  }
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_3) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) <span
                class='error_goto'>__PYX_ERR(0, 889, __pyx_L1_error)</span>
  __pyx_t_12 = ((PyArrayObject *)__pyx_t_3);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_Zf.rcbuffer-&gt;pybuffer);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Zf.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_12, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_7 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_8, &amp;__pyx_t_9, &amp;__pyx_t_10);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_Zf.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_Zf, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_8); Py_XDECREF(__pyx_t_9); Py_XDECREF(__pyx_t_10);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_8, __pyx_t_9, __pyx_t_10);
      }
      __pyx_t_8 = __pyx_t_9 = __pyx_t_10 = 0;
    }
    __pyx_pybuffernd_Zf.diminfo[0].strides = __pyx_pybuffernd_Zf.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_Zf.diminfo[0].shape = __pyx_pybuffernd_Zf.rcbuffer-&gt;pybuffer.shape[0];
    if (unlikely(__pyx_t_7 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 889, __pyx_L1_error)</span>
  }
  __pyx_t_12 = 0;
  __pyx_v_Zf = ((PyArrayObject *)__pyx_t_3);
  __pyx_t_3 = 0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0890</span>: </pre>
    <pre class="cython line score-47"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0891</span>:     <span class="n">I</span> <span class="o">=</span> <span class="n">np</span><span
            class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mf">2</span><span
            class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span
            class="o">.</span><span class="n">double</span><span class="p">)</span></pre>
    <pre class='cython code score-47 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span
            class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 891, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 891, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 891, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 891, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_double);<span
                class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 891, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_13) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 891, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_tuple__25, __pyx_t_3);<span
                class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 891, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_13) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_13, __pyx_ptype_5numpy_ndarray))))) <span
                class='error_goto'>__PYX_ERR(0, 891, __pyx_L1_error)</span>
  __pyx_t_12 = ((PyArrayObject *)__pyx_t_13);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_I.rcbuffer-&gt;pybuffer);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_I.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_12, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_7 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_10, &amp;__pyx_t_9, &amp;__pyx_t_8);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_I.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_I, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_10); Py_XDECREF(__pyx_t_9); Py_XDECREF(__pyx_t_8);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_10, __pyx_t_9, __pyx_t_8);
      }
      __pyx_t_10 = __pyx_t_9 = __pyx_t_8 = 0;
    }
    __pyx_pybuffernd_I.diminfo[0].strides = __pyx_pybuffernd_I.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_I.diminfo[0].shape = __pyx_pybuffernd_I.rcbuffer-&gt;pybuffer.shape[0];
    if (unlikely(__pyx_t_7 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 891, __pyx_L1_error)</span>
  }
  __pyx_t_12 = 0;
  __pyx_v_I = ((PyArrayObject *)__pyx_t_13);
  __pyx_t_13 = 0;
/* â€¦ */
  __pyx_tuple__25 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_int_2);<span class='error_goto'> if (unlikely(!__pyx_tuple__25)) __PYX_ERR(0, 891, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__25);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__25);
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0892</span>: </pre>
    <pre class="cython line score-6"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0893</span>:     <span class="n">I</span><span class="p">[</span><span class="mf">0</span><span
            class="p">]</span> <span class="o">=</span> <span class="n">Zf</span><span class="p">[</span><span
            class="mf">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">Zf</span><span
            class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
    <pre class='cython code score-6 '>  __pyx_t_14 = 0;
  __pyx_t_7 = -1;
  if (__pyx_t_14 &lt; 0) {
    __pyx_t_14 += __pyx_pybuffernd_Zf.diminfo[0].shape;
    if (unlikely(__pyx_t_14 &lt; 0)) __pyx_t_7 = 0;
  } else if (unlikely(__pyx_t_14 &gt;= __pyx_pybuffernd_Zf.diminfo[0].shape)) __pyx_t_7 = 0;
  if (unlikely(__pyx_t_7 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
    <span class='error_goto'>__PYX_ERR(0, 893, __pyx_L1_error)</span>
  }
  __pyx_t_15 = 1;
  __pyx_t_7 = -1;
  if (__pyx_t_15 &lt; 0) {
    __pyx_t_15 += __pyx_pybuffernd_Zf.diminfo[0].shape;
    if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_7 = 0;
  } else if (unlikely(__pyx_t_15 &gt;= __pyx_pybuffernd_Zf.diminfo[0].shape)) __pyx_t_7 = 0;
  if (unlikely(__pyx_t_7 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
    <span class='error_goto'>__PYX_ERR(0, 893, __pyx_L1_error)</span>
  }
  __pyx_t_16 = 0;
  __pyx_t_7 = -1;
  if (__pyx_t_16 &lt; 0) {
    __pyx_t_16 += __pyx_pybuffernd_I.diminfo[0].shape;
    if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_7 = 0;
  } else if (unlikely(__pyx_t_16 &gt;= __pyx_pybuffernd_I.diminfo[0].shape)) __pyx_t_7 = 0;
  if (unlikely(__pyx_t_7 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
    <span class='error_goto'>__PYX_ERR(0, 893, __pyx_L1_error)</span>
  }
  *__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_I.rcbuffer-&gt;pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_I.diminfo[0].strides) = ((*__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_Zf.rcbuffer-&gt;pybuffer.buf, __pyx_t_14, __pyx_pybuffernd_Zf.diminfo[0].strides)) + (*__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_Zf.rcbuffer-&gt;pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_Zf.diminfo[0].strides)));
</pre>
    <pre class="cython line score-6"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0894</span>:     <span class="n">I</span><span class="p">[</span><span class="mf">1</span><span
            class="p">]</span> <span class="o">=</span> <span class="n">Zf</span><span class="p">[</span><span
            class="mf">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">Zf</span><span
            class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
    <pre class='cython code score-6 '>  __pyx_t_17 = 0;
  __pyx_t_7 = -1;
  if (__pyx_t_17 &lt; 0) {
    __pyx_t_17 += __pyx_pybuffernd_Zf.diminfo[0].shape;
    if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_7 = 0;
  } else if (unlikely(__pyx_t_17 &gt;= __pyx_pybuffernd_Zf.diminfo[0].shape)) __pyx_t_7 = 0;
  if (unlikely(__pyx_t_7 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
    <span class='error_goto'>__PYX_ERR(0, 894, __pyx_L1_error)</span>
  }
  __pyx_t_18 = 1;
  __pyx_t_7 = -1;
  if (__pyx_t_18 &lt; 0) {
    __pyx_t_18 += __pyx_pybuffernd_Zf.diminfo[0].shape;
    if (unlikely(__pyx_t_18 &lt; 0)) __pyx_t_7 = 0;
  } else if (unlikely(__pyx_t_18 &gt;= __pyx_pybuffernd_Zf.diminfo[0].shape)) __pyx_t_7 = 0;
  if (unlikely(__pyx_t_7 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
    <span class='error_goto'>__PYX_ERR(0, 894, __pyx_L1_error)</span>
  }
  __pyx_t_19 = 1;
  __pyx_t_7 = -1;
  if (__pyx_t_19 &lt; 0) {
    __pyx_t_19 += __pyx_pybuffernd_I.diminfo[0].shape;
    if (unlikely(__pyx_t_19 &lt; 0)) __pyx_t_7 = 0;
  } else if (unlikely(__pyx_t_19 &gt;= __pyx_pybuffernd_I.diminfo[0].shape)) __pyx_t_7 = 0;
  if (unlikely(__pyx_t_7 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
    <span class='error_goto'>__PYX_ERR(0, 894, __pyx_L1_error)</span>
  }
  *__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_I.rcbuffer-&gt;pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_I.diminfo[0].strides) = ((*__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_Zf.rcbuffer-&gt;pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_Zf.diminfo[0].strides)) - (*__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_Zf.rcbuffer-&gt;pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_Zf.diminfo[0].strides)));
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0895</span>: </pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0896</span>:     <span class="k">if</span> <span class="n">cos_T_sin_t</span><span
            class="p">:</span></pre>
    <pre class='cython code score-0 '>  __pyx_t_20 = (__pyx_v_cos_T_sin_t != 0);
  if (__pyx_t_20) {
/* â€¦ */
    goto __pyx_L3;
  }
</pre>
    <pre class="cython line score-60"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0897</span>:         <span class="n">cos_t0</span> <span class="o">=</span> <span
            class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span
            class="n">izaDeg</span> <span class="o">*</span> <span class="n">DEG_TO_RAD</span><span
            class="p">)</span></pre>
    <pre class='cython code score-60 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span
            class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 897, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_cos);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 897, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_izaDeg * __pyx_v_6pyrism_4core_3tma_DEG_TO_RAD));<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 897, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      }
    }
    if (!__pyx_t_4) {
      __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_3);<span
                class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 897, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    } else {
      #if CYTHON_FAST_PYCALL
      if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_5)) {
        PyObject *__pyx_temp[2] = {__pyx_t_4, __pyx_t_3};
        __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 897, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      } else
      #endif
      #if CYTHON_FAST_PYCCALL
      if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_5)) {
        PyObject *__pyx_temp[2] = {__pyx_t_4, __pyx_t_3};
        __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 897, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      } else
      #endif
      {
        __pyx_t_21 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 897, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 0, __pyx_t_4); __pyx_t_4 = NULL;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 0+1, __pyx_t_3);
        __pyx_t_3 = 0;
        __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_21, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 897, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
      }
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_2 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_13); if (unlikely((__pyx_t_2 == (double)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 897, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    __pyx_v_cos_t0 = __pyx_t_2;
</pre>
    <pre class="cython line score-60"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0898</span>:         <span class="n">sin_t0</span> <span class="o">=</span> <span
            class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span
            class="n">izaDeg</span> <span class="o">*</span> <span class="n">DEG_TO_RAD</span><span
            class="p">)</span></pre>
    <pre class='cython code score-60 '>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span
            class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 898, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_sin);<span
                class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 898, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_izaDeg * __pyx_v_6pyrism_4core_3tma_DEG_TO_RAD));<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 898, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_3 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_21))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_21);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_21);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_21, function);
      }
    }
    if (!__pyx_t_3) {
      __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_21, __pyx_t_5);<span
                class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 898, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    } else {
      #if CYTHON_FAST_PYCALL
      if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_21)) {
        PyObject *__pyx_temp[2] = {__pyx_t_3, __pyx_t_5};
        __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_21, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 898, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      } else
      #endif
      #if CYTHON_FAST_PYCCALL
      if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_21)) {
        PyObject *__pyx_temp[2] = {__pyx_t_3, __pyx_t_5};
        __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_21, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 898, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      } else
      #endif
      {
        __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 898, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3); __pyx_t_3 = NULL;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+1, __pyx_t_5);
        __pyx_t_5 = 0;
        __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_21, __pyx_t_4, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 898, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      }
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
    __pyx_t_2 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_13); if (unlikely((__pyx_t_2 == (double)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 898, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    __pyx_v_sin_t0 = __pyx_t_2;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0899</span>: </pre>
    <pre class="cython line score-85"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0900</span>:         <span class="n">multi</span> <span class="o">=</span> <span
            class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span
            class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mf">2</span> <span
            class="o">*</span> <span class="n">vza</span><span class="p">)</span> <span class="o">*</span> <span
            class="n">cos_t0</span> <span class="o">+</span></pre>
    <pre class='cython code score-85 '>    __pyx_t_21 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span
            class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 900, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_21, __pyx_n_s_sin);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 900, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
    __pyx_t_21 = <span class='py_c_api'>PyFloat_FromDouble</span>((2.0 * __pyx_v_vza));<span class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 900, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
    __pyx_t_5 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_5)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      }
    }
    if (!__pyx_t_5) {
      __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_21);<span
                class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 900, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    } else {
      #if CYTHON_FAST_PYCALL
      if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_4)) {
        PyObject *__pyx_temp[2] = {__pyx_t_5, __pyx_t_21};
        __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 900, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
      } else
      #endif
      #if CYTHON_FAST_PYCCALL
      if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_4)) {
        PyObject *__pyx_temp[2] = {__pyx_t_5, __pyx_t_21};
        __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 900, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
      } else
      #endif
      {
        __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 900, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_5); __pyx_t_5 = NULL;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_21);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+1, __pyx_t_21);
        __pyx_t_21 = 0;
        __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_3, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 900, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      }
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_cos_t0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 900, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_13, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 900, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
/* â€¦ */
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, __pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 900, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    __pyx_t_13 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_float_0_5, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 900, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_2 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_13); if (unlikely((__pyx_t_2 == (double)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 900, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    __pyx_v_multi = __pyx_t_2;
</pre>
    <pre class="cython line score-120"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0901</span>:                        <span class="p">(</span><span class="mf">1</span> <span
            class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span
            class="p">(</span><span class="mf">2</span> <span class="o">*</span> <span class="n">vza</span><span
            class="p">))</span> <span class="o">*</span> <span class="n">sin_t0</span> <span class="o">*</span> <span
            class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">((</span><span
            class="n">iaaDeg</span> <span class="o">*</span> <span class="n">DEG_TO_RAD</span><span
            class="p">)</span> <span class="o">-</span> <span class="n">vaa</span><span class="p">))</span></pre>
    <pre class='cython code score-120 '>    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span
            class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 901, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_13, __pyx_n_s_cos);<span
                class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 901, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    __pyx_t_13 = <span class='py_c_api'>PyFloat_FromDouble</span>((2.0 * __pyx_v_vza));<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 901, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    __pyx_t_5 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_21))) {
      __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_21);
      if (likely(__pyx_t_5)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_21);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_21, function);
      }
    }
    if (!__pyx_t_5) {
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_21, __pyx_t_13);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 901, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    } else {
      #if CYTHON_FAST_PYCALL
      if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_21)) {
        PyObject *__pyx_temp[2] = {__pyx_t_5, __pyx_t_13};
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_21, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 901, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
      } else
      #endif
      #if CYTHON_FAST_PYCCALL
      if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_21)) {
        PyObject *__pyx_temp[2] = {__pyx_t_5, __pyx_t_13};
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_21, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 901, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
      } else
      #endif
      {
        __pyx_t_22 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 901, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_22);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_22, 0, __pyx_t_5); __pyx_t_5 = NULL;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_13);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_22, 0+1, __pyx_t_13);
        __pyx_t_13 = 0;
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_21, __pyx_t_22, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 901, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_22); __pyx_t_22 = 0;
      }
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
    __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractCObj</span>(__pyx_int_1, __pyx_t_4, 1, 0);<span
                class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 901, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_sin_t0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 901, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_22 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_21, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 901, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_22);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_21 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 901, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_21, __pyx_n_s_cos);<span
                class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 901, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
    __pyx_t_21 = <span class='py_c_api'>PyFloat_FromDouble</span>(((__pyx_v_iaaDeg * __pyx_v_6pyrism_4core_3tma_DEG_TO_RAD) - __pyx_v_vaa));<span
                class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 901, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
    __pyx_t_5 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_13))) {
      __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_13);
      if (likely(__pyx_t_5)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_13);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_13, function);
      }
    }
    if (!__pyx_t_5) {
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_13, __pyx_t_21);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 901, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    } else {
      #if CYTHON_FAST_PYCALL
      if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_13)) {
        PyObject *__pyx_temp[2] = {__pyx_t_5, __pyx_t_21};
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_13, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 901, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
      } else
      #endif
      #if CYTHON_FAST_PYCCALL
      if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_13)) {
        PyObject *__pyx_temp[2] = {__pyx_t_5, __pyx_t_21};
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_13, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 901, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
      } else
      #endif
      {
        __pyx_t_23 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 901, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_23, 0, __pyx_t_5); __pyx_t_5 = NULL;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_21);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_23, 0+1, __pyx_t_21);
        __pyx_t_21 = 0;
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_13, __pyx_t_23, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 901, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
      }
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    __pyx_t_13 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_22, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 901, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_22); __pyx_t_22 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0902</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">0903</span>:     <span class="k">else</span><span
            class="p">:</span></pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0904</span>:         <span class="n">multi</span> <span class="o">=</span> <span
            class="n">sin</span><span class="p">(</span><span class="n">vza</span><span class="p">)</span></pre>
    <pre class='cython code score-0 '>  /*else*/ {
    __pyx_v_multi = sin(__pyx_v_vza);
  }
  __pyx_L3:;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0905</span>: </pre>
    <pre class="cython line score-2"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0906</span>:     <span class="k">return</span> <span class="n">I</span><span
            class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">multi</span></pre>
    <pre class='cython code score-2 '>  __pyx_t_24 = __pyx_v_i;
  __pyx_t_7 = -1;
  if (__pyx_t_24 &lt; 0) {
    __pyx_t_24 += __pyx_pybuffernd_I.diminfo[0].shape;
    if (unlikely(__pyx_t_24 &lt; 0)) __pyx_t_7 = 0;
  } else if (unlikely(__pyx_t_24 &gt;= __pyx_pybuffernd_I.diminfo[0].shape)) __pyx_t_7 = 0;
  if (unlikely(__pyx_t_7 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
    <span class='error_goto'>__PYX_ERR(0, 906, __pyx_L1_error)</span>
  }
  __pyx_r = ((*__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_I.rcbuffer-&gt;pybuffer.buf, __pyx_t_24, __pyx_pybuffernd_I.diminfo[0].strides)) * __pyx_v_multi);
  goto __pyx_L0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0907</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">0908</span>: <span class="c"># Scattering and Asymmetry for Averaged Fixed Orientation --------------------------------------------------------------</span></pre>
    <pre class="cython line score-19"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0909</span>: <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:,:]</span> <span
            class="n">XSEC_QS_AF</span><span class="p">(</span><span class="nb">int</span><span
            class="p">[:]</span> <span class="n">nmax</span><span class="p">,</span> <span class="n">double</span><span
            class="p">[:]</span> <span class="n">wavelength</span><span class="p">,</span> <span class="n">double</span><span
            class="p">[:]</span> <span class="n">izaDeg</span><span class="p">,</span> <span
            class="n">double</span><span class="p">[:]</span> <span class="n">iaaDeg</span><span
            class="p">,</span> <span class="nb">int</span> <span class="n">n_alpha</span><span class="p">,</span></pre>
    <pre class='cython code score-19 '>static __Pyx_memviewslice __pyx_f_6pyrism_4core_3tma_XSEC_QS_AF(__Pyx_memviewslice __pyx_v_nmax, __Pyx_memviewslice __pyx_v_wavelength, __Pyx_memviewslice __pyx_v_izaDeg, __Pyx_memviewslice __pyx_v_iaaDeg, int __pyx_v_n_alpha, int __pyx_v_n_beta, PyObject *__pyx_v_or_pdf, int __pyx_v_verbose) {
  int __pyx_v_i;
  Py_ssize_t __pyx_v_x;
  Py_ssize_t __pyx_v_xmax;
  PyObject *__pyx_v_QS = NULL;
  __Pyx_memviewslice __pyx_v_QS_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_r = { 0, 0, { 0 }, { 0 }, { 0 } };
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("XSEC_QS_AF", 0);
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_20);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_21);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_22);
  __pyx_r.data = NULL;
  __pyx_r.memview = NULL;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.XSEC_QS_AF", __pyx_clineno, __pyx_lineno, __pyx_filename);

  goto __pyx_L2;
  __pyx_L0:;
  if (unlikely(!__pyx_r.memview)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "Memoryview return value is not initialized");
  }
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_QS);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_QS_view, 1);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0910</span>:                             <span
            class="nb">int</span> <span class="n">n_beta</span><span class="p">,</span> <span
            class="n">or_pdf</span><span class="p">,</span> <span class="nb">int</span> <span
            class="n">verbose</span><span class="p">):</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0911</span>:     <span class="sd">&quot;&quot;&quot;Scattering Cross Section for Averaged Fixed Orientation.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0912</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">0913</span>: <span class="sd">    Parameters</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0914</span>: <span class="sd">    ----------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0915</span>: <span class="sd">    nmax : int[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0916</span>: <span
            class="sd">        Nmax parameter.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0917</span>: <span
            class="sd">    wavelength : double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0918</span>: <span class="sd">        Wavelength in same unit as radius (used by function calc_nmax).</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0919</span>: <span class="sd">    izaDeg, vzaDeg, iaaDeg, vaaDeg : double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0920</span>: <span class="sd">        Incidence (iza) and scattering (vza) zenith angle and incidence and viewing</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0921</span>: <span class="sd">        azimuth angle (ira, vra) in [DEG].</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0922</span>: <span class="sd">    n_alpha, n_beta : int</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0923</span>: <span class="sd">        Number of integration points in the alpha and beta Euler angle.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0924</span>: <span
            class="sd">    or_pdf: callable</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0925</span>: <span class="sd">        Particle orientation Probability Density Function (PDF) for orientation averaging.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0926</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">0927</span>: <span class="sd">    Returns</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0928</span>: <span class="sd">    -------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0929</span>: <span
            class="sd">    Qs : double[:,:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0930</span>: <span class="sd">        Two dimensional scattering cross section.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0931</span>: <span
            class="sd">    &quot;&quot;&quot;</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0932</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">0933</span>:     <span class="k">cdef</span><span
            class="p">:</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0934</span>:         <span class="nb">int</span> <span
            class="n">i</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0935</span>:         <span class="n">Py_ssize_t</span> <span
            class="n">x</span></pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0936</span>:         <span class="n">Py_ssize_t</span> <span class="n">xmax</span> <span class="o">=</span> <span
            class="n">nmax</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span
            class="mf">0</span><span class="p">]</span></pre>
    <pre class='cython code score-0 '>  __pyx_v_xmax = (__pyx_v_nmax.shape[0]);
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0937</span>: </pre>
    <pre class="cython line score-42"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0938</span>:     <span class="n">QS</span> <span class="o">=</span> <span class="n">np</span><span
            class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">xmax</span><span
            class="p">,</span> <span class="mf">2</span><span class="p">),</span> <span class="n">dtype</span><span
            class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span
            class="p">)</span></pre>
    <pre class='cython code score-42 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span
            class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 938, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 938, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_xmax);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 938, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 938, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_2);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 938, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 938, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 938, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_double);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 938, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 938, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 938, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_QS = __pyx_t_5;
  __pyx_t_5 = 0;
</pre>
    <pre class="cython line score-2"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0939</span>:     <span class="k">cdef</span> <span class="kt">double</span>[<span
            class="p">:,:]</span> <span class="n">QS_view</span> <span class="o">=</span> <span
            class="n">QS</span></pre>
    <pre class='cython code score-2 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_QS, PyBUF_WRITABLE);<span
            class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 939, __pyx_L1_error)</span>
  __pyx_v_QS_view = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0940</span>: </pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0941</span>:     <span class="k">for</span> <span class="n">x</span> <span
            class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">xmax</span><span
            class="p">):</span></pre>
    <pre class='cython code score-0 '>  __pyx_t_7 = __pyx_v_xmax;
  __pyx_t_8 = __pyx_t_7;
  for (__pyx_t_9 = 0; __pyx_t_9 &lt; __pyx_t_8; __pyx_t_9+=1) {
    __pyx_v_x = __pyx_t_9;
</pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0942</span>:         <span class="k">if</span> <span class="n">verbose</span> <span
            class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
    <pre class='cython code score-0 '>    __pyx_t_10 = ((__pyx_v_verbose == 1) != 0);
    if (__pyx_t_10) {
/* â€¦ */
    }
</pre>
    <pre class="cython line score-111"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0943</span>:             <span class="n">sys</span><span class="o">.</span><span
            class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span
            class="s">&quot;</span><span class="se">\r</span><span class="s">&quot;</span> <span
            class="o">+</span> <span class="s">&quot;Computing Scattering Cross Section for Averaged Fixed Orientation: {0} of {1}&quot;</span><span
            class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span
            class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mf">1</span><span class="p">),</span> <span
            class="nb">str</span><span class="p">(</span><span class="n">xmax</span><span class="p">)))</span></pre>
    <pre class='cython code score-111 '>      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_sys);<span
            class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 943, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_stdout);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 943, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_write);<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 943, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_kp_s_Computing_Scattering_Cross_Secti_2, __pyx_n_s_format);<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 943, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_4 = <span class='py_c_api'>PyInt_FromSsize_t</span>((__pyx_v_x + 1));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 943, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)(&amp;PyString_Type)), __pyx_t_4);<span
                class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 943, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_xmax);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 943, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)(&amp;PyString_Type)), __pyx_t_4);<span
                class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 943, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = NULL;
      __pyx_t_13 = 0;
      if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
        __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
        if (likely(__pyx_t_4)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
          __pyx_t_13 = 1;
        }
      }
      #if CYTHON_FAST_PYCALL
      if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_2)) {
        PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_11, __pyx_t_12};
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_13, 2+__pyx_t_13);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 943, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      } else
      #endif
      #if CYTHON_FAST_PYCCALL
      if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_2)) {
        PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_11, __pyx_t_12};
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_13, 2+__pyx_t_13);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 943, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      } else
      #endif
      {
        __pyx_t_14 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 943, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
        if (__pyx_t_4) {
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0, __pyx_t_4); __pyx_t_4 = NULL;
        }
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0+__pyx_t_13, __pyx_t_11);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 1+__pyx_t_13, __pyx_t_12);
        __pyx_t_11 = 0;
        __pyx_t_12 = 0;
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_14, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 943, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_kp_s_, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 943, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = NULL;
      if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
        __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
        if (likely(__pyx_t_1)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        }
      }
      if (!__pyx_t_1) {
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_2);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 943, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      } else {
        #if CYTHON_FAST_PYCALL
        if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
          PyObject *__pyx_temp[2] = {__pyx_t_1, __pyx_t_2};
          __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 943, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        } else
        #endif
        #if CYTHON_FAST_PYCCALL
        if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
          PyObject *__pyx_temp[2] = {__pyx_t_1, __pyx_t_2};
          __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 943, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        } else
        #endif
        {
          __pyx_t_14 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 943, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0, __pyx_t_1); __pyx_t_1 = NULL;
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0+1, __pyx_t_2);
          __pyx_t_2 = 0;
          __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_14, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 943, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
        }
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre>
    <pre class="cython line score-25"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0944</span>:             <span class="n">sys</span><span class="o">.</span><span
            class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span></pre>
    <pre class='cython code score-25 '>      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_sys);<span
            class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 944, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_stdout);<span
                class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 944, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_14, __pyx_n_s_flush);<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 944, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
      __pyx_t_14 = NULL;
      if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
        __pyx_t_14 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
        if (likely(__pyx_t_14)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_14);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        }
      }
      if (__pyx_t_14) {
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_14);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 944, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
      } else {
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 944, __pyx_L1_error)</span>
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0945</span>: </pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0946</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span
            class="nb">range</span><span class="p">(</span><span class="mf">2</span><span class="p">):</span></pre>
    <pre class='cython code score-0 '>    for (__pyx_t_13 = 0; __pyx_t_13 &lt; 2; __pyx_t_13+=1) {
      __pyx_v_i = __pyx_t_13;
</pre>
    <pre class="cython line score-40"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0947</span>:             <span class="n">QS_view</span><span class="p">[</span><span
            class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span
            class="n">dblquad</span><span class="p">(</span><span class="n">IFUNC_XSEC_QS_AF</span><span
            class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">2</span> <span
            class="o">*</span> <span class="n">PI</span><span class="p">,</span> <span class="k">lambda</span> <span
            class="n">x</span><span class="p">:</span> <span class="mf">0</span><span class="p">,</span> <span
            class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">PI</span><span
            class="p">,</span></pre>
    <pre class='cython code score-40 '>/* Python wrapper */
static PyObject *__pyx_pw_6pyrism_4core_3tma_10XSEC_QS_AF_lambda12(PyObject *__pyx_self, PyObject *__pyx_v_x); /*proto*/
static PyMethodDef __pyx_mdef_6pyrism_4core_3tma_10XSEC_QS_AF_lambda12 = {"lambda12", (PyCFunction)__pyx_pw_6pyrism_4core_3tma_10XSEC_QS_AF_lambda12, METH_O, 0};
static PyObject *__pyx_pw_6pyrism_4core_3tma_10XSEC_QS_AF_lambda12(PyObject *__pyx_self, PyObject *__pyx_v_x) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("lambda12 (wrapper)", 0);
  __pyx_r = __pyx_lambda_funcdef_lambda12(__pyx_self, ((PyObject *)__pyx_v_x));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_lambda_funcdef_lambda12(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_x) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("lambda12", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  __pyx_r = __pyx_int_0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6pyrism_4core_3tma_10XSEC_QS_AF_1lambda13(PyObject *__pyx_self, PyObject *__pyx_v_x); /*proto*/
static PyMethodDef __pyx_mdef_6pyrism_4core_3tma_10XSEC_QS_AF_1lambda13 = {"lambda13", (PyCFunction)__pyx_pw_6pyrism_4core_3tma_10XSEC_QS_AF_1lambda13, METH_O, 0};
static PyObject *__pyx_pw_6pyrism_4core_3tma_10XSEC_QS_AF_1lambda13(PyObject *__pyx_self, PyObject *__pyx_v_x) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("lambda13 (wrapper)", 0);
  __pyx_r = __pyx_lambda_funcdef_lambda13(__pyx_self, ((PyObject *)__pyx_v_x));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_lambda_funcdef_lambda13(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_x) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("lambda13", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_6pyrism_4core_3tma_PI);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 947, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.XSEC_QS_AF.lambda13", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* â€¦ */
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_dblquad);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 947, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_3 = __Pyx_CFunc_double____double____double____int____double____double____double____int____int____object____int____int___to_py(__pyx_f_6pyrism_4core_3tma_IFUNC_XSEC_QS_AF);<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 947, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_14 = <span class='py_c_api'>PyFloat_FromDouble</span>((2.0 * __pyx_v_6pyrism_4core_3tma_PI));<span
                class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 947, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_6pyrism_4core_3tma_10XSEC_QS_AF_lambda12, 0, __pyx_n_s_XSEC_QS_AF_locals_lambda, NULL, __pyx_n_s_pyrism_core_tma, __pyx_d, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 947, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_6pyrism_4core_3tma_10XSEC_QS_AF_1lambda13, 0, __pyx_n_s_XSEC_QS_AF_locals_lambda, NULL, __pyx_n_s_pyrism_core_tma, __pyx_d, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 947, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 947, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 1, __pyx_int_0);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_14);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 2, __pyx_t_14);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 3, __pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 4, __pyx_t_1);
      __pyx_t_3 = 0;
      __pyx_t_14 = 0;
      __pyx_t_2 = 0;
      __pyx_t_1 = 0;
/* â€¦ */
      __pyx_t_22 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_12, __pyx_t_1);<span
                class='error_goto'> if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 947, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_22);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* â€¦ */
      __pyx_t_24 = __pyx_v_x;
      __pyx_t_25 = __pyx_v_i;
      __pyx_t_16 = -1;
      if (__pyx_t_24 &lt; 0) {
        __pyx_t_24 += __pyx_v_QS_view.shape[0];
        if (unlikely(__pyx_t_24 &lt; 0)) __pyx_t_16 = 0;
      } else if (unlikely(__pyx_t_24 &gt;= __pyx_v_QS_view.shape[0])) __pyx_t_16 = 0;
      if (__pyx_t_25 &lt; 0) {
        __pyx_t_25 += __pyx_v_QS_view.shape[1];
        if (unlikely(__pyx_t_25 &lt; 0)) __pyx_t_16 = 1;
      } else if (unlikely(__pyx_t_25 &gt;= __pyx_v_QS_view.shape[1])) __pyx_t_16 = 1;
      if (unlikely(__pyx_t_16 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
        <span class='error_goto'>__PYX_ERR(0, 947, __pyx_L1_error)</span>
      }
      *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_QS_view.data + __pyx_t_24 * __pyx_v_QS_view.strides[0]) ) + __pyx_t_25 * __pyx_v_QS_view.strides[1]) )) = __pyx_t_23;
    }
  }
</pre>
    <pre class="cython line score-53"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0948</span>:                                            <span class="n">args</span><span class="o">=</span><span
            class="p">(</span><span class="n">nmax</span><span class="p">[</span><span class="n">x</span><span
            class="p">],</span> <span class="n">wavelength</span><span class="p">[</span><span class="n">x</span><span
            class="p">],</span> <span class="n">izaDeg</span><span class="p">[</span><span class="n">x</span><span
            class="p">],</span> <span class="n">iaaDeg</span><span class="p">[</span><span class="n">x</span><span
            class="p">],</span> <span class="n">n_alpha</span><span class="p">,</span> <span
            class="n">n_beta</span><span class="p">,</span> <span class="n">or_pdf</span><span class="p">,</span></pre>
    <pre class='cython code score-53 '>      __pyx_t_1 = <span
            class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 948, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_15 = __pyx_v_x;
      __pyx_t_16 = -1;
      if (__pyx_t_15 &lt; 0) {
        __pyx_t_15 += __pyx_v_nmax.shape[0];
        if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_16 = 0;
      } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_nmax.shape[0])) __pyx_t_16 = 0;
      if (unlikely(__pyx_t_16 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
        <span class='error_goto'>__PYX_ERR(0, 948, __pyx_L1_error)</span>
      }
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>((*((int *) ( /* dim=0 */ (__pyx_v_nmax.data + __pyx_t_15 * __pyx_v_nmax.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 948, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_17 = __pyx_v_x;
      __pyx_t_16 = -1;
      if (__pyx_t_17 &lt; 0) {
        __pyx_t_17 += __pyx_v_wavelength.shape[0];
        if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_16 = 0;
      } else if (unlikely(__pyx_t_17 &gt;= __pyx_v_wavelength.shape[0])) __pyx_t_16 = 0;
      if (unlikely(__pyx_t_16 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
        <span class='error_goto'>__PYX_ERR(0, 948, __pyx_L1_error)</span>
      }
      __pyx_t_14 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_wavelength.data + __pyx_t_17 * __pyx_v_wavelength.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 948, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      __pyx_t_18 = __pyx_v_x;
      __pyx_t_16 = -1;
      if (__pyx_t_18 &lt; 0) {
        __pyx_t_18 += __pyx_v_izaDeg.shape[0];
        if (unlikely(__pyx_t_18 &lt; 0)) __pyx_t_16 = 0;
      } else if (unlikely(__pyx_t_18 &gt;= __pyx_v_izaDeg.shape[0])) __pyx_t_16 = 0;
      if (unlikely(__pyx_t_16 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
        <span class='error_goto'>__PYX_ERR(0, 948, __pyx_L1_error)</span>
      }
      __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_izaDeg.data + __pyx_t_18 * __pyx_v_izaDeg.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 948, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_19 = __pyx_v_x;
      __pyx_t_16 = -1;
      if (__pyx_t_19 &lt; 0) {
        __pyx_t_19 += __pyx_v_iaaDeg.shape[0];
        if (unlikely(__pyx_t_19 &lt; 0)) __pyx_t_16 = 0;
      } else if (unlikely(__pyx_t_19 &gt;= __pyx_v_iaaDeg.shape[0])) __pyx_t_16 = 0;
      if (unlikely(__pyx_t_16 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
        <span class='error_goto'>__PYX_ERR(0, 948, __pyx_L1_error)</span>
      }
      __pyx_t_11 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_iaaDeg.data + __pyx_t_19 * __pyx_v_iaaDeg.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 948, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_alpha);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 948, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_beta);<span class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 948, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
/* â€¦ */
      __pyx_t_22 = <span class='py_c_api'>PyTuple_New</span>(9);<span class='error_goto'> if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 948, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_22);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_22, 0, __pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_14);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_22, 1, __pyx_t_14);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_22, 2, __pyx_t_3);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_22, 3, __pyx_t_11);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_22, 4, __pyx_t_4);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_20);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_22, 5, __pyx_t_20);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_or_pdf);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_or_pdf);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_22, 6, __pyx_v_or_pdf);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_21);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_22, 7, __pyx_t_21);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_22, 8, __pyx_int_0);
      __pyx_t_2 = 0;
      __pyx_t_14 = 0;
      __pyx_t_3 = 0;
      __pyx_t_11 = 0;
      __pyx_t_4 = 0;
      __pyx_t_20 = 0;
      __pyx_t_21 = 0;
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_args, __pyx_t_22) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 948, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_22); __pyx_t_22 = 0;
</pre>
    <pre class="cython line score-16"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0949</span>:                                                  <span class="n">i</span><span
            class="p">,</span> <span class="mf">0</span><span class="p">))[</span><span class="mf">0</span><span
            class="p">]</span></pre>
    <pre class='cython code score-16 '>      __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_i);<span
            class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 949, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
/* â€¦ */
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_22, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 949, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_22); __pyx_t_22 = 0;
      __pyx_t_23 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1); if (unlikely((__pyx_t_23 == (double)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 949, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0950</span>: </pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0951</span>:     <span class="k">if</span> <span class="n">verbose</span> <span class="o">==</span> <span
            class="mf">1</span><span class="p">:</span></pre>
    <pre class='cython code score-0 '>  __pyx_t_10 = ((__pyx_v_verbose == 1) != 0);
  if (__pyx_t_10) {
/* â€¦ */
  }
</pre>
    <pre class="cython line score-17"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0952</span>:         <span class="n">sys</span><span class="o">.</span><span
            class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span
            class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span></pre>
    <pre class='cython code score-17 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_sys);<span
            class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 952, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_22 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_stdout);<span
                class='error_goto'> if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 952, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_22);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_22, __pyx_n_s_write);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 952, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_22); __pyx_t_22 = 0;
    __pyx_t_22 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_tuple__26, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 952, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_22);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_22); __pyx_t_22 = 0;
/* â€¦ */
  __pyx_tuple__26 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s__2);<span class='error_goto'> if (unlikely(!__pyx_tuple__26)) __PYX_ERR(0, 952, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__26);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__26);
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0953</span>: </pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0954</span>:     <span class="k">return</span> <span class="n">QS_view</span></pre>
    <pre class='cython code score-0 '>  __PYX_INC_MEMVIEW(&amp;__pyx_v_QS_view, 0);
  __pyx_r = __pyx_v_QS_view;
  goto __pyx_L0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0955</span>: </pre>
    <pre class="cython line score-19"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0956</span>: <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:,:]</span> <span
            class="n">XSEC_ASY_AF</span><span class="p">(</span><span class="nb">int</span><span
            class="p">[:]</span> <span class="n">nmax</span><span class="p">,</span> <span class="n">double</span><span
            class="p">[:]</span> <span class="n">wavelength</span><span class="p">,</span> <span class="n">double</span><span
            class="p">[:]</span> <span class="n">izaDeg</span><span class="p">,</span> <span
            class="n">double</span><span class="p">[:]</span> <span class="n">iaaDeg</span><span
            class="p">,</span> <span class="nb">int</span> <span class="n">n_alpha</span><span class="p">,</span></pre>
    <pre class='cython code score-19 '>static __Pyx_memviewslice __pyx_f_6pyrism_4core_3tma_XSEC_ASY_AF(__Pyx_memviewslice __pyx_v_nmax, __Pyx_memviewslice __pyx_v_wavelength, __Pyx_memviewslice __pyx_v_izaDeg, __Pyx_memviewslice __pyx_v_iaaDeg, int __pyx_v_n_alpha, int __pyx_v_n_beta, PyObject *__pyx_v_or_pdf, int __pyx_v_verbose) {
  int __pyx_v_i;
  Py_ssize_t __pyx_v_x;
  Py_ssize_t __pyx_v_xmax;
  PyObject *__pyx_v_QS = NULL;
  __Pyx_memviewslice __pyx_v_QS_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_r = { 0, 0, { 0 }, { 0 }, { 0 } };
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("XSEC_ASY_AF", 0);
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_20);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_21);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_22);
  __pyx_r.data = NULL;
  __pyx_r.memview = NULL;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.XSEC_ASY_AF", __pyx_clineno, __pyx_lineno, __pyx_filename);

  goto __pyx_L2;
  __pyx_L0:;
  if (unlikely(!__pyx_r.memview)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "Memoryview return value is not initialized");
  }
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_QS);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_QS_view, 1);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0957</span>:                              <span
            class="nb">int</span> <span class="n">n_beta</span><span class="p">,</span> <span
            class="n">or_pdf</span><span class="p">,</span> <span class="nb">int</span> <span
            class="n">verbose</span><span class="p">):</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0958</span>:     <span class="sd">&quot;&quot;&quot;Scattering Cross Section for Averaged Fixed Orientation.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0959</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">0960</span>: <span class="sd">    Parameters</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0961</span>: <span class="sd">    ----------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0962</span>: <span class="sd">    nmax : int[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0963</span>: <span
            class="sd">        Nmax parameter.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0964</span>: <span
            class="sd">    wavelength : double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0965</span>: <span class="sd">        Wavelength in same unit as radius (used by function calc_nmax).</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0966</span>: <span class="sd">    izaDeg, vzaDeg, iaaDeg, vaaDeg : double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0967</span>: <span class="sd">        Incidence (iza) and scattering (vza) zenith angle and incidence and viewing</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0968</span>: <span class="sd">        azimuth angle (ira, vra) in [DEG].</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0969</span>: <span class="sd">    n_alpha, n_beta : int</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0970</span>: <span class="sd">        Number of integration points in the alpha and beta Euler angle.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0971</span>: <span
            class="sd">    or_pdf: callable</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0972</span>: <span class="sd">        Particle orientation Probability Density Function (PDF) for orientation averaging.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0973</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">0974</span>: <span class="sd">    Returns</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0975</span>: <span class="sd">    -------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0976</span>: <span
            class="sd">    Qas : double[:,:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0977</span>: <span class="sd">        Two dimensional asymmetry cross section.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0978</span>: <span
            class="sd">    &quot;&quot;&quot;</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0979</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">0980</span>:     <span class="k">cdef</span><span
            class="p">:</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0981</span>:         <span class="nb">int</span> <span
            class="n">i</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">0982</span>:         <span class="n">Py_ssize_t</span> <span
            class="n">x</span></pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0983</span>:         <span class="n">Py_ssize_t</span> <span class="n">xmax</span> <span class="o">=</span> <span
            class="n">nmax</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span
            class="mf">0</span><span class="p">]</span></pre>
    <pre class='cython code score-0 '>  __pyx_v_xmax = (__pyx_v_nmax.shape[0]);
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0984</span>: </pre>
    <pre class="cython line score-42"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0985</span>:     <span class="n">QS</span> <span class="o">=</span> <span class="n">np</span><span
            class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">xmax</span><span
            class="p">,</span> <span class="mf">2</span><span class="p">),</span> <span class="n">dtype</span><span
            class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span
            class="p">)</span></pre>
    <pre class='cython code score-42 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span
            class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 985, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 985, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_xmax);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 985, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 985, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_2);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 985, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 985, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 985, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_double);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 985, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 985, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 985, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_QS = __pyx_t_5;
  __pyx_t_5 = 0;
</pre>
    <pre class="cython line score-2"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0986</span>:     <span class="k">cdef</span> <span class="kt">double</span>[<span
            class="p">:,:]</span> <span class="n">QS_view</span> <span class="o">=</span> <span
            class="n">QS</span></pre>
    <pre class='cython code score-2 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_QS, PyBUF_WRITABLE);<span
            class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 986, __pyx_L1_error)</span>
  __pyx_v_QS_view = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0987</span>: </pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0988</span>:     <span class="k">for</span> <span class="n">x</span> <span
            class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">xmax</span><span
            class="p">):</span></pre>
    <pre class='cython code score-0 '>  __pyx_t_7 = __pyx_v_xmax;
  __pyx_t_8 = __pyx_t_7;
  for (__pyx_t_9 = 0; __pyx_t_9 &lt; __pyx_t_8; __pyx_t_9+=1) {
    __pyx_v_x = __pyx_t_9;
</pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0989</span>:         <span class="k">if</span> <span class="n">verbose</span> <span
            class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
    <pre class='cython code score-0 '>    __pyx_t_10 = ((__pyx_v_verbose == 1) != 0);
    if (__pyx_t_10) {
/* â€¦ */
    }
</pre>
    <pre class="cython line score-111"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0990</span>:             <span class="n">sys</span><span class="o">.</span><span
            class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span
            class="s">&quot;</span><span class="se">\r</span><span class="s">&quot;</span> <span
            class="o">+</span> <span class="s">&quot;Computing Asymmetry Cross Section for Averaged Fixed Orientation: {0} of {1}&quot;</span><span
            class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span
            class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mf">1</span><span class="p">),</span> <span
            class="nb">str</span><span class="p">(</span><span class="n">xmax</span><span class="p">)))</span></pre>
    <pre class='cython code score-111 '>      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_sys);<span
            class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 990, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_stdout);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 990, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_write);<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 990, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_kp_s_Computing_Asymmetry_Cross_Sectio_2, __pyx_n_s_format);<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 990, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_4 = <span class='py_c_api'>PyInt_FromSsize_t</span>((__pyx_v_x + 1));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 990, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)(&amp;PyString_Type)), __pyx_t_4);<span
                class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 990, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_xmax);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 990, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)(&amp;PyString_Type)), __pyx_t_4);<span
                class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 990, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = NULL;
      __pyx_t_13 = 0;
      if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
        __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
        if (likely(__pyx_t_4)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
          __pyx_t_13 = 1;
        }
      }
      #if CYTHON_FAST_PYCALL
      if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_2)) {
        PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_11, __pyx_t_12};
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_13, 2+__pyx_t_13);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 990, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      } else
      #endif
      #if CYTHON_FAST_PYCCALL
      if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_2)) {
        PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_11, __pyx_t_12};
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_13, 2+__pyx_t_13);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 990, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      } else
      #endif
      {
        __pyx_t_14 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 990, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
        if (__pyx_t_4) {
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0, __pyx_t_4); __pyx_t_4 = NULL;
        }
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0+__pyx_t_13, __pyx_t_11);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 1+__pyx_t_13, __pyx_t_12);
        __pyx_t_11 = 0;
        __pyx_t_12 = 0;
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_14, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 990, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_kp_s_, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 990, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = NULL;
      if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
        __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
        if (likely(__pyx_t_1)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        }
      }
      if (!__pyx_t_1) {
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_2);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 990, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      } else {
        #if CYTHON_FAST_PYCALL
        if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
          PyObject *__pyx_temp[2] = {__pyx_t_1, __pyx_t_2};
          __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 990, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        } else
        #endif
        #if CYTHON_FAST_PYCCALL
        if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
          PyObject *__pyx_temp[2] = {__pyx_t_1, __pyx_t_2};
          __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 990, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        } else
        #endif
        {
          __pyx_t_14 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 990, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0, __pyx_t_1); __pyx_t_1 = NULL;
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0+1, __pyx_t_2);
          __pyx_t_2 = 0;
          __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_14, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 990, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
        }
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre>
    <pre class="cython line score-25"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0991</span>:             <span class="n">sys</span><span class="o">.</span><span
            class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span></pre>
    <pre class='cython code score-25 '>      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_sys);<span
            class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 991, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_stdout);<span
                class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 991, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_14, __pyx_n_s_flush);<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 991, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
      __pyx_t_14 = NULL;
      if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
        __pyx_t_14 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
        if (likely(__pyx_t_14)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_14);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        }
      }
      if (__pyx_t_14) {
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_14);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 991, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
      } else {
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 991, __pyx_L1_error)</span>
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0992</span>: </pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0993</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span
            class="nb">range</span><span class="p">(</span><span class="mf">2</span><span class="p">):</span></pre>
    <pre class='cython code score-0 '>    for (__pyx_t_13 = 0; __pyx_t_13 &lt; 2; __pyx_t_13+=1) {
      __pyx_v_i = __pyx_t_13;
</pre>
    <pre class="cython line score-40"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0994</span>:             <span class="n">QS_view</span><span class="p">[</span><span
            class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span
            class="n">dblquad</span><span class="p">(</span><span class="n">IFUNC_XSEC_QS_AF</span><span
            class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">2</span> <span
            class="o">*</span> <span class="n">PI</span><span class="p">,</span> <span class="k">lambda</span> <span
            class="n">x</span><span class="p">:</span> <span class="mf">0</span><span class="p">,</span> <span
            class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">PI</span><span
            class="p">,</span></pre>
    <pre class='cython code score-40 '>/* Python wrapper */
static PyObject *__pyx_pw_6pyrism_4core_3tma_11XSEC_ASY_AF_lambda14(PyObject *__pyx_self, PyObject *__pyx_v_x); /*proto*/
static PyMethodDef __pyx_mdef_6pyrism_4core_3tma_11XSEC_ASY_AF_lambda14 = {"lambda14", (PyCFunction)__pyx_pw_6pyrism_4core_3tma_11XSEC_ASY_AF_lambda14, METH_O, 0};
static PyObject *__pyx_pw_6pyrism_4core_3tma_11XSEC_ASY_AF_lambda14(PyObject *__pyx_self, PyObject *__pyx_v_x) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("lambda14 (wrapper)", 0);
  __pyx_r = __pyx_lambda_funcdef_lambda14(__pyx_self, ((PyObject *)__pyx_v_x));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_lambda_funcdef_lambda14(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_x) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("lambda14", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  __pyx_r = __pyx_int_0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6pyrism_4core_3tma_11XSEC_ASY_AF_1lambda15(PyObject *__pyx_self, PyObject *__pyx_v_x); /*proto*/
static PyMethodDef __pyx_mdef_6pyrism_4core_3tma_11XSEC_ASY_AF_1lambda15 = {"lambda15", (PyCFunction)__pyx_pw_6pyrism_4core_3tma_11XSEC_ASY_AF_1lambda15, METH_O, 0};
static PyObject *__pyx_pw_6pyrism_4core_3tma_11XSEC_ASY_AF_1lambda15(PyObject *__pyx_self, PyObject *__pyx_v_x) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("lambda15 (wrapper)", 0);
  __pyx_r = __pyx_lambda_funcdef_lambda15(__pyx_self, ((PyObject *)__pyx_v_x));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_lambda_funcdef_lambda15(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_x) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("lambda15", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_6pyrism_4core_3tma_PI);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 994, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.XSEC_ASY_AF.lambda15", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* â€¦ */
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_dblquad);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 994, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_3 = __Pyx_CFunc_double____double____double____int____double____double____double____int____int____object____int____int___to_py(__pyx_f_6pyrism_4core_3tma_IFUNC_XSEC_QS_AF);<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 994, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_14 = <span class='py_c_api'>PyFloat_FromDouble</span>((2.0 * __pyx_v_6pyrism_4core_3tma_PI));<span
                class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 994, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_6pyrism_4core_3tma_11XSEC_ASY_AF_lambda14, 0, __pyx_n_s_XSEC_ASY_AF_locals_lambda, NULL, __pyx_n_s_pyrism_core_tma, __pyx_d, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 994, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_6pyrism_4core_3tma_11XSEC_ASY_AF_1lambda15, 0, __pyx_n_s_XSEC_ASY_AF_locals_lambda, NULL, __pyx_n_s_pyrism_core_tma, __pyx_d, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 994, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 994, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 1, __pyx_int_0);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_14);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 2, __pyx_t_14);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 3, __pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 4, __pyx_t_1);
      __pyx_t_3 = 0;
      __pyx_t_14 = 0;
      __pyx_t_2 = 0;
      __pyx_t_1 = 0;
/* â€¦ */
      __pyx_t_22 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_12, __pyx_t_1);<span
                class='error_goto'> if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 994, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_22);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* â€¦ */
      __pyx_t_24 = __pyx_v_x;
      __pyx_t_25 = __pyx_v_i;
      __pyx_t_16 = -1;
      if (__pyx_t_24 &lt; 0) {
        __pyx_t_24 += __pyx_v_QS_view.shape[0];
        if (unlikely(__pyx_t_24 &lt; 0)) __pyx_t_16 = 0;
      } else if (unlikely(__pyx_t_24 &gt;= __pyx_v_QS_view.shape[0])) __pyx_t_16 = 0;
      if (__pyx_t_25 &lt; 0) {
        __pyx_t_25 += __pyx_v_QS_view.shape[1];
        if (unlikely(__pyx_t_25 &lt; 0)) __pyx_t_16 = 1;
      } else if (unlikely(__pyx_t_25 &gt;= __pyx_v_QS_view.shape[1])) __pyx_t_16 = 1;
      if (unlikely(__pyx_t_16 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
        <span class='error_goto'>__PYX_ERR(0, 994, __pyx_L1_error)</span>
      }
      *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_QS_view.data + __pyx_t_24 * __pyx_v_QS_view.strides[0]) ) + __pyx_t_25 * __pyx_v_QS_view.strides[1]) )) = __pyx_t_23;
    }
  }
</pre>
    <pre class="cython line score-53"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0995</span>:                                            <span class="n">args</span><span class="o">=</span><span
            class="p">(</span><span class="n">nmax</span><span class="p">[</span><span class="n">x</span><span
            class="p">],</span> <span class="n">wavelength</span><span class="p">[</span><span class="n">x</span><span
            class="p">],</span> <span class="n">izaDeg</span><span class="p">[</span><span class="n">x</span><span
            class="p">],</span> <span class="n">iaaDeg</span><span class="p">[</span><span class="n">x</span><span
            class="p">],</span> <span class="n">n_alpha</span><span class="p">,</span> <span
            class="n">n_beta</span><span class="p">,</span> <span class="n">or_pdf</span><span class="p">,</span></pre>
    <pre class='cython code score-53 '>      __pyx_t_1 = <span
            class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 995, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_15 = __pyx_v_x;
      __pyx_t_16 = -1;
      if (__pyx_t_15 &lt; 0) {
        __pyx_t_15 += __pyx_v_nmax.shape[0];
        if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_16 = 0;
      } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_nmax.shape[0])) __pyx_t_16 = 0;
      if (unlikely(__pyx_t_16 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
        <span class='error_goto'>__PYX_ERR(0, 995, __pyx_L1_error)</span>
      }
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>((*((int *) ( /* dim=0 */ (__pyx_v_nmax.data + __pyx_t_15 * __pyx_v_nmax.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 995, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_17 = __pyx_v_x;
      __pyx_t_16 = -1;
      if (__pyx_t_17 &lt; 0) {
        __pyx_t_17 += __pyx_v_wavelength.shape[0];
        if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_16 = 0;
      } else if (unlikely(__pyx_t_17 &gt;= __pyx_v_wavelength.shape[0])) __pyx_t_16 = 0;
      if (unlikely(__pyx_t_16 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
        <span class='error_goto'>__PYX_ERR(0, 995, __pyx_L1_error)</span>
      }
      __pyx_t_14 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_wavelength.data + __pyx_t_17 * __pyx_v_wavelength.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 995, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      __pyx_t_18 = __pyx_v_x;
      __pyx_t_16 = -1;
      if (__pyx_t_18 &lt; 0) {
        __pyx_t_18 += __pyx_v_izaDeg.shape[0];
        if (unlikely(__pyx_t_18 &lt; 0)) __pyx_t_16 = 0;
      } else if (unlikely(__pyx_t_18 &gt;= __pyx_v_izaDeg.shape[0])) __pyx_t_16 = 0;
      if (unlikely(__pyx_t_16 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
        <span class='error_goto'>__PYX_ERR(0, 995, __pyx_L1_error)</span>
      }
      __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_izaDeg.data + __pyx_t_18 * __pyx_v_izaDeg.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 995, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_19 = __pyx_v_x;
      __pyx_t_16 = -1;
      if (__pyx_t_19 &lt; 0) {
        __pyx_t_19 += __pyx_v_iaaDeg.shape[0];
        if (unlikely(__pyx_t_19 &lt; 0)) __pyx_t_16 = 0;
      } else if (unlikely(__pyx_t_19 &gt;= __pyx_v_iaaDeg.shape[0])) __pyx_t_16 = 0;
      if (unlikely(__pyx_t_16 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
        <span class='error_goto'>__PYX_ERR(0, 995, __pyx_L1_error)</span>
      }
      __pyx_t_11 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_iaaDeg.data + __pyx_t_19 * __pyx_v_iaaDeg.strides[0]) ))));<span
                class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 995, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_alpha);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 995, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_beta);<span class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 995, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
/* â€¦ */
      __pyx_t_22 = <span class='py_c_api'>PyTuple_New</span>(9);<span class='error_goto'> if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 995, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_22);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_22, 0, __pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_14);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_22, 1, __pyx_t_14);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_22, 2, __pyx_t_3);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_22, 3, __pyx_t_11);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_22, 4, __pyx_t_4);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_20);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_22, 5, __pyx_t_20);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_or_pdf);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_or_pdf);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_22, 6, __pyx_v_or_pdf);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_21);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_22, 7, __pyx_t_21);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_22, 8, __pyx_int_1);
      __pyx_t_2 = 0;
      __pyx_t_14 = 0;
      __pyx_t_3 = 0;
      __pyx_t_11 = 0;
      __pyx_t_4 = 0;
      __pyx_t_20 = 0;
      __pyx_t_21 = 0;
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_args, __pyx_t_22) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 995, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_22); __pyx_t_22 = 0;
</pre>
    <pre class="cython line score-16"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0996</span>:                                                  <span class="n">i</span><span
            class="p">,</span> <span class="mf">1</span><span class="p">))[</span><span class="mf">0</span><span
            class="p">]</span></pre>
    <pre class='cython code score-16 '>      __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_i);<span
            class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 996, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
/* â€¦ */
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_22, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 996, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_22); __pyx_t_22 = 0;
      __pyx_t_23 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1); if (unlikely((__pyx_t_23 == (double)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 996, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">0997</span>: </pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0998</span>:     <span class="k">if</span> <span class="n">verbose</span> <span class="o">==</span> <span
            class="mf">1</span><span class="p">:</span></pre>
    <pre class='cython code score-0 '>  __pyx_t_10 = ((__pyx_v_verbose == 1) != 0);
  if (__pyx_t_10) {
/* â€¦ */
  }
</pre>
    <pre class="cython line score-17"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">0999</span>:         <span class="n">sys</span><span class="o">.</span><span
            class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span
            class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span></pre>
    <pre class='cython code score-17 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_sys);<span
            class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 999, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_22 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_stdout);<span
                class='error_goto'> if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 999, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_22);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_22, __pyx_n_s_write);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 999, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_22); __pyx_t_22 = 0;
    __pyx_t_22 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_tuple__27, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 999, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_22);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_22); __pyx_t_22 = 0;
/* â€¦ */
  __pyx_tuple__27 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s__2);<span class='error_goto'> if (unlikely(!__pyx_tuple__27)) __PYX_ERR(0, 999, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__27);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__27);
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1000</span>: </pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1001</span>:     <span class="k">return</span> <span class="n">QS_view</span></pre>
    <pre class='cython code score-0 '>  __PYX_INC_MEMVIEW(&amp;__pyx_v_QS_view, 0);
  __pyx_r = __pyx_v_QS_view;
  goto __pyx_L0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1002</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">1003</span>: <span class="c"># ----------------------------------------------------------------------------------------------------------------------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1004</span>: <span
            class="c"># Extinction Cross Section.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1005</span>: <span class="c"># ----------------------------------------------------------------------------------------------------------------------</span></pre>
    <pre class="cython line score-13"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1006</span>: <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:,:]</span> <span
            class="n">XSEC_QE</span><span class="p">(</span><span class="n">double</span> <span
            class="nb">complex</span><span class="p">[:,:,:]</span> <span class="n">S</span><span
            class="p">,</span> <span class="n">double</span><span class="p">[:]</span> <span class="n">wavelength</span><span
            class="p">):</span></pre>
    <pre class='cython code score-13 '>static __Pyx_memviewslice __pyx_f_6pyrism_4core_3tma_XSEC_QE(__Pyx_memviewslice __pyx_v_S, __Pyx_memviewslice __pyx_v_wavelength) {
  Py_ssize_t __pyx_v_x;
  Py_ssize_t __pyx_v_xmax;
  PyObject *__pyx_v_QE = NULL;
  __Pyx_memviewslice __pyx_r = { 0, 0, { 0 }, { 0 }, { 0 } };
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("XSEC_QE", 0);
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_18, 1);
  __pyx_r.data = NULL;
  __pyx_r.memview = NULL;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.XSEC_QE", __pyx_clineno, __pyx_lineno, __pyx_filename);

  goto __pyx_L2;
  __pyx_L0:;
  if (unlikely(!__pyx_r.memview)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "Memoryview return value is not initialized");
  }
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_QE);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1007</span>:     <span class="sd">&quot;&quot;&quot;Extinction Cross Section.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1008</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">1009</span>: <span class="sd">    Parameters</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1010</span>: <span class="sd">    ----------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1011</span>: <span
            class="sd">    S : double complex[:,:,:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1012</span>: <span class="sd">        Three dimensoinal scattering matrix.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1013</span>: <span
            class="sd">    wavelength : double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1014</span>: <span class="sd">        Wavelength in same unit as radius (used by function calc_nmax).</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1015</span>: <span class="sd">    Returns</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1016</span>: <span class="sd">    -------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1017</span>: <span
            class="sd">    Qe : double[:,:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1018</span>: <span class="sd">        Two dimensional extinction cross section.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1019</span>: <span
            class="sd">    &quot;&quot;&quot;</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1020</span>:     <span class="k">cdef</span><span
            class="p">:</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1021</span>:         <span class="n">np</span><span class="o">.</span><span
            class="n">ndarray</span><span class="p">[</span><span class="n">double</span><span class="p">,</span> <span
            class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span>  <span
            class="n">Qe</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1022</span>:         <span class="n">Py_ssize_t</span> <span
            class="n">x</span></pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1023</span>:         <span class="n">Py_ssize_t</span> <span class="n">xmax</span> <span class="o">=</span> <span
            class="n">S</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span
            class="mf">0</span><span class="p">]</span></pre>
    <pre class='cython code score-0 '>  __pyx_v_xmax = (__pyx_v_S.shape[0]);
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1024</span>: </pre>
    <pre class="cython line score-42"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1025</span>:     <span class="n">QE</span> <span class="o">=</span> <span class="n">np</span><span
            class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">xmax</span><span
            class="p">,</span> <span class="mf">2</span><span class="p">),</span> <span class="n">dtype</span><span
            class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span
            class="p">)</span></pre>
    <pre class='cython code score-42 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span
            class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1025, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1025, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_xmax);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1025, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1025, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_2);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1025, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1025, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1025, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_double);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1025, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 1025, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1025, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_QE = __pyx_t_5;
  __pyx_t_5 = 0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1026</span>: </pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1027</span>:     <span class="k">for</span> <span class="n">x</span> <span
            class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">xmax</span><span
            class="p">):</span></pre>
    <pre class='cython code score-0 '>  __pyx_t_6 = __pyx_v_xmax;
  __pyx_t_7 = __pyx_t_6;
  for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
    __pyx_v_x = __pyx_t_8;
</pre>
    <pre class="cython line score-30"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1028</span>:         <span class="n">QE</span><span class="p">[</span><span class="n">x</span><span
            class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span
            class="mf">2</span> <span class="o">*</span> <span class="n">wavelength</span><span class="p">[</span><span
            class="n">x</span><span class="p">]</span> <span class="o">*</span> <span class="n">S</span><span class="p">[</span><span
            class="n">x</span><span class="p">][</span><span class="mf">0</span><span class="p">,</span> <span
            class="mf">0</span><span class="p">]</span><span class="o">.</span><span class="n">imag</span></pre>
    <pre class='cython code score-30 '>    __pyx_t_9 = __pyx_v_x;
    __pyx_t_10 = -1;
    if (__pyx_t_9 &lt; 0) {
      __pyx_t_9 += __pyx_v_wavelength.shape[0];
      if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_10 = 0;
    } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_wavelength.shape[0])) __pyx_t_10 = 0;
    if (unlikely(__pyx_t_10 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_10);
      <span class='error_goto'>__PYX_ERR(0, 1028, __pyx_L1_error)</span>
    }
    __pyx_t_11 = __pyx_v_x;
    __pyx_t_12 = 0;
    __pyx_t_13 = 0;
    __pyx_t_10 = -1;
    if (__pyx_t_11 &lt; 0) {
      __pyx_t_11 += __pyx_v_S.shape[0];
      if (unlikely(__pyx_t_11 &lt; 0)) __pyx_t_10 = 0;
    } else if (unlikely(__pyx_t_11 &gt;= __pyx_v_S.shape[0])) __pyx_t_10 = 0;
    if (__pyx_t_12 &lt; 0) {
      __pyx_t_12 += __pyx_v_S.shape[1];
      if (unlikely(__pyx_t_12 &lt; 0)) __pyx_t_10 = 1;
    } else if (unlikely(__pyx_t_12 &gt;= __pyx_v_S.shape[1])) __pyx_t_10 = 1;
    if (__pyx_t_13 &lt; 0) {
      __pyx_t_13 += __pyx_v_S.shape[2];
      if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_10 = 2;
    } else if (unlikely(__pyx_t_13 &gt;= __pyx_v_S.shape[2])) __pyx_t_10 = 2;
    if (unlikely(__pyx_t_10 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_10);
      <span class='error_goto'>__PYX_ERR(0, 1028, __pyx_L1_error)</span>
    }
    __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(((2.0 * (*((double *) ( /* dim=0 */ (__pyx_v_wavelength.data + __pyx_t_9 * __pyx_v_wavelength.strides[0]) )))) * <span
                class='pyx_macro_api'>__Pyx_CIMAG</span>((*((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_S.data + __pyx_t_11 * __pyx_v_S.strides[0]) ) + __pyx_t_12 * __pyx_v_S.strides[1]) ) + __pyx_t_13 * __pyx_v_S.strides[2]) ))))));<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1028, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_3 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_x);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1028, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1028, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_0);
    __pyx_t_3 = 0;
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_QE, __pyx_t_1, __pyx_t_5) &lt; 0)) <span
                class='error_goto'>__PYX_ERR(0, 1028, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre>
    <pre class="cython line score-30"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1029</span>:         <span class="n">QE</span><span class="p">[</span><span class="n">x</span><span
            class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span
            class="mf">2</span> <span class="o">*</span> <span class="n">wavelength</span><span class="p">[</span><span
            class="n">x</span><span class="p">]</span> <span class="o">*</span> <span class="n">S</span><span class="p">[</span><span
            class="n">x</span><span class="p">][</span><span class="mf">1</span><span class="p">,</span> <span
            class="mf">1</span><span class="p">]</span><span class="o">.</span><span class="n">imag</span></pre>
    <pre class='cython code score-30 '>    __pyx_t_14 = __pyx_v_x;
    __pyx_t_10 = -1;
    if (__pyx_t_14 &lt; 0) {
      __pyx_t_14 += __pyx_v_wavelength.shape[0];
      if (unlikely(__pyx_t_14 &lt; 0)) __pyx_t_10 = 0;
    } else if (unlikely(__pyx_t_14 &gt;= __pyx_v_wavelength.shape[0])) __pyx_t_10 = 0;
    if (unlikely(__pyx_t_10 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_10);
      <span class='error_goto'>__PYX_ERR(0, 1029, __pyx_L1_error)</span>
    }
    __pyx_t_15 = __pyx_v_x;
    __pyx_t_16 = 1;
    __pyx_t_17 = 1;
    __pyx_t_10 = -1;
    if (__pyx_t_15 &lt; 0) {
      __pyx_t_15 += __pyx_v_S.shape[0];
      if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_10 = 0;
    } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_S.shape[0])) __pyx_t_10 = 0;
    if (__pyx_t_16 &lt; 0) {
      __pyx_t_16 += __pyx_v_S.shape[1];
      if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_10 = 1;
    } else if (unlikely(__pyx_t_16 &gt;= __pyx_v_S.shape[1])) __pyx_t_10 = 1;
    if (__pyx_t_17 &lt; 0) {
      __pyx_t_17 += __pyx_v_S.shape[2];
      if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_10 = 2;
    } else if (unlikely(__pyx_t_17 &gt;= __pyx_v_S.shape[2])) __pyx_t_10 = 2;
    if (unlikely(__pyx_t_10 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_10);
      <span class='error_goto'>__PYX_ERR(0, 1029, __pyx_L1_error)</span>
    }
    __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(((2.0 * (*((double *) ( /* dim=0 */ (__pyx_v_wavelength.data + __pyx_t_14 * __pyx_v_wavelength.strides[0]) )))) * <span
                class='pyx_macro_api'>__Pyx_CIMAG</span>((*((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_S.data + __pyx_t_15 * __pyx_v_S.strides[0]) ) + __pyx_t_16 * __pyx_v_S.strides[1]) ) + __pyx_t_17 * __pyx_v_S.strides[2]) ))))));<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1029, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_x);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1029, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1029, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_1);
    __pyx_t_1 = 0;
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_QE, __pyx_t_3, __pyx_t_5) &lt; 0)) <span
                class='error_goto'>__PYX_ERR(0, 1029, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1030</span>: </pre>
    <pre class="cython line score-2"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1031</span>:     <span class="k">return</span> <span class="n">QE</span></pre>
    <pre class='cython code score-2 '>  __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_QE, PyBUF_WRITABLE);<span
            class='error_goto'> if (unlikely(!__pyx_t_18.memview)) __PYX_ERR(0, 1031, __pyx_L1_error)</span>
  __pyx_r = __pyx_t_18;
  __pyx_t_18.memview = NULL;
  __pyx_t_18.data = NULL;
  goto __pyx_L0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1032</span>: </pre>
    <pre class="cython line score-21"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1033</span>: <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:,:]</span> <span
            class="n">XSEC_QSI</span><span class="p">(</span><span class="n">double</span><span class="p">[:,:,:]</span> <span
            class="n">Z</span><span class="p">):</span></pre>
    <pre class='cython code score-21 '>static __Pyx_memviewslice __pyx_f_6pyrism_4core_3tma_XSEC_QSI(__Pyx_memviewslice __pyx_v_Z) {
  PyArrayObject *__pyx_v_QSI = 0;
  Py_ssize_t __pyx_v_x;
  Py_ssize_t __pyx_v_xmax;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_QSI;
  __Pyx_Buffer __pyx_pybuffer_QSI;
  __Pyx_memviewslice __pyx_r = { 0, 0, { 0 }, { 0 }, { 0 } };
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("XSEC_QSI", 0);
  __pyx_pybuffer_QSI.pybuffer.buf = NULL;
  __pyx_pybuffer_QSI.refcount = 0;
  __pyx_pybuffernd_QSI.data = NULL;
  __pyx_pybuffernd_QSI.rcbuffer = &amp;__pyx_pybuffer_QSI;
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_30, 1);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_QSI.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  __pyx_r.data = NULL;
  __pyx_r.memview = NULL;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.XSEC_QSI", __pyx_clineno, __pyx_lineno, __pyx_filename);

  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_QSI.rcbuffer-&gt;pybuffer);
  if (unlikely(!__pyx_r.memview)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "Memoryview return value is not initialized");
  }
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_QSI);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1034</span>:     <span
            class="sd">&quot;&quot;&quot;Intensity.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1035</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">1036</span>: <span class="sd">    Parameters</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1037</span>: <span class="sd">    ----------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1038</span>: <span
            class="sd">    Z : double complex[:,:,:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1039</span>: <span class="sd">        Three dimensional phase matrix.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1040</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">1041</span>: <span class="sd">    Returns</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1042</span>: <span class="sd">    -------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1043</span>: <span
            class="sd">    Qi : double[:,:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1044</span>: <span class="sd">        Two dimensional intensity.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1045</span>: <span
            class="sd">    &quot;&quot;&quot;</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1046</span>:     <span class="k">cdef</span><span
            class="p">:</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1047</span>:         <span class="n">np</span><span class="o">.</span><span
            class="n">ndarray</span><span class="p">[</span><span class="n">double</span><span class="p">,</span> <span
            class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span>  <span
            class="n">QSI</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1048</span>:         <span class="n">Py_ssize_t</span> <span
            class="n">x</span></pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1049</span>:         <span class="n">Py_ssize_t</span> <span class="n">xmax</span> <span class="o">=</span> <span
            class="n">Z</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span
            class="mf">0</span><span class="p">]</span></pre>
    <pre class='cython code score-0 '>  __pyx_v_xmax = (__pyx_v_Z.shape[0]);
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1050</span>: </pre>
    <pre class="cython line score-62"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1051</span>:     <span class="n">QSI</span> <span class="o">=</span> <span class="n">np</span><span
            class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">xmax</span><span
            class="p">,</span> <span class="mf">2</span><span class="p">),</span> <span class="n">dtype</span><span
            class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span
            class="p">)</span></pre>
    <pre class='cython code score-62 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span
            class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1051, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1051, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_xmax);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1051, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1051, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_2);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1051, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1051, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1051, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_double);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1051, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 1051, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1051, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) <span
                class='error_goto'>__PYX_ERR(0, 1051, __pyx_L1_error)</span>
  __pyx_t_6 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_QSI.rcbuffer-&gt;pybuffer);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_QSI.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_6, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack);
    if (unlikely(__pyx_t_7 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_8, &amp;__pyx_t_9, &amp;__pyx_t_10);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_QSI.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_QSI, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_8); Py_XDECREF(__pyx_t_9); Py_XDECREF(__pyx_t_10);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_8, __pyx_t_9, __pyx_t_10);
      }
      __pyx_t_8 = __pyx_t_9 = __pyx_t_10 = 0;
    }
    __pyx_pybuffernd_QSI.diminfo[0].strides = __pyx_pybuffernd_QSI.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_QSI.diminfo[0].shape = __pyx_pybuffernd_QSI.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_QSI.diminfo[1].strides = __pyx_pybuffernd_QSI.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_QSI.diminfo[1].shape = __pyx_pybuffernd_QSI.rcbuffer-&gt;pybuffer.shape[1];
    if (unlikely(__pyx_t_7 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1051, __pyx_L1_error)</span>
  }
  __pyx_t_6 = 0;
  __pyx_v_QSI = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1052</span>: </pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1053</span>:     <span class="k">for</span> <span class="n">x</span> <span
            class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">xmax</span><span
            class="p">):</span></pre>
    <pre class='cython code score-0 '>  __pyx_t_11 = __pyx_v_xmax;
  __pyx_t_12 = __pyx_t_11;
  for (__pyx_t_13 = 0; __pyx_t_13 &lt; __pyx_t_12; __pyx_t_13+=1) {
    __pyx_v_x = __pyx_t_13;
</pre>
    <pre class="cython line score-6"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1054</span>:         <span class="n">QSI</span><span class="p">[</span><span
            class="n">x</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span
            class="o">=</span> <span class="n">Z</span><span class="p">[</span><span class="n">x</span><span
            class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span
            class="p">]</span> <span class="o">+</span> <span class="n">Z</span><span class="p">[</span><span class="n">x</span><span
            class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">1</span><span
            class="p">]</span></pre>
    <pre class='cython code score-6 '>    __pyx_t_14 = __pyx_v_x;
    __pyx_t_15 = 0;
    __pyx_t_16 = 0;
    __pyx_t_7 = -1;
    if (__pyx_t_14 &lt; 0) {
      __pyx_t_14 += __pyx_v_Z.shape[0];
      if (unlikely(__pyx_t_14 &lt; 0)) __pyx_t_7 = 0;
    } else if (unlikely(__pyx_t_14 &gt;= __pyx_v_Z.shape[0])) __pyx_t_7 = 0;
    if (__pyx_t_15 &lt; 0) {
      __pyx_t_15 += __pyx_v_Z.shape[1];
      if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_7 = 1;
    } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_Z.shape[1])) __pyx_t_7 = 1;
    if (__pyx_t_16 &lt; 0) {
      __pyx_t_16 += __pyx_v_Z.shape[2];
      if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_7 = 2;
    } else if (unlikely(__pyx_t_16 &gt;= __pyx_v_Z.shape[2])) __pyx_t_7 = 2;
    if (unlikely(__pyx_t_7 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
      <span class='error_goto'>__PYX_ERR(0, 1054, __pyx_L1_error)</span>
    }
    __pyx_t_17 = __pyx_v_x;
    __pyx_t_18 = 0;
    __pyx_t_19 = 1;
    __pyx_t_7 = -1;
    if (__pyx_t_17 &lt; 0) {
      __pyx_t_17 += __pyx_v_Z.shape[0];
      if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_7 = 0;
    } else if (unlikely(__pyx_t_17 &gt;= __pyx_v_Z.shape[0])) __pyx_t_7 = 0;
    if (__pyx_t_18 &lt; 0) {
      __pyx_t_18 += __pyx_v_Z.shape[1];
      if (unlikely(__pyx_t_18 &lt; 0)) __pyx_t_7 = 1;
    } else if (unlikely(__pyx_t_18 &gt;= __pyx_v_Z.shape[1])) __pyx_t_7 = 1;
    if (__pyx_t_19 &lt; 0) {
      __pyx_t_19 += __pyx_v_Z.shape[2];
      if (unlikely(__pyx_t_19 &lt; 0)) __pyx_t_7 = 2;
    } else if (unlikely(__pyx_t_19 &gt;= __pyx_v_Z.shape[2])) __pyx_t_7 = 2;
    if (unlikely(__pyx_t_7 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
      <span class='error_goto'>__PYX_ERR(0, 1054, __pyx_L1_error)</span>
    }
    __pyx_t_20 = __pyx_v_x;
    __pyx_t_21 = 0;
    __pyx_t_7 = -1;
    if (__pyx_t_20 &lt; 0) {
      __pyx_t_20 += __pyx_pybuffernd_QSI.diminfo[0].shape;
      if (unlikely(__pyx_t_20 &lt; 0)) __pyx_t_7 = 0;
    } else if (unlikely(__pyx_t_20 &gt;= __pyx_pybuffernd_QSI.diminfo[0].shape)) __pyx_t_7 = 0;
    if (__pyx_t_21 &lt; 0) {
      __pyx_t_21 += __pyx_pybuffernd_QSI.diminfo[1].shape;
      if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_7 = 1;
    } else if (unlikely(__pyx_t_21 &gt;= __pyx_pybuffernd_QSI.diminfo[1].shape)) __pyx_t_7 = 1;
    if (unlikely(__pyx_t_7 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
      <span class='error_goto'>__PYX_ERR(0, 1054, __pyx_L1_error)</span>
    }
    *__Pyx_BufPtrStrided2d(double *, __pyx_pybuffernd_QSI.rcbuffer-&gt;pybuffer.buf, __pyx_t_20, __pyx_pybuffernd_QSI.diminfo[0].strides, __pyx_t_21, __pyx_pybuffernd_QSI.diminfo[1].strides) = ((*((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_Z.data + __pyx_t_14 * __pyx_v_Z.strides[0]) ) + __pyx_t_15 * __pyx_v_Z.strides[1]) ) + __pyx_t_16 * __pyx_v_Z.strides[2]) ))) + (*((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_Z.data + __pyx_t_17 * __pyx_v_Z.strides[0]) ) + __pyx_t_18 * __pyx_v_Z.strides[1]) ) + __pyx_t_19 * __pyx_v_Z.strides[2]) ))));
</pre>
    <pre class="cython line score-6"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1055</span>:         <span class="n">QSI</span><span class="p">[</span><span
            class="n">x</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span
            class="o">=</span> <span class="n">Z</span><span class="p">[</span><span class="n">x</span><span
            class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span
            class="p">]</span> <span class="o">-</span> <span class="n">Z</span><span class="p">[</span><span class="n">x</span><span
            class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">1</span><span
            class="p">]</span></pre>
    <pre class='cython code score-6 '>    __pyx_t_22 = __pyx_v_x;
    __pyx_t_23 = 0;
    __pyx_t_24 = 0;
    __pyx_t_7 = -1;
    if (__pyx_t_22 &lt; 0) {
      __pyx_t_22 += __pyx_v_Z.shape[0];
      if (unlikely(__pyx_t_22 &lt; 0)) __pyx_t_7 = 0;
    } else if (unlikely(__pyx_t_22 &gt;= __pyx_v_Z.shape[0])) __pyx_t_7 = 0;
    if (__pyx_t_23 &lt; 0) {
      __pyx_t_23 += __pyx_v_Z.shape[1];
      if (unlikely(__pyx_t_23 &lt; 0)) __pyx_t_7 = 1;
    } else if (unlikely(__pyx_t_23 &gt;= __pyx_v_Z.shape[1])) __pyx_t_7 = 1;
    if (__pyx_t_24 &lt; 0) {
      __pyx_t_24 += __pyx_v_Z.shape[2];
      if (unlikely(__pyx_t_24 &lt; 0)) __pyx_t_7 = 2;
    } else if (unlikely(__pyx_t_24 &gt;= __pyx_v_Z.shape[2])) __pyx_t_7 = 2;
    if (unlikely(__pyx_t_7 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
      <span class='error_goto'>__PYX_ERR(0, 1055, __pyx_L1_error)</span>
    }
    __pyx_t_25 = __pyx_v_x;
    __pyx_t_26 = 0;
    __pyx_t_27 = 1;
    __pyx_t_7 = -1;
    if (__pyx_t_25 &lt; 0) {
      __pyx_t_25 += __pyx_v_Z.shape[0];
      if (unlikely(__pyx_t_25 &lt; 0)) __pyx_t_7 = 0;
    } else if (unlikely(__pyx_t_25 &gt;= __pyx_v_Z.shape[0])) __pyx_t_7 = 0;
    if (__pyx_t_26 &lt; 0) {
      __pyx_t_26 += __pyx_v_Z.shape[1];
      if (unlikely(__pyx_t_26 &lt; 0)) __pyx_t_7 = 1;
    } else if (unlikely(__pyx_t_26 &gt;= __pyx_v_Z.shape[1])) __pyx_t_7 = 1;
    if (__pyx_t_27 &lt; 0) {
      __pyx_t_27 += __pyx_v_Z.shape[2];
      if (unlikely(__pyx_t_27 &lt; 0)) __pyx_t_7 = 2;
    } else if (unlikely(__pyx_t_27 &gt;= __pyx_v_Z.shape[2])) __pyx_t_7 = 2;
    if (unlikely(__pyx_t_7 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
      <span class='error_goto'>__PYX_ERR(0, 1055, __pyx_L1_error)</span>
    }
    __pyx_t_28 = __pyx_v_x;
    __pyx_t_29 = 1;
    __pyx_t_7 = -1;
    if (__pyx_t_28 &lt; 0) {
      __pyx_t_28 += __pyx_pybuffernd_QSI.diminfo[0].shape;
      if (unlikely(__pyx_t_28 &lt; 0)) __pyx_t_7 = 0;
    } else if (unlikely(__pyx_t_28 &gt;= __pyx_pybuffernd_QSI.diminfo[0].shape)) __pyx_t_7 = 0;
    if (__pyx_t_29 &lt; 0) {
      __pyx_t_29 += __pyx_pybuffernd_QSI.diminfo[1].shape;
      if (unlikely(__pyx_t_29 &lt; 0)) __pyx_t_7 = 1;
    } else if (unlikely(__pyx_t_29 &gt;= __pyx_pybuffernd_QSI.diminfo[1].shape)) __pyx_t_7 = 1;
    if (unlikely(__pyx_t_7 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
      <span class='error_goto'>__PYX_ERR(0, 1055, __pyx_L1_error)</span>
    }
    *__Pyx_BufPtrStrided2d(double *, __pyx_pybuffernd_QSI.rcbuffer-&gt;pybuffer.buf, __pyx_t_28, __pyx_pybuffernd_QSI.diminfo[0].strides, __pyx_t_29, __pyx_pybuffernd_QSI.diminfo[1].strides) = ((*((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_Z.data + __pyx_t_22 * __pyx_v_Z.strides[0]) ) + __pyx_t_23 * __pyx_v_Z.strides[1]) ) + __pyx_t_24 * __pyx_v_Z.strides[2]) ))) - (*((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_Z.data + __pyx_t_25 * __pyx_v_Z.strides[0]) ) + __pyx_t_26 * __pyx_v_Z.strides[1]) ) + __pyx_t_27 * __pyx_v_Z.strides[2]) ))));
  }
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1056</span>: </pre>
    <pre class="cython line score-2"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1057</span>:     <span class="k">return</span> <span class="n">QSI</span></pre>
    <pre class='cython code score-2 '>  __pyx_t_30 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(((PyObject *)__pyx_v_QSI), PyBUF_WRITABLE);<span
            class='error_goto'> if (unlikely(!__pyx_t_30.memview)) __PYX_ERR(0, 1057, __pyx_L1_error)</span>
  __pyx_r = __pyx_t_30;
  __pyx_t_30.memview = NULL;
  __pyx_t_30.data = NULL;
  goto __pyx_L0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1058</span>: </pre>
    <pre class="cython line score-13"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1059</span>: <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:,:]</span> <span
            class="n">KT</span><span class="p">(</span><span class="n">double</span><span class="p">[:,:,:]</span> <span
            class="n">ke</span><span class="p">):</span></pre>
    <pre class='cython code score-13 '>static __Pyx_memviewslice __pyx_f_6pyrism_4core_3tma_KT(__Pyx_memviewslice __pyx_v_ke) {
  Py_ssize_t __pyx_v_x;
  Py_ssize_t __pyx_v_i;
  Py_ssize_t __pyx_v_xmax;
  PyObject *__pyx_v_kt = NULL;
  __Pyx_memviewslice __pyx_v_kt_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_r = { 0, 0, { 0 }, { 0 }, { 0 } };
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("KT", 0);
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  __pyx_r.data = NULL;
  __pyx_r.memview = NULL;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.KT", __pyx_clineno, __pyx_lineno, __pyx_filename);

  goto __pyx_L2;
  __pyx_L0:;
  if (unlikely(!__pyx_r.memview)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "Memoryview return value is not initialized");
  }
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_kt);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_kt_view, 1);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1060</span>:     <span class="k">cdef</span><span
            class="p">:</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1061</span>:         <span class="n">Py_ssize_t</span> <span
            class="n">x</span><span class="p">,</span> <span class="n">i</span></pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1062</span>:         <span class="n">Py_ssize_t</span> <span class="n">xmax</span> <span class="o">=</span> <span
            class="n">ke</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span
            class="mf">0</span><span class="p">]</span></pre>
    <pre class='cython code score-0 '>  __pyx_v_xmax = (__pyx_v_ke.shape[0]);
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1063</span>: </pre>
    <pre class="cython line score-42"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1064</span>:     <span class="n">kt</span> <span class="o">=</span> <span class="n">np</span><span
            class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">xmax</span><span
            class="p">,</span> <span class="mf">2</span><span class="p">),</span> <span class="n">dtype</span><span
            class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span
            class="p">)</span></pre>
    <pre class='cython code score-42 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span
            class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1064, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1064, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_xmax);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1064, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1064, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_2);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1064, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1064, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1064, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_double);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1064, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 1064, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1064, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_kt = __pyx_t_5;
  __pyx_t_5 = 0;
</pre>
    <pre class="cython line score-2"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1065</span>:     <span class="k">cdef</span> <span class="kt">double</span>[<span
            class="p">:,:]</span> <span class="n">kt_view</span> <span class="o">=</span> <span
            class="n">kt</span></pre>
    <pre class='cython code score-2 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_kt, PyBUF_WRITABLE);<span
            class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1065, __pyx_L1_error)</span>
  __pyx_v_kt_view = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1066</span>: </pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1067</span>:     <span class="k">for</span> <span class="n">x</span> <span
            class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">xmax</span><span
            class="p">):</span></pre>
    <pre class='cython code score-0 '>  __pyx_t_7 = __pyx_v_xmax;
  __pyx_t_8 = __pyx_t_7;
  for (__pyx_t_9 = 0; __pyx_t_9 &lt; __pyx_t_8; __pyx_t_9+=1) {
    __pyx_v_x = __pyx_t_9;
</pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1068</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span
            class="nb">range</span><span class="p">(</span><span class="mf">2</span><span class="p">):</span></pre>
    <pre class='cython code score-0 '>    for (__pyx_t_10 = 0; __pyx_t_10 &lt; 2; __pyx_t_10+=1) {
      __pyx_v_i = __pyx_t_10;
</pre>
    <pre class="cython line score-4"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1069</span>:             <span class="n">kt_view</span><span class="p">[</span><span
            class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span
            class="mf">1</span><span class="o">-</span><span class="n">ke</span><span class="p">[</span><span class="n">x</span><span
            class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span></pre>
    <pre class='cython code score-4 '>      __pyx_t_11 = __pyx_v_x;
      __pyx_t_12 = __pyx_v_i;
      __pyx_t_13 = __pyx_v_i;
      __pyx_t_14 = -1;
      if (__pyx_t_11 &lt; 0) {
        __pyx_t_11 += __pyx_v_ke.shape[0];
        if (unlikely(__pyx_t_11 &lt; 0)) __pyx_t_14 = 0;
      } else if (unlikely(__pyx_t_11 &gt;= __pyx_v_ke.shape[0])) __pyx_t_14 = 0;
      if (__pyx_t_12 &lt; 0) {
        __pyx_t_12 += __pyx_v_ke.shape[1];
        if (unlikely(__pyx_t_12 &lt; 0)) __pyx_t_14 = 1;
      } else if (unlikely(__pyx_t_12 &gt;= __pyx_v_ke.shape[1])) __pyx_t_14 = 1;
      if (__pyx_t_13 &lt; 0) {
        __pyx_t_13 += __pyx_v_ke.shape[2];
        if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_14 = 2;
      } else if (unlikely(__pyx_t_13 &gt;= __pyx_v_ke.shape[2])) __pyx_t_14 = 2;
      if (unlikely(__pyx_t_14 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_14);
        <span class='error_goto'>__PYX_ERR(0, 1069, __pyx_L1_error)</span>
      }
      __pyx_t_15 = __pyx_v_x;
      __pyx_t_16 = __pyx_v_i;
      __pyx_t_14 = -1;
      if (__pyx_t_15 &lt; 0) {
        __pyx_t_15 += __pyx_v_kt_view.shape[0];
        if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_14 = 0;
      } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_kt_view.shape[0])) __pyx_t_14 = 0;
      if (__pyx_t_16 &lt; 0) {
        __pyx_t_16 += __pyx_v_kt_view.shape[1];
        if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_14 = 1;
      } else if (unlikely(__pyx_t_16 &gt;= __pyx_v_kt_view.shape[1])) __pyx_t_14 = 1;
      if (unlikely(__pyx_t_14 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_14);
        <span class='error_goto'>__PYX_ERR(0, 1069, __pyx_L1_error)</span>
      }
      *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_kt_view.data + __pyx_t_15 * __pyx_v_kt_view.strides[0]) ) + __pyx_t_16 * __pyx_v_kt_view.strides[1]) )) = (1.0 - (*((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ke.data + __pyx_t_11 * __pyx_v_ke.strides[0]) ) + __pyx_t_12 * __pyx_v_ke.strides[1]) ) + __pyx_t_13 * __pyx_v_ke.strides[2]) ))));
    }
  }
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1070</span>: </pre>
    <pre class="cython line score-2"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1071</span>:     <span class="k">return</span> <span class="n">kt</span></pre>
    <pre class='cython code score-2 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_kt, PyBUF_WRITABLE);<span
            class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1071, __pyx_L1_error)</span>
  __pyx_r = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
  goto __pyx_L0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1072</span>: </pre>
    <pre class="cython line score-13"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1073</span>: <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:,:]</span> <span
            class="n">KA</span><span class="p">(</span><span class="n">double</span><span class="p">[:,:]</span> <span
            class="n">ks</span><span class="p">,</span> <span class="n">double</span><span class="p">[:,:]</span> <span
            class="n">omega</span><span class="p">):</span></pre>
    <pre class='cython code score-13 '>static __Pyx_memviewslice __pyx_f_6pyrism_4core_3tma_KA(__Pyx_memviewslice __pyx_v_ks, __Pyx_memviewslice __pyx_v_omega) {
  Py_ssize_t __pyx_v_x;
  Py_ssize_t __pyx_v_i;
  Py_ssize_t __pyx_v_xmax;
  PyObject *__pyx_v_ka = NULL;
  __Pyx_memviewslice __pyx_v_ka_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_r = { 0, 0, { 0 }, { 0 }, { 0 } };
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("KA", 0);
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  __pyx_r.data = NULL;
  __pyx_r.memview = NULL;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.KA", __pyx_clineno, __pyx_lineno, __pyx_filename);

  goto __pyx_L2;
  __pyx_L0:;
  if (unlikely(!__pyx_r.memview)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "Memoryview return value is not initialized");
  }
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ka);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_ka_view, 1);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1074</span>:     <span class="k">cdef</span><span
            class="p">:</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1075</span>:         <span class="n">Py_ssize_t</span> <span
            class="n">x</span><span class="p">,</span> <span class="n">i</span></pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1076</span>:         <span class="n">Py_ssize_t</span> <span class="n">xmax</span> <span class="o">=</span> <span
            class="n">omega</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span
            class="mf">0</span><span class="p">]</span></pre>
    <pre class='cython code score-0 '>  __pyx_v_xmax = (__pyx_v_omega.shape[0]);
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1077</span>: </pre>
    <pre class="cython line score-42"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1078</span>:     <span class="n">ka</span> <span class="o">=</span> <span class="n">np</span><span
            class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">xmax</span><span
            class="p">,</span> <span class="mf">2</span><span class="p">),</span> <span class="n">dtype</span><span
            class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span
            class="p">)</span></pre>
    <pre class='cython code score-42 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span
            class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1078, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1078, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_xmax);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1078, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1078, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_2);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1078, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1078, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1078, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_double);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1078, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 1078, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1078, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_ka = __pyx_t_5;
  __pyx_t_5 = 0;
</pre>
    <pre class="cython line score-2"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1079</span>:     <span class="k">cdef</span> <span class="kt">double</span>[<span
            class="p">:,:]</span> <span class="n">ka_view</span> <span class="o">=</span> <span
            class="n">ka</span></pre>
    <pre class='cython code score-2 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_ka, PyBUF_WRITABLE);<span
            class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1079, __pyx_L1_error)</span>
  __pyx_v_ka_view = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1080</span>: </pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1081</span>:     <span class="k">for</span> <span class="n">x</span> <span
            class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">xmax</span><span
            class="p">):</span></pre>
    <pre class='cython code score-0 '>  __pyx_t_7 = __pyx_v_xmax;
  __pyx_t_8 = __pyx_t_7;
  for (__pyx_t_9 = 0; __pyx_t_9 &lt; __pyx_t_8; __pyx_t_9+=1) {
    __pyx_v_x = __pyx_t_9;
</pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1082</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span
            class="nb">range</span><span class="p">(</span><span class="mf">2</span><span class="p">):</span></pre>
    <pre class='cython code score-0 '>    for (__pyx_t_10 = 0; __pyx_t_10 &lt; 2; __pyx_t_10+=1) {
      __pyx_v_i = __pyx_t_10;
</pre>
    <pre class="cython line score-10"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1083</span>:             <span class="n">ka_view</span><span class="p">[</span><span
            class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span
            class="p">(</span><span class="n">ks</span><span class="p">[</span><span class="n">x</span><span
            class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span
            class="n">omega</span><span class="p">[</span><span class="n">x</span><span class="p">,</span> <span
            class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">ks</span><span
            class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span> <span
            class="o">/</span> <span class="n">omega</span><span class="p">[</span><span class="n">x</span><span
            class="p">,</span> <span class="n">i</span><span class="p">]</span></pre>
    <pre class='cython code score-10 '>      __pyx_t_11 = __pyx_v_x;
      __pyx_t_12 = __pyx_v_i;
      __pyx_t_13 = -1;
      if (__pyx_t_11 &lt; 0) {
        __pyx_t_11 += __pyx_v_ks.shape[0];
        if (unlikely(__pyx_t_11 &lt; 0)) __pyx_t_13 = 0;
      } else if (unlikely(__pyx_t_11 &gt;= __pyx_v_ks.shape[0])) __pyx_t_13 = 0;
      if (__pyx_t_12 &lt; 0) {
        __pyx_t_12 += __pyx_v_ks.shape[1];
        if (unlikely(__pyx_t_12 &lt; 0)) __pyx_t_13 = 1;
      } else if (unlikely(__pyx_t_12 &gt;= __pyx_v_ks.shape[1])) __pyx_t_13 = 1;
      if (unlikely(__pyx_t_13 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
        <span class='error_goto'>__PYX_ERR(0, 1083, __pyx_L1_error)</span>
      }
      __pyx_t_14 = __pyx_v_x;
      __pyx_t_15 = __pyx_v_i;
      __pyx_t_13 = -1;
      if (__pyx_t_14 &lt; 0) {
        __pyx_t_14 += __pyx_v_omega.shape[0];
        if (unlikely(__pyx_t_14 &lt; 0)) __pyx_t_13 = 0;
      } else if (unlikely(__pyx_t_14 &gt;= __pyx_v_omega.shape[0])) __pyx_t_13 = 0;
      if (__pyx_t_15 &lt; 0) {
        __pyx_t_15 += __pyx_v_omega.shape[1];
        if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_13 = 1;
      } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_omega.shape[1])) __pyx_t_13 = 1;
      if (unlikely(__pyx_t_13 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
        <span class='error_goto'>__PYX_ERR(0, 1083, __pyx_L1_error)</span>
      }
      __pyx_t_16 = __pyx_v_x;
      __pyx_t_17 = __pyx_v_i;
      __pyx_t_13 = -1;
      if (__pyx_t_16 &lt; 0) {
        __pyx_t_16 += __pyx_v_ks.shape[0];
        if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_13 = 0;
      } else if (unlikely(__pyx_t_16 &gt;= __pyx_v_ks.shape[0])) __pyx_t_13 = 0;
      if (__pyx_t_17 &lt; 0) {
        __pyx_t_17 += __pyx_v_ks.shape[1];
        if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_13 = 1;
      } else if (unlikely(__pyx_t_17 &gt;= __pyx_v_ks.shape[1])) __pyx_t_13 = 1;
      if (unlikely(__pyx_t_13 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
        <span class='error_goto'>__PYX_ERR(0, 1083, __pyx_L1_error)</span>
      }
      __pyx_t_18 = __pyx_v_x;
      __pyx_t_19 = __pyx_v_i;
      __pyx_t_13 = -1;
      if (__pyx_t_18 &lt; 0) {
        __pyx_t_18 += __pyx_v_omega.shape[0];
        if (unlikely(__pyx_t_18 &lt; 0)) __pyx_t_13 = 0;
      } else if (unlikely(__pyx_t_18 &gt;= __pyx_v_omega.shape[0])) __pyx_t_13 = 0;
      if (__pyx_t_19 &lt; 0) {
        __pyx_t_19 += __pyx_v_omega.shape[1];
        if (unlikely(__pyx_t_19 &lt; 0)) __pyx_t_13 = 1;
      } else if (unlikely(__pyx_t_19 &gt;= __pyx_v_omega.shape[1])) __pyx_t_13 = 1;
      if (unlikely(__pyx_t_13 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
        <span class='error_goto'>__PYX_ERR(0, 1083, __pyx_L1_error)</span>
      }
      __pyx_t_20 = __pyx_v_x;
      __pyx_t_21 = __pyx_v_i;
      __pyx_t_13 = -1;
      if (__pyx_t_20 &lt; 0) {
        __pyx_t_20 += __pyx_v_ka_view.shape[0];
        if (unlikely(__pyx_t_20 &lt; 0)) __pyx_t_13 = 0;
      } else if (unlikely(__pyx_t_20 &gt;= __pyx_v_ka_view.shape[0])) __pyx_t_13 = 0;
      if (__pyx_t_21 &lt; 0) {
        __pyx_t_21 += __pyx_v_ka_view.shape[1];
        if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_13 = 1;
      } else if (unlikely(__pyx_t_21 &gt;= __pyx_v_ka_view.shape[1])) __pyx_t_13 = 1;
      if (unlikely(__pyx_t_13 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
        <span class='error_goto'>__PYX_ERR(0, 1083, __pyx_L1_error)</span>
      }
      *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ka_view.data + __pyx_t_20 * __pyx_v_ka_view.strides[0]) ) + __pyx_t_21 * __pyx_v_ka_view.strides[1]) )) = (((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ks.data + __pyx_t_11 * __pyx_v_ks.strides[0]) ) + __pyx_t_12 * __pyx_v_ks.strides[1]) ))) - ((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_omega.data + __pyx_t_14 * __pyx_v_omega.strides[0]) ) + __pyx_t_15 * __pyx_v_omega.strides[1]) ))) * (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ks.data + __pyx_t_16 * __pyx_v_ks.strides[0]) ) + __pyx_t_17 * __pyx_v_ks.strides[1]) ))))) / (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_omega.data + __pyx_t_18 * __pyx_v_omega.strides[0]) ) + __pyx_t_19 * __pyx_v_omega.strides[1]) ))));
    }
  }
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1084</span>: </pre>
    <pre class="cython line score-2"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1085</span>:     <span class="k">return</span> <span class="n">ka</span></pre>
    <pre class='cython code score-2 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_ka, PyBUF_WRITABLE);<span
            class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1085, __pyx_L1_error)</span>
  __pyx_r = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
  goto __pyx_L0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1086</span>: </pre>
    <pre class="cython line score-13"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1087</span>: <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:,:]</span> <span
            class="n">KS</span><span class="p">(</span><span class="n">double</span><span class="p">[:,:,:]</span> <span
            class="n">ke</span><span class="p">,</span> <span class="n">double</span><span class="p">[:,:]</span> <span
            class="n">omega</span><span class="p">):</span></pre>
    <pre class='cython code score-13 '>static __Pyx_memviewslice __pyx_f_6pyrism_4core_3tma_KS(__Pyx_memviewslice __pyx_v_ke, __Pyx_memviewslice __pyx_v_omega) {
  Py_ssize_t __pyx_v_x;
  Py_ssize_t __pyx_v_i;
  Py_ssize_t __pyx_v_xmax;
  PyObject *__pyx_v_ks = NULL;
  __Pyx_memviewslice __pyx_v_ks_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_r = { 0, 0, { 0 }, { 0 }, { 0 } };
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("KS", 0);
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  __pyx_r.data = NULL;
  __pyx_r.memview = NULL;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.KS", __pyx_clineno, __pyx_lineno, __pyx_filename);

  goto __pyx_L2;
  __pyx_L0:;
  if (unlikely(!__pyx_r.memview)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "Memoryview return value is not initialized");
  }
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ks);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_ks_view, 1);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1088</span>:     <span class="k">cdef</span><span
            class="p">:</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1089</span>:         <span class="n">Py_ssize_t</span> <span
            class="n">x</span><span class="p">,</span> <span class="n">i</span></pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1090</span>:         <span class="n">Py_ssize_t</span> <span class="n">xmax</span> <span class="o">=</span> <span
            class="n">omega</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span
            class="mf">0</span><span class="p">]</span></pre>
    <pre class='cython code score-0 '>  __pyx_v_xmax = (__pyx_v_omega.shape[0]);
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1091</span>: </pre>
    <pre class="cython line score-42"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1092</span>:     <span class="n">ks</span> <span class="o">=</span> <span class="n">np</span><span
            class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">xmax</span><span
            class="p">,</span> <span class="mf">2</span><span class="p">),</span> <span class="n">dtype</span><span
            class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span
            class="p">)</span></pre>
    <pre class='cython code score-42 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span
            class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1092, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1092, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_xmax);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1092, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1092, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_2);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1092, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1092, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1092, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_double);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1092, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 1092, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1092, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_ks = __pyx_t_5;
  __pyx_t_5 = 0;
</pre>
    <pre class="cython line score-2"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1093</span>:     <span class="k">cdef</span> <span class="kt">double</span>[<span
            class="p">:,:]</span> <span class="n">ks_view</span> <span class="o">=</span> <span
            class="n">ks</span></pre>
    <pre class='cython code score-2 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_ks, PyBUF_WRITABLE);<span
            class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1093, __pyx_L1_error)</span>
  __pyx_v_ks_view = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1094</span>: </pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1095</span>:     <span class="k">for</span> <span class="n">x</span> <span
            class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">xmax</span><span
            class="p">):</span></pre>
    <pre class='cython code score-0 '>  __pyx_t_7 = __pyx_v_xmax;
  __pyx_t_8 = __pyx_t_7;
  for (__pyx_t_9 = 0; __pyx_t_9 &lt; __pyx_t_8; __pyx_t_9+=1) {
    __pyx_v_x = __pyx_t_9;
</pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1096</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span
            class="nb">range</span><span class="p">(</span><span class="mf">2</span><span class="p">):</span></pre>
    <pre class='cython code score-0 '>    for (__pyx_t_10 = 0; __pyx_t_10 &lt; 2; __pyx_t_10+=1) {
      __pyx_v_i = __pyx_t_10;
</pre>
    <pre class="cython line score-6"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1097</span>:             <span class="n">ks_view</span><span class="p">[</span><span
            class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span
            class="n">omega</span><span class="p">[</span><span class="n">x</span><span class="p">,</span> <span
            class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">ke</span><span
            class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">i</span><span
            class="p">,</span> <span class="n">i</span><span class="p">]</span></pre>
    <pre class='cython code score-6 '>      __pyx_t_11 = __pyx_v_x;
      __pyx_t_12 = __pyx_v_i;
      __pyx_t_13 = -1;
      if (__pyx_t_11 &lt; 0) {
        __pyx_t_11 += __pyx_v_omega.shape[0];
        if (unlikely(__pyx_t_11 &lt; 0)) __pyx_t_13 = 0;
      } else if (unlikely(__pyx_t_11 &gt;= __pyx_v_omega.shape[0])) __pyx_t_13 = 0;
      if (__pyx_t_12 &lt; 0) {
        __pyx_t_12 += __pyx_v_omega.shape[1];
        if (unlikely(__pyx_t_12 &lt; 0)) __pyx_t_13 = 1;
      } else if (unlikely(__pyx_t_12 &gt;= __pyx_v_omega.shape[1])) __pyx_t_13 = 1;
      if (unlikely(__pyx_t_13 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
        <span class='error_goto'>__PYX_ERR(0, 1097, __pyx_L1_error)</span>
      }
      __pyx_t_14 = __pyx_v_x;
      __pyx_t_15 = __pyx_v_i;
      __pyx_t_16 = __pyx_v_i;
      __pyx_t_13 = -1;
      if (__pyx_t_14 &lt; 0) {
        __pyx_t_14 += __pyx_v_ke.shape[0];
        if (unlikely(__pyx_t_14 &lt; 0)) __pyx_t_13 = 0;
      } else if (unlikely(__pyx_t_14 &gt;= __pyx_v_ke.shape[0])) __pyx_t_13 = 0;
      if (__pyx_t_15 &lt; 0) {
        __pyx_t_15 += __pyx_v_ke.shape[1];
        if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_13 = 1;
      } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_ke.shape[1])) __pyx_t_13 = 1;
      if (__pyx_t_16 &lt; 0) {
        __pyx_t_16 += __pyx_v_ke.shape[2];
        if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_13 = 2;
      } else if (unlikely(__pyx_t_16 &gt;= __pyx_v_ke.shape[2])) __pyx_t_13 = 2;
      if (unlikely(__pyx_t_13 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
        <span class='error_goto'>__PYX_ERR(0, 1097, __pyx_L1_error)</span>
      }
      __pyx_t_17 = __pyx_v_x;
      __pyx_t_18 = __pyx_v_i;
      __pyx_t_13 = -1;
      if (__pyx_t_17 &lt; 0) {
        __pyx_t_17 += __pyx_v_ks_view.shape[0];
        if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_13 = 0;
      } else if (unlikely(__pyx_t_17 &gt;= __pyx_v_ks_view.shape[0])) __pyx_t_13 = 0;
      if (__pyx_t_18 &lt; 0) {
        __pyx_t_18 += __pyx_v_ks_view.shape[1];
        if (unlikely(__pyx_t_18 &lt; 0)) __pyx_t_13 = 1;
      } else if (unlikely(__pyx_t_18 &gt;= __pyx_v_ks_view.shape[1])) __pyx_t_13 = 1;
      if (unlikely(__pyx_t_13 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
        <span class='error_goto'>__PYX_ERR(0, 1097, __pyx_L1_error)</span>
      }
      *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ks_view.data + __pyx_t_17 * __pyx_v_ks_view.strides[0]) ) + __pyx_t_18 * __pyx_v_ks_view.strides[1]) )) = ((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_omega.data + __pyx_t_11 * __pyx_v_omega.strides[0]) ) + __pyx_t_12 * __pyx_v_omega.strides[1]) ))) * (*((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ke.data + __pyx_t_14 * __pyx_v_ke.strides[0]) ) + __pyx_t_15 * __pyx_v_ke.strides[1]) ) + __pyx_t_16 * __pyx_v_ke.strides[2]) ))));
    }
  }
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1098</span>: </pre>
    <pre class="cython line score-2"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1099</span>:     <span class="k">return</span> <span class="n">ks</span></pre>
    <pre class='cython code score-2 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_ks, PyBUF_WRITABLE);<span
            class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1099, __pyx_L1_error)</span>
  __pyx_r = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
  goto __pyx_L0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1100</span>: </pre>
    <pre class="cython line score-14"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1101</span>: <span class="k">cdef</span> <span class="kt">double</span>[<span
            class="p">:,:,:]</span> <span class="n">KE</span><span class="p">(</span><span class="n">double</span> <span
            class="nb">complex</span><span class="p">[:]</span> <span class="n">factor</span><span
            class="p">,</span> <span class="n">double</span> <span class="nb">complex</span><span
            class="p">[:,:,:]</span> <span class="n">S</span><span class="p">):</span></pre>
    <pre class='cython code score-14 '>static __Pyx_memviewslice __pyx_f_6pyrism_4core_3tma_KE(__Pyx_memviewslice __pyx_v_factor, __Pyx_memviewslice __pyx_v_S) {
  Py_ssize_t __pyx_v_x;
  Py_ssize_t __pyx_v_i;
  Py_ssize_t __pyx_v_j;
  Py_ssize_t __pyx_v_xmax;
  __pyx_t_double_complex __pyx_v_F;
  __pyx_t_double_complex __pyx_v_SF;
  PyObject *__pyx_v_ke = NULL;
  __Pyx_memviewslice __pyx_v_ke_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_Mpq = NULL;
  CYTHON_UNUSED __Pyx_memviewslice __pyx_v_Mpq_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_r = { 0, 0, { 0 }, { 0 }, { 0 } };
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("KE", 0);
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
  __pyx_r.data = NULL;
  __pyx_r.memview = NULL;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.KE", __pyx_clineno, __pyx_lineno, __pyx_filename);

  goto __pyx_L2;
  __pyx_L0:;
  if (unlikely(!__pyx_r.memview)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "Memoryview return value is not initialized");
  }
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ke);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_ke_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_Mpq);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_Mpq_view, 1);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1102</span>:     <span
            class="sd">&quot;&quot;&quot;</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1103</span>: <span class="sd">    Compute the extinction coefficient</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1104</span>: <span class="sd">    </span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1105</span>: <span class="sd">    Parameters</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1106</span>: <span class="sd">    ----------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1107</span>: <span
            class="sd">    factor : double complex[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1108</span>: <span class="sd">        The factor to compute Mpq. The factor is (i*2*PI*N/k0)</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1109</span>: <span
            class="sd">    S : double complex[:,:,:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1110</span>: <span
            class="sd">        Scattering matrix.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1111</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">1112</span>: <span class="sd">    Returns</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1113</span>: <span class="sd">    -------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1114</span>: <span class="sd">    KE : MemoryView, double[:,:,:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1115</span>: <span
            class="sd">    &quot;&quot;&quot;</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1116</span>:     <span class="k">cdef</span><span
            class="p">:</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1117</span>:         <span class="n">Py_ssize_t</span> <span
            class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span></pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1118</span>:         <span class="n">Py_ssize_t</span> <span class="n">xmax</span> <span class="o">=</span> <span
            class="n">S</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span
            class="mf">0</span><span class="p">]</span></pre>
    <pre class='cython code score-0 '>  __pyx_v_xmax = (__pyx_v_S.shape[0]);
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1119</span>:         <span class="n">double</span> <span
            class="nb">complex</span> <span class="n">F</span><span class="p">,</span> <span class="n">SF</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1120</span>: </pre>
    <pre class="cython line score-59"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1121</span>:     <span class="n">ke</span> <span class="o">=</span> <span class="n">np</span><span
            class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">xmax</span><span
            class="p">,</span> <span class="mf">4</span><span class="p">,</span> <span class="mf">4</span><span
            class="p">))</span></pre>
    <pre class='cython code score-59 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span
            class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1121, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros);<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1121, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_xmax);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1121, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1121, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_int_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2, __pyx_int_4);
  __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1121, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
      PyObject *__pyx_temp[2] = {__pyx_t_2, __pyx_t_4};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1121, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
      PyObject *__pyx_temp[2] = {__pyx_t_2, __pyx_t_4};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1121, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    } else
    #endif
    {
      __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1121, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2); __pyx_t_2 = NULL;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+1, __pyx_t_4);
      __pyx_t_4 = 0;
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_5, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1121, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_ke = __pyx_t_1;
  __pyx_t_1 = 0;
</pre>
    <pre class="cython line score-2"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1122</span>:     <span class="k">cdef</span> <span class="kt">double</span>[<span
            class="p">:,:,:]</span> <span class="n">ke_view</span> <span class="o">=</span> <span
            class="n">ke</span></pre>
    <pre class='cython code score-2 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_double</span>(__pyx_v_ke, PyBUF_WRITABLE);<span
            class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1122, __pyx_L1_error)</span>
  __pyx_v_ke_view = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1123</span>: </pre>
    <pre class="cython line score-44"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1124</span>:     <span class="n">Mpq</span> <span class="o">=</span> <span class="n">np</span><span
            class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">xmax</span><span
            class="p">,</span> <span class="mf">2</span><span class="p">,</span> <span class="mf">2</span><span
            class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span
            class="o">.</span><span class="n">complex</span><span class="p">)</span></pre>
    <pre class='cython code score-44 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span
            class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1124, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1124, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_xmax);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1124, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1124, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_int_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 2, __pyx_int_2);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1124, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1124, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1124, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_complex);<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1124, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_2) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 1124, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_1, __pyx_t_5);<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1124, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_Mpq = __pyx_t_2;
  __pyx_t_2 = 0;
</pre>
    <pre class="cython line score-2"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1125</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="kt">complex</span>[<span
            class="p">:,:,:]</span> <span class="n">Mpq_view</span> <span class="o">=</span> <span class="n">Mpq</span></pre>
    <pre class='cython code score-2 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds___pyx_t_double_complex</span>(__pyx_v_Mpq, PyBUF_WRITABLE);<span
            class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 1125, __pyx_L1_error)</span>
  __pyx_v_Mpq_view = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1126</span>: </pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1127</span>:     <span class="k">for</span> <span class="n">x</span> <span
            class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">xmax</span><span
            class="p">):</span></pre>
    <pre class='cython code score-0 '>  __pyx_t_8 = __pyx_v_xmax;
  __pyx_t_9 = __pyx_t_8;
  for (__pyx_t_10 = 0; __pyx_t_10 &lt; __pyx_t_9; __pyx_t_10+=1) {
    __pyx_v_x = __pyx_t_10;
</pre>
    <pre class="cython line score-2"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1128</span>:         <span class="n">F</span> <span class="o">=</span> <span
            class="n">factor</span><span class="p">[</span><span class="n">x</span><span class="p">]</span></pre>
    <pre class='cython code score-2 '>    __pyx_t_11 = __pyx_v_x;
    __pyx_t_12 = -1;
    if (__pyx_t_11 &lt; 0) {
      __pyx_t_11 += __pyx_v_factor.shape[0];
      if (unlikely(__pyx_t_11 &lt; 0)) __pyx_t_12 = 0;
    } else if (unlikely(__pyx_t_11 &gt;= __pyx_v_factor.shape[0])) __pyx_t_12 = 0;
    if (unlikely(__pyx_t_12 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_12);
      <span class='error_goto'>__PYX_ERR(0, 1128, __pyx_L1_error)</span>
    }
    __pyx_v_F = (*((__pyx_t_double_complex *) ( /* dim=0 */ (__pyx_v_factor.data + __pyx_t_11 * __pyx_v_factor.strides[0]) )));
</pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1129</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span
            class="nb">range</span><span class="p">(</span><span class="mf">2</span><span class="p">):</span></pre>
    <pre class='cython code score-0 '>    for (__pyx_t_13 = 0; __pyx_t_13 &lt; 2; __pyx_t_13+=1) {
      __pyx_v_i = __pyx_t_13;
</pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1130</span>:             <span class="k">for</span> <span class="n">j</span> <span
            class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">2</span><span
            class="p">):</span></pre>
    <pre class='cython code score-0 '>      for (__pyx_t_14 = 0; __pyx_t_14 &lt; 2; __pyx_t_14+=1) {
        __pyx_v_j = __pyx_t_14;
</pre>
    <pre class="cython line score-2"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1131</span>:                 <span class="n">SF</span> <span class="o">=</span> <span
            class="n">S</span><span class="p">[</span><span class="n">x</span><span class="p">,</span> <span
            class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span></pre>
    <pre class='cython code score-2 '>        __pyx_t_15 = __pyx_v_x;
        __pyx_t_16 = __pyx_v_i;
        __pyx_t_17 = __pyx_v_j;
        __pyx_t_12 = -1;
        if (__pyx_t_15 &lt; 0) {
          __pyx_t_15 += __pyx_v_S.shape[0];
          if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_12 = 0;
        } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_S.shape[0])) __pyx_t_12 = 0;
        if (__pyx_t_16 &lt; 0) {
          __pyx_t_16 += __pyx_v_S.shape[1];
          if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_12 = 1;
        } else if (unlikely(__pyx_t_16 &gt;= __pyx_v_S.shape[1])) __pyx_t_12 = 1;
        if (__pyx_t_17 &lt; 0) {
          __pyx_t_17 += __pyx_v_S.shape[2];
          if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_12 = 2;
        } else if (unlikely(__pyx_t_17 &gt;= __pyx_v_S.shape[2])) __pyx_t_12 = 2;
        if (unlikely(__pyx_t_12 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_12);
          <span class='error_goto'>__PYX_ERR(0, 1131, __pyx_L1_error)</span>
        }
        __pyx_v_SF = (*((__pyx_t_double_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_S.data + __pyx_t_15 * __pyx_v_S.strides[0]) ) + __pyx_t_16 * __pyx_v_S.strides[1]) ) + __pyx_t_17 * __pyx_v_S.strides[2]) )));
</pre>
    <pre class="cython line score-35"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1132</span>:                 <span class="n">Mpq</span><span class="p">[</span><span
            class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span
            class="p">]</span> <span class="o">=</span> <span class="n">F</span> <span class="o">*</span> <span
            class="n">SF</span></pre>
    <pre class='cython code score-35 '>        __pyx_t_18 = __Pyx_c_prod_double(__pyx_v_F, __pyx_v_SF);
        __pyx_t_2 = __pyx_<span class='py_c_api'>PyComplex_FromComplex</span>(__pyx_t_18);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1132, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        __pyx_t_5 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_x);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1132, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        __pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1132, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_3 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_j);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1132, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1132, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_5);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_1);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2, __pyx_t_3);
        __pyx_t_5 = 0;
        __pyx_t_1 = 0;
        __pyx_t_3 = 0;
        if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_Mpq, __pyx_t_4, __pyx_t_2) &lt; 0)) <span
                class='error_goto'>__PYX_ERR(0, 1132, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      }
    }
  }
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1133</span>: </pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1134</span>:     <span class="k">for</span> <span class="n">x</span> <span
            class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">xmax</span><span
            class="p">):</span></pre>
    <pre class='cython code score-0 '>  __pyx_t_8 = __pyx_v_xmax;
  __pyx_t_9 = __pyx_t_8;
  for (__pyx_t_10 = 0; __pyx_t_10 &lt; __pyx_t_9; __pyx_t_10+=1) {
    __pyx_v_x = __pyx_t_10;
</pre>
    <pre class="cython line score-40"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1135</span>:         <span class="n">ke_view</span><span class="p">[</span><span class="n">x</span><span
            class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span
            class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2</span> <span
            class="o">*</span> <span class="n">Mpq</span><span class="p">[</span><span class="n">x</span><span
            class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span
            class="p">]</span><span class="o">.</span><span class="n">real</span></pre>
    <pre class='cython code score-40 '>    __pyx_t_2 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_x);<span
            class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1135, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1135, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_int_0);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2, __pyx_int_0);
    __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_Mpq, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1135, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_real);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1135, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_neg_2, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1135, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_19 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2); if (unlikely((__pyx_t_19 == (double)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 1135, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_20 = __pyx_v_x;
    __pyx_t_21 = 0;
    __pyx_t_22 = 0;
    __pyx_t_12 = -1;
    if (__pyx_t_20 &lt; 0) {
      __pyx_t_20 += __pyx_v_ke_view.shape[0];
      if (unlikely(__pyx_t_20 &lt; 0)) __pyx_t_12 = 0;
    } else if (unlikely(__pyx_t_20 &gt;= __pyx_v_ke_view.shape[0])) __pyx_t_12 = 0;
    if (__pyx_t_21 &lt; 0) {
      __pyx_t_21 += __pyx_v_ke_view.shape[1];
      if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_12 = 1;
    } else if (unlikely(__pyx_t_21 &gt;= __pyx_v_ke_view.shape[1])) __pyx_t_12 = 1;
    if (__pyx_t_22 &lt; 0) {
      __pyx_t_22 += __pyx_v_ke_view.shape[2];
      if (unlikely(__pyx_t_22 &lt; 0)) __pyx_t_12 = 2;
    } else if (unlikely(__pyx_t_22 &gt;= __pyx_v_ke_view.shape[2])) __pyx_t_12 = 2;
    if (unlikely(__pyx_t_12 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_12);
      <span class='error_goto'>__PYX_ERR(0, 1135, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ke_view.data + __pyx_t_20 * __pyx_v_ke_view.strides[0]) ) + __pyx_t_21 * __pyx_v_ke_view.strides[1]) ) + __pyx_t_22 * __pyx_v_ke_view.strides[2]) )) = __pyx_t_19;
</pre>
    <pre class="cython line score-2"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1136</span>:         <span class="n">ke_view</span><span class="p">[</span><span class="n">x</span><span
            class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">1</span><span
            class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
    <pre class='cython code score-2 '>    __pyx_t_23 = __pyx_v_x;
    __pyx_t_24 = 0;
    __pyx_t_25 = 1;
    __pyx_t_12 = -1;
    if (__pyx_t_23 &lt; 0) {
      __pyx_t_23 += __pyx_v_ke_view.shape[0];
      if (unlikely(__pyx_t_23 &lt; 0)) __pyx_t_12 = 0;
    } else if (unlikely(__pyx_t_23 &gt;= __pyx_v_ke_view.shape[0])) __pyx_t_12 = 0;
    if (__pyx_t_24 &lt; 0) {
      __pyx_t_24 += __pyx_v_ke_view.shape[1];
      if (unlikely(__pyx_t_24 &lt; 0)) __pyx_t_12 = 1;
    } else if (unlikely(__pyx_t_24 &gt;= __pyx_v_ke_view.shape[1])) __pyx_t_12 = 1;
    if (__pyx_t_25 &lt; 0) {
      __pyx_t_25 += __pyx_v_ke_view.shape[2];
      if (unlikely(__pyx_t_25 &lt; 0)) __pyx_t_12 = 2;
    } else if (unlikely(__pyx_t_25 &gt;= __pyx_v_ke_view.shape[2])) __pyx_t_12 = 2;
    if (unlikely(__pyx_t_12 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_12);
      <span class='error_goto'>__PYX_ERR(0, 1136, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ke_view.data + __pyx_t_23 * __pyx_v_ke_view.strides[0]) ) + __pyx_t_24 * __pyx_v_ke_view.strides[1]) ) + __pyx_t_25 * __pyx_v_ke_view.strides[2]) )) = 0.0;
</pre>
    <pre class="cython line score-40"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1137</span>:         <span class="n">ke_view</span><span class="p">[</span><span class="n">x</span><span
            class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">2</span><span
            class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">Mpq</span><span
            class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span
            class="mf">1</span><span class="p">]</span><span class="o">.</span><span class="n">real</span></pre>
    <pre class='cython code score-40 '>    __pyx_t_2 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_x);<span
            class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1137, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1137, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_int_0);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2, __pyx_int_1);
    __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_Mpq, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1137, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_real);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1137, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Negative</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1137, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_19 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2); if (unlikely((__pyx_t_19 == (double)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 1137, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_26 = __pyx_v_x;
    __pyx_t_27 = 0;
    __pyx_t_28 = 2;
    __pyx_t_12 = -1;
    if (__pyx_t_26 &lt; 0) {
      __pyx_t_26 += __pyx_v_ke_view.shape[0];
      if (unlikely(__pyx_t_26 &lt; 0)) __pyx_t_12 = 0;
    } else if (unlikely(__pyx_t_26 &gt;= __pyx_v_ke_view.shape[0])) __pyx_t_12 = 0;
    if (__pyx_t_27 &lt; 0) {
      __pyx_t_27 += __pyx_v_ke_view.shape[1];
      if (unlikely(__pyx_t_27 &lt; 0)) __pyx_t_12 = 1;
    } else if (unlikely(__pyx_t_27 &gt;= __pyx_v_ke_view.shape[1])) __pyx_t_12 = 1;
    if (__pyx_t_28 &lt; 0) {
      __pyx_t_28 += __pyx_v_ke_view.shape[2];
      if (unlikely(__pyx_t_28 &lt; 0)) __pyx_t_12 = 2;
    } else if (unlikely(__pyx_t_28 &gt;= __pyx_v_ke_view.shape[2])) __pyx_t_12 = 2;
    if (unlikely(__pyx_t_12 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_12);
      <span class='error_goto'>__PYX_ERR(0, 1137, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ke_view.data + __pyx_t_26 * __pyx_v_ke_view.strides[0]) ) + __pyx_t_27 * __pyx_v_ke_view.strides[1]) ) + __pyx_t_28 * __pyx_v_ke_view.strides[2]) )) = __pyx_t_19;
</pre>
    <pre class="cython line score-40"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1138</span>:         <span class="n">ke_view</span><span class="p">[</span><span class="n">x</span><span
            class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">3</span><span
            class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">Mpq</span><span
            class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span
            class="mf">0</span><span class="p">]</span><span class="o">.</span><span class="n">imag</span></pre>
    <pre class='cython code score-40 '>    __pyx_t_2 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_x);<span
            class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1138, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1138, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_int_0);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2, __pyx_int_0);
    __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_Mpq, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1138, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_imag);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1138, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Negative</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1138, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_19 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2); if (unlikely((__pyx_t_19 == (double)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 1138, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_29 = __pyx_v_x;
    __pyx_t_30 = 0;
    __pyx_t_31 = 3;
    __pyx_t_12 = -1;
    if (__pyx_t_29 &lt; 0) {
      __pyx_t_29 += __pyx_v_ke_view.shape[0];
      if (unlikely(__pyx_t_29 &lt; 0)) __pyx_t_12 = 0;
    } else if (unlikely(__pyx_t_29 &gt;= __pyx_v_ke_view.shape[0])) __pyx_t_12 = 0;
    if (__pyx_t_30 &lt; 0) {
      __pyx_t_30 += __pyx_v_ke_view.shape[1];
      if (unlikely(__pyx_t_30 &lt; 0)) __pyx_t_12 = 1;
    } else if (unlikely(__pyx_t_30 &gt;= __pyx_v_ke_view.shape[1])) __pyx_t_12 = 1;
    if (__pyx_t_31 &lt; 0) {
      __pyx_t_31 += __pyx_v_ke_view.shape[2];
      if (unlikely(__pyx_t_31 &lt; 0)) __pyx_t_12 = 2;
    } else if (unlikely(__pyx_t_31 &gt;= __pyx_v_ke_view.shape[2])) __pyx_t_12 = 2;
    if (unlikely(__pyx_t_12 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_12);
      <span class='error_goto'>__PYX_ERR(0, 1138, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ke_view.data + __pyx_t_29 * __pyx_v_ke_view.strides[0]) ) + __pyx_t_30 * __pyx_v_ke_view.strides[1]) ) + __pyx_t_31 * __pyx_v_ke_view.strides[2]) )) = __pyx_t_19;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1139</span>: </pre>
    <pre class="cython line score-2"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1140</span>:         <span class="n">ke_view</span><span class="p">[</span><span class="n">x</span><span
            class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">0</span><span
            class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
    <pre class='cython code score-2 '>    __pyx_t_32 = __pyx_v_x;
    __pyx_t_33 = 1;
    __pyx_t_34 = 0;
    __pyx_t_12 = -1;
    if (__pyx_t_32 &lt; 0) {
      __pyx_t_32 += __pyx_v_ke_view.shape[0];
      if (unlikely(__pyx_t_32 &lt; 0)) __pyx_t_12 = 0;
    } else if (unlikely(__pyx_t_32 &gt;= __pyx_v_ke_view.shape[0])) __pyx_t_12 = 0;
    if (__pyx_t_33 &lt; 0) {
      __pyx_t_33 += __pyx_v_ke_view.shape[1];
      if (unlikely(__pyx_t_33 &lt; 0)) __pyx_t_12 = 1;
    } else if (unlikely(__pyx_t_33 &gt;= __pyx_v_ke_view.shape[1])) __pyx_t_12 = 1;
    if (__pyx_t_34 &lt; 0) {
      __pyx_t_34 += __pyx_v_ke_view.shape[2];
      if (unlikely(__pyx_t_34 &lt; 0)) __pyx_t_12 = 2;
    } else if (unlikely(__pyx_t_34 &gt;= __pyx_v_ke_view.shape[2])) __pyx_t_12 = 2;
    if (unlikely(__pyx_t_12 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_12);
      <span class='error_goto'>__PYX_ERR(0, 1140, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ke_view.data + __pyx_t_32 * __pyx_v_ke_view.strides[0]) ) + __pyx_t_33 * __pyx_v_ke_view.strides[1]) ) + __pyx_t_34 * __pyx_v_ke_view.strides[2]) )) = 0.0;
</pre>
    <pre class="cython line score-40"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1141</span>:         <span class="n">ke_view</span><span class="p">[</span><span class="n">x</span><span
            class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">1</span><span
            class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2</span> <span
            class="o">*</span> <span class="n">Mpq</span><span class="p">[</span><span class="n">x</span><span
            class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">1</span><span
            class="p">]</span><span class="o">.</span><span class="n">real</span></pre>
    <pre class='cython code score-40 '>    __pyx_t_2 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_x);<span
            class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1141, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1141, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_int_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2, __pyx_int_1);
    __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_Mpq, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1141, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_real);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1141, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_neg_2, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1141, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_19 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2); if (unlikely((__pyx_t_19 == (double)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 1141, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_35 = __pyx_v_x;
    __pyx_t_36 = 1;
    __pyx_t_37 = 1;
    __pyx_t_12 = -1;
    if (__pyx_t_35 &lt; 0) {
      __pyx_t_35 += __pyx_v_ke_view.shape[0];
      if (unlikely(__pyx_t_35 &lt; 0)) __pyx_t_12 = 0;
    } else if (unlikely(__pyx_t_35 &gt;= __pyx_v_ke_view.shape[0])) __pyx_t_12 = 0;
    if (__pyx_t_36 &lt; 0) {
      __pyx_t_36 += __pyx_v_ke_view.shape[1];
      if (unlikely(__pyx_t_36 &lt; 0)) __pyx_t_12 = 1;
    } else if (unlikely(__pyx_t_36 &gt;= __pyx_v_ke_view.shape[1])) __pyx_t_12 = 1;
    if (__pyx_t_37 &lt; 0) {
      __pyx_t_37 += __pyx_v_ke_view.shape[2];
      if (unlikely(__pyx_t_37 &lt; 0)) __pyx_t_12 = 2;
    } else if (unlikely(__pyx_t_37 &gt;= __pyx_v_ke_view.shape[2])) __pyx_t_12 = 2;
    if (unlikely(__pyx_t_12 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_12);
      <span class='error_goto'>__PYX_ERR(0, 1141, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ke_view.data + __pyx_t_35 * __pyx_v_ke_view.strides[0]) ) + __pyx_t_36 * __pyx_v_ke_view.strides[1]) ) + __pyx_t_37 * __pyx_v_ke_view.strides[2]) )) = __pyx_t_19;
</pre>
    <pre class="cython line score-40"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1142</span>:         <span class="n">ke_view</span><span class="p">[</span><span class="n">x</span><span
            class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">2</span><span
            class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">Mpq</span><span
            class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span
            class="mf">0</span><span class="p">]</span><span class="o">.</span><span class="n">real</span></pre>
    <pre class='cython code score-40 '>    __pyx_t_2 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_x);<span
            class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1142, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1142, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_int_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2, __pyx_int_0);
    __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_Mpq, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1142, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_real);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1142, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Negative</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1142, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_19 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2); if (unlikely((__pyx_t_19 == (double)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 1142, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_38 = __pyx_v_x;
    __pyx_t_39 = 1;
    __pyx_t_40 = 2;
    __pyx_t_12 = -1;
    if (__pyx_t_38 &lt; 0) {
      __pyx_t_38 += __pyx_v_ke_view.shape[0];
      if (unlikely(__pyx_t_38 &lt; 0)) __pyx_t_12 = 0;
    } else if (unlikely(__pyx_t_38 &gt;= __pyx_v_ke_view.shape[0])) __pyx_t_12 = 0;
    if (__pyx_t_39 &lt; 0) {
      __pyx_t_39 += __pyx_v_ke_view.shape[1];
      if (unlikely(__pyx_t_39 &lt; 0)) __pyx_t_12 = 1;
    } else if (unlikely(__pyx_t_39 &gt;= __pyx_v_ke_view.shape[1])) __pyx_t_12 = 1;
    if (__pyx_t_40 &lt; 0) {
      __pyx_t_40 += __pyx_v_ke_view.shape[2];
      if (unlikely(__pyx_t_40 &lt; 0)) __pyx_t_12 = 2;
    } else if (unlikely(__pyx_t_40 &gt;= __pyx_v_ke_view.shape[2])) __pyx_t_12 = 2;
    if (unlikely(__pyx_t_12 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_12);
      <span class='error_goto'>__PYX_ERR(0, 1142, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ke_view.data + __pyx_t_38 * __pyx_v_ke_view.strides[0]) ) + __pyx_t_39 * __pyx_v_ke_view.strides[1]) ) + __pyx_t_40 * __pyx_v_ke_view.strides[2]) )) = __pyx_t_19;
</pre>
    <pre class="cython line score-40"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1143</span>:         <span class="n">ke_view</span><span class="p">[</span><span class="n">x</span><span
            class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">3</span><span
            class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">Mpq</span><span
            class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span
            class="mf">0</span><span class="p">]</span><span class="o">.</span><span class="n">imag</span></pre>
    <pre class='cython code score-40 '>    __pyx_t_2 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_x);<span
            class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1143, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1143, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_int_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2, __pyx_int_0);
    __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_Mpq, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1143, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_imag);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1143, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Negative</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1143, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_19 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2); if (unlikely((__pyx_t_19 == (double)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 1143, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_41 = __pyx_v_x;
    __pyx_t_42 = 1;
    __pyx_t_43 = 3;
    __pyx_t_12 = -1;
    if (__pyx_t_41 &lt; 0) {
      __pyx_t_41 += __pyx_v_ke_view.shape[0];
      if (unlikely(__pyx_t_41 &lt; 0)) __pyx_t_12 = 0;
    } else if (unlikely(__pyx_t_41 &gt;= __pyx_v_ke_view.shape[0])) __pyx_t_12 = 0;
    if (__pyx_t_42 &lt; 0) {
      __pyx_t_42 += __pyx_v_ke_view.shape[1];
      if (unlikely(__pyx_t_42 &lt; 0)) __pyx_t_12 = 1;
    } else if (unlikely(__pyx_t_42 &gt;= __pyx_v_ke_view.shape[1])) __pyx_t_12 = 1;
    if (__pyx_t_43 &lt; 0) {
      __pyx_t_43 += __pyx_v_ke_view.shape[2];
      if (unlikely(__pyx_t_43 &lt; 0)) __pyx_t_12 = 2;
    } else if (unlikely(__pyx_t_43 &gt;= __pyx_v_ke_view.shape[2])) __pyx_t_12 = 2;
    if (unlikely(__pyx_t_12 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_12);
      <span class='error_goto'>__PYX_ERR(0, 1143, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ke_view.data + __pyx_t_41 * __pyx_v_ke_view.strides[0]) ) + __pyx_t_42 * __pyx_v_ke_view.strides[1]) ) + __pyx_t_43 * __pyx_v_ke_view.strides[2]) )) = __pyx_t_19;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1144</span>: </pre>
    <pre class="cython line score-40"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1145</span>:         <span class="n">ke_view</span><span class="p">[</span><span class="n">x</span><span
            class="p">,</span> <span class="mf">2</span><span class="p">,</span> <span class="mf">0</span><span
            class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2</span> <span
            class="o">*</span> <span class="n">Mpq</span><span class="p">[</span><span class="n">x</span><span
            class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">0</span><span
            class="p">]</span><span class="o">.</span><span class="n">real</span></pre>
    <pre class='cython code score-40 '>    __pyx_t_2 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_x);<span
            class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1145, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1145, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_int_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2, __pyx_int_0);
    __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_Mpq, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1145, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_real);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1145, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_neg_2, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1145, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_19 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2); if (unlikely((__pyx_t_19 == (double)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 1145, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_44 = __pyx_v_x;
    __pyx_t_45 = 2;
    __pyx_t_46 = 0;
    __pyx_t_12 = -1;
    if (__pyx_t_44 &lt; 0) {
      __pyx_t_44 += __pyx_v_ke_view.shape[0];
      if (unlikely(__pyx_t_44 &lt; 0)) __pyx_t_12 = 0;
    } else if (unlikely(__pyx_t_44 &gt;= __pyx_v_ke_view.shape[0])) __pyx_t_12 = 0;
    if (__pyx_t_45 &lt; 0) {
      __pyx_t_45 += __pyx_v_ke_view.shape[1];
      if (unlikely(__pyx_t_45 &lt; 0)) __pyx_t_12 = 1;
    } else if (unlikely(__pyx_t_45 &gt;= __pyx_v_ke_view.shape[1])) __pyx_t_12 = 1;
    if (__pyx_t_46 &lt; 0) {
      __pyx_t_46 += __pyx_v_ke_view.shape[2];
      if (unlikely(__pyx_t_46 &lt; 0)) __pyx_t_12 = 2;
    } else if (unlikely(__pyx_t_46 &gt;= __pyx_v_ke_view.shape[2])) __pyx_t_12 = 2;
    if (unlikely(__pyx_t_12 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_12);
      <span class='error_goto'>__PYX_ERR(0, 1145, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ke_view.data + __pyx_t_44 * __pyx_v_ke_view.strides[0]) ) + __pyx_t_45 * __pyx_v_ke_view.strides[1]) ) + __pyx_t_46 * __pyx_v_ke_view.strides[2]) )) = __pyx_t_19;
</pre>
    <pre class="cython line score-40"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1146</span>:         <span class="n">ke_view</span><span class="p">[</span><span class="n">x</span><span
            class="p">,</span> <span class="mf">2</span><span class="p">,</span> <span class="mf">1</span><span
            class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2</span> <span
            class="o">*</span> <span class="n">Mpq</span><span class="p">[</span><span class="n">x</span><span
            class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">1</span><span
            class="p">]</span><span class="o">.</span><span class="n">real</span></pre>
    <pre class='cython code score-40 '>    __pyx_t_2 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_x);<span
            class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1146, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1146, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_int_0);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2, __pyx_int_1);
    __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_Mpq, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1146, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_real);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1146, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_neg_2, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1146, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_19 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2); if (unlikely((__pyx_t_19 == (double)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 1146, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_47 = __pyx_v_x;
    __pyx_t_48 = 2;
    __pyx_t_49 = 1;
    __pyx_t_12 = -1;
    if (__pyx_t_47 &lt; 0) {
      __pyx_t_47 += __pyx_v_ke_view.shape[0];
      if (unlikely(__pyx_t_47 &lt; 0)) __pyx_t_12 = 0;
    } else if (unlikely(__pyx_t_47 &gt;= __pyx_v_ke_view.shape[0])) __pyx_t_12 = 0;
    if (__pyx_t_48 &lt; 0) {
      __pyx_t_48 += __pyx_v_ke_view.shape[1];
      if (unlikely(__pyx_t_48 &lt; 0)) __pyx_t_12 = 1;
    } else if (unlikely(__pyx_t_48 &gt;= __pyx_v_ke_view.shape[1])) __pyx_t_12 = 1;
    if (__pyx_t_49 &lt; 0) {
      __pyx_t_49 += __pyx_v_ke_view.shape[2];
      if (unlikely(__pyx_t_49 &lt; 0)) __pyx_t_12 = 2;
    } else if (unlikely(__pyx_t_49 &gt;= __pyx_v_ke_view.shape[2])) __pyx_t_12 = 2;
    if (unlikely(__pyx_t_12 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_12);
      <span class='error_goto'>__PYX_ERR(0, 1146, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ke_view.data + __pyx_t_47 * __pyx_v_ke_view.strides[0]) ) + __pyx_t_48 * __pyx_v_ke_view.strides[1]) ) + __pyx_t_49 * __pyx_v_ke_view.strides[2]) )) = __pyx_t_19;
</pre>
    <pre class="cython line score-68"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1147</span>:         <span class="n">ke_view</span><span class="p">[</span><span class="n">x</span><span
            class="p">,</span> <span class="mf">2</span><span class="p">,</span> <span class="mf">2</span><span
            class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">Mpq</span><span
            class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span
            class="mf">0</span><span class="p">]</span><span class="o">.</span><span class="n">real</span> <span
            class="o">+</span> <span class="n">Mpq</span><span class="p">[</span><span class="n">x</span><span
            class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">1</span><span
            class="p">]</span><span class="o">.</span><span class="n">real</span><span class="p">)</span></pre>
    <pre class='cython code score-68 '>    __pyx_t_2 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_x);<span
            class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1147, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1147, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_int_0);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2, __pyx_int_0);
    __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_Mpq, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1147, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_real);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1147, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_x);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1147, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1147, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 2, __pyx_int_1);
    __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_Mpq, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1147, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_real);<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1147, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1147, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Negative</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1147, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_19 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_3); if (unlikely((__pyx_t_19 == (double)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 1147, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_50 = __pyx_v_x;
    __pyx_t_51 = 2;
    __pyx_t_52 = 2;
    __pyx_t_12 = -1;
    if (__pyx_t_50 &lt; 0) {
      __pyx_t_50 += __pyx_v_ke_view.shape[0];
      if (unlikely(__pyx_t_50 &lt; 0)) __pyx_t_12 = 0;
    } else if (unlikely(__pyx_t_50 &gt;= __pyx_v_ke_view.shape[0])) __pyx_t_12 = 0;
    if (__pyx_t_51 &lt; 0) {
      __pyx_t_51 += __pyx_v_ke_view.shape[1];
      if (unlikely(__pyx_t_51 &lt; 0)) __pyx_t_12 = 1;
    } else if (unlikely(__pyx_t_51 &gt;= __pyx_v_ke_view.shape[1])) __pyx_t_12 = 1;
    if (__pyx_t_52 &lt; 0) {
      __pyx_t_52 += __pyx_v_ke_view.shape[2];
      if (unlikely(__pyx_t_52 &lt; 0)) __pyx_t_12 = 2;
    } else if (unlikely(__pyx_t_52 &gt;= __pyx_v_ke_view.shape[2])) __pyx_t_12 = 2;
    if (unlikely(__pyx_t_12 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_12);
      <span class='error_goto'>__PYX_ERR(0, 1147, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ke_view.data + __pyx_t_50 * __pyx_v_ke_view.strides[0]) ) + __pyx_t_51 * __pyx_v_ke_view.strides[1]) ) + __pyx_t_52 * __pyx_v_ke_view.strides[2]) )) = __pyx_t_19;
</pre>
    <pre class="cython line score-62"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1148</span>:         <span class="n">ke_view</span><span class="p">[</span><span class="n">x</span><span
            class="p">,</span> <span class="mf">2</span><span class="p">,</span> <span class="mf">3</span><span
            class="p">]</span> <span class="o">=</span> <span class="n">Mpq</span><span class="p">[</span><span
            class="n">x</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span
            class="mf">0</span><span class="p">]</span><span class="o">.</span><span class="n">imag</span> <span
            class="o">-</span> <span class="n">Mpq</span><span class="p">[</span><span class="n">x</span><span
            class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">1</span><span
            class="p">]</span><span class="o">.</span><span class="n">imag</span></pre>
    <pre class='cython code score-62 '>    __pyx_t_3 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_x);<span
            class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1148, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1148, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_int_0);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, __pyx_int_0);
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_Mpq, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1148, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_imag);<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1148, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_x);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1148, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1148, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_int_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2, __pyx_int_1);
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_Mpq, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1148, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_imag);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1148, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_2, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1148, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_19 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_3); if (unlikely((__pyx_t_19 == (double)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 1148, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_53 = __pyx_v_x;
    __pyx_t_54 = 2;
    __pyx_t_55 = 3;
    __pyx_t_12 = -1;
    if (__pyx_t_53 &lt; 0) {
      __pyx_t_53 += __pyx_v_ke_view.shape[0];
      if (unlikely(__pyx_t_53 &lt; 0)) __pyx_t_12 = 0;
    } else if (unlikely(__pyx_t_53 &gt;= __pyx_v_ke_view.shape[0])) __pyx_t_12 = 0;
    if (__pyx_t_54 &lt; 0) {
      __pyx_t_54 += __pyx_v_ke_view.shape[1];
      if (unlikely(__pyx_t_54 &lt; 0)) __pyx_t_12 = 1;
    } else if (unlikely(__pyx_t_54 &gt;= __pyx_v_ke_view.shape[1])) __pyx_t_12 = 1;
    if (__pyx_t_55 &lt; 0) {
      __pyx_t_55 += __pyx_v_ke_view.shape[2];
      if (unlikely(__pyx_t_55 &lt; 0)) __pyx_t_12 = 2;
    } else if (unlikely(__pyx_t_55 &gt;= __pyx_v_ke_view.shape[2])) __pyx_t_12 = 2;
    if (unlikely(__pyx_t_12 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_12);
      <span class='error_goto'>__PYX_ERR(0, 1148, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ke_view.data + __pyx_t_53 * __pyx_v_ke_view.strides[0]) ) + __pyx_t_54 * __pyx_v_ke_view.strides[1]) ) + __pyx_t_55 * __pyx_v_ke_view.strides[2]) )) = __pyx_t_19;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1149</span>: </pre>
    <pre class="cython line score-40"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1150</span>:         <span class="n">ke_view</span><span class="p">[</span><span class="n">x</span><span
            class="p">,</span> <span class="mf">3</span><span class="p">,</span> <span class="mf">0</span><span
            class="p">]</span> <span class="o">=</span> <span class="mf">2</span> <span class="o">*</span> <span
            class="n">Mpq</span><span class="p">[</span><span class="n">x</span><span class="p">,</span> <span
            class="mf">1</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span><span
            class="o">.</span><span class="n">imag</span></pre>
    <pre class='cython code score-40 '>    __pyx_t_3 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_x);<span
            class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1150, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1150, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_int_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2, __pyx_int_0);
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_Mpq, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1150, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_imag);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1150, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_2, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1150, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_19 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_3); if (unlikely((__pyx_t_19 == (double)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 1150, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_56 = __pyx_v_x;
    __pyx_t_57 = 3;
    __pyx_t_58 = 0;
    __pyx_t_12 = -1;
    if (__pyx_t_56 &lt; 0) {
      __pyx_t_56 += __pyx_v_ke_view.shape[0];
      if (unlikely(__pyx_t_56 &lt; 0)) __pyx_t_12 = 0;
    } else if (unlikely(__pyx_t_56 &gt;= __pyx_v_ke_view.shape[0])) __pyx_t_12 = 0;
    if (__pyx_t_57 &lt; 0) {
      __pyx_t_57 += __pyx_v_ke_view.shape[1];
      if (unlikely(__pyx_t_57 &lt; 0)) __pyx_t_12 = 1;
    } else if (unlikely(__pyx_t_57 &gt;= __pyx_v_ke_view.shape[1])) __pyx_t_12 = 1;
    if (__pyx_t_58 &lt; 0) {
      __pyx_t_58 += __pyx_v_ke_view.shape[2];
      if (unlikely(__pyx_t_58 &lt; 0)) __pyx_t_12 = 2;
    } else if (unlikely(__pyx_t_58 &gt;= __pyx_v_ke_view.shape[2])) __pyx_t_12 = 2;
    if (unlikely(__pyx_t_12 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_12);
      <span class='error_goto'>__PYX_ERR(0, 1150, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ke_view.data + __pyx_t_56 * __pyx_v_ke_view.strides[0]) ) + __pyx_t_57 * __pyx_v_ke_view.strides[1]) ) + __pyx_t_58 * __pyx_v_ke_view.strides[2]) )) = __pyx_t_19;
</pre>
    <pre class="cython line score-40"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1151</span>:         <span class="n">ke_view</span><span class="p">[</span><span class="n">x</span><span
            class="p">,</span> <span class="mf">3</span><span class="p">,</span> <span class="mf">1</span><span
            class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2</span> <span
            class="o">*</span> <span class="n">Mpq</span><span class="p">[</span><span class="n">x</span><span
            class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">1</span><span
            class="p">]</span><span class="o">.</span><span class="n">imag</span></pre>
    <pre class='cython code score-40 '>    __pyx_t_3 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_x);<span
            class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1151, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1151, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_int_0);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2, __pyx_int_1);
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_Mpq, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1151, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_imag);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1151, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_neg_2, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1151, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_19 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_3); if (unlikely((__pyx_t_19 == (double)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 1151, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_59 = __pyx_v_x;
    __pyx_t_60 = 3;
    __pyx_t_61 = 1;
    __pyx_t_12 = -1;
    if (__pyx_t_59 &lt; 0) {
      __pyx_t_59 += __pyx_v_ke_view.shape[0];
      if (unlikely(__pyx_t_59 &lt; 0)) __pyx_t_12 = 0;
    } else if (unlikely(__pyx_t_59 &gt;= __pyx_v_ke_view.shape[0])) __pyx_t_12 = 0;
    if (__pyx_t_60 &lt; 0) {
      __pyx_t_60 += __pyx_v_ke_view.shape[1];
      if (unlikely(__pyx_t_60 &lt; 0)) __pyx_t_12 = 1;
    } else if (unlikely(__pyx_t_60 &gt;= __pyx_v_ke_view.shape[1])) __pyx_t_12 = 1;
    if (__pyx_t_61 &lt; 0) {
      __pyx_t_61 += __pyx_v_ke_view.shape[2];
      if (unlikely(__pyx_t_61 &lt; 0)) __pyx_t_12 = 2;
    } else if (unlikely(__pyx_t_61 &gt;= __pyx_v_ke_view.shape[2])) __pyx_t_12 = 2;
    if (unlikely(__pyx_t_12 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_12);
      <span class='error_goto'>__PYX_ERR(0, 1151, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ke_view.data + __pyx_t_59 * __pyx_v_ke_view.strides[0]) ) + __pyx_t_60 * __pyx_v_ke_view.strides[1]) ) + __pyx_t_61 * __pyx_v_ke_view.strides[2]) )) = __pyx_t_19;
</pre>
    <pre class="cython line score-68"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1152</span>:         <span class="n">ke_view</span><span class="p">[</span><span class="n">x</span><span
            class="p">,</span> <span class="mf">3</span><span class="p">,</span> <span class="mf">2</span><span
            class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">Mpq</span><span
            class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span
            class="mf">0</span><span class="p">]</span><span class="o">.</span><span class="n">imag</span> <span
            class="o">-</span> <span class="n">Mpq</span><span class="p">[</span><span class="n">x</span><span
            class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">1</span><span
            class="p">]</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span></pre>
    <pre class='cython code score-68 '>    __pyx_t_3 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_x);<span
            class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1152, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1152, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_int_0);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2, __pyx_int_0);
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_Mpq, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1152, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_imag);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1152, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_x);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1152, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1152, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_int_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, __pyx_int_1);
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_Mpq, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1152, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_imag);<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1152, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_4, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1152, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Negative</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1152, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_19 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2); if (unlikely((__pyx_t_19 == (double)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 1152, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_62 = __pyx_v_x;
    __pyx_t_63 = 3;
    __pyx_t_64 = 2;
    __pyx_t_12 = -1;
    if (__pyx_t_62 &lt; 0) {
      __pyx_t_62 += __pyx_v_ke_view.shape[0];
      if (unlikely(__pyx_t_62 &lt; 0)) __pyx_t_12 = 0;
    } else if (unlikely(__pyx_t_62 &gt;= __pyx_v_ke_view.shape[0])) __pyx_t_12 = 0;
    if (__pyx_t_63 &lt; 0) {
      __pyx_t_63 += __pyx_v_ke_view.shape[1];
      if (unlikely(__pyx_t_63 &lt; 0)) __pyx_t_12 = 1;
    } else if (unlikely(__pyx_t_63 &gt;= __pyx_v_ke_view.shape[1])) __pyx_t_12 = 1;
    if (__pyx_t_64 &lt; 0) {
      __pyx_t_64 += __pyx_v_ke_view.shape[2];
      if (unlikely(__pyx_t_64 &lt; 0)) __pyx_t_12 = 2;
    } else if (unlikely(__pyx_t_64 &gt;= __pyx_v_ke_view.shape[2])) __pyx_t_12 = 2;
    if (unlikely(__pyx_t_12 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_12);
      <span class='error_goto'>__PYX_ERR(0, 1152, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ke_view.data + __pyx_t_62 * __pyx_v_ke_view.strides[0]) ) + __pyx_t_63 * __pyx_v_ke_view.strides[1]) ) + __pyx_t_64 * __pyx_v_ke_view.strides[2]) )) = __pyx_t_19;
</pre>
    <pre class="cython line score-68"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1153</span>:         <span class="n">ke_view</span><span class="p">[</span><span class="n">x</span><span
            class="p">,</span> <span class="mf">3</span><span class="p">,</span> <span class="mf">3</span><span
            class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">Mpq</span><span
            class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span
            class="mf">0</span><span class="p">]</span><span class="o">.</span><span class="n">real</span> <span
            class="o">+</span> <span class="n">Mpq</span><span class="p">[</span><span class="n">x</span><span
            class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">1</span><span
            class="p">]</span><span class="o">.</span><span class="n">real</span><span class="p">)</span></pre>
    <pre class='cython code score-68 '>    __pyx_t_2 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_x);<span
            class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1153, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1153, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_0);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 2, __pyx_int_0);
    __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_Mpq, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1153, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_real);<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1153, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_x);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1153, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1153, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_int_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2, __pyx_int_1);
    __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_Mpq, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1153, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_real);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1153, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1153, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Negative</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1153, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_19 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_4); if (unlikely((__pyx_t_19 == (double)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 1153, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_65 = __pyx_v_x;
    __pyx_t_66 = 3;
    __pyx_t_67 = 3;
    __pyx_t_12 = -1;
    if (__pyx_t_65 &lt; 0) {
      __pyx_t_65 += __pyx_v_ke_view.shape[0];
      if (unlikely(__pyx_t_65 &lt; 0)) __pyx_t_12 = 0;
    } else if (unlikely(__pyx_t_65 &gt;= __pyx_v_ke_view.shape[0])) __pyx_t_12 = 0;
    if (__pyx_t_66 &lt; 0) {
      __pyx_t_66 += __pyx_v_ke_view.shape[1];
      if (unlikely(__pyx_t_66 &lt; 0)) __pyx_t_12 = 1;
    } else if (unlikely(__pyx_t_66 &gt;= __pyx_v_ke_view.shape[1])) __pyx_t_12 = 1;
    if (__pyx_t_67 &lt; 0) {
      __pyx_t_67 += __pyx_v_ke_view.shape[2];
      if (unlikely(__pyx_t_67 &lt; 0)) __pyx_t_12 = 2;
    } else if (unlikely(__pyx_t_67 &gt;= __pyx_v_ke_view.shape[2])) __pyx_t_12 = 2;
    if (unlikely(__pyx_t_12 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_12);
      <span class='error_goto'>__PYX_ERR(0, 1153, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ke_view.data + __pyx_t_65 * __pyx_v_ke_view.strides[0]) ) + __pyx_t_66 * __pyx_v_ke_view.strides[1]) ) + __pyx_t_67 * __pyx_v_ke_view.strides[2]) )) = __pyx_t_19;
  }
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1154</span>: </pre>
    <pre class="cython line score-2"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1155</span>:     <span class="k">return</span> <span class="n">ke</span></pre>
    <pre class='cython code score-2 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_double</span>(__pyx_v_ke, PyBUF_WRITABLE);<span
            class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1155, __pyx_L1_error)</span>
  __pyx_r = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
  goto __pyx_L0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1156</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">1157</span>: <span class="c"># ----------------------------------------------------------------------------------------------------------------------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1158</span>: <span
            class="c"># Orientation Function</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1159</span>: <span class="c"># ----------------------------------------------------------------------------------------------------------------------</span></pre>
    <pre class="cython line score-9"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1160</span>: <span class="k">cdef</span> <span class="nf">gaussian</span><span
            class="p">(</span><span class="nb">float</span> <span class="n">std</span><span class="p">,</span> <span
            class="nb">float</span> <span class="n">mean</span><span class="p">):</span></pre>
    <pre class='cython code score-9 '>static PyObject *__pyx_f_6pyrism_4core_3tma_gaussian(float __pyx_v_std, float __pyx_v_mean) {
  struct __pyx_obj_6pyrism_4core_3tma___pyx_scope_struct____pyx_f_6pyrism_4core_3tma_gaussian *__pyx_cur_scope;
  PyObject *__pyx_v_pdf = 0;
  float __pyx_v_norm_dev;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("gaussian", 0);
  __pyx_cur_scope = (struct __pyx_obj_6pyrism_4core_3tma___pyx_scope_struct____pyx_f_6pyrism_4core_3tma_gaussian *)__pyx_tp_new_6pyrism_4core_3tma___pyx_scope_struct____pyx_f_6pyrism_4core_3tma_gaussian(__pyx_ptype_6pyrism_4core_3tma___pyx_scope_struct____pyx_f_6pyrism_4core_3tma_gaussian, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    __pyx_cur_scope = ((struct __pyx_obj_6pyrism_4core_3tma___pyx_scope_struct____pyx_f_6pyrism_4core_3tma_gaussian *)Py_None);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    <span class='error_goto'>__PYX_ERR(0, 1160, __pyx_L1_error)</span>
  } else {
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_cur_scope);
  }
  __pyx_cur_scope-&gt;__pyx_v_std = __pyx_v_std;
  __pyx_cur_scope-&gt;__pyx_v_mean = __pyx_v_mean;
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.gaussian", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_pdf);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_cur_scope));
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* â€¦ */
struct __pyx_obj_6pyrism_4core_3tma___pyx_scope_struct____pyx_f_6pyrism_4core_3tma_gaussian {
  PyObject_HEAD
  float __pyx_v_mean;
  float __pyx_v_norm_const;
  float __pyx_v_std;
};

</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1161</span>:     <span class="sd">&quot;&quot;&quot;Gaussian probability distribution function (PDF) for orientation averaging.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1162</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">1163</span>: <span class="sd">    Parameters</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1164</span>: <span class="sd">    ----------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1165</span>: <span class="sd">    std : float</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1166</span>: <span class="sd">        The standard deviation in degrees of the Gaussian PDF</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1167</span>: <span class="sd">    mean : float</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1168</span>: <span class="sd">        The mean in degrees of the Gaussian PDF.  This should be a number in the interval [0, 180)</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1169</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">1170</span>: <span class="sd">    Returns</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1171</span>: <span class="sd">    -------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1172</span>: <span
            class="sd">    pdf(x): callable</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1173</span>: <span class="sd">        A function that returns the value of the spherical Jacobian-normalized Gaussian PDF with the given STD at x</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1174</span>: <span class="sd">        (degrees). It is normalized for the interval [0, 180].</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1175</span>: <span
            class="sd">    &quot;&quot;&quot;</span></pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1176</span>:     <span class="k">cdef</span> <span class="kt">float</span> <span class="nf">norm_const</span> <span
            class="o">=</span> <span class="mf">1.0</span></pre>
    <pre class='cython code score-0 '>  __pyx_cur_scope-&gt;__pyx_v_norm_const = 1.0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1177</span>: </pre>
    <pre class="cython line score-19"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1178</span>:     <span class="k">def</span> <span class="nf">pdf</span><span
            class="p">(</span><span class="n">x</span><span class="p">):</span></pre>
    <pre class='cython code score-19 '>/* Python wrapper */
static PyObject *__pyx_pw_6pyrism_4core_3tma_8gaussian_1pdf(PyObject *__pyx_self, PyObject *__pyx_v_x); /*proto*/
static PyMethodDef __pyx_mdef_6pyrism_4core_3tma_8gaussian_1pdf = {"pdf", (PyCFunction)__pyx_pw_6pyrism_4core_3tma_8gaussian_1pdf, METH_O, 0};
static PyObject *__pyx_pw_6pyrism_4core_3tma_8gaussian_1pdf(PyObject *__pyx_self, PyObject *__pyx_v_x) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("pdf (wrapper)", 0);
  __pyx_r = __pyx_pf_6pyrism_4core_3tma_8gaussian_pdf(__pyx_self, ((PyObject *)__pyx_v_x));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6pyrism_4core_3tma_8gaussian_pdf(PyObject *__pyx_self, PyObject *__pyx_v_x) {
  struct __pyx_obj_6pyrism_4core_3tma___pyx_scope_struct____pyx_f_6pyrism_4core_3tma_gaussian *__pyx_cur_scope;
  struct __pyx_obj_6pyrism_4core_3tma___pyx_scope_struct____pyx_f_6pyrism_4core_3tma_gaussian *__pyx_outer_scope;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("pdf", 0);
  __pyx_outer_scope = (struct __pyx_obj_6pyrism_4core_3tma___pyx_scope_struct____pyx_f_6pyrism_4core_3tma_gaussian *) <span
                class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.gaussian.pdf", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* â€¦ */
  __pyx_tuple__28 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_n_s_x);<span class='error_goto'> if (unlikely(!__pyx_tuple__28)) __PYX_ERR(0, 1178, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__28);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__28);
/* â€¦ */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_6pyrism_4core_3tma_8gaussian_1pdf, 0, __pyx_n_s_gaussian_locals_pdf, ((PyObject*)__pyx_cur_scope), __pyx_n_s_pyrism_core_tma, __pyx_d, ((PyObject *)__pyx_codeobj__29));<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1178, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_pdf = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_codeobj__29 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__28, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyrism_core_tma_pyx, __pyx_n_s_pdf, 1178, __pyx_empty_bytes);<span
                class='error_goto'> if (unlikely(!__pyx_codeobj__29)) __PYX_ERR(0, 1178, __pyx_L1_error)</span>
</pre>
    <pre class="cython line score-96"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1179</span>:         <span class="k">return</span> <span class="n">norm_const</span> <span
            class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span
            class="p">(</span><span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span
            class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="n">mean</span><span
            class="p">)</span> <span class="o">/</span> <span class="n">std</span><span class="p">)</span> <span
            class="o">**</span> <span class="mf">2</span><span class="p">)</span> <span class="o">*</span> \</pre>
    <pre class='cython code score-96 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_cur_scope-&gt;__pyx_v_norm_const);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1179, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1179, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_exp);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1179, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_cur_scope-&gt;__pyx_v_mean);<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1179, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_x, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1179, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_cur_scope-&gt;__pyx_v_std);<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1179, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_5, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1179, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Power</span>(__pyx_t_6, __pyx_int_2, Py_None);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1179, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_float_neg_0_5, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1179, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1179, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  } else {
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_4)) {
      PyObject *__pyx_temp[2] = {__pyx_t_3, __pyx_t_6};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1179, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_4)) {
      PyObject *__pyx_temp[2] = {__pyx_t_3, __pyx_t_6};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1179, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    } else
    #endif
    {
      __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1179, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_3); __pyx_t_3 = NULL;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+1, __pyx_t_6);
      __pyx_t_6 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_5, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1179, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1179, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* â€¦ */
  __pyx_t_5 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_4, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1179, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_r = __pyx_t_5;
  __pyx_t_5 = 0;
  goto __pyx_L0;
</pre>
    <pre class="cython line score-55"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1180</span>:                <span class="n">np</span><span class="o">.</span><span
            class="n">sin</span><span class="p">(</span><span class="n">PI</span> <span class="o">/</span> <span
            class="mf">180.0</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span></pre>
    <pre class='cython code score-55 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span
            class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1180, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_sin);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1180, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((((double)__pyx_v_6pyrism_4core_3tma_PI) / 180.0));<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1180, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_v_x);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1180, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  if (!__pyx_t_1) {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1180, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  } else {
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_5)) {
      PyObject *__pyx_temp[2] = {__pyx_t_1, __pyx_t_6};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1180, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_5)) {
      PyObject *__pyx_temp[2] = {__pyx_t_1, __pyx_t_6};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1180, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    } else
    #endif
    {
      __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1180, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1); __pyx_t_1 = NULL;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+1, __pyx_t_6);
      __pyx_t_6 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_3, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1180, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1181</span>: </pre>
    <pre class="cython line score-55"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1182</span>:     <span class="k">cdef</span> <span class="kt">float</span> <span class="nf">norm_dev</span> <span
            class="o">=</span> <span class="n">quad</span><span class="p">(</span><span class="n">pdf</span><span
            class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">180.0</span><span
            class="p">)[</span><span class="mf">0</span><span class="p">]</span></pre>
    <pre class='cython code score-55 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_quad);<span
            class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1182, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  __pyx_t_4 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_4 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_2)) {
    PyObject *__pyx_temp[4] = {__pyx_t_3, __pyx_v_pdf, __pyx_float_0_0, __pyx_float_180_0};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 3+__pyx_t_4);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1182, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_2)) {
    PyObject *__pyx_temp[4] = {__pyx_t_3, __pyx_v_pdf, __pyx_float_0_0, __pyx_float_180_0};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 3+__pyx_t_4);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1182, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else
  #endif
  {
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1182, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (__pyx_t_3) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_3); __pyx_t_3 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_pdf);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_pdf);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+__pyx_t_4, __pyx_v_pdf);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_0_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_0_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1+__pyx_t_4, __pyx_float_0_0);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_180_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_180_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 2+__pyx_t_4, __pyx_float_180_0);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1182, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span
                class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1182, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_6 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_t_2); if (unlikely((__pyx_t_6 == (float)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 1182, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_norm_dev = __pyx_t_6;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1183</span>:     <span class="c"># ensure that the integral over the distribution equals 1</span></pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1184</span>:     <span class="n">norm_const</span> <span class="o">/=</span> <span class="n">norm_dev</span></pre>
    <pre class='cython code score-0 '>  __pyx_cur_scope-&gt;__pyx_v_norm_const = (__pyx_cur_scope-&gt;__pyx_v_norm_const / __pyx_v_norm_dev);
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1185</span>: </pre>
    <pre class="cython line score-2"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1186</span>:     <span class="k">return</span> <span class="n">pdf</span></pre>
    <pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_pdf);
  __pyx_r = __pyx_v_pdf;
  goto __pyx_L0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1187</span>: </pre>
    <pre class="cython line score-9"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1188</span>: <span class="k">cdef</span> <span class="nf">uniform</span><span class="p">():</span></pre>
    <pre class='cython code score-9 '>static PyObject *__pyx_f_6pyrism_4core_3tma_uniform(void) {
  struct __pyx_obj_6pyrism_4core_3tma___pyx_scope_struct_1___pyx_f_6pyrism_4core_3tma_uniform *__pyx_cur_scope;
  PyObject *__pyx_v_pdf = 0;
  float __pyx_v_norm_dev;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("uniform", 0);
  __pyx_cur_scope = (struct __pyx_obj_6pyrism_4core_3tma___pyx_scope_struct_1___pyx_f_6pyrism_4core_3tma_uniform *)__pyx_tp_new_6pyrism_4core_3tma___pyx_scope_struct_1___pyx_f_6pyrism_4core_3tma_uniform(__pyx_ptype_6pyrism_4core_3tma___pyx_scope_struct_1___pyx_f_6pyrism_4core_3tma_uniform, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    __pyx_cur_scope = ((struct __pyx_obj_6pyrism_4core_3tma___pyx_scope_struct_1___pyx_f_6pyrism_4core_3tma_uniform *)Py_None);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    <span class='error_goto'>__PYX_ERR(0, 1188, __pyx_L1_error)</span>
  } else {
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_cur_scope);
  }
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.uniform", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_pdf);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_cur_scope));
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* â€¦ */
struct __pyx_obj_6pyrism_4core_3tma___pyx_scope_struct_1___pyx_f_6pyrism_4core_3tma_uniform {
  PyObject_HEAD
  float __pyx_v_norm_const;
};

</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1189</span>:     <span class="sd">&quot;&quot;&quot;Uniform probability distribution function (PDF) for orientation averaging.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1190</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">1191</span>: <span class="sd">    Returns</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1192</span>: <span class="sd">    -------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1193</span>: <span
            class="sd">    pdf(x): callable</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1194</span>: <span class="sd">        A function that returns the value of the spherical Jacobian-normalized uniform PDF. It is normalized for</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1195</span>: <span
            class="sd">        the interval [0, 180].</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1196</span>: <span
            class="sd">    &quot;&quot;&quot;</span></pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1197</span>:     <span class="k">cdef</span> <span class="kt">float</span> <span class="nf">norm_const</span> <span
            class="o">=</span> <span class="mf">1.0</span></pre>
    <pre class='cython code score-0 '>  __pyx_cur_scope-&gt;__pyx_v_norm_const = 1.0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1198</span>: </pre>
    <pre class="cython line score-19"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1199</span>:     <span class="k">def</span> <span class="nf">pdf</span><span
            class="p">(</span><span class="n">x</span><span class="p">):</span></pre>
    <pre class='cython code score-19 '>/* Python wrapper */
static PyObject *__pyx_pw_6pyrism_4core_3tma_7uniform_1pdf(PyObject *__pyx_self, PyObject *__pyx_v_x); /*proto*/
static PyMethodDef __pyx_mdef_6pyrism_4core_3tma_7uniform_1pdf = {"pdf", (PyCFunction)__pyx_pw_6pyrism_4core_3tma_7uniform_1pdf, METH_O, 0};
static PyObject *__pyx_pw_6pyrism_4core_3tma_7uniform_1pdf(PyObject *__pyx_self, PyObject *__pyx_v_x) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("pdf (wrapper)", 0);
  __pyx_r = __pyx_pf_6pyrism_4core_3tma_7uniform_pdf(__pyx_self, ((PyObject *)__pyx_v_x));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6pyrism_4core_3tma_7uniform_pdf(PyObject *__pyx_self, PyObject *__pyx_v_x) {
  struct __pyx_obj_6pyrism_4core_3tma___pyx_scope_struct_1___pyx_f_6pyrism_4core_3tma_uniform *__pyx_cur_scope;
  struct __pyx_obj_6pyrism_4core_3tma___pyx_scope_struct_1___pyx_f_6pyrism_4core_3tma_uniform *__pyx_outer_scope;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("pdf", 0);
  __pyx_outer_scope = (struct __pyx_obj_6pyrism_4core_3tma___pyx_scope_struct_1___pyx_f_6pyrism_4core_3tma_uniform *) <span
                class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.uniform.pdf", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* â€¦ */
  __pyx_tuple__30 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_n_s_x);<span class='error_goto'> if (unlikely(!__pyx_tuple__30)) __PYX_ERR(0, 1199, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__30);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__30);
/* â€¦ */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_6pyrism_4core_3tma_7uniform_1pdf, 0, __pyx_n_s_uniform_locals_pdf, ((PyObject*)__pyx_cur_scope), __pyx_n_s_pyrism_core_tma, __pyx_d, ((PyObject *)__pyx_codeobj__31));<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1199, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_pdf = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_codeobj__31 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__30, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyrism_core_tma_pyx, __pyx_n_s_pdf, 1199, __pyx_empty_bytes);<span
                class='error_goto'> if (unlikely(!__pyx_codeobj__31)) __PYX_ERR(0, 1199, __pyx_L1_error)</span>
</pre>
    <pre class="cython line score-68"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1200</span>:         <span class="k">return</span> <span class="n">norm_const</span> <span
            class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span
            class="p">(</span><span class="n">PI</span> <span class="o">/</span> <span class="mf">180.0</span> <span
            class="o">*</span> <span class="n">x</span><span class="p">)</span></pre>
    <pre class='cython code score-68 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_cur_scope-&gt;__pyx_v_norm_const);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1200, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1200, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_sin);<span
                class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1200, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>((((double)__pyx_v_6pyrism_4core_3tma_PI) / 180.0));<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1200, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_3, __pyx_v_x);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1200, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1200, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  } else {
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_4)) {
      PyObject *__pyx_temp[2] = {__pyx_t_3, __pyx_t_5};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1200, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_4)) {
      PyObject *__pyx_temp[2] = {__pyx_t_3, __pyx_t_5};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-1, 1+1);<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1200, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    } else
    #endif
    {
      __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1200, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_3); __pyx_t_3 = NULL;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0+1, __pyx_t_5);
      __pyx_t_5 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_6, NULL);<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1200, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1200, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_r = __pyx_t_4;
  __pyx_t_4 = 0;
  goto __pyx_L0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1201</span>: </pre>
    <pre class="cython line score-55"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1202</span>:     <span class="k">cdef</span> <span class="kt">float</span> <span class="nf">norm_dev</span> <span
            class="o">=</span> <span class="n">quad</span><span class="p">(</span><span class="n">pdf</span><span
            class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">180.0</span><span
            class="p">)[</span><span class="mf">0</span><span class="p">]</span></pre>
    <pre class='cython code score-55 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_quad);<span
            class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1202, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  __pyx_t_4 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_4 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_2)) {
    PyObject *__pyx_temp[4] = {__pyx_t_3, __pyx_v_pdf, __pyx_float_0_0, __pyx_float_180_0};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 3+__pyx_t_4);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1202, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_2)) {
    PyObject *__pyx_temp[4] = {__pyx_t_3, __pyx_v_pdf, __pyx_float_0_0, __pyx_float_180_0};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 3+__pyx_t_4);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1202, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else
  #endif
  {
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1202, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (__pyx_t_3) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_3); __pyx_t_3 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_pdf);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_pdf);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+__pyx_t_4, __pyx_v_pdf);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_0_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_0_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1+__pyx_t_4, __pyx_float_0_0);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_180_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_180_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 2+__pyx_t_4, __pyx_float_180_0);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1202, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span
                class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1202, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_6 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_t_2); if (unlikely((__pyx_t_6 == (float)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 1202, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_norm_dev = __pyx_t_6;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1203</span>:     <span class="c"># ensure that the integral over the distribution equals 1</span></pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1204</span>:     <span class="n">norm_const</span> <span class="o">/=</span> <span class="n">norm_dev</span></pre>
    <pre class='cython code score-0 '>  __pyx_cur_scope-&gt;__pyx_v_norm_const = (__pyx_cur_scope-&gt;__pyx_v_norm_const / __pyx_v_norm_dev);
</pre>
    <pre class="cython line score-2"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1205</span>:     <span class="k">return</span> <span class="n">pdf</span></pre>
    <pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_pdf);
  __pyx_r = __pyx_v_pdf;
  goto __pyx_L0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1206</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">1207</span>: <span class="c"># ----------------------------------------------------------------------------------------------------------------------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1208</span>: <span
            class="c"># Other Auxiliary Functions</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1209</span>: <span class="c"># ----------------------------------------------------------------------------------------------------------------------</span></pre>
    <pre class="cython line score-13"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1210</span>: <span class="k">cdef</span> <span class="kt">double</span>[<span
            class="p">:]</span> <span class="n">equal_volume_from_maximum</span><span class="p">(</span><span class="n">double</span><span
            class="p">[:]</span> <span class="n">radius</span><span class="p">,</span> <span
            class="n">double</span><span class="p">[:]</span> <span class="n">axis_ratio</span><span class="p">,</span> <span
            class="nb">int</span> <span class="n">shape</span><span class="p">):</span></pre>
    <pre class='cython code score-13 '>static __Pyx_memviewslice __pyx_f_6pyrism_4core_3tma_equal_volume_from_maximum(__Pyx_memviewslice __pyx_v_radius, __Pyx_memviewslice __pyx_v_axis_ratio, int __pyx_v_shape) {
  Py_ssize_t __pyx_v_xmax;
  Py_ssize_t __pyx_v_x;
  PyObject *__pyx_v_result = NULL;
  __Pyx_memviewslice __pyx_v_result_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_r = { 0, 0, { 0 }, { 0 }, { 0 } };
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("equal_volume_from_maximum", 0);
/* â€¦ */
  /* function exit code */
  __Pyx_pretend_to_initialize(&amp;__pyx_r);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  __pyx_r.data = NULL;
  __pyx_r.memview = NULL;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.equal_volume_from_maximum", __pyx_clineno, __pyx_lineno, __pyx_filename);

  goto __pyx_L2;
  __pyx_L0:;
  if (unlikely(!__pyx_r.memview)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "Memoryview return value is not initialized");
  }
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_result);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_result_view, 1);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1211</span>:     <span
            class="sd">&quot;&quot;&quot;</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1212</span>: <span class="sd">    Convert maximum radius into volume equivalent radius</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1213</span>: <span class="sd">    </span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1214</span>: <span class="sd">    Parameters</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1215</span>: <span class="sd">    ----------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1216</span>: <span
            class="sd">    radius : double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1217</span>: <span class="sd">        Equivalent particle radius in same unit as wavelength.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1218</span>: <span
            class="sd">    axis_ratio : double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1219</span>: <span class="sd">        The horizontal-to-rotational axis ratio.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1220</span>: <span class="sd">    shape : int, {-1, -2}</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1221</span>: <span
            class="sd">        Shape of the particle:</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1222</span>: <span
            class="sd">            * -1 : spheroid,</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1223</span>: <span
            class="sd">            * -2 : cylinders.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1224</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">1225</span>: <span class="sd">    Returns</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1226</span>: <span class="sd">    -------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1227</span>: <span
            class="sd">    Rv : MemoryView, double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1228</span>: <span class="sd">        Volume equivalent radius.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1229</span>: <span
            class="sd">    &quot;&quot;&quot;</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1230</span>:     <span class="k">cdef</span> <span class="kt">float</span> <span
            class="nf">r_eq</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1231</span>:     <span class="k">cdef</span><span
            class="p">:</span></pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1232</span>:         <span class="n">Py_ssize_t</span> <span class="n">xmax</span> <span class="o">=</span> <span
            class="n">radius</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span
            class="mf">0</span><span class="p">]</span></pre>
    <pre class='cython code score-0 '>  __pyx_v_xmax = (__pyx_v_radius.shape[0]);
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1233</span>:         <span class="n">Py_ssize_t</span> <span
            class="n">x</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1234</span>: </pre>
    <pre class="cython line score-29"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1235</span>:     <span class="n">result</span> <span class="o">=</span> <span
            class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span
            class="n">radius</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span
            class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">)</span></pre>
    <pre class='cython code score-29 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span
            class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1235, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros_like);<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1235, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_radius, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1235, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1235, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1235, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1235, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_double);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1235, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 1235, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, __pyx_t_1);<span
                class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1235, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_result = __pyx_t_5;
  __pyx_t_5 = 0;
</pre>
    <pre class="cython line score-2"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1236</span>:     <span class="k">cdef</span> <span class="kt">double</span>[<span
            class="p">:]</span> <span class="n">result_view</span> <span class="o">=</span> <span
            class="n">result</span></pre>
    <pre class='cython code score-2 '>  __pyx_t_6 = <span
            class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_v_result, PyBUF_WRITABLE);<span
            class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1236, __pyx_L1_error)</span>
  __pyx_v_result_view = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1237</span>: </pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1238</span>:     <span class="k">for</span> <span class="n">x</span> <span
            class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">xmax</span><span
            class="p">):</span></pre>
    <pre class='cython code score-0 '>  __pyx_t_7 = __pyx_v_xmax;
  __pyx_t_8 = __pyx_t_7;
  for (__pyx_t_9 = 0; __pyx_t_9 &lt; __pyx_t_8; __pyx_t_9+=1) {
    __pyx_v_x = __pyx_t_9;
</pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1239</span>:         <span class="k">if</span> <span class="n">shape</span> <span
            class="o">==</span> <span class="o">-</span><span class="mf">1</span><span class="p">:</span></pre>
    <pre class='cython code score-0 '>    switch (__pyx_v_shape) {
      case -1L:
/* â€¦ */
      break;
</pre>
    <pre class="cython line score-2"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1240</span>:             <span class="k">if</span> <span class="n">axis_ratio</span><span
            class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">&gt;</span> <span
            class="mf">1.0</span><span class="p">:</span>  <span class="c"># oblate</span></pre>
    <pre class='cython code score-2 '>      __pyx_t_10 = __pyx_v_x;
      __pyx_t_11 = -1;
      if (__pyx_t_10 &lt; 0) {
        __pyx_t_10 += __pyx_v_axis_ratio.shape[0];
        if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_11 = 0;
      } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_axis_ratio.shape[0])) __pyx_t_11 = 0;
      if (unlikely(__pyx_t_11 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
        <span class='error_goto'>__PYX_ERR(0, 1240, __pyx_L1_error)</span>
      }
      __pyx_t_12 = (((*((double *) ( /* dim=0 */ (__pyx_v_axis_ratio.data + __pyx_t_10 * __pyx_v_axis_ratio.strides[0]) ))) &gt; 1.0) != 0);
      if (__pyx_t_12) {
/* â€¦ */
        goto __pyx_L5;
      }
</pre>
    <pre class="cython line score-6"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1241</span>:                 <span class="n">result_view</span><span class="p">[</span><span
            class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">radius</span><span
            class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">/</span> <span class="n">axis_ratio</span><span
            class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">**</span> <span
            class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="mf">3.0</span><span
            class="p">)</span></pre>
    <pre class='cython code score-6 '>        __pyx_t_13 = __pyx_v_x;
        __pyx_t_11 = -1;
        if (__pyx_t_13 &lt; 0) {
          __pyx_t_13 += __pyx_v_radius.shape[0];
          if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_13 &gt;= __pyx_v_radius.shape[0])) __pyx_t_11 = 0;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 1241, __pyx_L1_error)</span>
        }
        __pyx_t_14 = __pyx_v_x;
        __pyx_t_11 = -1;
        if (__pyx_t_14 &lt; 0) {
          __pyx_t_14 += __pyx_v_axis_ratio.shape[0];
          if (unlikely(__pyx_t_14 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_14 &gt;= __pyx_v_axis_ratio.shape[0])) __pyx_t_11 = 0;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 1241, __pyx_L1_error)</span>
        }
        __pyx_t_15 = __pyx_v_x;
        __pyx_t_11 = -1;
        if (__pyx_t_15 &lt; 0) {
          __pyx_t_15 += __pyx_v_result_view.shape[0];
          if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_result_view.shape[0])) __pyx_t_11 = 0;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 1241, __pyx_L1_error)</span>
        }
        *((double *) ( /* dim=0 */ (__pyx_v_result_view.data + __pyx_t_15 * __pyx_v_result_view.strides[0]) )) = ((*((double *) ( /* dim=0 */ (__pyx_v_radius.data + __pyx_t_13 * __pyx_v_radius.strides[0]) ))) / pow((*((double *) ( /* dim=0 */ (__pyx_v_axis_ratio.data + __pyx_t_14 * __pyx_v_axis_ratio.strides[0]) ))), (1.0 / 3.0)));
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1242</span>:             <span class="k">else</span><span
            class="p">:</span>  <span class="c"># prolate</span></pre>
    <pre class="cython line score-6"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1243</span>:                 <span class="n">result_view</span><span class="p">[</span><span
            class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">radius</span><span
            class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">/</span> <span class="n">axis_ratio</span><span
            class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">**</span> <span
            class="p">(</span><span class="mf">2.0</span> <span class="o">/</span> <span class="mf">3.0</span><span
            class="p">)</span></pre>
    <pre class='cython code score-6 '>      /*else*/ {
        __pyx_t_16 = __pyx_v_x;
        __pyx_t_11 = -1;
        if (__pyx_t_16 &lt; 0) {
          __pyx_t_16 += __pyx_v_radius.shape[0];
          if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_16 &gt;= __pyx_v_radius.shape[0])) __pyx_t_11 = 0;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 1243, __pyx_L1_error)</span>
        }
        __pyx_t_17 = __pyx_v_x;
        __pyx_t_11 = -1;
        if (__pyx_t_17 &lt; 0) {
          __pyx_t_17 += __pyx_v_axis_ratio.shape[0];
          if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_17 &gt;= __pyx_v_axis_ratio.shape[0])) __pyx_t_11 = 0;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 1243, __pyx_L1_error)</span>
        }
        __pyx_t_18 = __pyx_v_x;
        __pyx_t_11 = -1;
        if (__pyx_t_18 &lt; 0) {
          __pyx_t_18 += __pyx_v_result_view.shape[0];
          if (unlikely(__pyx_t_18 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_18 &gt;= __pyx_v_result_view.shape[0])) __pyx_t_11 = 0;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 1243, __pyx_L1_error)</span>
        }
        *((double *) ( /* dim=0 */ (__pyx_v_result_view.data + __pyx_t_18 * __pyx_v_result_view.strides[0]) )) = ((*((double *) ( /* dim=0 */ (__pyx_v_radius.data + __pyx_t_16 * __pyx_v_radius.strides[0]) ))) / pow((*((double *) ( /* dim=0 */ (__pyx_v_axis_ratio.data + __pyx_t_17 * __pyx_v_axis_ratio.strides[0]) ))), (2.0 / 3.0)));
      }
      __pyx_L5:;
</pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1244</span>:         <span class="k">elif</span> <span class="n">shape</span> <span
            class="o">==</span> <span class="o">-</span><span class="mf">2</span><span class="p">:</span></pre>
    <pre class='cython code score-0 '>      case -2L:
/* â€¦ */
      break;
      default:
</pre>
    <pre class="cython line score-2"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1245</span>:             <span class="k">if</span> <span class="n">axis_ratio</span><span
            class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">&gt;</span> <span
            class="mf">1.0</span><span class="p">:</span>  <span class="c"># oblate</span></pre>
    <pre class='cython code score-2 '>      __pyx_t_19 = __pyx_v_x;
      __pyx_t_11 = -1;
      if (__pyx_t_19 &lt; 0) {
        __pyx_t_19 += __pyx_v_axis_ratio.shape[0];
        if (unlikely(__pyx_t_19 &lt; 0)) __pyx_t_11 = 0;
      } else if (unlikely(__pyx_t_19 &gt;= __pyx_v_axis_ratio.shape[0])) __pyx_t_11 = 0;
      if (unlikely(__pyx_t_11 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
        <span class='error_goto'>__PYX_ERR(0, 1245, __pyx_L1_error)</span>
      }
      __pyx_t_12 = (((*((double *) ( /* dim=0 */ (__pyx_v_axis_ratio.data + __pyx_t_19 * __pyx_v_axis_ratio.strides[0]) ))) &gt; 1.0) != 0);
      if (__pyx_t_12) {
/* â€¦ */
        goto __pyx_L6;
      }
</pre>
    <pre class="cython line score-6"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1246</span>:                 <span class="n">result_view</span><span class="p">[</span><span
            class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">radius</span><span
            class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span
            class="mf">0.75</span> <span class="o">/</span> <span class="n">axis_ratio</span><span
            class="p">[</span><span class="n">x</span><span class="p">])</span> <span class="o">**</span> <span
            class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="mf">3.0</span><span
            class="p">)</span></pre>
    <pre class='cython code score-6 '>        __pyx_t_20 = __pyx_v_x;
        __pyx_t_11 = -1;
        if (__pyx_t_20 &lt; 0) {
          __pyx_t_20 += __pyx_v_radius.shape[0];
          if (unlikely(__pyx_t_20 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_20 &gt;= __pyx_v_radius.shape[0])) __pyx_t_11 = 0;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 1246, __pyx_L1_error)</span>
        }
        __pyx_t_21 = __pyx_v_x;
        __pyx_t_11 = -1;
        if (__pyx_t_21 &lt; 0) {
          __pyx_t_21 += __pyx_v_axis_ratio.shape[0];
          if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_21 &gt;= __pyx_v_axis_ratio.shape[0])) __pyx_t_11 = 0;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 1246, __pyx_L1_error)</span>
        }
        __pyx_t_22 = __pyx_v_x;
        __pyx_t_11 = -1;
        if (__pyx_t_22 &lt; 0) {
          __pyx_t_22 += __pyx_v_result_view.shape[0];
          if (unlikely(__pyx_t_22 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_22 &gt;= __pyx_v_result_view.shape[0])) __pyx_t_11 = 0;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 1246, __pyx_L1_error)</span>
        }
        *((double *) ( /* dim=0 */ (__pyx_v_result_view.data + __pyx_t_22 * __pyx_v_result_view.strides[0]) )) = ((*((double *) ( /* dim=0 */ (__pyx_v_radius.data + __pyx_t_20 * __pyx_v_radius.strides[0]) ))) * pow((0.75 / (*((double *) ( /* dim=0 */ (__pyx_v_axis_ratio.data + __pyx_t_21 * __pyx_v_axis_ratio.strides[0]) )))), (1.0 / 3.0)));
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1247</span>:             <span class="k">else</span><span
            class="p">:</span>  <span class="c"># prolate</span></pre>
    <pre class="cython line score-6"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1248</span>:                 <span class="n">result_view</span><span class="p">[</span><span
            class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">radius</span><span
            class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span
            class="mf">0.75</span> <span class="o">/</span> <span class="n">axis_ratio</span><span
            class="p">[</span><span class="n">x</span><span class="p">])</span> <span class="o">**</span> <span
            class="p">(</span><span class="mf">2.0</span> <span class="o">/</span> <span class="mf">3.0</span><span
            class="p">)</span></pre>
    <pre class='cython code score-6 '>      /*else*/ {
        __pyx_t_23 = __pyx_v_x;
        __pyx_t_11 = -1;
        if (__pyx_t_23 &lt; 0) {
          __pyx_t_23 += __pyx_v_radius.shape[0];
          if (unlikely(__pyx_t_23 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_23 &gt;= __pyx_v_radius.shape[0])) __pyx_t_11 = 0;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 1248, __pyx_L1_error)</span>
        }
        __pyx_t_24 = __pyx_v_x;
        __pyx_t_11 = -1;
        if (__pyx_t_24 &lt; 0) {
          __pyx_t_24 += __pyx_v_axis_ratio.shape[0];
          if (unlikely(__pyx_t_24 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_24 &gt;= __pyx_v_axis_ratio.shape[0])) __pyx_t_11 = 0;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 1248, __pyx_L1_error)</span>
        }
        __pyx_t_25 = __pyx_v_x;
        __pyx_t_11 = -1;
        if (__pyx_t_25 &lt; 0) {
          __pyx_t_25 += __pyx_v_result_view.shape[0];
          if (unlikely(__pyx_t_25 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_25 &gt;= __pyx_v_result_view.shape[0])) __pyx_t_11 = 0;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 1248, __pyx_L1_error)</span>
        }
        *((double *) ( /* dim=0 */ (__pyx_v_result_view.data + __pyx_t_25 * __pyx_v_result_view.strides[0]) )) = ((*((double *) ( /* dim=0 */ (__pyx_v_radius.data + __pyx_t_23 * __pyx_v_radius.strides[0]) ))) * pow((0.75 / (*((double *) ( /* dim=0 */ (__pyx_v_axis_ratio.data + __pyx_t_24 * __pyx_v_axis_ratio.strides[0]) )))), (2.0 / 3.0)));
      }
      __pyx_L6:;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1249</span>:         <span class="k">else</span><span
            class="p">:</span></pre>
    <pre class="cython line score-10"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1250</span>:             <span class="k">raise</span> <span class="ne">ValueError</span><span
            class="p">(</span><span class="s">&quot;Parameter shape must be -1 or -2.&quot;</span><span
            class="p">)</span></pre>
    <pre class='cython code score-10 '>      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__32, NULL);<span
            class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1250, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_5, 0, 0, 0);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='error_goto'>__PYX_ERR(0, 1250, __pyx_L1_error)</span>
      break;
    }
/* â€¦ */
  __pyx_tuple__32 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_Parameter_shape_must_be_1_or_2);<span
                class='error_goto'> if (unlikely(!__pyx_tuple__32)) __PYX_ERR(0, 1250, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__32);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__32);
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1251</span>: </pre>
    <pre class="cython line score-2"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1252</span>:         <span class="k">return</span> <span class="n">result</span></pre>
    <pre class='cython code score-2 '>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_v_result, PyBUF_WRITABLE);<span
            class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1252, __pyx_L1_error)</span>
    __pyx_r = __pyx_t_6;
    __pyx_t_6.memview = NULL;
    __pyx_t_6.data = NULL;
    goto __pyx_L0;
  }
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1253</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">1254</span>: <span class="c"># ----------------------------------------------------------------------------------------------------------------------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1255</span>: <span
            class="c"># T-Matrix with PSD Integrator</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1256</span>: <span class="c"># ----------------------------------------------------------------------------------------------------------------------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1257</span>: <span class="c"># def init_SZ(double[:] wavelength, double[:] izaDeg, double[:] vzaDeg, double[:] iaaDeg, double[:] vaaDeg, double[:] alphaDeg,</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1258</span>: <span class="c">#             double[:] betaDeg, double[:] eps_real, double[:] eps_imag, double[:] axis_ratio, int shape,</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1259</span>: <span class="c">#             int radius_type, int num_points, double[:] psd_D,  int angular_integration, int verbose):</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1260</span>: <span class="c">#</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1261</span>: <span
            class="c">#     xmax = psd_D.shape[0]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1262</span>: <span class="c">#</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1263</span>: <span
            class="c">#     for x in range(xmax):</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1264</span>: <span class="c">#         D = np.zeros_like(wavelength, dtype=np.double) + psd_D[x]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1265</span>: <span class="c">#</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1266</span>: <span class="c">#         if verbose == 1:</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1267</span>: <span class="c">#             print(&quot;Computing point {x} at radius {D}...&quot;.format(x=x, D=D))</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1268</span>: <span class="c">#</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1269</span>: <span class="c">#         radius = D / 2.0</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1270</span>: <span class="c">#</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1271</span>: <span class="c">#         nmax = NMAX_VEC(radius=radius, radius_type=radius_type, wavelength=wavelength, eps_real=eps_real,</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1272</span>: <span class="c">#                         eps_imag=eps_imag, axis_ratio=axis_ratio, shape=shape)</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1273</span>: <span class="c">#</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1274</span>: <span class="c">#         S, Z = SZ_S_VEC(nmax, wavelength, izaDeg, vzaDeg, iaaDeg, vaaDeg, alphaDeg, betaDeg)</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1275</span>: <span class="c">#</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1276</span>: <span class="c">#         if angular_integration == 1:</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1277</span>: <span class="c">#             QAS = XSEC_ASY_S(nmax, wavelength, izaDeg, iaaDeg, alphaDeg, betaDeg)</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1278</span>: <span class="c">#             QS = XSEC_QS_S(nmax, wavelength, izaDeg, iaaDeg, alphaDeg, betaDeg)</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1279</span>: <span class="c">#             QE = XSEC_QE(S, wavelength)</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1280</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">1281</span>: <span class="c"># ----------------------------------------------------------------------------------------------------------------------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1282</span>: <span
            class="c"># Orientation Wrapper</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1283</span>: <span class="c"># ----------------------------------------------------------------------------------------------------------------------</span></pre>
    <pre class="cython line score-60"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1284</span>: <span class="k">def</span> <span class="nf">gaussian_wrapper</span><span
            class="p">(</span><span class="nb">float</span> <span class="n">std</span><span class="p">,</span> <span
            class="nb">float</span> <span class="n">mean</span><span class="p">):</span></pre>
    <pre class='cython code score-60 '>/* Python wrapper */
static PyObject *__pyx_pw_6pyrism_4core_3tma_1gaussian_wrapper(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6pyrism_4core_3tma_gaussian_wrapper[] = "Gaussian probability distribution function (PDF) for orientation averaging.\n\n    Parameters\n    ----------\n    std : float\n        The standard deviation in degrees of the Gaussian PDF\n    mean : float\n        The mean in degrees of the Gaussian PDF.  This should be a number in the interval [0, 180)\n\n    Returns\n    -------\n    pdf(x): callable\n        A function that returns the value of the spherical Jacobian-normalized Gaussian PDF with the given STD at x\n        (degrees). It is normalized for the interval [0, 180].\n    ";
static PyMethodDef __pyx_mdef_6pyrism_4core_3tma_1gaussian_wrapper = {"gaussian_wrapper", (PyCFunction)__pyx_pw_6pyrism_4core_3tma_1gaussian_wrapper, METH_VARARGS|METH_KEYWORDS, __pyx_doc_6pyrism_4core_3tma_gaussian_wrapper};
static PyObject *__pyx_pw_6pyrism_4core_3tma_1gaussian_wrapper(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  float __pyx_v_std;
  float __pyx_v_mean;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("gaussian_wrapper (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_std,&amp;__pyx_n_s_mean,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_std)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_mean)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("gaussian_wrapper", 1, 2, 2, 1); <span
                class='error_goto'>__PYX_ERR(0, 1284, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "gaussian_wrapper") &lt; 0)) <span
                class='error_goto'>__PYX_ERR(0, 1284, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_std = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[0]); if (unlikely((__pyx_v_std == (float)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 1284, __pyx_L3_error)</span>
    __pyx_v_mean = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[1]); if (unlikely((__pyx_v_mean == (float)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 1284, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("gaussian_wrapper", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span
                class='error_goto'>__PYX_ERR(0, 1284, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.gaussian_wrapper", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6pyrism_4core_3tma_gaussian_wrapper(__pyx_self, __pyx_v_std, __pyx_v_mean);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6pyrism_4core_3tma_gaussian_wrapper(CYTHON_UNUSED PyObject *__pyx_self, float __pyx_v_std, float __pyx_v_mean) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("gaussian_wrapper", 0);
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.gaussian_wrapper", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* â€¦ */
  __pyx_tuple__75 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_n_s_std, __pyx_n_s_mean);<span
                class='error_goto'> if (unlikely(!__pyx_tuple__75)) __PYX_ERR(0, 1284, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__75);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__75);
/* â€¦ */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_6pyrism_4core_3tma_1gaussian_wrapper, NULL, __pyx_n_s_pyrism_core_tma);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1284, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_gaussian_wrapper, __pyx_t_1) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 1284, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__76 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__75, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyrism_core_tma_pyx, __pyx_n_s_gaussian_wrapper, 1284, __pyx_empty_bytes);<span
                class='error_goto'> if (unlikely(!__pyx_codeobj__76)) __PYX_ERR(0, 1284, __pyx_L1_error)</span>
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1285</span>:     <span class="sd">&quot;&quot;&quot;Gaussian probability distribution function (PDF) for orientation averaging.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1286</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">1287</span>: <span class="sd">    Parameters</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1288</span>: <span class="sd">    ----------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1289</span>: <span class="sd">    std : float</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1290</span>: <span class="sd">        The standard deviation in degrees of the Gaussian PDF</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1291</span>: <span class="sd">    mean : float</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1292</span>: <span class="sd">        The mean in degrees of the Gaussian PDF.  This should be a number in the interval [0, 180)</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1293</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">1294</span>: <span class="sd">    Returns</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1295</span>: <span class="sd">    -------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1296</span>: <span
            class="sd">    pdf(x): callable</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1297</span>: <span class="sd">        A function that returns the value of the spherical Jacobian-normalized Gaussian PDF with the given STD at x</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1298</span>: <span class="sd">        (degrees). It is normalized for the interval [0, 180].</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1299</span>: <span
            class="sd">    &quot;&quot;&quot;</span></pre>
    <pre class="cython line score-1"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1300</span>:     <span class="k">return</span> <span class="n">gaussian</span><span
            class="p">(</span><span class="n">std</span><span class="p">,</span> <span class="n">mean</span><span
            class="p">)</span></pre>
    <pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_6pyrism_4core_3tma_gaussian(__pyx_v_std, __pyx_v_mean);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1300, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1301</span>: </pre>
    <pre class="cython line score-11"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1302</span>: <span class="k">def</span> <span class="nf">uniform_wrapper</span><span
            class="p">():</span></pre>
    <pre class='cython code score-11 '>/* Python wrapper */
static PyObject *__pyx_pw_6pyrism_4core_3tma_3uniform_wrapper(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_6pyrism_4core_3tma_2uniform_wrapper[] = "Uniform probability distribution function (PDF) for orientation averaging.\n\n    Returns\n    -------\n    pdf(x): callable\n        A function that returns the value of the spherical Jacobian-normalized uniform PDF. It is normalized for\n        the interval [0, 180].\n    ";
static PyMethodDef __pyx_mdef_6pyrism_4core_3tma_3uniform_wrapper = {"uniform_wrapper", (PyCFunction)__pyx_pw_6pyrism_4core_3tma_3uniform_wrapper, METH_NOARGS, __pyx_doc_6pyrism_4core_3tma_2uniform_wrapper};
static PyObject *__pyx_pw_6pyrism_4core_3tma_3uniform_wrapper(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("uniform_wrapper (wrapper)", 0);
  __pyx_r = __pyx_pf_6pyrism_4core_3tma_2uniform_wrapper(__pyx_self);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6pyrism_4core_3tma_2uniform_wrapper(CYTHON_UNUSED PyObject *__pyx_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("uniform_wrapper", 0);
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.uniform_wrapper", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* â€¦ */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_6pyrism_4core_3tma_3uniform_wrapper, NULL, __pyx_n_s_pyrism_core_tma);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1302, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_uniform_wrapper, __pyx_t_1) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 1302, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* â€¦ */
  __pyx_codeobj__77 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(0, 0, 0, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyrism_core_tma_pyx, __pyx_n_s_uniform_wrapper, 1302, __pyx_empty_bytes);<span
                class='error_goto'> if (unlikely(!__pyx_codeobj__77)) __PYX_ERR(0, 1302, __pyx_L1_error)</span>
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1303</span>:     <span class="sd">&quot;&quot;&quot;Uniform probability distribution function (PDF) for orientation averaging.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1304</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">1305</span>: <span class="sd">    Returns</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1306</span>: <span class="sd">    -------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1307</span>: <span
            class="sd">    pdf(x): callable</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1308</span>: <span class="sd">        A function that returns the value of the spherical Jacobian-normalized uniform PDF. It is normalized for</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1309</span>: <span
            class="sd">        the interval [0, 180].</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1310</span>: <span
            class="sd">    &quot;&quot;&quot;</span></pre>
    <pre class="cython line score-1"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1311</span>:     <span class="k">return</span> <span class="n">uniform</span><span
            class="p">()</span></pre>
    <pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_6pyrism_4core_3tma_uniform();<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1311, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1312</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">1313</span>: <span class="c"># ----------------------------------------------------------------------------------------------------------------------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1314</span>: <span class="c"># Auxiliary Wrapper</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1315</span>: <span class="c"># ----------------------------------------------------------------------------------------------------------------------</span></pre>
    <pre class="cython line score-57"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1316</span>: <span class="k">def</span> <span
            class="nf">equal_volume_from_maximum_wrapper</span><span class="p">(</span><span
            class="n">double</span><span class="p">[:]</span> <span class="n">radius</span><span
            class="p">,</span> <span class="n">double</span><span class="p">[:]</span> <span class="n">axis_ratio</span><span
            class="p">,</span> <span class="nb">int</span> <span class="n">shape</span><span class="p">):</span></pre>
    <pre class='cython code score-57 '>/* Python wrapper */
static PyObject *__pyx_pw_6pyrism_4core_3tma_5equal_volume_from_maximum_wrapper(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6pyrism_4core_3tma_4equal_volume_from_maximum_wrapper[] = "\n    Convert maximum radius into volume equivalent radius\n\n    Parameters\n    ----------\n    radius : double[:]\n        Equivalent particle radius in same unit as wavelength.\n    axis_ratio : double[:]\n        The horizontal-to-rotational axis ratio.\n    shape : int, {-1, -2}\n        Shape of the particle:\n            * -1 : spheroid,\n            * -2 : cylinders.\n\n    Returns\n    -------\n    Rv : MemoryView, double[:]\n        Volume equivalent radius.\n    ";
static PyMethodDef __pyx_mdef_6pyrism_4core_3tma_5equal_volume_from_maximum_wrapper = {"equal_volume_from_maximum_wrapper", (PyCFunction)__pyx_pw_6pyrism_4core_3tma_5equal_volume_from_maximum_wrapper, METH_VARARGS|METH_KEYWORDS, __pyx_doc_6pyrism_4core_3tma_4equal_volume_from_maximum_wrapper};
static PyObject *__pyx_pw_6pyrism_4core_3tma_5equal_volume_from_maximum_wrapper(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_radius = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_axis_ratio = { 0, 0, { 0 }, { 0 }, { 0 } };
  int __pyx_v_shape;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("equal_volume_from_maximum_wrapper (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_radius,&amp;__pyx_n_s_axis_ratio,&amp;__pyx_n_s_shape,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_radius)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_axis_ratio)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("equal_volume_from_maximum_wrapper", 1, 3, 3, 1); <span
                class='error_goto'>__PYX_ERR(0, 1316, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_shape)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("equal_volume_from_maximum_wrapper", 1, 3, 3, 2); <span
                class='error_goto'>__PYX_ERR(0, 1316, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "equal_volume_from_maximum_wrapper") &lt; 0)) <span
                class='error_goto'>__PYX_ERR(0, 1316, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_radius = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[0], PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_v_radius.memview)) __PYX_ERR(0, 1316, __pyx_L3_error)</span>
    __pyx_v_axis_ratio = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[1], PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_v_axis_ratio.memview)) __PYX_ERR(0, 1316, __pyx_L3_error)</span>
    __pyx_v_shape = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[2]); if (unlikely((__pyx_v_shape == (int)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 1316, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("equal_volume_from_maximum_wrapper", 1, 3, 3, <span
                class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 1316, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.equal_volume_from_maximum_wrapper", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6pyrism_4core_3tma_4equal_volume_from_maximum_wrapper(__pyx_self, __pyx_v_radius, __pyx_v_axis_ratio, __pyx_v_shape);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6pyrism_4core_3tma_4equal_volume_from_maximum_wrapper(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_radius, __Pyx_memviewslice __pyx_v_axis_ratio, int __pyx_v_shape) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("equal_volume_from_maximum_wrapper", 0);
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.equal_volume_from_maximum_wrapper", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_radius, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_axis_ratio, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* â€¦ */
  __pyx_tuple__78 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_n_s_radius, __pyx_n_s_axis_ratio, __pyx_n_s_shape);<span
                class='error_goto'> if (unlikely(!__pyx_tuple__78)) __PYX_ERR(0, 1316, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__78);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__78);
/* â€¦ */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_6pyrism_4core_3tma_5equal_volume_from_maximum_wrapper, NULL, __pyx_n_s_pyrism_core_tma);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1316, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_equal_volume_from_maximum_wrappe, __pyx_t_1) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 1316, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__79 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(3, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__78, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyrism_core_tma_pyx, __pyx_n_s_equal_volume_from_maximum_wrappe, 1316, __pyx_empty_bytes);<span
                class='error_goto'> if (unlikely(!__pyx_codeobj__79)) __PYX_ERR(0, 1316, __pyx_L1_error)</span>
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1317</span>:     <span
            class="sd">&quot;&quot;&quot;</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1318</span>: <span class="sd">    Convert maximum radius into volume equivalent radius</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1319</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">1320</span>: <span class="sd">    Parameters</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1321</span>: <span class="sd">    ----------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1322</span>: <span
            class="sd">    radius : double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1323</span>: <span class="sd">        Equivalent particle radius in same unit as wavelength.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1324</span>: <span
            class="sd">    axis_ratio : double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1325</span>: <span class="sd">        The horizontal-to-rotational axis ratio.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1326</span>: <span class="sd">    shape : int, {-1, -2}</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1327</span>: <span
            class="sd">        Shape of the particle:</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1328</span>: <span
            class="sd">            * -1 : spheroid,</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1329</span>: <span
            class="sd">            * -2 : cylinders.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1330</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">1331</span>: <span class="sd">    Returns</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1332</span>: <span class="sd">    -------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1333</span>: <span
            class="sd">    Rv : MemoryView, double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1334</span>: <span class="sd">        Volume equivalent radius.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1335</span>: <span
            class="sd">    &quot;&quot;&quot;</span></pre>
    <pre class="cython line score-1"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1336</span>:     <span class="k">return</span> <span
            class="n">equal_volume_from_maximum</span><span class="p">(</span><span class="n">radius</span><span
            class="p">,</span> <span class="n">axis_ratio</span><span class="p">,</span> <span
            class="n">shape</span><span class="p">)</span></pre>
    <pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_6pyrism_4core_3tma_equal_volume_from_maximum(__pyx_v_radius, __pyx_v_axis_ratio, __pyx_v_shape);<span
                class='error_goto'> if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 1336, __pyx_L1_error)</span>
  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_t_1, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1336, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1337</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">1338</span>: <span class="c"># ----------------------------------------------------------------------------------------------------------------------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1339</span>: <span
            class="c"># SZ and NMAX Wrapper</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1340</span>: <span class="c"># ----------------------------------------------------------------------------------------------------------------------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1341</span>: <span class="c"># NMAX -----------------------------------------------------------------------------------------------------------------</span></pre>
    <pre class="cython line score-107"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1342</span>: <span class="k">def</span> <span class="nf">NMAX_VEC_WRAPPER</span><span
            class="p">(</span><span class="n">double</span><span class="p">[:]</span> <span class="n">radius</span><span
            class="p">,</span> <span class="nb">int</span> <span class="n">radius_type</span><span
            class="p">,</span> <span class="n">double</span><span class="p">[:]</span> <span class="n">wavelength</span><span
            class="p">,</span> <span class="n">double</span><span class="p">[:]</span> <span
            class="n">eps_real</span><span class="p">,</span> <span class="n">double</span><span
            class="p">[:]</span> <span class="n">eps_imag</span><span class="p">,</span></pre>
    <pre class='cython code score-107 '>/* Python wrapper */
static PyObject *__pyx_pw_6pyrism_4core_3tma_7NMAX_VEC_WRAPPER(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6pyrism_4core_3tma_6NMAX_VEC_WRAPPER[] = "\n    Calculate NMAX in a vectorized function.\n\n    Parameters\n    ----------\n    radius : double[:]\n        Equivalent particle radius in same unit as wavelength.\n    radius_type : int, {0, 1, 2}\n        Specification of particle radius:\n            * 0: radius is the equivalent volume radius (default).\n            * 1: radius is the equivalent area radius.\n            * 2: radius is the maximum radius.\n    wavelength : double[:]\n        Wavelength in same unit as radius.\n    eps_real, eps_imag : double[:]\n        Real and imaginary part of the dielectric constant.\n    axis_ratio : double[:]\n        The horizontal-to-rotational axis ratio.\n    shape : int, {-1, -2}\n        Shape of the particle:\n            * -1 : spheroid,\n            * -2 : cylinders.\n\n    Returns\n    -------\n    nmax : MemoryView\n\n    ";
static PyMethodDef __pyx_mdef_6pyrism_4core_3tma_7NMAX_VEC_WRAPPER = {"NMAX_VEC_WRAPPER", (PyCFunction)__pyx_pw_6pyrism_4core_3tma_7NMAX_VEC_WRAPPER, METH_VARARGS|METH_KEYWORDS, __pyx_doc_6pyrism_4core_3tma_6NMAX_VEC_WRAPPER};
static PyObject *__pyx_pw_6pyrism_4core_3tma_7NMAX_VEC_WRAPPER(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_radius = { 0, 0, { 0 }, { 0 }, { 0 } };
  int __pyx_v_radius_type;
  __Pyx_memviewslice __pyx_v_wavelength = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_eps_real = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_eps_imag = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_axis_ratio = { 0, 0, { 0 }, { 0 }, { 0 } };
  int __pyx_v_shape;
  int __pyx_v_verbose;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("NMAX_VEC_WRAPPER (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_radius,&amp;__pyx_n_s_radius_type,&amp;__pyx_n_s_wavelength,&amp;__pyx_n_s_eps_real,&amp;__pyx_n_s_eps_imag,&amp;__pyx_n_s_axis_ratio,&amp;__pyx_n_s_shape,&amp;__pyx_n_s_verbose,0};
    PyObject* values[8] = {0,0,0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_radius)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_radius_type)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("NMAX_VEC_WRAPPER", 1, 8, 8, 1); <span
                class='error_goto'>__PYX_ERR(0, 1342, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_wavelength)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("NMAX_VEC_WRAPPER", 1, 8, 8, 2); <span
                class='error_goto'>__PYX_ERR(0, 1342, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_eps_real)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("NMAX_VEC_WRAPPER", 1, 8, 8, 3); <span
                class='error_goto'>__PYX_ERR(0, 1342, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_eps_imag)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("NMAX_VEC_WRAPPER", 1, 8, 8, 4); <span
                class='error_goto'>__PYX_ERR(0, 1342, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_axis_ratio)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("NMAX_VEC_WRAPPER", 1, 8, 8, 5); <span
                class='error_goto'>__PYX_ERR(0, 1342, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (likely((values[6] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_shape)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("NMAX_VEC_WRAPPER", 1, 8, 8, 6); <span
                class='error_goto'>__PYX_ERR(0, 1342, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  7:
        if (likely((values[7] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_verbose)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("NMAX_VEC_WRAPPER", 1, 8, 8, 7); <span
                class='error_goto'>__PYX_ERR(0, 1342, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "NMAX_VEC_WRAPPER") &lt; 0)) <span
                class='error_goto'>__PYX_ERR(0, 1342, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 8) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
      values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
      values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
      values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
    }
    __pyx_v_radius = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[0], PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_v_radius.memview)) __PYX_ERR(0, 1342, __pyx_L3_error)</span>
    __pyx_v_radius_type = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[1]); if (unlikely((__pyx_v_radius_type == (int)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 1342, __pyx_L3_error)</span>
    __pyx_v_wavelength = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[2], PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_v_wavelength.memview)) __PYX_ERR(0, 1342, __pyx_L3_error)</span>
    __pyx_v_eps_real = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[3], PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_v_eps_real.memview)) __PYX_ERR(0, 1342, __pyx_L3_error)</span>
    __pyx_v_eps_imag = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[4], PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_v_eps_imag.memview)) __PYX_ERR(0, 1342, __pyx_L3_error)</span>
    __pyx_v_axis_ratio = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[5], PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_v_axis_ratio.memview)) __PYX_ERR(0, 1343, __pyx_L3_error)</span>
    __pyx_v_shape = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[6]); if (unlikely((__pyx_v_shape == (int)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 1343, __pyx_L3_error)</span>
    __pyx_v_verbose = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[7]); if (unlikely((__pyx_v_verbose == (int)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 1343, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("NMAX_VEC_WRAPPER", 1, 8, 8, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span
                class='error_goto'>__PYX_ERR(0, 1342, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.NMAX_VEC_WRAPPER", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6pyrism_4core_3tma_6NMAX_VEC_WRAPPER(__pyx_self, __pyx_v_radius, __pyx_v_radius_type, __pyx_v_wavelength, __pyx_v_eps_real, __pyx_v_eps_imag, __pyx_v_axis_ratio, __pyx_v_shape, __pyx_v_verbose);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6pyrism_4core_3tma_6NMAX_VEC_WRAPPER(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_radius, int __pyx_v_radius_type, __Pyx_memviewslice __pyx_v_wavelength, __Pyx_memviewslice __pyx_v_eps_real, __Pyx_memviewslice __pyx_v_eps_imag, __Pyx_memviewslice __pyx_v_axis_ratio, int __pyx_v_shape, int __pyx_v_verbose) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("NMAX_VEC_WRAPPER", 0);
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.NMAX_VEC_WRAPPER", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_radius, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_wavelength, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_eps_real, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_eps_imag, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_axis_ratio, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* â€¦ */
  __pyx_tuple__80 = <span class='py_c_api'>PyTuple_Pack</span>(8, __pyx_n_s_radius, __pyx_n_s_radius_type, __pyx_n_s_wavelength, __pyx_n_s_eps_real, __pyx_n_s_eps_imag, __pyx_n_s_axis_ratio, __pyx_n_s_shape, __pyx_n_s_verbose);<span
                class='error_goto'> if (unlikely(!__pyx_tuple__80)) __PYX_ERR(0, 1342, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__80);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__80);
/* â€¦ */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_6pyrism_4core_3tma_7NMAX_VEC_WRAPPER, NULL, __pyx_n_s_pyrism_core_tma);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1342, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_NMAX_VEC_WRAPPER, __pyx_t_1) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 1342, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__81 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(8, 0, 8, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__80, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyrism_core_tma_pyx, __pyx_n_s_NMAX_VEC_WRAPPER, 1342, __pyx_empty_bytes);<span
                class='error_goto'> if (unlikely(!__pyx_codeobj__81)) __PYX_ERR(0, 1342, __pyx_L1_error)</span>
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1343</span>:                    <span
            class="n">double</span><span class="p">[:]</span> <span class="n">axis_ratio</span><span class="p">,</span> <span
            class="nb">int</span> <span class="n">shape</span><span class="p">,</span> <span class="nb">int</span> <span
            class="n">verbose</span><span class="p">):</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1344</span>:     <span
            class="sd">&quot;&quot;&quot;</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1345</span>: <span class="sd">    Calculate NMAX in a vectorized function.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1346</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">1347</span>: <span class="sd">    Parameters</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1348</span>: <span class="sd">    ----------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1349</span>: <span
            class="sd">    radius : double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1350</span>: <span class="sd">        Equivalent particle radius in same unit as wavelength.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1351</span>: <span
            class="sd">    radius_type : int, {0, 1, 2}</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1352</span>: <span class="sd">        Specification of particle radius:</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1353</span>: <span class="sd">            * 0: radius is the equivalent volume radius (default).</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1354</span>: <span class="sd">            * 1: radius is the equivalent area radius.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1355</span>: <span class="sd">            * 2: radius is the maximum radius.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1356</span>: <span
            class="sd">    wavelength : double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1357</span>: <span class="sd">        Wavelength in same unit as radius.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1358</span>: <span class="sd">    eps_real, eps_imag : double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1359</span>: <span class="sd">        Real and imaginary part of the dielectric constant.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1360</span>: <span
            class="sd">    axis_ratio : double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1361</span>: <span class="sd">        The horizontal-to-rotational axis ratio.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1362</span>: <span class="sd">    shape : int, {-1, -2}</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1363</span>: <span
            class="sd">        Shape of the particle:</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1364</span>: <span
            class="sd">            * -1 : spheroid,</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1365</span>: <span
            class="sd">            * -2 : cylinders.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1366</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">1367</span>: <span class="sd">    Returns</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1368</span>: <span class="sd">    -------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1369</span>: <span
            class="sd">    nmax : MemoryView</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1370</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">1371</span>: <span
            class="sd">    &quot;&quot;&quot;</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1372</span>: </pre>
    <pre class="cython line score-1"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1373</span>:     <span class="k">return</span> <span class="n">NMAX_VEC</span><span
            class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="n">radius</span><span
            class="p">,</span> <span class="n">radius_type</span><span class="o">=</span><span
            class="n">radius_type</span><span class="p">,</span> <span class="n">wavelength</span><span
            class="o">=</span><span class="n">wavelength</span><span class="p">,</span> <span
            class="n">eps_real</span><span class="o">=</span><span class="n">eps_real</span><span
            class="p">,</span> <span class="n">eps_imag</span><span class="o">=</span><span
            class="n">eps_imag</span><span class="p">,</span></pre>
    <pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
/* â€¦ */
  __pyx_t_1 = __pyx_f_6pyrism_4core_3tma_NMAX_VEC(__pyx_v_radius, __pyx_v_radius_type, __pyx_v_wavelength, __pyx_v_eps_real, __pyx_v_eps_imag, __pyx_v_axis_ratio, __pyx_v_shape, __pyx_v_verbose);<span
                class='error_goto'> if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 1373, __pyx_L1_error)</span>
/* â€¦ */
  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_t_1, 1, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1373, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1374</span>:                     <span
            class="n">axis_ratio</span><span class="o">=</span><span class="n">axis_ratio</span><span class="p">,</span> <span
            class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span> <span
            class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1375</span>: </pre>
    <pre class="cython line score-134"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1376</span>: <span class="k">def</span> <span class="nf">NMAX_WRAPPER</span><span
            class="p">(</span><span class="n">double</span> <span class="n">radius</span><span class="p">,</span> <span
            class="nb">int</span> <span class="n">radius_type</span><span class="p">,</span> <span
            class="n">double</span> <span class="n">wavelength</span><span class="p">,</span> <span
            class="n">double</span> <span class="n">eps_real</span><span class="p">,</span> <span
            class="n">double</span> <span class="n">eps_imag</span><span class="p">,</span></pre>
    <pre class='cython code score-134 '>/* Python wrapper */
static PyObject *__pyx_pw_6pyrism_4core_3tma_9NMAX_WRAPPER(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6pyrism_4core_3tma_8NMAX_WRAPPER[] = "\n    Calculate NMAX.\n\n    Parameters\n    ----------\n    radius : double\n        Equivalent particle radius in same unit as wavelength.\n    radius_type : int, {0, 1, 2}\n        Specification of particle radius:\n            * 0: radius is the equivalent volume radius (default).\n            * 1: radius is the equivalent area radius.\n            * 2: radius is the maximum radius.\n    wavelength : double\n        Wavelength in same unit as radius.\n    eps_real, eps_imag : double\n        Real and imaginary part of the dielectric constant.\n    axis_ratio : double\n        The horizontal-to-rotational axis ratio.\n    shape : int, {-1, -2}\n        Shape of the particle:\n            * -1 : spheroid,\n            * -2 : cylinders.\n\n    Returns\n    -------\n    nmax : int\n\n    ";
static PyMethodDef __pyx_mdef_6pyrism_4core_3tma_9NMAX_WRAPPER = {"NMAX_WRAPPER", (PyCFunction)__pyx_pw_6pyrism_4core_3tma_9NMAX_WRAPPER, METH_VARARGS|METH_KEYWORDS, __pyx_doc_6pyrism_4core_3tma_8NMAX_WRAPPER};
static PyObject *__pyx_pw_6pyrism_4core_3tma_9NMAX_WRAPPER(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  double __pyx_v_radius;
  int __pyx_v_radius_type;
  double __pyx_v_wavelength;
  double __pyx_v_eps_real;
  double __pyx_v_eps_imag;
  double __pyx_v_axis_ratio;
  int __pyx_v_shape;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("NMAX_WRAPPER (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_radius,&amp;__pyx_n_s_radius_type,&amp;__pyx_n_s_wavelength,&amp;__pyx_n_s_eps_real,&amp;__pyx_n_s_eps_imag,&amp;__pyx_n_s_axis_ratio,&amp;__pyx_n_s_shape,0};
    PyObject* values[7] = {0,0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_radius)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_radius_type)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("NMAX_WRAPPER", 1, 7, 7, 1); <span
                class='error_goto'>__PYX_ERR(0, 1376, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_wavelength)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("NMAX_WRAPPER", 1, 7, 7, 2); <span
                class='error_goto'>__PYX_ERR(0, 1376, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_eps_real)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("NMAX_WRAPPER", 1, 7, 7, 3); <span
                class='error_goto'>__PYX_ERR(0, 1376, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_eps_imag)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("NMAX_WRAPPER", 1, 7, 7, 4); <span
                class='error_goto'>__PYX_ERR(0, 1376, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_axis_ratio)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("NMAX_WRAPPER", 1, 7, 7, 5); <span
                class='error_goto'>__PYX_ERR(0, 1376, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (likely((values[6] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_shape)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("NMAX_WRAPPER", 1, 7, 7, 6); <span
                class='error_goto'>__PYX_ERR(0, 1376, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "NMAX_WRAPPER") &lt; 0)) <span
                class='error_goto'>__PYX_ERR(0, 1376, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 7) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
      values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
      values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
    }
    __pyx_v_radius = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[0]); if (unlikely((__pyx_v_radius == (double)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 1376, __pyx_L3_error)</span>
    __pyx_v_radius_type = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[1]); if (unlikely((__pyx_v_radius_type == (int)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 1376, __pyx_L3_error)</span>
    __pyx_v_wavelength = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[2]); if (unlikely((__pyx_v_wavelength == (double)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 1376, __pyx_L3_error)</span>
    __pyx_v_eps_real = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[3]); if (unlikely((__pyx_v_eps_real == (double)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 1376, __pyx_L3_error)</span>
    __pyx_v_eps_imag = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[4]); if (unlikely((__pyx_v_eps_imag == (double)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 1376, __pyx_L3_error)</span>
    __pyx_v_axis_ratio = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[5]); if (unlikely((__pyx_v_axis_ratio == (double)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 1377, __pyx_L3_error)</span>
    __pyx_v_shape = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[6]); if (unlikely((__pyx_v_shape == (int)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 1377, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("NMAX_WRAPPER", 1, 7, 7, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span
                class='error_goto'>__PYX_ERR(0, 1376, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.NMAX_WRAPPER", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6pyrism_4core_3tma_8NMAX_WRAPPER(__pyx_self, __pyx_v_radius, __pyx_v_radius_type, __pyx_v_wavelength, __pyx_v_eps_real, __pyx_v_eps_imag, __pyx_v_axis_ratio, __pyx_v_shape);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6pyrism_4core_3tma_8NMAX_WRAPPER(CYTHON_UNUSED PyObject *__pyx_self, double __pyx_v_radius, int __pyx_v_radius_type, double __pyx_v_wavelength, double __pyx_v_eps_real, double __pyx_v_eps_imag, double __pyx_v_axis_ratio, int __pyx_v_shape) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("NMAX_WRAPPER", 0);
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.NMAX_WRAPPER", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* â€¦ */
  __pyx_tuple__82 = <span class='py_c_api'>PyTuple_Pack</span>(7, __pyx_n_s_radius, __pyx_n_s_radius_type, __pyx_n_s_wavelength, __pyx_n_s_eps_real, __pyx_n_s_eps_imag, __pyx_n_s_axis_ratio, __pyx_n_s_shape);<span
                class='error_goto'> if (unlikely(!__pyx_tuple__82)) __PYX_ERR(0, 1376, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__82);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__82);
/* â€¦ */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_6pyrism_4core_3tma_9NMAX_WRAPPER, NULL, __pyx_n_s_pyrism_core_tma);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1376, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_NMAX_WRAPPER, __pyx_t_1) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 1376, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__83 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(7, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__82, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyrism_core_tma_pyx, __pyx_n_s_NMAX_WRAPPER, 1376, __pyx_empty_bytes);<span
                class='error_goto'> if (unlikely(!__pyx_codeobj__83)) __PYX_ERR(0, 1376, __pyx_L1_error)</span>
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1377</span>:                  <span
            class="n">double</span> <span class="n">axis_ratio</span><span class="p">,</span> <span
            class="nb">int</span> <span class="n">shape</span><span class="p">):</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1378</span>:     <span
            class="sd">&quot;&quot;&quot;</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1379</span>: <span class="sd">    Calculate NMAX.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1380</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">1381</span>: <span class="sd">    Parameters</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1382</span>: <span class="sd">    ----------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1383</span>: <span class="sd">    radius : double</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1384</span>: <span class="sd">        Equivalent particle radius in same unit as wavelength.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1385</span>: <span
            class="sd">    radius_type : int, {0, 1, 2}</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1386</span>: <span class="sd">        Specification of particle radius:</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1387</span>: <span class="sd">            * 0: radius is the equivalent volume radius (default).</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1388</span>: <span class="sd">            * 1: radius is the equivalent area radius.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1389</span>: <span class="sd">            * 2: radius is the maximum radius.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1390</span>: <span
            class="sd">    wavelength : double</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1391</span>: <span class="sd">        Wavelength in same unit as radius.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1392</span>: <span
            class="sd">    eps_real, eps_imag : double</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1393</span>: <span class="sd">        Real and imaginary part of the dielectric constant.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1394</span>: <span
            class="sd">    axis_ratio : double</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1395</span>: <span class="sd">        The horizontal-to-rotational axis ratio.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1396</span>: <span class="sd">    shape : int, {-1, -2}</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1397</span>: <span
            class="sd">        Shape of the particle:</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1398</span>: <span
            class="sd">            * -1 : spheroid,</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1399</span>: <span
            class="sd">            * -2 : cylinders.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1400</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">1401</span>: <span class="sd">    Returns</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1402</span>: <span class="sd">    -------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1403</span>: <span class="sd">    nmax : int</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1404</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">1405</span>: <span
            class="sd">    &quot;&quot;&quot;</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1406</span>: </pre>
    <pre class="cython line score-3"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1407</span>:     <span class="k">return</span> <span class="n">NMAX</span><span
            class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="n">radius</span><span
            class="p">,</span> <span class="n">radius_type</span><span class="o">=</span><span
            class="n">radius_type</span><span class="p">,</span> <span class="n">wavelength</span><span
            class="o">=</span><span class="n">wavelength</span><span class="p">,</span> <span
            class="n">eps_real</span><span class="o">=</span><span class="n">eps_real</span><span
            class="p">,</span> <span class="n">eps_imag</span><span class="o">=</span><span
            class="n">eps_imag</span><span class="p">,</span></pre>
    <pre class='cython code score-3 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
/* â€¦ */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_f_6pyrism_4core_3tma_NMAX(__pyx_v_radius, __pyx_v_radius_type, __pyx_v_wavelength, __pyx_v_eps_real, __pyx_v_eps_imag, __pyx_v_axis_ratio, __pyx_v_shape));<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1407, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1408</span>:                 <span class="n">axis_ratio</span><span
            class="o">=</span><span class="n">axis_ratio</span><span class="p">,</span> <span
            class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">)</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1409</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">1410</span>: <span class="c"># S and Z for Single Orientation ---------------------------------------------------------------------------------------</span></pre>
    <pre class="cython line score-92"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1411</span>: <span class="k">def</span> <span class="nf">SZ_S_VEC_WRAPPER</span><span
            class="p">(</span><span class="nb">int</span><span class="p">[:]</span> <span class="n">nmax</span><span
            class="p">,</span> <span class="n">double</span><span class="p">[:]</span> <span class="n">wavelength</span><span
            class="p">,</span> <span class="n">double</span><span class="p">[:]</span> <span
            class="n">izaDeg</span><span class="p">,</span> <span class="n">double</span><span
            class="p">[:]</span> <span class="n">vzaDeg</span><span class="p">,</span> <span
            class="n">double</span><span class="p">[:]</span> <span class="n">iaaDeg</span><span
            class="p">,</span></pre>
    <pre class='cython code score-92 '>/* Python wrapper */
static PyObject *__pyx_pw_6pyrism_4core_3tma_11SZ_S_VEC_WRAPPER(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6pyrism_4core_3tma_10SZ_S_VEC_WRAPPER[] = "\n    Calculate the single scattering and phase matrix in a vectorized function.\n\n    Parameters\n    ----------\n    nmax : int[:]\n        Nmax parameter.\n    wavelength : double[:]\n        Wavelength in same unit as radius (used by function calc_nmax).\n    izaDeg, vzaDeg, iaaDeg, vaaDeg : double[:]\n        Incidence (iza) and scattering (vza) zenith angle and incidence and viewing\n        azimuth angle (ira, vra) in [DEG].\n    alphaDeg, betaDeg: double[:]\n        The Euler angles of the particle orientation in [DEG].\n\n    Returns\n    -------\n    S, Z : tuple with double[:,:,:]\n        Three dimensional scattering (S) and phase (Z) matrix.\n    ";
static PyMethodDef __pyx_mdef_6pyrism_4core_3tma_11SZ_S_VEC_WRAPPER = {"SZ_S_VEC_WRAPPER", (PyCFunction)__pyx_pw_6pyrism_4core_3tma_11SZ_S_VEC_WRAPPER, METH_VARARGS|METH_KEYWORDS, __pyx_doc_6pyrism_4core_3tma_10SZ_S_VEC_WRAPPER};
static PyObject *__pyx_pw_6pyrism_4core_3tma_11SZ_S_VEC_WRAPPER(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_nmax = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_wavelength = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_izaDeg = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_vzaDeg = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_iaaDeg = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_vaaDeg = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_alphaDeg = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_betaDeg = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("SZ_S_VEC_WRAPPER (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_nmax,&amp;__pyx_n_s_wavelength,&amp;__pyx_n_s_izaDeg,&amp;__pyx_n_s_vzaDeg,&amp;__pyx_n_s_iaaDeg,&amp;__pyx_n_s_vaaDeg,&amp;__pyx_n_s_alphaDeg,&amp;__pyx_n_s_betaDeg,0};
    PyObject* values[8] = {0,0,0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_nmax)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_wavelength)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("SZ_S_VEC_WRAPPER", 1, 8, 8, 1); <span
                class='error_goto'>__PYX_ERR(0, 1411, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_izaDeg)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("SZ_S_VEC_WRAPPER", 1, 8, 8, 2); <span
                class='error_goto'>__PYX_ERR(0, 1411, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_vzaDeg)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("SZ_S_VEC_WRAPPER", 1, 8, 8, 3); <span
                class='error_goto'>__PYX_ERR(0, 1411, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_iaaDeg)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("SZ_S_VEC_WRAPPER", 1, 8, 8, 4); <span
                class='error_goto'>__PYX_ERR(0, 1411, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_vaaDeg)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("SZ_S_VEC_WRAPPER", 1, 8, 8, 5); <span
                class='error_goto'>__PYX_ERR(0, 1411, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (likely((values[6] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_alphaDeg)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("SZ_S_VEC_WRAPPER", 1, 8, 8, 6); <span
                class='error_goto'>__PYX_ERR(0, 1411, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  7:
        if (likely((values[7] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_betaDeg)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("SZ_S_VEC_WRAPPER", 1, 8, 8, 7); <span
                class='error_goto'>__PYX_ERR(0, 1411, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "SZ_S_VEC_WRAPPER") &lt; 0)) <span
                class='error_goto'>__PYX_ERR(0, 1411, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 8) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
      values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
      values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
      values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
    }
    __pyx_v_nmax = <span
                class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[0], PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_v_nmax.memview)) __PYX_ERR(0, 1411, __pyx_L3_error)</span>
    __pyx_v_wavelength = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[1], PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_v_wavelength.memview)) __PYX_ERR(0, 1411, __pyx_L3_error)</span>
    __pyx_v_izaDeg = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[2], PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_v_izaDeg.memview)) __PYX_ERR(0, 1411, __pyx_L3_error)</span>
    __pyx_v_vzaDeg = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[3], PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_v_vzaDeg.memview)) __PYX_ERR(0, 1411, __pyx_L3_error)</span>
    __pyx_v_iaaDeg = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[4], PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_v_iaaDeg.memview)) __PYX_ERR(0, 1411, __pyx_L3_error)</span>
    __pyx_v_vaaDeg = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[5], PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_v_vaaDeg.memview)) __PYX_ERR(0, 1412, __pyx_L3_error)</span>
    __pyx_v_alphaDeg = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[6], PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_v_alphaDeg.memview)) __PYX_ERR(0, 1412, __pyx_L3_error)</span>
    __pyx_v_betaDeg = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[7], PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_v_betaDeg.memview)) __PYX_ERR(0, 1412, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("SZ_S_VEC_WRAPPER", 1, 8, 8, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span
                class='error_goto'>__PYX_ERR(0, 1411, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.SZ_S_VEC_WRAPPER", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6pyrism_4core_3tma_10SZ_S_VEC_WRAPPER(__pyx_self, __pyx_v_nmax, __pyx_v_wavelength, __pyx_v_izaDeg, __pyx_v_vzaDeg, __pyx_v_iaaDeg, __pyx_v_vaaDeg, __pyx_v_alphaDeg, __pyx_v_betaDeg);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6pyrism_4core_3tma_10SZ_S_VEC_WRAPPER(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_nmax, __Pyx_memviewslice __pyx_v_wavelength, __Pyx_memviewslice __pyx_v_izaDeg, __Pyx_memviewslice __pyx_v_vzaDeg, __Pyx_memviewslice __pyx_v_iaaDeg, __Pyx_memviewslice __pyx_v_vaaDeg, __Pyx_memviewslice __pyx_v_alphaDeg, __Pyx_memviewslice __pyx_v_betaDeg) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("SZ_S_VEC_WRAPPER", 0);
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.SZ_S_VEC_WRAPPER", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_nmax, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_wavelength, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_izaDeg, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_vzaDeg, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_iaaDeg, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_vaaDeg, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_alphaDeg, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_betaDeg, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* â€¦ */
  __pyx_tuple__84 = <span class='py_c_api'>PyTuple_Pack</span>(8, __pyx_n_s_nmax, __pyx_n_s_wavelength, __pyx_n_s_izaDeg, __pyx_n_s_vzaDeg, __pyx_n_s_iaaDeg, __pyx_n_s_vaaDeg, __pyx_n_s_alphaDeg, __pyx_n_s_betaDeg);<span
                class='error_goto'> if (unlikely(!__pyx_tuple__84)) __PYX_ERR(0, 1411, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__84);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__84);
/* â€¦ */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_6pyrism_4core_3tma_11SZ_S_VEC_WRAPPER, NULL, __pyx_n_s_pyrism_core_tma);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1411, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_SZ_S_VEC_WRAPPER, __pyx_t_1) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 1411, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__85 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(8, 0, 8, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__84, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyrism_core_tma_pyx, __pyx_n_s_SZ_S_VEC_WRAPPER, 1411, __pyx_empty_bytes);<span
                class='error_goto'> if (unlikely(!__pyx_codeobj__85)) __PYX_ERR(0, 1411, __pyx_L1_error)</span>
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1412</span>:                         <span
            class="n">double</span><span class="p">[:]</span> <span class="n">vaaDeg</span><span
            class="p">,</span> <span class="n">double</span><span class="p">[:]</span> <span
            class="n">alphaDeg</span><span class="p">,</span> <span class="n">double</span><span
            class="p">[:]</span> <span class="n">betaDeg</span><span class="p">):</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1413</span>:     <span
            class="sd">&quot;&quot;&quot;</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1414</span>: <span class="sd">    Calculate the single scattering and phase matrix in a vectorized function.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1415</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">1416</span>: <span class="sd">    Parameters</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1417</span>: <span class="sd">    ----------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1418</span>: <span class="sd">    nmax : int[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1419</span>: <span
            class="sd">        Nmax parameter.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1420</span>: <span
            class="sd">    wavelength : double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1421</span>: <span class="sd">        Wavelength in same unit as radius (used by function calc_nmax).</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1422</span>: <span class="sd">    izaDeg, vzaDeg, iaaDeg, vaaDeg : double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1423</span>: <span class="sd">        Incidence (iza) and scattering (vza) zenith angle and incidence and viewing</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1424</span>: <span class="sd">        azimuth angle (ira, vra) in [DEG].</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1425</span>: <span
            class="sd">    alphaDeg, betaDeg: double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1426</span>: <span class="sd">        The Euler angles of the particle orientation in [DEG].</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1427</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">1428</span>: <span class="sd">    Returns</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1429</span>: <span class="sd">    -------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1430</span>: <span class="sd">    S, Z : tuple with double[:,:,:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1431</span>: <span class="sd">        Three dimensional scattering (S) and phase (Z) matrix.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1432</span>: <span
            class="sd">    &quot;&quot;&quot;</span></pre>
    <pre class="cython line score-1"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1433</span>:     <span class="k">return</span> <span class="n">SZ_S_VEC</span><span
            class="p">(</span><span class="n">nmax</span><span class="p">,</span> <span class="n">wavelength</span><span
            class="p">,</span> <span class="n">izaDeg</span><span class="p">,</span> <span class="n">vzaDeg</span><span
            class="p">,</span> <span class="n">iaaDeg</span><span class="p">,</span> <span class="n">vaaDeg</span><span
            class="p">,</span> <span class="n">alphaDeg</span><span class="p">,</span> <span
            class="n">betaDeg</span><span class="p">)</span></pre>
    <pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_6pyrism_4core_3tma_SZ_S_VEC(__pyx_v_nmax, __pyx_v_wavelength, __pyx_v_izaDeg, __pyx_v_vzaDeg, __pyx_v_iaaDeg, __pyx_v_vaaDeg, __pyx_v_alphaDeg, __pyx_v_betaDeg);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1433, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1434</span>: </pre>
    <pre class="cython line score-153"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1435</span>: <span class="k">def</span> <span class="nf">SZ_S_WRAPPER</span><span
            class="p">(</span><span class="nb">int</span> <span class="n">nmax</span><span class="p">,</span> <span
            class="n">double</span> <span class="n">wavelength</span><span class="p">,</span> <span
            class="n">double</span> <span class="n">izaDeg</span><span class="p">,</span> <span class="n">double</span> <span
            class="n">vzaDeg</span><span class="p">,</span> <span class="n">double</span> <span
            class="n">iaaDeg</span><span class="p">,</span></pre>
    <pre class='cython code score-153 '>/* Python wrapper */
static PyObject *__pyx_pw_6pyrism_4core_3tma_13SZ_S_WRAPPER(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6pyrism_4core_3tma_12SZ_S_WRAPPER[] = "\n    Calculate the single scattering and phase matrix.\n\n    Parameters\n    ----------\n    nmax : int[:]\n        Nmax parameter.\n    wavelength : double[:]\n        Wavelength in same unit as radius (used by function calc_nmax).\n    izaDeg, vzaDeg, iaaDeg, vaaDeg : double[:]\n        Incidence (iza) and scattering (vza) zenith angle and incidence and viewing\n        azimuth angle (ira, vra) in [DEG].\n    alphaDeg, betaDeg: double[:]\n        The Euler angles of the particle orientation in [DEG].\n\n    Returns\n    -------\n    S, Z : tuple with double[:,:,:]\n        Three dimensional scattering (S) and phase (Z) matrix.\n    ";
static PyMethodDef __pyx_mdef_6pyrism_4core_3tma_13SZ_S_WRAPPER = {"SZ_S_WRAPPER", (PyCFunction)__pyx_pw_6pyrism_4core_3tma_13SZ_S_WRAPPER, METH_VARARGS|METH_KEYWORDS, __pyx_doc_6pyrism_4core_3tma_12SZ_S_WRAPPER};
static PyObject *__pyx_pw_6pyrism_4core_3tma_13SZ_S_WRAPPER(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_nmax;
  double __pyx_v_wavelength;
  double __pyx_v_izaDeg;
  double __pyx_v_vzaDeg;
  double __pyx_v_iaaDeg;
  double __pyx_v_vaaDeg;
  double __pyx_v_alphaDeg;
  double __pyx_v_betaDeg;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("SZ_S_WRAPPER (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_nmax,&amp;__pyx_n_s_wavelength,&amp;__pyx_n_s_izaDeg,&amp;__pyx_n_s_vzaDeg,&amp;__pyx_n_s_iaaDeg,&amp;__pyx_n_s_vaaDeg,&amp;__pyx_n_s_alphaDeg,&amp;__pyx_n_s_betaDeg,0};
    PyObject* values[8] = {0,0,0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_nmax)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_wavelength)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("SZ_S_WRAPPER", 1, 8, 8, 1); <span
                class='error_goto'>__PYX_ERR(0, 1435, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_izaDeg)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("SZ_S_WRAPPER", 1, 8, 8, 2); <span
                class='error_goto'>__PYX_ERR(0, 1435, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_vzaDeg)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("SZ_S_WRAPPER", 1, 8, 8, 3); <span
                class='error_goto'>__PYX_ERR(0, 1435, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_iaaDeg)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("SZ_S_WRAPPER", 1, 8, 8, 4); <span
                class='error_goto'>__PYX_ERR(0, 1435, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_vaaDeg)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("SZ_S_WRAPPER", 1, 8, 8, 5); <span
                class='error_goto'>__PYX_ERR(0, 1435, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (likely((values[6] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_alphaDeg)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("SZ_S_WRAPPER", 1, 8, 8, 6); <span
                class='error_goto'>__PYX_ERR(0, 1435, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  7:
        if (likely((values[7] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_betaDeg)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("SZ_S_WRAPPER", 1, 8, 8, 7); <span
                class='error_goto'>__PYX_ERR(0, 1435, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "SZ_S_WRAPPER") &lt; 0)) <span
                class='error_goto'>__PYX_ERR(0, 1435, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 8) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
      values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
      values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
      values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
    }
    __pyx_v_nmax = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[0]); if (unlikely((__pyx_v_nmax == (int)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 1435, __pyx_L3_error)</span>
    __pyx_v_wavelength = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[1]); if (unlikely((__pyx_v_wavelength == (double)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 1435, __pyx_L3_error)</span>
    __pyx_v_izaDeg = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[2]); if (unlikely((__pyx_v_izaDeg == (double)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 1435, __pyx_L3_error)</span>
    __pyx_v_vzaDeg = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[3]); if (unlikely((__pyx_v_vzaDeg == (double)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 1435, __pyx_L3_error)</span>
    __pyx_v_iaaDeg = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[4]); if (unlikely((__pyx_v_iaaDeg == (double)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 1435, __pyx_L3_error)</span>
    __pyx_v_vaaDeg = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[5]); if (unlikely((__pyx_v_vaaDeg == (double)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 1436, __pyx_L3_error)</span>
    __pyx_v_alphaDeg = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[6]); if (unlikely((__pyx_v_alphaDeg == (double)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 1436, __pyx_L3_error)</span>
    __pyx_v_betaDeg = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[7]); if (unlikely((__pyx_v_betaDeg == (double)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 1436, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("SZ_S_WRAPPER", 1, 8, 8, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span
                class='error_goto'>__PYX_ERR(0, 1435, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.SZ_S_WRAPPER", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6pyrism_4core_3tma_12SZ_S_WRAPPER(__pyx_self, __pyx_v_nmax, __pyx_v_wavelength, __pyx_v_izaDeg, __pyx_v_vzaDeg, __pyx_v_iaaDeg, __pyx_v_vaaDeg, __pyx_v_alphaDeg, __pyx_v_betaDeg);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6pyrism_4core_3tma_12SZ_S_WRAPPER(CYTHON_UNUSED PyObject *__pyx_self, int __pyx_v_nmax, double __pyx_v_wavelength, double __pyx_v_izaDeg, double __pyx_v_vzaDeg, double __pyx_v_iaaDeg, double __pyx_v_vaaDeg, double __pyx_v_alphaDeg, double __pyx_v_betaDeg) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("SZ_S_WRAPPER", 0);
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.SZ_S_WRAPPER", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* â€¦ */
  __pyx_tuple__86 = <span class='py_c_api'>PyTuple_Pack</span>(8, __pyx_n_s_nmax, __pyx_n_s_wavelength, __pyx_n_s_izaDeg, __pyx_n_s_vzaDeg, __pyx_n_s_iaaDeg, __pyx_n_s_vaaDeg, __pyx_n_s_alphaDeg, __pyx_n_s_betaDeg);<span
                class='error_goto'> if (unlikely(!__pyx_tuple__86)) __PYX_ERR(0, 1435, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__86);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__86);
/* â€¦ */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_6pyrism_4core_3tma_13SZ_S_WRAPPER, NULL, __pyx_n_s_pyrism_core_tma);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1435, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_SZ_S_WRAPPER, __pyx_t_1) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 1435, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__87 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(8, 0, 8, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__86, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyrism_core_tma_pyx, __pyx_n_s_SZ_S_WRAPPER, 1435, __pyx_empty_bytes);<span
                class='error_goto'> if (unlikely(!__pyx_codeobj__87)) __PYX_ERR(0, 1435, __pyx_L1_error)</span>
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1436</span>:                  <span
            class="n">double</span> <span class="n">vaaDeg</span><span class="p">,</span> <span class="n">double</span> <span
            class="n">alphaDeg</span><span class="p">,</span> <span class="n">double</span> <span
            class="n">betaDeg</span><span class="p">):</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1437</span>:     <span
            class="sd">&quot;&quot;&quot;</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1438</span>: <span class="sd">    Calculate the single scattering and phase matrix.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1439</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">1440</span>: <span class="sd">    Parameters</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1441</span>: <span class="sd">    ----------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1442</span>: <span class="sd">    nmax : int[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1443</span>: <span
            class="sd">        Nmax parameter.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1444</span>: <span
            class="sd">    wavelength : double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1445</span>: <span class="sd">        Wavelength in same unit as radius (used by function calc_nmax).</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1446</span>: <span class="sd">    izaDeg, vzaDeg, iaaDeg, vaaDeg : double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1447</span>: <span class="sd">        Incidence (iza) and scattering (vza) zenith angle and incidence and viewing</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1448</span>: <span class="sd">        azimuth angle (ira, vra) in [DEG].</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1449</span>: <span
            class="sd">    alphaDeg, betaDeg: double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1450</span>: <span class="sd">        The Euler angles of the particle orientation in [DEG].</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1451</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">1452</span>: <span class="sd">    Returns</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1453</span>: <span class="sd">    -------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1454</span>: <span class="sd">    S, Z : tuple with double[:,:,:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1455</span>: <span class="sd">        Three dimensional scattering (S) and phase (Z) matrix.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1456</span>: <span
            class="sd">    &quot;&quot;&quot;</span></pre>
    <pre class="cython line score-1"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1457</span>:     <span class="k">return</span> <span class="n">SZ_S</span><span
            class="p">(</span><span class="n">nmax</span><span class="p">,</span> <span class="n">wavelength</span><span
            class="p">,</span> <span class="n">izaDeg</span><span class="p">,</span> <span class="n">vzaDeg</span><span
            class="p">,</span> <span class="n">iaaDeg</span><span class="p">,</span> <span class="n">vaaDeg</span><span
            class="p">,</span> <span class="n">alphaDeg</span><span class="p">,</span> <span
            class="n">betaDeg</span><span class="p">)</span></pre>
    <pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_6pyrism_4core_3tma_SZ_S(__pyx_v_nmax, __pyx_v_wavelength, __pyx_v_izaDeg, __pyx_v_vzaDeg, __pyx_v_iaaDeg, __pyx_v_vaaDeg, __pyx_v_alphaDeg, __pyx_v_betaDeg);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1457, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1458</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">1459</span>: <span class="c"># S and Z for Adaptive Fixed Orientation -------------------------------------------------------------------------------</span></pre>
    <pre class="cython line score-108"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1460</span>: <span class="k">def</span> <span class="nf">SZ_AF_VEC_WRAPPER</span><span
            class="p">(</span><span class="nb">int</span><span class="p">[:]</span> <span class="n">nmax</span><span
            class="p">,</span> <span class="n">double</span><span class="p">[:]</span> <span class="n">wavelength</span><span
            class="p">,</span> <span class="n">double</span><span class="p">[:]</span> <span
            class="n">izaDeg</span><span class="p">,</span> <span class="n">double</span><span
            class="p">[:]</span> <span class="n">vzaDeg</span><span class="p">,</span> <span
            class="n">double</span><span class="p">[:]</span> <span class="n">iaaDeg</span><span
            class="p">,</span></pre>
    <pre class='cython code score-108 '>/* Python wrapper */
static PyObject *__pyx_pw_6pyrism_4core_3tma_15SZ_AF_VEC_WRAPPER(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6pyrism_4core_3tma_14SZ_AF_VEC_WRAPPER[] = "\n    Calculate the variable orientation scattering and phase matrix in a vectorized function.\n\n    This method uses a fast Gaussian quadrature and is suitable\n    for most use. Uses the set particle orientation PDF, ignoring\n    the alpha and beta attributes.\n\n    Parameters\n    ----------\n    nmax : int[:]\n        Nmax parameter.\n    wavelength : double[:]\n        Wavelength in same unit as radius (used by function calc_nmax).\n    izaDeg, vzaDeg, iaaDeg, vaaDeg : double[:]\n        Incidence (iza) and scattering (vza) zenith angle and incidence and viewing\n        azimuth angle (ira, vra) in [DEG].\n    n_alpha, n_beta : int\n        Number of integration points in the alpha and beta Euler angle.\n    or_pdf: callable\n        Particle orientation Probability Density Function (PDF) for orientation averaging.\n\n    Returns\n    -------\n    S, Z : tuple with double[:,:,:]\n        Three dimensional scattering (S) and phase (Z) matrix.\n    ";
static PyMethodDef __pyx_mdef_6pyrism_4core_3tma_15SZ_AF_VEC_WRAPPER = {"SZ_AF_VEC_WRAPPER", (PyCFunction)__pyx_pw_6pyrism_4core_3tma_15SZ_AF_VEC_WRAPPER, METH_VARARGS|METH_KEYWORDS, __pyx_doc_6pyrism_4core_3tma_14SZ_AF_VEC_WRAPPER};
static PyObject *__pyx_pw_6pyrism_4core_3tma_15SZ_AF_VEC_WRAPPER(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_nmax = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_wavelength = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_izaDeg = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_vzaDeg = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_iaaDeg = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_vaaDeg = { 0, 0, { 0 }, { 0 }, { 0 } };
  int __pyx_v_n_alpha;
  int __pyx_v_n_beta;
  PyObject *__pyx_v_or_pdf = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("SZ_AF_VEC_WRAPPER (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_nmax,&amp;__pyx_n_s_wavelength,&amp;__pyx_n_s_izaDeg,&amp;__pyx_n_s_vzaDeg,&amp;__pyx_n_s_iaaDeg,&amp;__pyx_n_s_vaaDeg,&amp;__pyx_n_s_n_alpha,&amp;__pyx_n_s_n_beta,&amp;__pyx_n_s_or_pdf,0};
    PyObject* values[9] = {0,0,0,0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  9: values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_nmax)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_wavelength)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("SZ_AF_VEC_WRAPPER", 1, 9, 9, 1); <span
                class='error_goto'>__PYX_ERR(0, 1460, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_izaDeg)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("SZ_AF_VEC_WRAPPER", 1, 9, 9, 2); <span
                class='error_goto'>__PYX_ERR(0, 1460, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_vzaDeg)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("SZ_AF_VEC_WRAPPER", 1, 9, 9, 3); <span
                class='error_goto'>__PYX_ERR(0, 1460, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_iaaDeg)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("SZ_AF_VEC_WRAPPER", 1, 9, 9, 4); <span
                class='error_goto'>__PYX_ERR(0, 1460, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_vaaDeg)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("SZ_AF_VEC_WRAPPER", 1, 9, 9, 5); <span
                class='error_goto'>__PYX_ERR(0, 1460, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (likely((values[6] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_n_alpha)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("SZ_AF_VEC_WRAPPER", 1, 9, 9, 6); <span
                class='error_goto'>__PYX_ERR(0, 1460, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  7:
        if (likely((values[7] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_n_beta)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("SZ_AF_VEC_WRAPPER", 1, 9, 9, 7); <span
                class='error_goto'>__PYX_ERR(0, 1460, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  8:
        if (likely((values[8] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_or_pdf)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("SZ_AF_VEC_WRAPPER", 1, 9, 9, 8); <span
                class='error_goto'>__PYX_ERR(0, 1460, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "SZ_AF_VEC_WRAPPER") &lt; 0)) <span
                class='error_goto'>__PYX_ERR(0, 1460, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 9) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
      values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
      values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
      values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
      values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
    }
    __pyx_v_nmax = <span
                class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[0], PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_v_nmax.memview)) __PYX_ERR(0, 1460, __pyx_L3_error)</span>
    __pyx_v_wavelength = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[1], PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_v_wavelength.memview)) __PYX_ERR(0, 1460, __pyx_L3_error)</span>
    __pyx_v_izaDeg = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[2], PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_v_izaDeg.memview)) __PYX_ERR(0, 1460, __pyx_L3_error)</span>
    __pyx_v_vzaDeg = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[3], PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_v_vzaDeg.memview)) __PYX_ERR(0, 1460, __pyx_L3_error)</span>
    __pyx_v_iaaDeg = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[4], PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_v_iaaDeg.memview)) __PYX_ERR(0, 1460, __pyx_L3_error)</span>
    __pyx_v_vaaDeg = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[5], PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_v_vaaDeg.memview)) __PYX_ERR(0, 1461, __pyx_L3_error)</span>
    __pyx_v_n_alpha = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[6]); if (unlikely((__pyx_v_n_alpha == (int)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 1461, __pyx_L3_error)</span>
    __pyx_v_n_beta = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[7]); if (unlikely((__pyx_v_n_beta == (int)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 1461, __pyx_L3_error)</span>
    __pyx_v_or_pdf = values[8];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("SZ_AF_VEC_WRAPPER", 1, 9, 9, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span
                class='error_goto'>__PYX_ERR(0, 1460, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.SZ_AF_VEC_WRAPPER", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6pyrism_4core_3tma_14SZ_AF_VEC_WRAPPER(__pyx_self, __pyx_v_nmax, __pyx_v_wavelength, __pyx_v_izaDeg, __pyx_v_vzaDeg, __pyx_v_iaaDeg, __pyx_v_vaaDeg, __pyx_v_n_alpha, __pyx_v_n_beta, __pyx_v_or_pdf);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6pyrism_4core_3tma_14SZ_AF_VEC_WRAPPER(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_nmax, __Pyx_memviewslice __pyx_v_wavelength, __Pyx_memviewslice __pyx_v_izaDeg, __Pyx_memviewslice __pyx_v_vzaDeg, __Pyx_memviewslice __pyx_v_iaaDeg, __Pyx_memviewslice __pyx_v_vaaDeg, int __pyx_v_n_alpha, int __pyx_v_n_beta, PyObject *__pyx_v_or_pdf) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("SZ_AF_VEC_WRAPPER", 0);
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.SZ_AF_VEC_WRAPPER", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_nmax, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_wavelength, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_izaDeg, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_vzaDeg, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_iaaDeg, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_vaaDeg, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* â€¦ */
  __pyx_tuple__88 = <span class='py_c_api'>PyTuple_Pack</span>(9, __pyx_n_s_nmax, __pyx_n_s_wavelength, __pyx_n_s_izaDeg, __pyx_n_s_vzaDeg, __pyx_n_s_iaaDeg, __pyx_n_s_vaaDeg, __pyx_n_s_n_alpha, __pyx_n_s_n_beta, __pyx_n_s_or_pdf);<span
                class='error_goto'> if (unlikely(!__pyx_tuple__88)) __PYX_ERR(0, 1460, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__88);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__88);
/* â€¦ */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_6pyrism_4core_3tma_15SZ_AF_VEC_WRAPPER, NULL, __pyx_n_s_pyrism_core_tma);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1460, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_SZ_AF_VEC_WRAPPER, __pyx_t_1) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 1460, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__89 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(9, 0, 9, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__88, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyrism_core_tma_pyx, __pyx_n_s_SZ_AF_VEC_WRAPPER, 1460, __pyx_empty_bytes);<span
                class='error_goto'> if (unlikely(!__pyx_codeobj__89)) __PYX_ERR(0, 1460, __pyx_L1_error)</span>
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1461</span>:                                  <span class="n">double</span><span
            class="p">[:]</span> <span class="n">vaaDeg</span><span class="p">,</span> <span class="nb">int</span> <span
            class="n">n_alpha</span><span class="p">,</span> <span class="nb">int</span> <span
            class="n">n_beta</span><span class="p">,</span> <span class="n">or_pdf</span><span class="p">):</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1462</span>:     <span
            class="sd">&quot;&quot;&quot;</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1463</span>: <span class="sd">    Calculate the variable orientation scattering and phase matrix in a vectorized function.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1464</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">1465</span>: <span class="sd">    This method uses a fast Gaussian quadrature and is suitable</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1466</span>: <span class="sd">    for most use. Uses the set particle orientation PDF, ignoring</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1467</span>: <span class="sd">    the alpha and beta attributes.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1468</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">1469</span>: <span class="sd">    Parameters</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1470</span>: <span class="sd">    ----------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1471</span>: <span class="sd">    nmax : int[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1472</span>: <span
            class="sd">        Nmax parameter.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1473</span>: <span
            class="sd">    wavelength : double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1474</span>: <span class="sd">        Wavelength in same unit as radius (used by function calc_nmax).</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1475</span>: <span class="sd">    izaDeg, vzaDeg, iaaDeg, vaaDeg : double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1476</span>: <span class="sd">        Incidence (iza) and scattering (vza) zenith angle and incidence and viewing</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1477</span>: <span class="sd">        azimuth angle (ira, vra) in [DEG].</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1478</span>: <span class="sd">    n_alpha, n_beta : int</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1479</span>: <span class="sd">        Number of integration points in the alpha and beta Euler angle.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1480</span>: <span
            class="sd">    or_pdf: callable</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1481</span>: <span class="sd">        Particle orientation Probability Density Function (PDF) for orientation averaging.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1482</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">1483</span>: <span class="sd">    Returns</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1484</span>: <span class="sd">    -------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1485</span>: <span class="sd">    S, Z : tuple with double[:,:,:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1486</span>: <span class="sd">        Three dimensional scattering (S) and phase (Z) matrix.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1487</span>: <span
            class="sd">    &quot;&quot;&quot;</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1488</span>: </pre>
    <pre class="cython line score-1"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1489</span>:     <span class="k">return</span> <span class="n">SZ_AF_VEC</span><span
            class="p">(</span><span class="n">nmax</span><span class="p">,</span> <span class="n">wavelength</span><span
            class="p">,</span> <span class="n">izaDeg</span><span class="p">,</span> <span class="n">vzaDeg</span><span
            class="p">,</span> <span class="n">iaaDeg</span><span class="p">,</span> <span class="n">vaaDeg</span><span
            class="p">,</span> <span class="n">n_alpha</span><span class="p">,</span> <span class="n">n_beta</span><span
            class="p">,</span> <span class="n">or_pdf</span><span class="p">)</span></pre>
    <pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_6pyrism_4core_3tma_SZ_AF_VEC(__pyx_v_nmax, __pyx_v_wavelength, __pyx_v_izaDeg, __pyx_v_vzaDeg, __pyx_v_iaaDeg, __pyx_v_vaaDeg, __pyx_v_n_alpha, __pyx_v_n_beta, __pyx_v_or_pdf);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1489, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1490</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">1491</span>: </pre>
    <pre class="cython line score-153"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1492</span>: <span class="k">def</span> <span class="nf">SZ_AF_WRAPPER</span><span
            class="p">(</span><span class="nb">int</span> <span class="n">nmax</span><span class="p">,</span> <span
            class="n">double</span> <span class="n">wavelength</span><span class="p">,</span> <span
            class="n">double</span> <span class="n">izaDeg</span><span class="p">,</span> <span class="n">double</span> <span
            class="n">vzaDeg</span><span class="p">,</span> <span class="n">double</span> <span
            class="n">iaaDeg</span><span class="p">,</span></pre>
    <pre class='cython code score-153 '>/* Python wrapper */
static PyObject *__pyx_pw_6pyrism_4core_3tma_17SZ_AF_WRAPPER(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6pyrism_4core_3tma_16SZ_AF_WRAPPER[] = "\n    Calculate the variable orientation scattering and phase matrix.\n\n    This method uses a fast Gaussian quadrature and is suitable\n    for most use. Uses the set particle orientation PDF, ignoring\n    the alpha and beta attributes.\n\n    Parameters\n    ----------\n    nmax : int\n        Nmax parameter.\n    wavelength : double\n        Wavelength in same unit as radius (used by function calc_nmax).\n    izaDeg, vzaDeg, iaaDeg, vaaDeg : double\n        Incidence (iza) and scattering (vza) zenith angle and incidence and viewing\n        azimuth angle (ira, vra) in [DEG].\n    n_alpha, n_beta : int\n        Number of integration points in the alpha and beta Euler angle.\n    or_pdf: callable\n        Particle orientation Probability Density Function (PDF) for orientation averaging.\n\n    Returns\n    -------\n    S, Z : tuple with double[:,:]\n        Two dimensional scattering (S) and phase (Z) matrix.\n    ";
static PyMethodDef __pyx_mdef_6pyrism_4core_3tma_17SZ_AF_WRAPPER = {"SZ_AF_WRAPPER", (PyCFunction)__pyx_pw_6pyrism_4core_3tma_17SZ_AF_WRAPPER, METH_VARARGS|METH_KEYWORDS, __pyx_doc_6pyrism_4core_3tma_16SZ_AF_WRAPPER};
static PyObject *__pyx_pw_6pyrism_4core_3tma_17SZ_AF_WRAPPER(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_nmax;
  double __pyx_v_wavelength;
  double __pyx_v_izaDeg;
  double __pyx_v_vzaDeg;
  double __pyx_v_iaaDeg;
  double __pyx_v_vaaDeg;
  int __pyx_v_n_alpha;
  int __pyx_v_n_beta;
  PyObject *__pyx_v_or_pdf = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("SZ_AF_WRAPPER (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_nmax,&amp;__pyx_n_s_wavelength,&amp;__pyx_n_s_izaDeg,&amp;__pyx_n_s_vzaDeg,&amp;__pyx_n_s_iaaDeg,&amp;__pyx_n_s_vaaDeg,&amp;__pyx_n_s_n_alpha,&amp;__pyx_n_s_n_beta,&amp;__pyx_n_s_or_pdf,0};
    PyObject* values[9] = {0,0,0,0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  9: values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_nmax)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_wavelength)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("SZ_AF_WRAPPER", 1, 9, 9, 1); <span
                class='error_goto'>__PYX_ERR(0, 1492, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_izaDeg)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("SZ_AF_WRAPPER", 1, 9, 9, 2); <span
                class='error_goto'>__PYX_ERR(0, 1492, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_vzaDeg)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("SZ_AF_WRAPPER", 1, 9, 9, 3); <span
                class='error_goto'>__PYX_ERR(0, 1492, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_iaaDeg)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("SZ_AF_WRAPPER", 1, 9, 9, 4); <span
                class='error_goto'>__PYX_ERR(0, 1492, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_vaaDeg)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("SZ_AF_WRAPPER", 1, 9, 9, 5); <span
                class='error_goto'>__PYX_ERR(0, 1492, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (likely((values[6] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_n_alpha)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("SZ_AF_WRAPPER", 1, 9, 9, 6); <span
                class='error_goto'>__PYX_ERR(0, 1492, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  7:
        if (likely((values[7] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_n_beta)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("SZ_AF_WRAPPER", 1, 9, 9, 7); <span
                class='error_goto'>__PYX_ERR(0, 1492, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  8:
        if (likely((values[8] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_or_pdf)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("SZ_AF_WRAPPER", 1, 9, 9, 8); <span
                class='error_goto'>__PYX_ERR(0, 1492, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "SZ_AF_WRAPPER") &lt; 0)) <span
                class='error_goto'>__PYX_ERR(0, 1492, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 9) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
      values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
      values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
      values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
      values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
    }
    __pyx_v_nmax = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[0]); if (unlikely((__pyx_v_nmax == (int)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 1492, __pyx_L3_error)</span>
    __pyx_v_wavelength = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[1]); if (unlikely((__pyx_v_wavelength == (double)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 1492, __pyx_L3_error)</span>
    __pyx_v_izaDeg = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[2]); if (unlikely((__pyx_v_izaDeg == (double)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 1492, __pyx_L3_error)</span>
    __pyx_v_vzaDeg = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[3]); if (unlikely((__pyx_v_vzaDeg == (double)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 1492, __pyx_L3_error)</span>
    __pyx_v_iaaDeg = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[4]); if (unlikely((__pyx_v_iaaDeg == (double)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 1492, __pyx_L3_error)</span>
    __pyx_v_vaaDeg = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[5]); if (unlikely((__pyx_v_vaaDeg == (double)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 1493, __pyx_L3_error)</span>
    __pyx_v_n_alpha = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[6]); if (unlikely((__pyx_v_n_alpha == (int)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 1493, __pyx_L3_error)</span>
    __pyx_v_n_beta = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[7]); if (unlikely((__pyx_v_n_beta == (int)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 1493, __pyx_L3_error)</span>
    __pyx_v_or_pdf = values[8];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("SZ_AF_WRAPPER", 1, 9, 9, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span
                class='error_goto'>__PYX_ERR(0, 1492, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.SZ_AF_WRAPPER", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6pyrism_4core_3tma_16SZ_AF_WRAPPER(__pyx_self, __pyx_v_nmax, __pyx_v_wavelength, __pyx_v_izaDeg, __pyx_v_vzaDeg, __pyx_v_iaaDeg, __pyx_v_vaaDeg, __pyx_v_n_alpha, __pyx_v_n_beta, __pyx_v_or_pdf);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6pyrism_4core_3tma_16SZ_AF_WRAPPER(CYTHON_UNUSED PyObject *__pyx_self, int __pyx_v_nmax, double __pyx_v_wavelength, double __pyx_v_izaDeg, double __pyx_v_vzaDeg, double __pyx_v_iaaDeg, double __pyx_v_vaaDeg, int __pyx_v_n_alpha, int __pyx_v_n_beta, PyObject *__pyx_v_or_pdf) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("SZ_AF_WRAPPER", 0);
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.SZ_AF_WRAPPER", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* â€¦ */
  __pyx_tuple__90 = <span class='py_c_api'>PyTuple_Pack</span>(9, __pyx_n_s_nmax, __pyx_n_s_wavelength, __pyx_n_s_izaDeg, __pyx_n_s_vzaDeg, __pyx_n_s_iaaDeg, __pyx_n_s_vaaDeg, __pyx_n_s_n_alpha, __pyx_n_s_n_beta, __pyx_n_s_or_pdf);<span
                class='error_goto'> if (unlikely(!__pyx_tuple__90)) __PYX_ERR(0, 1492, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__90);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__90);
/* â€¦ */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_6pyrism_4core_3tma_17SZ_AF_WRAPPER, NULL, __pyx_n_s_pyrism_core_tma);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1492, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_SZ_AF_WRAPPER, __pyx_t_1) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 1492, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__91 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(9, 0, 9, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__90, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyrism_core_tma_pyx, __pyx_n_s_SZ_AF_WRAPPER, 1492, __pyx_empty_bytes);<span
                class='error_goto'> if (unlikely(!__pyx_codeobj__91)) __PYX_ERR(0, 1492, __pyx_L1_error)</span>
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1493</span>:                   <span
            class="n">double</span> <span class="n">vaaDeg</span><span class="p">,</span> <span
            class="nb">int</span> <span class="n">n_alpha</span><span class="p">,</span> <span
            class="nb">int</span> <span class="n">n_beta</span><span class="p">,</span> <span
            class="n">or_pdf</span><span class="p">):</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1494</span>:     <span
            class="sd">&quot;&quot;&quot;</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1495</span>: <span class="sd">    Calculate the variable orientation scattering and phase matrix.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1496</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">1497</span>: <span class="sd">    This method uses a fast Gaussian quadrature and is suitable</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1498</span>: <span class="sd">    for most use. Uses the set particle orientation PDF, ignoring</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1499</span>: <span class="sd">    the alpha and beta attributes.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1500</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">1501</span>: <span class="sd">    Parameters</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1502</span>: <span class="sd">    ----------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1503</span>: <span class="sd">    nmax : int</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1504</span>: <span
            class="sd">        Nmax parameter.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1505</span>: <span
            class="sd">    wavelength : double</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1506</span>: <span class="sd">        Wavelength in same unit as radius (used by function calc_nmax).</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1507</span>: <span class="sd">    izaDeg, vzaDeg, iaaDeg, vaaDeg : double</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1508</span>: <span class="sd">        Incidence (iza) and scattering (vza) zenith angle and incidence and viewing</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1509</span>: <span class="sd">        azimuth angle (ira, vra) in [DEG].</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1510</span>: <span class="sd">    n_alpha, n_beta : int</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1511</span>: <span class="sd">        Number of integration points in the alpha and beta Euler angle.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1512</span>: <span
            class="sd">    or_pdf: callable</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1513</span>: <span class="sd">        Particle orientation Probability Density Function (PDF) for orientation averaging.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1514</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">1515</span>: <span class="sd">    Returns</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1516</span>: <span class="sd">    -------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1517</span>: <span class="sd">    S, Z : tuple with double[:,:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1518</span>: <span class="sd">        Two dimensional scattering (S) and phase (Z) matrix.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1519</span>: <span
            class="sd">    &quot;&quot;&quot;</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1520</span>: </pre>
    <pre class="cython line score-1"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1521</span>:     <span class="k">return</span> <span class="n">SZ_AF</span><span class="p">(</span><span
            class="n">nmax</span><span class="p">,</span> <span class="n">wavelength</span><span
            class="p">,</span> <span class="n">izaDeg</span><span class="p">,</span> <span class="n">vzaDeg</span><span
            class="p">,</span> <span class="n">iaaDeg</span><span class="p">,</span> <span class="n">vaaDeg</span><span
            class="p">,</span> <span class="n">n_alpha</span><span class="p">,</span> <span class="n">n_beta</span><span
            class="p">,</span> <span class="n">or_pdf</span><span class="p">)</span></pre>
    <pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_6pyrism_4core_3tma_SZ_AF(__pyx_v_nmax, __pyx_v_wavelength, __pyx_v_izaDeg, __pyx_v_vzaDeg, __pyx_v_iaaDeg, __pyx_v_vaaDeg, __pyx_v_n_alpha, __pyx_v_n_beta, __pyx_v_or_pdf);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1521, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1522</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">1523</span>: <span class="c"># ----------------------------------------------------------------------------------------------------------------------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1524</span>: <span class="c"># Integrate Scattering and Phase Matrix Wrapper</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1525</span>: <span class="c"># ----------------------------------------------------------------------------------------------------------------------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1526</span>: <span class="c"># S and Z for Single Orientation ---------------------------------------------------------------------------------------</span></pre>
    <pre class="cython line score-89"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1527</span>: <span class="k">def</span> <span class="nf">DBLQUAD_Z_S_WRAPPER</span><span class="p">(</span><span
            class="nb">int</span><span class="p">[:]</span> <span class="n">nmax</span><span class="p">,</span> <span
            class="n">double</span><span class="p">[:]</span> <span class="n">wavelength</span><span class="p">,</span> <span
            class="n">double</span><span class="p">[:]</span> <span class="n">xzaDeg</span><span
            class="p">,</span> <span class="n">double</span><span class="p">[:]</span> <span
            class="n">xaaDeg</span><span class="p">,</span> <span class="n">double</span><span
            class="p">[:]</span> <span class="n">alphaDeg</span><span class="p">,</span></pre>
    <pre class='cython code score-89 '>/* Python wrapper */
static PyObject *__pyx_pw_6pyrism_4core_3tma_19DBLQUAD_Z_S_WRAPPER(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6pyrism_4core_3tma_18DBLQUAD_Z_S_WRAPPER[] = "\n    Integrate the phase matrix over a half sphere for SINGLE ORIENTATION.\n\n    Parameters\n    ----------\n    nmax : int[:]\n        Nmax parameter.\n    wavelength : double[:]\n        Wavelength in same unit as radius (used by function calc_nmax).\n    xzaDeg, xaaDeg : double[:]\n        Scattering (vza) or incidence (iza) zenith and azimuth angle (vaa, iaa) in [DEG].\n    alphaDeg, betaDeg: double[:]\n        The Euler angles of the particle orientation in [DEG].\n    iza_flag : int\n        If True, the integration is over the incidence angle. Then the xzaDeg and xaaDeg must be the viewing angle\n        vzaDeg and vaaDeg. Else it will be integrated over the viewing direction where xzaDeg and xaaDeg must be the\n        incidence angle izaDeg and iaaDeg.\n    Returns\n    -------\n    Z : MemoryView, double[:,:]\n        Two dimensional integrated phase matrix.\n\n    Note\n    ----\n    The output is a array with shape (nmax.shape[0], 16). To put it in a matrix form one must reshape it like\n    np.reshape(Z, (nmax.shape[0], 4, 4)).\n    ";
static PyMethodDef __pyx_mdef_6pyrism_4core_3tma_19DBLQUAD_Z_S_WRAPPER = {"DBLQUAD_Z_S_WRAPPER", (PyCFunction)__pyx_pw_6pyrism_4core_3tma_19DBLQUAD_Z_S_WRAPPER, METH_VARARGS|METH_KEYWORDS, __pyx_doc_6pyrism_4core_3tma_18DBLQUAD_Z_S_WRAPPER};
static PyObject *__pyx_pw_6pyrism_4core_3tma_19DBLQUAD_Z_S_WRAPPER(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_nmax = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_wavelength = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_xzaDeg = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_xaaDeg = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_alphaDeg = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_betaDeg = { 0, 0, { 0 }, { 0 }, { 0 } };
  int __pyx_v_iza_flag;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("DBLQUAD_Z_S_WRAPPER (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_nmax,&amp;__pyx_n_s_wavelength,&amp;__pyx_n_s_xzaDeg,&amp;__pyx_n_s_xaaDeg,&amp;__pyx_n_s_alphaDeg,&amp;__pyx_n_s_betaDeg,&amp;__pyx_n_s_iza_flag,0};
    PyObject* values[7] = {0,0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_nmax)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_wavelength)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("DBLQUAD_Z_S_WRAPPER", 1, 7, 7, 1); <span
                class='error_goto'>__PYX_ERR(0, 1527, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_xzaDeg)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("DBLQUAD_Z_S_WRAPPER", 1, 7, 7, 2); <span
                class='error_goto'>__PYX_ERR(0, 1527, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_xaaDeg)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("DBLQUAD_Z_S_WRAPPER", 1, 7, 7, 3); <span
                class='error_goto'>__PYX_ERR(0, 1527, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_alphaDeg)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("DBLQUAD_Z_S_WRAPPER", 1, 7, 7, 4); <span
                class='error_goto'>__PYX_ERR(0, 1527, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_betaDeg)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("DBLQUAD_Z_S_WRAPPER", 1, 7, 7, 5); <span
                class='error_goto'>__PYX_ERR(0, 1527, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (likely((values[6] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_iza_flag)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("DBLQUAD_Z_S_WRAPPER", 1, 7, 7, 6); <span
                class='error_goto'>__PYX_ERR(0, 1527, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "DBLQUAD_Z_S_WRAPPER") &lt; 0)) <span
                class='error_goto'>__PYX_ERR(0, 1527, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 7) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
      values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
      values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
    }
    __pyx_v_nmax = <span
                class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[0], PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_v_nmax.memview)) __PYX_ERR(0, 1527, __pyx_L3_error)</span>
    __pyx_v_wavelength = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[1], PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_v_wavelength.memview)) __PYX_ERR(0, 1527, __pyx_L3_error)</span>
    __pyx_v_xzaDeg = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[2], PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_v_xzaDeg.memview)) __PYX_ERR(0, 1527, __pyx_L3_error)</span>
    __pyx_v_xaaDeg = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[3], PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_v_xaaDeg.memview)) __PYX_ERR(0, 1527, __pyx_L3_error)</span>
    __pyx_v_alphaDeg = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[4], PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_v_alphaDeg.memview)) __PYX_ERR(0, 1527, __pyx_L3_error)</span>
    __pyx_v_betaDeg = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[5], PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_v_betaDeg.memview)) __PYX_ERR(0, 1528, __pyx_L3_error)</span>
    __pyx_v_iza_flag = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[6]); if (unlikely((__pyx_v_iza_flag == (int)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 1528, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("DBLQUAD_Z_S_WRAPPER", 1, 7, 7, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span
                class='error_goto'>__PYX_ERR(0, 1527, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.DBLQUAD_Z_S_WRAPPER", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6pyrism_4core_3tma_18DBLQUAD_Z_S_WRAPPER(__pyx_self, __pyx_v_nmax, __pyx_v_wavelength, __pyx_v_xzaDeg, __pyx_v_xaaDeg, __pyx_v_alphaDeg, __pyx_v_betaDeg, __pyx_v_iza_flag);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6pyrism_4core_3tma_18DBLQUAD_Z_S_WRAPPER(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_nmax, __Pyx_memviewslice __pyx_v_wavelength, __Pyx_memviewslice __pyx_v_xzaDeg, __Pyx_memviewslice __pyx_v_xaaDeg, __Pyx_memviewslice __pyx_v_alphaDeg, __Pyx_memviewslice __pyx_v_betaDeg, int __pyx_v_iza_flag) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("DBLQUAD_Z_S_WRAPPER", 0);
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_2, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.DBLQUAD_Z_S_WRAPPER", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_nmax, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_wavelength, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_xzaDeg, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_xaaDeg, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_alphaDeg, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_betaDeg, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* â€¦ */
  __pyx_tuple__92 = <span class='py_c_api'>PyTuple_Pack</span>(7, __pyx_n_s_nmax, __pyx_n_s_wavelength, __pyx_n_s_xzaDeg, __pyx_n_s_xaaDeg, __pyx_n_s_alphaDeg, __pyx_n_s_betaDeg, __pyx_n_s_iza_flag);<span
                class='error_goto'> if (unlikely(!__pyx_tuple__92)) __PYX_ERR(0, 1527, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__92);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__92);
/* â€¦ */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_6pyrism_4core_3tma_19DBLQUAD_Z_S_WRAPPER, NULL, __pyx_n_s_pyrism_core_tma);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1527, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_DBLQUAD_Z_S_WRAPPER, __pyx_t_1) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 1527, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__93 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(7, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__92, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyrism_core_tma_pyx, __pyx_n_s_DBLQUAD_Z_S_WRAPPER, 1527, __pyx_empty_bytes);<span
                class='error_goto'> if (unlikely(!__pyx_codeobj__93)) __PYX_ERR(0, 1527, __pyx_L1_error)</span>
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1528</span>:                         <span
            class="n">double</span><span class="p">[:]</span> <span class="n">betaDeg</span><span
            class="p">,</span> <span class="nb">int</span> <span class="n">iza_flag</span><span
            class="p">):</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1529</span>:     <span
            class="sd">&quot;&quot;&quot;</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1530</span>: <span class="sd">    Integrate the phase matrix over a half sphere for SINGLE ORIENTATION.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1531</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">1532</span>: <span class="sd">    Parameters</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1533</span>: <span class="sd">    ----------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1534</span>: <span class="sd">    nmax : int[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1535</span>: <span
            class="sd">        Nmax parameter.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1536</span>: <span
            class="sd">    wavelength : double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1537</span>: <span class="sd">        Wavelength in same unit as radius (used by function calc_nmax).</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1538</span>: <span
            class="sd">    xzaDeg, xaaDeg : double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1539</span>: <span class="sd">        Scattering (vza) or incidence (iza) zenith and azimuth angle (vaa, iaa) in [DEG].</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1540</span>: <span
            class="sd">    alphaDeg, betaDeg: double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1541</span>: <span class="sd">        The Euler angles of the particle orientation in [DEG].</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1542</span>: <span class="sd">    iza_flag : int</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1543</span>: <span class="sd">        If True, the integration is over the incidence angle. Then the xzaDeg and xaaDeg must be the viewing angle</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1544</span>: <span class="sd">        vzaDeg and vaaDeg. Else it will be integrated over the viewing direction where xzaDeg and xaaDeg must be the</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1545</span>: <span class="sd">        incidence angle izaDeg and iaaDeg.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1546</span>: <span class="sd">    Returns</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1547</span>: <span class="sd">    -------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1548</span>: <span
            class="sd">    Z : MemoryView, double[:,:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1549</span>: <span class="sd">        Two dimensional integrated phase matrix.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1550</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">1551</span>: <span class="sd">    Note</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1552</span>: <span class="sd">    ----</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1553</span>: <span class="sd">    The output is a array with shape (nmax.shape[0], 16). To put it in a matrix form one must reshape it like</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1554</span>: <span class="sd">    np.reshape(Z, (nmax.shape[0], 4, 4)).</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1555</span>: <span
            class="sd">    &quot;&quot;&quot;</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1556</span>: </pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1557</span>:     <span class="k">if</span> <span class="n">iza_flag</span><span class="p">:</span></pre>
    <pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_iza_flag != 0);
  if (__pyx_t_1) {
/* â€¦ */
  }
</pre>
    <pre class="cython line score-1"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1558</span>:         <span class="k">return</span> <span class="n">DBLQUAD_Z_S_IZA</span><span
            class="p">(</span><span class="n">nmax</span><span class="p">,</span> <span class="n">wavelength</span><span
            class="p">,</span> <span class="n">xzaDeg</span><span class="p">,</span> <span class="n">xaaDeg</span><span
            class="p">,</span> <span class="n">alphaDeg</span><span class="p">,</span> <span
            class="n">betaDeg</span><span class="p">)</span></pre>
    <pre class='cython code score-1 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_2 = __pyx_f_6pyrism_4core_3tma_DBLQUAD_Z_S_IZA(__pyx_v_nmax, __pyx_v_wavelength, __pyx_v_xzaDeg, __pyx_v_xaaDeg, __pyx_v_alphaDeg, __pyx_v_betaDeg);<span
                class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1558, __pyx_L1_error)</span>
    __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_t_2, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1558, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_2, 1);
    __pyx_t_2.memview = NULL;
    __pyx_t_2.data = NULL;
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1559</span>:     <span class="k">else</span><span
            class="p">:</span></pre>
    <pre class="cython line score-1"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1560</span>:         <span class="k">return</span> <span class="n">DBLQUAD_Z_S_VZA</span><span
            class="p">(</span><span class="n">nmax</span><span class="p">,</span> <span class="n">wavelength</span><span
            class="p">,</span> <span class="n">xzaDeg</span><span class="p">,</span> <span class="n">xaaDeg</span><span
            class="p">,</span> <span class="n">alphaDeg</span><span class="p">,</span> <span
            class="n">betaDeg</span><span class="p">)</span></pre>
    <pre class='cython code score-1 '>  /*else*/ {
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_2 = __pyx_f_6pyrism_4core_3tma_DBLQUAD_Z_S_VZA(__pyx_v_nmax, __pyx_v_wavelength, __pyx_v_xzaDeg, __pyx_v_xaaDeg, __pyx_v_alphaDeg, __pyx_v_betaDeg);<span
                class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1560, __pyx_L1_error)</span>
    __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_t_2, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1560, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_2, 1);
    __pyx_t_2.memview = NULL;
    __pyx_t_2.data = NULL;
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;
  }
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1561</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">1562</span>: <span class="c"># S and Z for Adaptive Fixed Orientation -------------------------------------------------------------------------------</span></pre>
    <pre class="cython line score-105"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1563</span>: <span class="k">def</span> <span class="nf">DBLQUAD_Z_AF_WRAPPER</span><span
            class="p">(</span><span class="nb">int</span><span class="p">[:]</span> <span class="n">nmax</span><span
            class="p">,</span> <span class="n">double</span><span class="p">[:]</span> <span class="n">wavelength</span><span
            class="p">,</span> <span class="n">double</span><span class="p">[:]</span> <span
            class="n">xzaDeg</span><span class="p">,</span> <span class="n">double</span><span
            class="p">[:]</span> <span class="n">xaaDeg</span><span class="p">,</span> <span class="nb">int</span> <span
            class="n">n_alpha</span><span class="p">,</span> <span class="nb">int</span> <span
            class="n">n_beta</span><span class="p">,</span></pre>
    <pre class='cython code score-105 '>/* Python wrapper */
static PyObject *__pyx_pw_6pyrism_4core_3tma_21DBLQUAD_Z_AF_WRAPPER(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6pyrism_4core_3tma_20DBLQUAD_Z_AF_WRAPPER[] = "\n    Integrate the phase matrix over a half sphere for Adaptive Fixed Orientation.\n\n    Parameters\n    ----------\n    nmax : int[:]\n        Nmax parameter.\n    wavelength : double[:]\n        Wavelength in same unit as radius (used by function calc_nmax).\n    xzaDeg, xaaDeg : double[:]\n        Scattering (vza) or incidence (iza) zenith and azimuth angle (vaa, iaa) in [DEG].\n    alphaDeg, betaDeg: double[:]\n        The Euler angles of the particle orientation in [DEG].\n    iza_flag : int\n        If True, the integration is over the incidence angle. Then the xzaDeg and xaaDeg must be the viewing angle\n        vzaDeg and vaaDeg. Else it will be integrated over the viewing direction where xzaDeg and xaaDeg must be the\n        incidence angle izaDeg and iaaDeg.\n    Returns\n    -------\n    Z : MemoryView, double[:,:]\n        Two dimensional integrated phase matrix.\n\n    Note\n    ----\n    The output is a array with shape (nmax.shape[0], 16). To put it in a matrix form one must reshape it like\n    np.reshape(Z, (nmax.shape[0], 4, 4)).\n    ";
static PyMethodDef __pyx_mdef_6pyrism_4core_3tma_21DBLQUAD_Z_AF_WRAPPER = {"DBLQUAD_Z_AF_WRAPPER", (PyCFunction)__pyx_pw_6pyrism_4core_3tma_21DBLQUAD_Z_AF_WRAPPER, METH_VARARGS|METH_KEYWORDS, __pyx_doc_6pyrism_4core_3tma_20DBLQUAD_Z_AF_WRAPPER};
static PyObject *__pyx_pw_6pyrism_4core_3tma_21DBLQUAD_Z_AF_WRAPPER(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_nmax = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_wavelength = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_xzaDeg = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_xaaDeg = { 0, 0, { 0 }, { 0 }, { 0 } };
  int __pyx_v_n_alpha;
  int __pyx_v_n_beta;
  PyObject *__pyx_v_or_pdf = 0;
  int __pyx_v_iza_flag;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("DBLQUAD_Z_AF_WRAPPER (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_nmax,&amp;__pyx_n_s_wavelength,&amp;__pyx_n_s_xzaDeg,&amp;__pyx_n_s_xaaDeg,&amp;__pyx_n_s_n_alpha,&amp;__pyx_n_s_n_beta,&amp;__pyx_n_s_or_pdf,&amp;__pyx_n_s_iza_flag,0};
    PyObject* values[8] = {0,0,0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_nmax)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_wavelength)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("DBLQUAD_Z_AF_WRAPPER", 1, 8, 8, 1); <span
                class='error_goto'>__PYX_ERR(0, 1563, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_xzaDeg)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("DBLQUAD_Z_AF_WRAPPER", 1, 8, 8, 2); <span
                class='error_goto'>__PYX_ERR(0, 1563, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_xaaDeg)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("DBLQUAD_Z_AF_WRAPPER", 1, 8, 8, 3); <span
                class='error_goto'>__PYX_ERR(0, 1563, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_n_alpha)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("DBLQUAD_Z_AF_WRAPPER", 1, 8, 8, 4); <span
                class='error_goto'>__PYX_ERR(0, 1563, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_n_beta)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("DBLQUAD_Z_AF_WRAPPER", 1, 8, 8, 5); <span
                class='error_goto'>__PYX_ERR(0, 1563, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (likely((values[6] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_or_pdf)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("DBLQUAD_Z_AF_WRAPPER", 1, 8, 8, 6); <span
                class='error_goto'>__PYX_ERR(0, 1563, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  7:
        if (likely((values[7] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_iza_flag)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("DBLQUAD_Z_AF_WRAPPER", 1, 8, 8, 7); <span
                class='error_goto'>__PYX_ERR(0, 1563, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "DBLQUAD_Z_AF_WRAPPER") &lt; 0)) <span
                class='error_goto'>__PYX_ERR(0, 1563, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 8) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
      values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
      values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
      values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
    }
    __pyx_v_nmax = <span
                class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[0], PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_v_nmax.memview)) __PYX_ERR(0, 1563, __pyx_L3_error)</span>
    __pyx_v_wavelength = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[1], PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_v_wavelength.memview)) __PYX_ERR(0, 1563, __pyx_L3_error)</span>
    __pyx_v_xzaDeg = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[2], PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_v_xzaDeg.memview)) __PYX_ERR(0, 1563, __pyx_L3_error)</span>
    __pyx_v_xaaDeg = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[3], PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_v_xaaDeg.memview)) __PYX_ERR(0, 1563, __pyx_L3_error)</span>
    __pyx_v_n_alpha = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[4]); if (unlikely((__pyx_v_n_alpha == (int)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 1563, __pyx_L3_error)</span>
    __pyx_v_n_beta = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[5]); if (unlikely((__pyx_v_n_beta == (int)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 1563, __pyx_L3_error)</span>
    __pyx_v_or_pdf = values[6];
    __pyx_v_iza_flag = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[7]); if (unlikely((__pyx_v_iza_flag == (int)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 1564, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("DBLQUAD_Z_AF_WRAPPER", 1, 8, 8, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span
                class='error_goto'>__PYX_ERR(0, 1563, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.DBLQUAD_Z_AF_WRAPPER", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6pyrism_4core_3tma_20DBLQUAD_Z_AF_WRAPPER(__pyx_self, __pyx_v_nmax, __pyx_v_wavelength, __pyx_v_xzaDeg, __pyx_v_xaaDeg, __pyx_v_n_alpha, __pyx_v_n_beta, __pyx_v_or_pdf, __pyx_v_iza_flag);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6pyrism_4core_3tma_20DBLQUAD_Z_AF_WRAPPER(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_nmax, __Pyx_memviewslice __pyx_v_wavelength, __Pyx_memviewslice __pyx_v_xzaDeg, __Pyx_memviewslice __pyx_v_xaaDeg, int __pyx_v_n_alpha, int __pyx_v_n_beta, PyObject *__pyx_v_or_pdf, int __pyx_v_iza_flag) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("DBLQUAD_Z_AF_WRAPPER", 0);
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_2, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.DBLQUAD_Z_AF_WRAPPER", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_nmax, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_wavelength, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_xzaDeg, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_xaaDeg, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* â€¦ */
  __pyx_tuple__94 = <span class='py_c_api'>PyTuple_Pack</span>(8, __pyx_n_s_nmax, __pyx_n_s_wavelength, __pyx_n_s_xzaDeg, __pyx_n_s_xaaDeg, __pyx_n_s_n_alpha, __pyx_n_s_n_beta, __pyx_n_s_or_pdf, __pyx_n_s_iza_flag);<span
                class='error_goto'> if (unlikely(!__pyx_tuple__94)) __PYX_ERR(0, 1563, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__94);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__94);
/* â€¦ */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_6pyrism_4core_3tma_21DBLQUAD_Z_AF_WRAPPER, NULL, __pyx_n_s_pyrism_core_tma);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1563, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_DBLQUAD_Z_AF_WRAPPER, __pyx_t_1) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 1563, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__95 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(8, 0, 8, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__94, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyrism_core_tma_pyx, __pyx_n_s_DBLQUAD_Z_AF_WRAPPER, 1563, __pyx_empty_bytes);<span
                class='error_goto'> if (unlikely(!__pyx_codeobj__95)) __PYX_ERR(0, 1563, __pyx_L1_error)</span>
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1564</span>:                          <span
            class="n">or_pdf</span><span class="p">,</span> <span class="nb">int</span> <span
            class="n">iza_flag</span><span class="p">):</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1565</span>:     <span
            class="sd">&quot;&quot;&quot;</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1566</span>: <span class="sd">    Integrate the phase matrix over a half sphere for Adaptive Fixed Orientation.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1567</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">1568</span>: <span class="sd">    Parameters</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1569</span>: <span class="sd">    ----------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1570</span>: <span class="sd">    nmax : int[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1571</span>: <span
            class="sd">        Nmax parameter.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1572</span>: <span
            class="sd">    wavelength : double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1573</span>: <span class="sd">        Wavelength in same unit as radius (used by function calc_nmax).</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1574</span>: <span
            class="sd">    xzaDeg, xaaDeg : double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1575</span>: <span class="sd">        Scattering (vza) or incidence (iza) zenith and azimuth angle (vaa, iaa) in [DEG].</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1576</span>: <span
            class="sd">    alphaDeg, betaDeg: double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1577</span>: <span class="sd">        The Euler angles of the particle orientation in [DEG].</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1578</span>: <span class="sd">    iza_flag : int</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1579</span>: <span class="sd">        If True, the integration is over the incidence angle. Then the xzaDeg and xaaDeg must be the viewing angle</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1580</span>: <span class="sd">        vzaDeg and vaaDeg. Else it will be integrated over the viewing direction where xzaDeg and xaaDeg must be the</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1581</span>: <span class="sd">        incidence angle izaDeg and iaaDeg.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1582</span>: <span class="sd">    Returns</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1583</span>: <span class="sd">    -------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1584</span>: <span
            class="sd">    Z : MemoryView, double[:,:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1585</span>: <span class="sd">        Two dimensional integrated phase matrix.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1586</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">1587</span>: <span class="sd">    Note</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1588</span>: <span class="sd">    ----</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1589</span>: <span class="sd">    The output is a array with shape (nmax.shape[0], 16). To put it in a matrix form one must reshape it like</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1590</span>: <span class="sd">    np.reshape(Z, (nmax.shape[0], 4, 4)).</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1591</span>: <span
            class="sd">    &quot;&quot;&quot;</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1592</span>: </pre>
    <pre class="cython line score-0"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1593</span>:     <span class="k">if</span> <span class="n">iza_flag</span><span class="p">:</span></pre>
    <pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_iza_flag != 0);
  if (__pyx_t_1) {
/* â€¦ */
  }
</pre>
    <pre class="cython line score-1"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1594</span>:         <span class="k">return</span> <span class="n">DBLQUAD_Z_AF_IZA</span><span
            class="p">(</span><span class="n">nmax</span><span class="p">,</span> <span class="n">wavelength</span><span
            class="p">,</span> <span class="n">xzaDeg</span><span class="p">,</span> <span class="n">xaaDeg</span><span
            class="p">,</span> <span class="n">n_alpha</span><span class="p">,</span> <span class="n">n_beta</span><span
            class="p">,</span> <span class="n">or_pdf</span><span class="p">)</span></pre>
    <pre class='cython code score-1 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_2 = __pyx_f_6pyrism_4core_3tma_DBLQUAD_Z_AF_IZA(__pyx_v_nmax, __pyx_v_wavelength, __pyx_v_xzaDeg, __pyx_v_xaaDeg, __pyx_v_n_alpha, __pyx_v_n_beta, __pyx_v_or_pdf);<span
                class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1594, __pyx_L1_error)</span>
    __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_t_2, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1594, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_2, 1);
    __pyx_t_2.memview = NULL;
    __pyx_t_2.data = NULL;
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1595</span>:     <span class="k">else</span><span
            class="p">:</span></pre>
    <pre class="cython line score-1"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1596</span>:         <span class="k">return</span> <span class="n">DBLQUAD_Z_AF_VZA</span><span
            class="p">(</span><span class="n">nmax</span><span class="p">,</span> <span class="n">wavelength</span><span
            class="p">,</span> <span class="n">xzaDeg</span><span class="p">,</span> <span class="n">xaaDeg</span><span
            class="p">,</span> <span class="n">n_alpha</span><span class="p">,</span> <span class="n">n_beta</span><span
            class="p">,</span> <span class="n">or_pdf</span><span class="p">)</span></pre>
    <pre class='cython code score-1 '>  /*else*/ {
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_2 = __pyx_f_6pyrism_4core_3tma_DBLQUAD_Z_AF_VZA(__pyx_v_nmax, __pyx_v_wavelength, __pyx_v_xzaDeg, __pyx_v_xaaDeg, __pyx_v_n_alpha, __pyx_v_n_beta, __pyx_v_or_pdf);<span
                class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1596, __pyx_L1_error)</span>
    __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_t_2, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span
                class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1596, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_2, 1);
    __pyx_t_2.memview = NULL;
    __pyx_t_2.data = NULL;
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;
  }
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1597</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">1598</span>: <span class="c"># ----------------------------------------------------------------------------------------------------------------------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1599</span>: <span
            class="c"># Cross Section Wrapper</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1600</span>: <span class="c"># ----------------------------------------------------------------------------------------------------------------------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1601</span>: <span class="c"># Single Orientation ---------------------------------------------------------------------------------------------------</span></pre>
    <pre class="cython line score-89"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1602</span>: <span class="k">def</span> <span class="nf">XSEC_QS_S_WRAPPER</span><span
            class="p">(</span><span class="nb">int</span><span class="p">[:]</span> <span class="n">nmax</span><span
            class="p">,</span> <span class="n">double</span><span class="p">[:]</span> <span class="n">wavelength</span><span
            class="p">,</span> <span class="n">double</span><span class="p">[:]</span> <span
            class="n">izaDeg</span><span class="p">,</span> <span class="n">double</span><span
            class="p">[:]</span> <span class="n">iaaDeg</span><span class="p">,</span> <span
            class="n">double</span><span class="p">[:]</span> <span class="n">alphaDeg</span><span
            class="p">,</span></pre>
    <pre class='cython code score-89 '>/* Python wrapper */
static PyObject *__pyx_pw_6pyrism_4core_3tma_23XSEC_QS_S_WRAPPER(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6pyrism_4core_3tma_22XSEC_QS_S_WRAPPER[] = "Scattering Cross Section for single orientation.\n\n    Parameters\n    ----------\n    nmax : int[:]\n        Nmax parameter.\n    wavelength : double[:]\n        Wavelength in same unit as radius (used by function calc_nmax).\n    izaDeg, vzaDeg, iaaDeg, vaaDeg : double[:]\n        Incidence (iza) and scattering (vza) zenith angle and incidence and viewing\n        azimuth angle (ira, vra) in [DEG].\n    alphaDeg, betaDeg: double[:]\n        The Euler angles of the particle orientation in [DEG].\n\n    Returns\n    -------\n    Qs : double[:,:]\n        Two dimensional scattering cross section.\n    ";
static PyMethodDef __pyx_mdef_6pyrism_4core_3tma_23XSEC_QS_S_WRAPPER = {"XSEC_QS_S_WRAPPER", (PyCFunction)__pyx_pw_6pyrism_4core_3tma_23XSEC_QS_S_WRAPPER, METH_VARARGS|METH_KEYWORDS, __pyx_doc_6pyrism_4core_3tma_22XSEC_QS_S_WRAPPER};
static PyObject *__pyx_pw_6pyrism_4core_3tma_23XSEC_QS_S_WRAPPER(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_nmax = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_wavelength = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_izaDeg = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_iaaDeg = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_alphaDeg = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_betaDeg = { 0, 0, { 0 }, { 0 }, { 0 } };
  int __pyx_v_verbose;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("XSEC_QS_S_WRAPPER (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_nmax,&amp;__pyx_n_s_wavelength,&amp;__pyx_n_s_izaDeg,&amp;__pyx_n_s_iaaDeg,&amp;__pyx_n_s_alphaDeg,&amp;__pyx_n_s_betaDeg,&amp;__pyx_n_s_verbose,0};
    PyObject* values[7] = {0,0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_nmax)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_wavelength)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("XSEC_QS_S_WRAPPER", 1, 7, 7, 1); <span
                class='error_goto'>__PYX_ERR(0, 1602, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_izaDeg)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("XSEC_QS_S_WRAPPER", 1, 7, 7, 2); <span
                class='error_goto'>__PYX_ERR(0, 1602, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_iaaDeg)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("XSEC_QS_S_WRAPPER", 1, 7, 7, 3); <span
                class='error_goto'>__PYX_ERR(0, 1602, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_alphaDeg)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("XSEC_QS_S_WRAPPER", 1, 7, 7, 4); <span
                class='error_goto'>__PYX_ERR(0, 1602, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_betaDeg)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("XSEC_QS_S_WRAPPER", 1, 7, 7, 5); <span
                class='error_goto'>__PYX_ERR(0, 1602, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (likely((values[6] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_verbose)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("XSEC_QS_S_WRAPPER", 1, 7, 7, 6); <span
                class='error_goto'>__PYX_ERR(0, 1602, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "XSEC_QS_S_WRAPPER") &lt; 0)) <span
                class='error_goto'>__PYX_ERR(0, 1602, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 7) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
      values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
      values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
    }
    __pyx_v_nmax = <span
                class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[0], PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_v_nmax.memview)) __PYX_ERR(0, 1602, __pyx_L3_error)</span>
    __pyx_v_wavelength = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[1], PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_v_wavelength.memview)) __PYX_ERR(0, 1602, __pyx_L3_error)</span>
    __pyx_v_izaDeg = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[2], PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_v_izaDeg.memview)) __PYX_ERR(0, 1602, __pyx_L3_error)</span>
    __pyx_v_iaaDeg = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[3], PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_v_iaaDeg.memview)) __PYX_ERR(0, 1602, __pyx_L3_error)</span>
    __pyx_v_alphaDeg = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[4], PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_v_alphaDeg.memview)) __PYX_ERR(0, 1602, __pyx_L3_error)</span>
    __pyx_v_betaDeg = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[5], PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_v_betaDeg.memview)) __PYX_ERR(0, 1603, __pyx_L3_error)</span>
    __pyx_v_verbose = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[6]); if (unlikely((__pyx_v_verbose == (int)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 1603, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("XSEC_QS_S_WRAPPER", 1, 7, 7, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span
                class='error_goto'>__PYX_ERR(0, 1602, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.XSEC_QS_S_WRAPPER", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6pyrism_4core_3tma_22XSEC_QS_S_WRAPPER(__pyx_self, __pyx_v_nmax, __pyx_v_wavelength, __pyx_v_izaDeg, __pyx_v_iaaDeg, __pyx_v_alphaDeg, __pyx_v_betaDeg, __pyx_v_verbose);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6pyrism_4core_3tma_22XSEC_QS_S_WRAPPER(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_nmax, __Pyx_memviewslice __pyx_v_wavelength, __Pyx_memviewslice __pyx_v_izaDeg, __Pyx_memviewslice __pyx_v_iaaDeg, __Pyx_memviewslice __pyx_v_alphaDeg, __Pyx_memviewslice __pyx_v_betaDeg, int __pyx_v_verbose) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("XSEC_QS_S_WRAPPER", 0);
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.XSEC_QS_S_WRAPPER", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_nmax, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_wavelength, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_izaDeg, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_iaaDeg, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_alphaDeg, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_betaDeg, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* â€¦ */
  __pyx_tuple__96 = <span class='py_c_api'>PyTuple_Pack</span>(7, __pyx_n_s_nmax, __pyx_n_s_wavelength, __pyx_n_s_izaDeg, __pyx_n_s_iaaDeg, __pyx_n_s_alphaDeg, __pyx_n_s_betaDeg, __pyx_n_s_verbose);<span
                class='error_goto'> if (unlikely(!__pyx_tuple__96)) __PYX_ERR(0, 1602, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__96);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__96);
/* â€¦ */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_6pyrism_4core_3tma_23XSEC_QS_S_WRAPPER, NULL, __pyx_n_s_pyrism_core_tma);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1602, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_XSEC_QS_S_WRAPPER, __pyx_t_1) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 1602, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__97 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(7, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__96, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyrism_core_tma_pyx, __pyx_n_s_XSEC_QS_S_WRAPPER, 1602, __pyx_empty_bytes);<span
                class='error_goto'> if (unlikely(!__pyx_codeobj__97)) __PYX_ERR(0, 1602, __pyx_L1_error)</span>
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1603</span>:                       <span
            class="n">double</span><span class="p">[:]</span> <span class="n">betaDeg</span><span
            class="p">,</span> <span class="nb">int</span> <span class="n">verbose</span><span class="p">):</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1604</span>:     <span class="sd">&quot;&quot;&quot;Scattering Cross Section for single orientation.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1605</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">1606</span>: <span class="sd">    Parameters</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1607</span>: <span class="sd">    ----------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1608</span>: <span class="sd">    nmax : int[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1609</span>: <span
            class="sd">        Nmax parameter.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1610</span>: <span
            class="sd">    wavelength : double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1611</span>: <span class="sd">        Wavelength in same unit as radius (used by function calc_nmax).</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1612</span>: <span class="sd">    izaDeg, vzaDeg, iaaDeg, vaaDeg : double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1613</span>: <span class="sd">        Incidence (iza) and scattering (vza) zenith angle and incidence and viewing</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1614</span>: <span class="sd">        azimuth angle (ira, vra) in [DEG].</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1615</span>: <span
            class="sd">    alphaDeg, betaDeg: double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1616</span>: <span class="sd">        The Euler angles of the particle orientation in [DEG].</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1617</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">1618</span>: <span class="sd">    Returns</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1619</span>: <span class="sd">    -------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1620</span>: <span
            class="sd">    Qs : double[:,:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1621</span>: <span class="sd">        Two dimensional scattering cross section.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1622</span>: <span
            class="sd">    &quot;&quot;&quot;</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1623</span>: </pre>
    <pre class="cython line score-1"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1624</span>:     <span class="k">return</span> <span class="n">XSEC_QS_S</span><span
            class="p">(</span><span class="n">nmax</span><span class="p">,</span> <span class="n">wavelength</span><span
            class="p">,</span> <span class="n">izaDeg</span><span class="p">,</span> <span class="n">iaaDeg</span><span
            class="p">,</span> <span class="n">alphaDeg</span><span class="p">,</span> <span
            class="n">betaDeg</span><span class="p">,</span> <span class="n">verbose</span><span
            class="p">)</span></pre>
    <pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_6pyrism_4core_3tma_XSEC_QS_S(__pyx_v_nmax, __pyx_v_wavelength, __pyx_v_izaDeg, __pyx_v_iaaDeg, __pyx_v_alphaDeg, __pyx_v_betaDeg, __pyx_v_verbose);<span
                class='error_goto'> if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 1624, __pyx_L1_error)</span>
  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_t_1, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1624, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1625</span>: </pre>
    <pre class="cython line score-89"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1626</span>: <span class="k">def</span> <span class="nf">XSEC_ASY_S_WRAPPER</span><span
            class="p">(</span><span class="nb">int</span><span class="p">[:]</span> <span class="n">nmax</span><span
            class="p">,</span> <span class="n">double</span><span class="p">[:]</span> <span class="n">wavelength</span><span
            class="p">,</span> <span class="n">double</span><span class="p">[:]</span> <span
            class="n">izaDeg</span><span class="p">,</span> <span class="n">double</span><span
            class="p">[:]</span> <span class="n">iaaDeg</span><span class="p">,</span> <span
            class="n">double</span><span class="p">[:]</span> <span class="n">alphaDeg</span><span
            class="p">,</span></pre>
    <pre class='cython code score-89 '>/* Python wrapper */
static PyObject *__pyx_pw_6pyrism_4core_3tma_25XSEC_ASY_S_WRAPPER(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6pyrism_4core_3tma_24XSEC_ASY_S_WRAPPER[] = "Asymetry Cross Section for single orientation.\n\n    Parameters\n    ----------\n    nmax : int[:]\n        Nmax parameter.\n    wavelength : double[:]\n        Wavelength in same unit as radius (used by function calc_nmax).\n    izaDeg, vzaDeg, iaaDeg, vaaDeg : double[:]\n        Incidence (iza) and scattering (vza) zenith angle and incidence and viewing\n        azimuth angle (ira, vra) in [DEG].\n    alphaDeg, betaDeg: double[:]\n        The Euler angles of the particle orientation in [DEG].\n\n    Returns\n    -------\n    Qas : double[:,:]\n        Two dimensional asymmetry cross section.\n\n    Note\n    ----\n    To obtain the asymetry factor the output of this function must be divided through the scattering cross section.\n    ";
static PyMethodDef __pyx_mdef_6pyrism_4core_3tma_25XSEC_ASY_S_WRAPPER = {"XSEC_ASY_S_WRAPPER", (PyCFunction)__pyx_pw_6pyrism_4core_3tma_25XSEC_ASY_S_WRAPPER, METH_VARARGS|METH_KEYWORDS, __pyx_doc_6pyrism_4core_3tma_24XSEC_ASY_S_WRAPPER};
static PyObject *__pyx_pw_6pyrism_4core_3tma_25XSEC_ASY_S_WRAPPER(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_nmax = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_wavelength = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_izaDeg = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_iaaDeg = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_alphaDeg = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_betaDeg = { 0, 0, { 0 }, { 0 }, { 0 } };
  int __pyx_v_verbose;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("XSEC_ASY_S_WRAPPER (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_nmax,&amp;__pyx_n_s_wavelength,&amp;__pyx_n_s_izaDeg,&amp;__pyx_n_s_iaaDeg,&amp;__pyx_n_s_alphaDeg,&amp;__pyx_n_s_betaDeg,&amp;__pyx_n_s_verbose,0};
    PyObject* values[7] = {0,0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_nmax)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_wavelength)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("XSEC_ASY_S_WRAPPER", 1, 7, 7, 1); <span
                class='error_goto'>__PYX_ERR(0, 1626, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_izaDeg)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("XSEC_ASY_S_WRAPPER", 1, 7, 7, 2); <span
                class='error_goto'>__PYX_ERR(0, 1626, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_iaaDeg)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("XSEC_ASY_S_WRAPPER", 1, 7, 7, 3); <span
                class='error_goto'>__PYX_ERR(0, 1626, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_alphaDeg)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("XSEC_ASY_S_WRAPPER", 1, 7, 7, 4); <span
                class='error_goto'>__PYX_ERR(0, 1626, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_betaDeg)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("XSEC_ASY_S_WRAPPER", 1, 7, 7, 5); <span
                class='error_goto'>__PYX_ERR(0, 1626, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (likely((values[6] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_verbose)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("XSEC_ASY_S_WRAPPER", 1, 7, 7, 6); <span
                class='error_goto'>__PYX_ERR(0, 1626, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "XSEC_ASY_S_WRAPPER") &lt; 0)) <span
                class='error_goto'>__PYX_ERR(0, 1626, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 7) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
      values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
      values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
    }
    __pyx_v_nmax = <span
                class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[0], PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_v_nmax.memview)) __PYX_ERR(0, 1626, __pyx_L3_error)</span>
    __pyx_v_wavelength = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[1], PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_v_wavelength.memview)) __PYX_ERR(0, 1626, __pyx_L3_error)</span>
    __pyx_v_izaDeg = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[2], PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_v_izaDeg.memview)) __PYX_ERR(0, 1626, __pyx_L3_error)</span>
    __pyx_v_iaaDeg = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[3], PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_v_iaaDeg.memview)) __PYX_ERR(0, 1626, __pyx_L3_error)</span>
    __pyx_v_alphaDeg = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[4], PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_v_alphaDeg.memview)) __PYX_ERR(0, 1626, __pyx_L3_error)</span>
    __pyx_v_betaDeg = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[5], PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_v_betaDeg.memview)) __PYX_ERR(0, 1627, __pyx_L3_error)</span>
    __pyx_v_verbose = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[6]); if (unlikely((__pyx_v_verbose == (int)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 1627, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("XSEC_ASY_S_WRAPPER", 1, 7, 7, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span
                class='error_goto'>__PYX_ERR(0, 1626, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.XSEC_ASY_S_WRAPPER", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6pyrism_4core_3tma_24XSEC_ASY_S_WRAPPER(__pyx_self, __pyx_v_nmax, __pyx_v_wavelength, __pyx_v_izaDeg, __pyx_v_iaaDeg, __pyx_v_alphaDeg, __pyx_v_betaDeg, __pyx_v_verbose);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6pyrism_4core_3tma_24XSEC_ASY_S_WRAPPER(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_nmax, __Pyx_memviewslice __pyx_v_wavelength, __Pyx_memviewslice __pyx_v_izaDeg, __Pyx_memviewslice __pyx_v_iaaDeg, __Pyx_memviewslice __pyx_v_alphaDeg, __Pyx_memviewslice __pyx_v_betaDeg, int __pyx_v_verbose) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("XSEC_ASY_S_WRAPPER", 0);
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.XSEC_ASY_S_WRAPPER", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_nmax, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_wavelength, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_izaDeg, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_iaaDeg, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_alphaDeg, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_betaDeg, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* â€¦ */
  __pyx_tuple__98 = <span class='py_c_api'>PyTuple_Pack</span>(7, __pyx_n_s_nmax, __pyx_n_s_wavelength, __pyx_n_s_izaDeg, __pyx_n_s_iaaDeg, __pyx_n_s_alphaDeg, __pyx_n_s_betaDeg, __pyx_n_s_verbose);<span
                class='error_goto'> if (unlikely(!__pyx_tuple__98)) __PYX_ERR(0, 1626, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__98);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__98);
/* â€¦ */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_6pyrism_4core_3tma_25XSEC_ASY_S_WRAPPER, NULL, __pyx_n_s_pyrism_core_tma);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1626, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_XSEC_ASY_S_WRAPPER, __pyx_t_1) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 1626, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__99 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(7, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__98, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyrism_core_tma_pyx, __pyx_n_s_XSEC_ASY_S_WRAPPER, 1626, __pyx_empty_bytes);<span
                class='error_goto'> if (unlikely(!__pyx_codeobj__99)) __PYX_ERR(0, 1626, __pyx_L1_error)</span>
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1627</span>:                        <span
            class="n">double</span><span class="p">[:]</span> <span class="n">betaDeg</span><span
            class="p">,</span> <span class="nb">int</span> <span class="n">verbose</span><span class="p">):</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1628</span>:     <span class="sd">&quot;&quot;&quot;Asymetry Cross Section for single orientation.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1629</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">1630</span>: <span class="sd">    Parameters</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1631</span>: <span class="sd">    ----------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1632</span>: <span class="sd">    nmax : int[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1633</span>: <span
            class="sd">        Nmax parameter.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1634</span>: <span
            class="sd">    wavelength : double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1635</span>: <span class="sd">        Wavelength in same unit as radius (used by function calc_nmax).</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1636</span>: <span class="sd">    izaDeg, vzaDeg, iaaDeg, vaaDeg : double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1637</span>: <span class="sd">        Incidence (iza) and scattering (vza) zenith angle and incidence and viewing</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1638</span>: <span class="sd">        azimuth angle (ira, vra) in [DEG].</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1639</span>: <span
            class="sd">    alphaDeg, betaDeg: double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1640</span>: <span class="sd">        The Euler angles of the particle orientation in [DEG].</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1641</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">1642</span>: <span class="sd">    Returns</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1643</span>: <span class="sd">    -------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1644</span>: <span
            class="sd">    Qas : double[:,:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1645</span>: <span class="sd">        Two dimensional asymmetry cross section.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1646</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">1647</span>: <span class="sd">    Note</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1648</span>: <span class="sd">    ----</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1649</span>: <span class="sd">    To obtain the asymetry factor the output of this function must be divided through the scattering cross section.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1650</span>: <span
            class="sd">    &quot;&quot;&quot;</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1651</span>: </pre>
    <pre class="cython line score-1"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1652</span>:     <span class="k">return</span> <span class="n">XSEC_ASY_S</span><span
            class="p">(</span><span class="n">nmax</span><span class="p">,</span> <span class="n">wavelength</span><span
            class="p">,</span> <span class="n">izaDeg</span><span class="p">,</span> <span class="n">iaaDeg</span><span
            class="p">,</span> <span class="n">alphaDeg</span><span class="p">,</span> <span
            class="n">betaDeg</span><span class="p">,</span> <span class="n">verbose</span><span
            class="p">)</span></pre>
    <pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_6pyrism_4core_3tma_XSEC_ASY_S(__pyx_v_nmax, __pyx_v_wavelength, __pyx_v_izaDeg, __pyx_v_iaaDeg, __pyx_v_alphaDeg, __pyx_v_betaDeg, __pyx_v_verbose);<span
                class='error_goto'> if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 1652, __pyx_L1_error)</span>
  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_t_1, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1652, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1653</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">1654</span>: <span class="c"># Averaged Fixed Orientation -------------------------------------------------------------------------------------------</span></pre>
    <pre class="cython line score-105"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1655</span>: <span class="k">def</span> <span class="nf">XSEC_QS_AF_WRAPPER</span><span
            class="p">(</span><span class="nb">int</span><span class="p">[:]</span> <span class="n">nmax</span><span
            class="p">,</span> <span class="n">double</span><span class="p">[:]</span> <span class="n">wavelength</span><span
            class="p">,</span> <span class="n">double</span><span class="p">[:]</span> <span
            class="n">izaDeg</span><span class="p">,</span> <span class="n">double</span><span
            class="p">[:]</span> <span class="n">iaaDeg</span><span class="p">,</span> <span class="nb">int</span> <span
            class="n">n_alpha</span><span class="p">,</span> <span class="nb">int</span> <span
            class="n">n_beta</span><span class="p">,</span></pre>
    <pre class='cython code score-105 '>/* Python wrapper */
static PyObject *__pyx_pw_6pyrism_4core_3tma_27XSEC_QS_AF_WRAPPER(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6pyrism_4core_3tma_26XSEC_QS_AF_WRAPPER[] = "Scattering Cross Section for Averaged Fixed Orientation.\n\n    Parameters\n    ----------\n    nmax : int[:]\n        Nmax parameter.\n    wavelength : double[:]\n        Wavelength in same unit as radius (used by function calc_nmax).\n    izaDeg, vzaDeg, iaaDeg, vaaDeg : double[:]\n        Incidence (iza) and scattering (vza) zenith angle and incidence and viewing\n        azimuth angle (ira, vra) in [DEG].\n    n_alpha, n_beta : int\n        Number of integration points in the alpha and beta Euler angle.\n    or_pdf: callable\n        Particle orientation Probability Density Function (PDF) for orientation averaging.\n\n    Returns\n    -------\n    Qs : double[:,:]\n        Two dimensional scattering cross section.\n    ";
static PyMethodDef __pyx_mdef_6pyrism_4core_3tma_27XSEC_QS_AF_WRAPPER = {"XSEC_QS_AF_WRAPPER", (PyCFunction)__pyx_pw_6pyrism_4core_3tma_27XSEC_QS_AF_WRAPPER, METH_VARARGS|METH_KEYWORDS, __pyx_doc_6pyrism_4core_3tma_26XSEC_QS_AF_WRAPPER};
static PyObject *__pyx_pw_6pyrism_4core_3tma_27XSEC_QS_AF_WRAPPER(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_nmax = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_wavelength = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_izaDeg = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_iaaDeg = { 0, 0, { 0 }, { 0 }, { 0 } };
  int __pyx_v_n_alpha;
  int __pyx_v_n_beta;
  PyObject *__pyx_v_or_pdf = 0;
  int __pyx_v_verbose;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("XSEC_QS_AF_WRAPPER (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_nmax,&amp;__pyx_n_s_wavelength,&amp;__pyx_n_s_izaDeg,&amp;__pyx_n_s_iaaDeg,&amp;__pyx_n_s_n_alpha,&amp;__pyx_n_s_n_beta,&amp;__pyx_n_s_or_pdf,&amp;__pyx_n_s_verbose,0};
    PyObject* values[8] = {0,0,0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_nmax)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_wavelength)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("XSEC_QS_AF_WRAPPER", 1, 8, 8, 1); <span
                class='error_goto'>__PYX_ERR(0, 1655, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_izaDeg)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("XSEC_QS_AF_WRAPPER", 1, 8, 8, 2); <span
                class='error_goto'>__PYX_ERR(0, 1655, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_iaaDeg)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("XSEC_QS_AF_WRAPPER", 1, 8, 8, 3); <span
                class='error_goto'>__PYX_ERR(0, 1655, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_n_alpha)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("XSEC_QS_AF_WRAPPER", 1, 8, 8, 4); <span
                class='error_goto'>__PYX_ERR(0, 1655, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_n_beta)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("XSEC_QS_AF_WRAPPER", 1, 8, 8, 5); <span
                class='error_goto'>__PYX_ERR(0, 1655, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (likely((values[6] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_or_pdf)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("XSEC_QS_AF_WRAPPER", 1, 8, 8, 6); <span
                class='error_goto'>__PYX_ERR(0, 1655, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  7:
        if (likely((values[7] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_verbose)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("XSEC_QS_AF_WRAPPER", 1, 8, 8, 7); <span
                class='error_goto'>__PYX_ERR(0, 1655, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "XSEC_QS_AF_WRAPPER") &lt; 0)) <span
                class='error_goto'>__PYX_ERR(0, 1655, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 8) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
      values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
      values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
      values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
    }
    __pyx_v_nmax = <span
                class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[0], PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_v_nmax.memview)) __PYX_ERR(0, 1655, __pyx_L3_error)</span>
    __pyx_v_wavelength = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[1], PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_v_wavelength.memview)) __PYX_ERR(0, 1655, __pyx_L3_error)</span>
    __pyx_v_izaDeg = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[2], PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_v_izaDeg.memview)) __PYX_ERR(0, 1655, __pyx_L3_error)</span>
    __pyx_v_iaaDeg = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[3], PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_v_iaaDeg.memview)) __PYX_ERR(0, 1655, __pyx_L3_error)</span>
    __pyx_v_n_alpha = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[4]); if (unlikely((__pyx_v_n_alpha == (int)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 1655, __pyx_L3_error)</span>
    __pyx_v_n_beta = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[5]); if (unlikely((__pyx_v_n_beta == (int)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 1655, __pyx_L3_error)</span>
    __pyx_v_or_pdf = values[6];
    __pyx_v_verbose = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[7]); if (unlikely((__pyx_v_verbose == (int)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 1656, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("XSEC_QS_AF_WRAPPER", 1, 8, 8, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span
                class='error_goto'>__PYX_ERR(0, 1655, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.XSEC_QS_AF_WRAPPER", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6pyrism_4core_3tma_26XSEC_QS_AF_WRAPPER(__pyx_self, __pyx_v_nmax, __pyx_v_wavelength, __pyx_v_izaDeg, __pyx_v_iaaDeg, __pyx_v_n_alpha, __pyx_v_n_beta, __pyx_v_or_pdf, __pyx_v_verbose);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6pyrism_4core_3tma_26XSEC_QS_AF_WRAPPER(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_nmax, __Pyx_memviewslice __pyx_v_wavelength, __Pyx_memviewslice __pyx_v_izaDeg, __Pyx_memviewslice __pyx_v_iaaDeg, int __pyx_v_n_alpha, int __pyx_v_n_beta, PyObject *__pyx_v_or_pdf, int __pyx_v_verbose) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("XSEC_QS_AF_WRAPPER", 0);
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.XSEC_QS_AF_WRAPPER", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_nmax, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_wavelength, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_izaDeg, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_iaaDeg, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* â€¦ */
  __pyx_tuple__100 = <span class='py_c_api'>PyTuple_Pack</span>(8, __pyx_n_s_nmax, __pyx_n_s_wavelength, __pyx_n_s_izaDeg, __pyx_n_s_iaaDeg, __pyx_n_s_n_alpha, __pyx_n_s_n_beta, __pyx_n_s_or_pdf, __pyx_n_s_verbose);<span
                class='error_goto'> if (unlikely(!__pyx_tuple__100)) __PYX_ERR(0, 1655, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__100);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__100);
/* â€¦ */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_6pyrism_4core_3tma_27XSEC_QS_AF_WRAPPER, NULL, __pyx_n_s_pyrism_core_tma);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1655, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_XSEC_QS_AF_WRAPPER, __pyx_t_1) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 1655, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__101 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(8, 0, 8, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__100, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyrism_core_tma_pyx, __pyx_n_s_XSEC_QS_AF_WRAPPER, 1655, __pyx_empty_bytes);<span
                class='error_goto'> if (unlikely(!__pyx_codeobj__101)) __PYX_ERR(0, 1655, __pyx_L1_error)</span>
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1656</span>:                          <span
            class="n">or_pdf</span><span class="p">,</span> <span class="nb">int</span> <span
            class="n">verbose</span><span class="p">):</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1657</span>:     <span class="sd">&quot;&quot;&quot;Scattering Cross Section for Averaged Fixed Orientation.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1658</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">1659</span>: <span class="sd">    Parameters</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1660</span>: <span class="sd">    ----------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1661</span>: <span class="sd">    nmax : int[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1662</span>: <span
            class="sd">        Nmax parameter.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1663</span>: <span
            class="sd">    wavelength : double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1664</span>: <span class="sd">        Wavelength in same unit as radius (used by function calc_nmax).</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1665</span>: <span class="sd">    izaDeg, vzaDeg, iaaDeg, vaaDeg : double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1666</span>: <span class="sd">        Incidence (iza) and scattering (vza) zenith angle and incidence and viewing</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1667</span>: <span class="sd">        azimuth angle (ira, vra) in [DEG].</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1668</span>: <span class="sd">    n_alpha, n_beta : int</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1669</span>: <span class="sd">        Number of integration points in the alpha and beta Euler angle.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1670</span>: <span
            class="sd">    or_pdf: callable</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1671</span>: <span class="sd">        Particle orientation Probability Density Function (PDF) for orientation averaging.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1672</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">1673</span>: <span class="sd">    Returns</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1674</span>: <span class="sd">    -------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1675</span>: <span
            class="sd">    Qs : double[:,:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1676</span>: <span class="sd">        Two dimensional scattering cross section.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1677</span>: <span
            class="sd">    &quot;&quot;&quot;</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1678</span>: </pre>
    <pre class="cython line score-1"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1679</span>:     <span class="k">return</span> <span class="n">XSEC_QS_AF</span><span
            class="p">(</span><span class="n">nmax</span><span class="p">,</span> <span class="n">wavelength</span><span
            class="p">,</span> <span class="n">izaDeg</span><span class="p">,</span> <span class="n">iaaDeg</span><span
            class="p">,</span> <span class="n">n_alpha</span><span class="p">,</span> <span class="n">n_beta</span><span
            class="p">,</span> <span class="n">or_pdf</span><span class="p">,</span> <span class="n">verbose</span><span
            class="p">)</span></pre>
    <pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_6pyrism_4core_3tma_XSEC_QS_AF(__pyx_v_nmax, __pyx_v_wavelength, __pyx_v_izaDeg, __pyx_v_iaaDeg, __pyx_v_n_alpha, __pyx_v_n_beta, __pyx_v_or_pdf, __pyx_v_verbose);<span
                class='error_goto'> if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 1679, __pyx_L1_error)</span>
  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_t_1, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1679, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1680</span>: </pre>
    <pre class="cython line score-105"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1681</span>: <span class="k">def</span> <span class="nf">XSEC_ASY_AF_WRAPPER</span><span class="p">(</span><span
            class="nb">int</span><span class="p">[:]</span> <span class="n">nmax</span><span class="p">,</span> <span
            class="n">double</span><span class="p">[:]</span> <span class="n">wavelength</span><span class="p">,</span> <span
            class="n">double</span><span class="p">[:]</span> <span class="n">izaDeg</span><span
            class="p">,</span> <span class="n">double</span><span class="p">[:]</span> <span
            class="n">iaaDeg</span><span class="p">,</span> <span class="nb">int</span> <span
            class="n">n_alpha</span><span class="p">,</span> <span class="nb">int</span> <span
            class="n">n_beta</span><span class="p">,</span></pre>
    <pre class='cython code score-105 '>/* Python wrapper */
static PyObject *__pyx_pw_6pyrism_4core_3tma_29XSEC_ASY_AF_WRAPPER(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6pyrism_4core_3tma_28XSEC_ASY_AF_WRAPPER[] = "Scattering Cross Section for Averaged Fixed Orientation.\n\n    Parameters\n    ----------\n    nmax : int[:]\n        Nmax parameter.\n    wavelength : double[:]\n        Wavelength in same unit as radius (used by function calc_nmax).\n    izaDeg, vzaDeg, iaaDeg, vaaDeg : double[:]\n        Incidence (iza) and scattering (vza) zenith angle and incidence and viewing\n        azimuth angle (ira, vra) in [DEG].\n    n_alpha, n_beta : int\n        Number of integration points in the alpha and beta Euler angle.\n    or_pdf: callable\n        Particle orientation Probability Density Function (PDF) for orientation averaging.\n\n    Returns\n    -------\n    Qas : double[:,:]\n        Two dimensional asymmetry cross section.\n    ";
static PyMethodDef __pyx_mdef_6pyrism_4core_3tma_29XSEC_ASY_AF_WRAPPER = {"XSEC_ASY_AF_WRAPPER", (PyCFunction)__pyx_pw_6pyrism_4core_3tma_29XSEC_ASY_AF_WRAPPER, METH_VARARGS|METH_KEYWORDS, __pyx_doc_6pyrism_4core_3tma_28XSEC_ASY_AF_WRAPPER};
static PyObject *__pyx_pw_6pyrism_4core_3tma_29XSEC_ASY_AF_WRAPPER(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_nmax = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_wavelength = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_izaDeg = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_iaaDeg = { 0, 0, { 0 }, { 0 }, { 0 } };
  int __pyx_v_n_alpha;
  int __pyx_v_n_beta;
  PyObject *__pyx_v_or_pdf = 0;
  int __pyx_v_verbose;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("XSEC_ASY_AF_WRAPPER (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_nmax,&amp;__pyx_n_s_wavelength,&amp;__pyx_n_s_izaDeg,&amp;__pyx_n_s_iaaDeg,&amp;__pyx_n_s_n_alpha,&amp;__pyx_n_s_n_beta,&amp;__pyx_n_s_or_pdf,&amp;__pyx_n_s_verbose,0};
    PyObject* values[8] = {0,0,0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_nmax)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_wavelength)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("XSEC_ASY_AF_WRAPPER", 1, 8, 8, 1); <span
                class='error_goto'>__PYX_ERR(0, 1681, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_izaDeg)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("XSEC_ASY_AF_WRAPPER", 1, 8, 8, 2); <span
                class='error_goto'>__PYX_ERR(0, 1681, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_iaaDeg)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("XSEC_ASY_AF_WRAPPER", 1, 8, 8, 3); <span
                class='error_goto'>__PYX_ERR(0, 1681, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_n_alpha)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("XSEC_ASY_AF_WRAPPER", 1, 8, 8, 4); <span
                class='error_goto'>__PYX_ERR(0, 1681, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_n_beta)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("XSEC_ASY_AF_WRAPPER", 1, 8, 8, 5); <span
                class='error_goto'>__PYX_ERR(0, 1681, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (likely((values[6] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_or_pdf)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("XSEC_ASY_AF_WRAPPER", 1, 8, 8, 6); <span
                class='error_goto'>__PYX_ERR(0, 1681, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  7:
        if (likely((values[7] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_verbose)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("XSEC_ASY_AF_WRAPPER", 1, 8, 8, 7); <span
                class='error_goto'>__PYX_ERR(0, 1681, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "XSEC_ASY_AF_WRAPPER") &lt; 0)) <span
                class='error_goto'>__PYX_ERR(0, 1681, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 8) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
      values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
      values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
      values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
    }
    __pyx_v_nmax = <span
                class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[0], PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_v_nmax.memview)) __PYX_ERR(0, 1681, __pyx_L3_error)</span>
    __pyx_v_wavelength = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[1], PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_v_wavelength.memview)) __PYX_ERR(0, 1681, __pyx_L3_error)</span>
    __pyx_v_izaDeg = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[2], PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_v_izaDeg.memview)) __PYX_ERR(0, 1681, __pyx_L3_error)</span>
    __pyx_v_iaaDeg = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[3], PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_v_iaaDeg.memview)) __PYX_ERR(0, 1681, __pyx_L3_error)</span>
    __pyx_v_n_alpha = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[4]); if (unlikely((__pyx_v_n_alpha == (int)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 1681, __pyx_L3_error)</span>
    __pyx_v_n_beta = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[5]); if (unlikely((__pyx_v_n_beta == (int)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 1681, __pyx_L3_error)</span>
    __pyx_v_or_pdf = values[6];
    __pyx_v_verbose = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[7]); if (unlikely((__pyx_v_verbose == (int)-1) &amp;&amp; <span
                class='py_c_api'>PyErr_Occurred</span>())) <span
                class='error_goto'>__PYX_ERR(0, 1682, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("XSEC_ASY_AF_WRAPPER", 1, 8, 8, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span
                class='error_goto'>__PYX_ERR(0, 1681, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.XSEC_ASY_AF_WRAPPER", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6pyrism_4core_3tma_28XSEC_ASY_AF_WRAPPER(__pyx_self, __pyx_v_nmax, __pyx_v_wavelength, __pyx_v_izaDeg, __pyx_v_iaaDeg, __pyx_v_n_alpha, __pyx_v_n_beta, __pyx_v_or_pdf, __pyx_v_verbose);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6pyrism_4core_3tma_28XSEC_ASY_AF_WRAPPER(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_nmax, __Pyx_memviewslice __pyx_v_wavelength, __Pyx_memviewslice __pyx_v_izaDeg, __Pyx_memviewslice __pyx_v_iaaDeg, int __pyx_v_n_alpha, int __pyx_v_n_beta, PyObject *__pyx_v_or_pdf, int __pyx_v_verbose) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("XSEC_ASY_AF_WRAPPER", 0);
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.XSEC_ASY_AF_WRAPPER", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_nmax, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_wavelength, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_izaDeg, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_iaaDeg, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* â€¦ */
  __pyx_tuple__102 = <span class='py_c_api'>PyTuple_Pack</span>(8, __pyx_n_s_nmax, __pyx_n_s_wavelength, __pyx_n_s_izaDeg, __pyx_n_s_iaaDeg, __pyx_n_s_n_alpha, __pyx_n_s_n_beta, __pyx_n_s_or_pdf, __pyx_n_s_verbose);<span
                class='error_goto'> if (unlikely(!__pyx_tuple__102)) __PYX_ERR(0, 1681, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__102);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__102);
/* â€¦ */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_6pyrism_4core_3tma_29XSEC_ASY_AF_WRAPPER, NULL, __pyx_n_s_pyrism_core_tma);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1681, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_XSEC_ASY_AF_WRAPPER, __pyx_t_1) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 1681, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__103 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(8, 0, 8, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__102, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyrism_core_tma_pyx, __pyx_n_s_XSEC_ASY_AF_WRAPPER, 1681, __pyx_empty_bytes);<span
                class='error_goto'> if (unlikely(!__pyx_codeobj__103)) __PYX_ERR(0, 1681, __pyx_L1_error)</span>
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1682</span>:                          <span
            class="n">or_pdf</span><span class="p">,</span> <span class="nb">int</span> <span
            class="n">verbose</span><span class="p">):</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1683</span>:     <span class="sd">&quot;&quot;&quot;Scattering Cross Section for Averaged Fixed Orientation.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1684</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">1685</span>: <span class="sd">    Parameters</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1686</span>: <span class="sd">    ----------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1687</span>: <span class="sd">    nmax : int[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1688</span>: <span
            class="sd">        Nmax parameter.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1689</span>: <span
            class="sd">    wavelength : double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1690</span>: <span class="sd">        Wavelength in same unit as radius (used by function calc_nmax).</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1691</span>: <span class="sd">    izaDeg, vzaDeg, iaaDeg, vaaDeg : double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1692</span>: <span class="sd">        Incidence (iza) and scattering (vza) zenith angle and incidence and viewing</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1693</span>: <span class="sd">        azimuth angle (ira, vra) in [DEG].</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1694</span>: <span class="sd">    n_alpha, n_beta : int</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1695</span>: <span class="sd">        Number of integration points in the alpha and beta Euler angle.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1696</span>: <span
            class="sd">    or_pdf: callable</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1697</span>: <span class="sd">        Particle orientation Probability Density Function (PDF) for orientation averaging.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1698</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">1699</span>: <span class="sd">    Returns</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1700</span>: <span class="sd">    -------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1701</span>: <span
            class="sd">    Qas : double[:,:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1702</span>: <span class="sd">        Two dimensional asymmetry cross section.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1703</span>: <span
            class="sd">    &quot;&quot;&quot;</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1704</span>: </pre>
    <pre class="cython line score-1"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1705</span>:     <span class="k">return</span> <span class="n">XSEC_ASY_AF</span><span
            class="p">(</span><span class="n">nmax</span><span class="p">,</span> <span class="n">wavelength</span><span
            class="p">,</span> <span class="n">izaDeg</span><span class="p">,</span> <span class="n">iaaDeg</span><span
            class="p">,</span> <span class="n">n_alpha</span><span class="p">,</span> <span class="n">n_beta</span><span
            class="p">,</span> <span class="n">or_pdf</span><span class="p">,</span> <span class="n">verbose</span><span
            class="p">)</span></pre>
    <pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_6pyrism_4core_3tma_XSEC_ASY_AF(__pyx_v_nmax, __pyx_v_wavelength, __pyx_v_izaDeg, __pyx_v_iaaDeg, __pyx_v_n_alpha, __pyx_v_n_beta, __pyx_v_or_pdf, __pyx_v_verbose);<span
                class='error_goto'> if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 1705, __pyx_L1_error)</span>
  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_t_1, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1705, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1706</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">1707</span>: <span class="c"># Extinction and Intensity ---------------------------------------------------------------------------------------------</span></pre>
    <pre class="cython line score-44"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1708</span>: <span class="k">def</span> <span class="nf">XSEC_QE_WRAPPER</span><span
            class="p">(</span><span class="n">double</span> <span class="nb">complex</span><span
            class="p">[:,:,:]</span> <span class="n">S</span><span class="p">,</span> <span class="n">double</span><span
            class="p">[:]</span> <span class="n">wavelength</span><span class="p">):</span></pre>
    <pre class='cython code score-44 '>/* Python wrapper */
static PyObject *__pyx_pw_6pyrism_4core_3tma_31XSEC_QE_WRAPPER(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6pyrism_4core_3tma_30XSEC_QE_WRAPPER[] = "Extinction Cross Section.\n\n    Parameters\n    ----------\n    S : double complex[:,:,:]\n        Three dimensoinal scattering matrix.\n    wavelength : double[:]\n        Wavelength in same unit as radius (used by function calc_nmax).\n    Returns\n    -------\n    Qe : double[:,:]\n        Two dimensional extinction cross section.\n    ";
static PyMethodDef __pyx_mdef_6pyrism_4core_3tma_31XSEC_QE_WRAPPER = {"XSEC_QE_WRAPPER", (PyCFunction)__pyx_pw_6pyrism_4core_3tma_31XSEC_QE_WRAPPER, METH_VARARGS|METH_KEYWORDS, __pyx_doc_6pyrism_4core_3tma_30XSEC_QE_WRAPPER};
static PyObject *__pyx_pw_6pyrism_4core_3tma_31XSEC_QE_WRAPPER(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_S = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_wavelength = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("XSEC_QE_WRAPPER (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_S,&amp;__pyx_n_s_wavelength,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_S)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_wavelength)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("XSEC_QE_WRAPPER", 1, 2, 2, 1); <span
                class='error_goto'>__PYX_ERR(0, 1708, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "XSEC_QE_WRAPPER") &lt; 0)) <span
                class='error_goto'>__PYX_ERR(0, 1708, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_S = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds___pyx_t_double_complex</span>(values[0], PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_v_S.memview)) __PYX_ERR(0, 1708, __pyx_L3_error)</span>
    __pyx_v_wavelength = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[1], PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_v_wavelength.memview)) __PYX_ERR(0, 1708, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("XSEC_QE_WRAPPER", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span
                class='error_goto'>__PYX_ERR(0, 1708, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.XSEC_QE_WRAPPER", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6pyrism_4core_3tma_30XSEC_QE_WRAPPER(__pyx_self, __pyx_v_S, __pyx_v_wavelength);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6pyrism_4core_3tma_30XSEC_QE_WRAPPER(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_S, __Pyx_memviewslice __pyx_v_wavelength) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("XSEC_QE_WRAPPER", 0);
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.XSEC_QE_WRAPPER", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_S, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_wavelength, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* â€¦ */
  __pyx_tuple__104 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_n_s_S, __pyx_n_s_wavelength);<span
                class='error_goto'> if (unlikely(!__pyx_tuple__104)) __PYX_ERR(0, 1708, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__104);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__104);
/* â€¦ */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_6pyrism_4core_3tma_31XSEC_QE_WRAPPER, NULL, __pyx_n_s_pyrism_core_tma);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1708, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_XSEC_QE_WRAPPER, __pyx_t_1) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 1708, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__105 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__104, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyrism_core_tma_pyx, __pyx_n_s_XSEC_QE_WRAPPER, 1708, __pyx_empty_bytes);<span
                class='error_goto'> if (unlikely(!__pyx_codeobj__105)) __PYX_ERR(0, 1708, __pyx_L1_error)</span>
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1709</span>:     <span class="sd">&quot;&quot;&quot;Extinction Cross Section.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1710</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">1711</span>: <span class="sd">    Parameters</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1712</span>: <span class="sd">    ----------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1713</span>: <span
            class="sd">    S : double complex[:,:,:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1714</span>: <span class="sd">        Three dimensoinal scattering matrix.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1715</span>: <span
            class="sd">    wavelength : double[:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1716</span>: <span class="sd">        Wavelength in same unit as radius (used by function calc_nmax).</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1717</span>: <span class="sd">    Returns</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1718</span>: <span class="sd">    -------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1719</span>: <span
            class="sd">    Qe : double[:,:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1720</span>: <span class="sd">        Two dimensional extinction cross section.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1721</span>: <span
            class="sd">    &quot;&quot;&quot;</span></pre>
    <pre class="cython line score-1"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1722</span>:     <span class="k">return</span> <span class="n">XSEC_QE</span><span
            class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">wavelength</span><span
            class="p">)</span></pre>
    <pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_6pyrism_4core_3tma_XSEC_QE(__pyx_v_S, __pyx_v_wavelength);<span class='error_goto'> if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 1722, __pyx_L1_error)</span>
  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_t_1, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1722, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1723</span>: </pre>
    <pre class="cython line score-20"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1724</span>: <span class="k">def</span> <span class="nf">XSEC_QSI_WRAPPER</span><span
            class="p">(</span><span class="n">double</span><span class="p">[:,:,:]</span> <span class="n">Z</span><span
            class="p">):</span></pre>
    <pre class='cython code score-20 '>/* Python wrapper */
static PyObject *__pyx_pw_6pyrism_4core_3tma_33XSEC_QSI_WRAPPER(PyObject *__pyx_self, PyObject *__pyx_arg_Z); /*proto*/
static char __pyx_doc_6pyrism_4core_3tma_32XSEC_QSI_WRAPPER[] = "Intensity.\n\n    Parameters\n    ----------\n    Z : double complex[:,:,:]\n        Three dimensional phase matrix.\n\n    Returns\n    -------\n    Qi : double[:,:]\n        Two dimensional intensity.\n    ";
static PyMethodDef __pyx_mdef_6pyrism_4core_3tma_33XSEC_QSI_WRAPPER = {"XSEC_QSI_WRAPPER", (PyCFunction)__pyx_pw_6pyrism_4core_3tma_33XSEC_QSI_WRAPPER, METH_O, __pyx_doc_6pyrism_4core_3tma_32XSEC_QSI_WRAPPER};
static PyObject *__pyx_pw_6pyrism_4core_3tma_33XSEC_QSI_WRAPPER(PyObject *__pyx_self, PyObject *__pyx_arg_Z) {
  __Pyx_memviewslice __pyx_v_Z = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("XSEC_QSI_WRAPPER (wrapper)", 0);
  assert(__pyx_arg_Z); {
    __pyx_v_Z = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_double</span>(__pyx_arg_Z, PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_v_Z.memview)) __PYX_ERR(0, 1724, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.XSEC_QSI_WRAPPER", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6pyrism_4core_3tma_32XSEC_QSI_WRAPPER(__pyx_self, __pyx_v_Z);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6pyrism_4core_3tma_32XSEC_QSI_WRAPPER(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_Z) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("XSEC_QSI_WRAPPER", 0);
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.XSEC_QSI_WRAPPER", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_Z, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* â€¦ */
  __pyx_tuple__106 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_n_s_Z, __pyx_n_s_Z);<span class='error_goto'> if (unlikely(!__pyx_tuple__106)) __PYX_ERR(0, 1724, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__106);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__106);
/* â€¦ */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_6pyrism_4core_3tma_33XSEC_QSI_WRAPPER, NULL, __pyx_n_s_pyrism_core_tma);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1724, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_XSEC_QSI_WRAPPER, __pyx_t_1) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 1724, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__107 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__106, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyrism_core_tma_pyx, __pyx_n_s_XSEC_QSI_WRAPPER, 1724, __pyx_empty_bytes);<span
                class='error_goto'> if (unlikely(!__pyx_codeobj__107)) __PYX_ERR(0, 1724, __pyx_L1_error)</span>
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1725</span>:     <span
            class="sd">&quot;&quot;&quot;Intensity.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1726</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">1727</span>: <span class="sd">    Parameters</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1728</span>: <span class="sd">    ----------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1729</span>: <span
            class="sd">    Z : double complex[:,:,:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1730</span>: <span class="sd">        Three dimensional phase matrix.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1731</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">1732</span>: <span class="sd">    Returns</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1733</span>: <span class="sd">    -------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1734</span>: <span
            class="sd">    Qi : double[:,:]</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1735</span>: <span class="sd">        Two dimensional intensity.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1736</span>: <span
            class="sd">    &quot;&quot;&quot;</span></pre>
    <pre class="cython line score-1"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1737</span>:     <span class="k">return</span> <span class="n">XSEC_QSI</span><span
            class="p">(</span><span class="n">Z</span><span class="p">)</span></pre>
    <pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_6pyrism_4core_3tma_XSEC_QSI(__pyx_v_Z);<span class='error_goto'> if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 1737, __pyx_L1_error)</span>
  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_t_1, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1737, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1738</span>: </pre>
    <pre class="cython line score-44"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1739</span>: <span class="k">def</span> <span class="nf">KE_WRAPPER</span><span
            class="p">(</span><span class="n">double</span> <span class="nb">complex</span><span
            class="p">[:]</span> <span class="n">factor</span><span class="p">,</span> <span
            class="n">double</span> <span class="nb">complex</span><span class="p">[:,:,:]</span> <span
            class="n">S</span><span class="p">):</span></pre>
    <pre class='cython code score-44 '>/* Python wrapper */
static PyObject *__pyx_pw_6pyrism_4core_3tma_35KE_WRAPPER(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_6pyrism_4core_3tma_35KE_WRAPPER = {"KE_WRAPPER", (PyCFunction)__pyx_pw_6pyrism_4core_3tma_35KE_WRAPPER, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6pyrism_4core_3tma_35KE_WRAPPER(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_factor = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_S = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("KE_WRAPPER (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_factor,&amp;__pyx_n_s_S,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_factor)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_S)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("KE_WRAPPER", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 1739, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "KE_WRAPPER") &lt; 0)) <span
                class='error_goto'>__PYX_ERR(0, 1739, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_factor = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds___pyx_t_double_complex</span>(values[0], PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_v_factor.memview)) __PYX_ERR(0, 1739, __pyx_L3_error)</span>
    __pyx_v_S = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds___pyx_t_double_complex</span>(values[1], PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_v_S.memview)) __PYX_ERR(0, 1739, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("KE_WRAPPER", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span
                class='error_goto'>__PYX_ERR(0, 1739, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.KE_WRAPPER", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6pyrism_4core_3tma_34KE_WRAPPER(__pyx_self, __pyx_v_factor, __pyx_v_S);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6pyrism_4core_3tma_34KE_WRAPPER(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_factor, __Pyx_memviewslice __pyx_v_S) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("KE_WRAPPER", 0);
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.KE_WRAPPER", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_factor, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_S, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* â€¦ */
  __pyx_tuple__108 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_n_s_factor, __pyx_n_s_S);<span
                class='error_goto'> if (unlikely(!__pyx_tuple__108)) __PYX_ERR(0, 1739, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__108);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__108);
/* â€¦ */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_6pyrism_4core_3tma_35KE_WRAPPER, NULL, __pyx_n_s_pyrism_core_tma);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1739, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_KE_WRAPPER, __pyx_t_1) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 1739, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__109 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__108, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyrism_core_tma_pyx, __pyx_n_s_KE_WRAPPER, 1739, __pyx_empty_bytes);<span
                class='error_goto'> if (unlikely(!__pyx_codeobj__109)) __PYX_ERR(0, 1739, __pyx_L1_error)</span>
</pre>
    <pre class="cython line score-1"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1740</span>:     <span class="k">return</span> <span class="n">KE</span><span
            class="p">(</span><span class="n">factor</span><span class="p">,</span> <span class="n">S</span><span
            class="p">)</span></pre>
    <pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_6pyrism_4core_3tma_KE(__pyx_v_factor, __pyx_v_S);<span class='error_goto'> if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 1740, __pyx_L1_error)</span>
  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_t_1, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1740, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1741</span>: </pre>
    <pre class="cython line score-44"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1742</span>: <span class="k">def</span> <span class="nf">KS_WRAPPER</span><span
            class="p">(</span><span class="n">double</span><span class="p">[:,:,:]</span> <span class="n">ke</span><span
            class="p">,</span> <span class="n">double</span><span class="p">[:,:]</span> <span
            class="n">omega</span><span class="p">):</span></pre>
    <pre class='cython code score-44 '>/* Python wrapper */
static PyObject *__pyx_pw_6pyrism_4core_3tma_37KS_WRAPPER(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_6pyrism_4core_3tma_37KS_WRAPPER = {"KS_WRAPPER", (PyCFunction)__pyx_pw_6pyrism_4core_3tma_37KS_WRAPPER, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6pyrism_4core_3tma_37KS_WRAPPER(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_ke = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_omega = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("KS_WRAPPER (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_ke,&amp;__pyx_n_s_omega,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_ke)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_omega)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("KS_WRAPPER", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 1742, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "KS_WRAPPER") &lt; 0)) <span
                class='error_goto'>__PYX_ERR(0, 1742, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_ke = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_double</span>(values[0], PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_v_ke.memview)) __PYX_ERR(0, 1742, __pyx_L3_error)</span>
    __pyx_v_omega = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(values[1], PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_v_omega.memview)) __PYX_ERR(0, 1742, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("KS_WRAPPER", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span
                class='error_goto'>__PYX_ERR(0, 1742, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.KS_WRAPPER", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6pyrism_4core_3tma_36KS_WRAPPER(__pyx_self, __pyx_v_ke, __pyx_v_omega);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6pyrism_4core_3tma_36KS_WRAPPER(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_ke, __Pyx_memviewslice __pyx_v_omega) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("KS_WRAPPER", 0);
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.KS_WRAPPER", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_ke, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_omega, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* â€¦ */
  __pyx_tuple__110 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_n_s_ke, __pyx_n_s_omega);<span
                class='error_goto'> if (unlikely(!__pyx_tuple__110)) __PYX_ERR(0, 1742, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__110);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__110);
/* â€¦ */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_6pyrism_4core_3tma_37KS_WRAPPER, NULL, __pyx_n_s_pyrism_core_tma);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1742, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_KS_WRAPPER, __pyx_t_1) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 1742, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__111 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__110, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyrism_core_tma_pyx, __pyx_n_s_KS_WRAPPER, 1742, __pyx_empty_bytes);<span
                class='error_goto'> if (unlikely(!__pyx_codeobj__111)) __PYX_ERR(0, 1742, __pyx_L1_error)</span>
</pre>
    <pre class="cython line score-1"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1743</span>:     <span class="k">return</span> <span class="n">KS</span><span
            class="p">(</span><span class="n">ke</span><span class="p">,</span> <span class="n">omega</span><span
            class="p">)</span></pre>
    <pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_6pyrism_4core_3tma_KS(__pyx_v_ke, __pyx_v_omega);<span class='error_goto'> if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 1743, __pyx_L1_error)</span>
  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_t_1, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1743, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1744</span>: </pre>
    <pre class="cython line score-44"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1745</span>: <span class="k">def</span> <span class="nf">KA_WRAPPER</span><span
            class="p">(</span><span class="n">double</span><span class="p">[:,:]</span> <span class="n">ks</span><span
            class="p">,</span> <span class="n">double</span><span class="p">[:,:]</span> <span
            class="n">omega</span><span class="p">):</span></pre>
    <pre class='cython code score-44 '>/* Python wrapper */
static PyObject *__pyx_pw_6pyrism_4core_3tma_39KA_WRAPPER(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_6pyrism_4core_3tma_39KA_WRAPPER = {"KA_WRAPPER", (PyCFunction)__pyx_pw_6pyrism_4core_3tma_39KA_WRAPPER, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6pyrism_4core_3tma_39KA_WRAPPER(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_ks = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_omega = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("KA_WRAPPER (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_ks,&amp;__pyx_n_s_omega,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_ks)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_omega)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("KA_WRAPPER", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 1745, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "KA_WRAPPER") &lt; 0)) <span
                class='error_goto'>__PYX_ERR(0, 1745, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_ks = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(values[0], PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_v_ks.memview)) __PYX_ERR(0, 1745, __pyx_L3_error)</span>
    __pyx_v_omega = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(values[1], PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_v_omega.memview)) __PYX_ERR(0, 1745, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("KA_WRAPPER", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span
                class='error_goto'>__PYX_ERR(0, 1745, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.KA_WRAPPER", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6pyrism_4core_3tma_38KA_WRAPPER(__pyx_self, __pyx_v_ks, __pyx_v_omega);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6pyrism_4core_3tma_38KA_WRAPPER(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_ks, __Pyx_memviewslice __pyx_v_omega) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("KA_WRAPPER", 0);
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.KA_WRAPPER", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_ks, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_omega, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* â€¦ */
  __pyx_tuple__112 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_n_s_ks, __pyx_n_s_omega);<span
                class='error_goto'> if (unlikely(!__pyx_tuple__112)) __PYX_ERR(0, 1745, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__112);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__112);
/* â€¦ */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_6pyrism_4core_3tma_39KA_WRAPPER, NULL, __pyx_n_s_pyrism_core_tma);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1745, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_KA_WRAPPER, __pyx_t_1) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 1745, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__113 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__112, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyrism_core_tma_pyx, __pyx_n_s_KA_WRAPPER, 1745, __pyx_empty_bytes);<span
                class='error_goto'> if (unlikely(!__pyx_codeobj__113)) __PYX_ERR(0, 1745, __pyx_L1_error)</span>
</pre>
    <pre class="cython line score-1"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1746</span>:     <span class="k">return</span> <span class="n">KA</span><span
            class="p">(</span><span class="n">ks</span><span class="p">,</span> <span class="n">omega</span><span
            class="p">)</span></pre>
    <pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_6pyrism_4core_3tma_KA(__pyx_v_ks, __pyx_v_omega);<span class='error_goto'> if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 1746, __pyx_L1_error)</span>
  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_t_1, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1746, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1747</span>: </pre>
    <pre class="cython line score-20"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1748</span>: <span class="k">def</span> <span class="nf">KT_WRAPPER</span><span
            class="p">(</span><span class="n">double</span><span class="p">[:,:,:]</span> <span class="n">ke</span><span
            class="p">):</span></pre>
    <pre class='cython code score-20 '>/* Python wrapper */
static PyObject *__pyx_pw_6pyrism_4core_3tma_41KT_WRAPPER(PyObject *__pyx_self, PyObject *__pyx_arg_ke); /*proto*/
static PyMethodDef __pyx_mdef_6pyrism_4core_3tma_41KT_WRAPPER = {"KT_WRAPPER", (PyCFunction)__pyx_pw_6pyrism_4core_3tma_41KT_WRAPPER, METH_O, 0};
static PyObject *__pyx_pw_6pyrism_4core_3tma_41KT_WRAPPER(PyObject *__pyx_self, PyObject *__pyx_arg_ke) {
  __Pyx_memviewslice __pyx_v_ke = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("KT_WRAPPER (wrapper)", 0);
  assert(__pyx_arg_ke); {
    __pyx_v_ke = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_double</span>(__pyx_arg_ke, PyBUF_WRITABLE);<span
                class='error_goto'> if (unlikely(!__pyx_v_ke.memview)) __PYX_ERR(0, 1748, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.KT_WRAPPER", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6pyrism_4core_3tma_40KT_WRAPPER(__pyx_self, __pyx_v_ke);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6pyrism_4core_3tma_40KT_WRAPPER(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_ke) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("KT_WRAPPER", 0);
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyrism.core.tma.KT_WRAPPER", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_ke, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* â€¦ */
  __pyx_tuple__114 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_n_s_ke, __pyx_n_s_ke);<span class='error_goto'> if (unlikely(!__pyx_tuple__114)) __PYX_ERR(0, 1748, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__114);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__114);
/* â€¦ */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_6pyrism_4core_3tma_41KT_WRAPPER, NULL, __pyx_n_s_pyrism_core_tma);<span
                class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1748, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_KT_WRAPPER, __pyx_t_1) &lt; 0) <span
                class='error_goto'>__PYX_ERR(0, 1748, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__115 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__114, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_pyrism_core_tma_pyx, __pyx_n_s_KT_WRAPPER, 1748, __pyx_empty_bytes);<span
                class='error_goto'> if (unlikely(!__pyx_codeobj__115)) __PYX_ERR(0, 1748, __pyx_L1_error)</span>
</pre>
    <pre class="cython line score-1"
         onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span
            class="">1749</span>:     <span class="k">return</span> <span class="n">KT</span><span
            class="p">(</span><span class="n">ke</span><span class="p">)</span></pre>
    <pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_6pyrism_4core_3tma_KT(__pyx_v_ke);<span class='error_goto'> if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 1749, __pyx_L1_error)</span>
  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_t_1, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span
                class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1749, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre>
    <pre class="cython line score-0">&#xA0;<span class="">1750</span>: <span class="c"># ----------------------------------------------------------------------------------------------------------------------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1751</span>: <span
            class="c"># Not Used Functions Yet</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1752</span>: <span class="c"># ----------------------------------------------------------------------------------------------------------------------</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1753</span>: <span class="c"># def orient_averaged_adaptive_wrapper(float nmax, float wavelength, float izaDeg, float vzaDeg, float iaaDeg,</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1754</span>: <span class="c">#                                      float vaaDeg, or_pdf):</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1755</span>: <span class="c">#     return orient_averaged_adaptive(nmax, wavelength, izaDeg, vzaDeg, iaaDeg, vaaDeg, or_pdf)</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1756</span>: </pre>
    <pre class="cython line score-0">&#xA0;<span class="">1757</span>: <span class="c"># cdef orient_averaged_adaptive(float nmax, float wavelength, float izaDeg, float vzaDeg, float iaaDeg, float vaaDeg,</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1758</span>: <span class="c">#                               or_pdf):</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1759</span>: <span class="c">#     &quot;&quot;&quot;Compute the T-matrix using variable orientation scatterers.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1760</span>: <span class="c">#</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1761</span>: <span class="c">#     This method uses a very slow adaptive routine and should mainly be used</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1762</span>: <span class="c">#     for reference purposes. Uses the set particle orientation PDF, ignoring</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1763</span>: <span class="c">#     the alpha and beta attributes.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1764</span>: <span class="c">#</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1765</span>: <span class="c">#     Args:</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1766</span>: <span class="c">#         : selfatrix (or descendant) instance</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1767</span>: <span class="c">#</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1768</span>: <span class="c">#     Returns:</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1769</span>: <span class="c">#         The amplitude (S) and phase (Z) matrices.</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1770</span>: <span
            class="c">#     &quot;&quot;&quot;</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1771</span>: <span class="c">#     cdef np.ndarray S = np.zeros((2, 2), dtype=complex)</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1772</span>: <span class="c">#     cdef np.ndarray Z = np.zeros((4, 4))</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1773</span>: <span class="c">#     cdef int i, j</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1774</span>: <span class="c">#</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1775</span>: <span class="c">#     ind = range(2)</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1776</span>: <span class="c">#     for i in ind:</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1777</span>: <span
            class="c">#         for j in ind:</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1778</span>: <span class="c">#             S.real[i, j] = dblquad(ifunc_S, 0.0, 360.0,</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1779</span>: <span class="c">#                                    lambda x: 0.0, lambda x: 180.0,</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1780</span>: <span class="c">#                                    (i, j, 1, nmax, wavelength, izaDeg, vzaDeg, iaaDeg, vaaDeg, or_pdf))[0] / 360.0</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1781</span>: <span class="c">#             S.imag[i, j] = dblquad(ifunc_S, 0.0, 360.0,</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1782</span>: <span class="c">#                                    lambda x: 0.0, lambda x: 180.0,</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1783</span>: <span class="c">#                                    (i, j, 0, nmax, wavelength, izaDeg, vzaDeg, iaaDeg, vaaDeg, or_pdf))[0] / 360.0</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1784</span>: <span class="c">#</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1785</span>: <span class="c">#     ind = range(4)</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1786</span>: <span class="c">#     for i in ind:</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1787</span>: <span
            class="c">#         for j in ind:</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1788</span>: <span class="c">#             Z[i, j] = dblquad(ifunc_Z, 0.0, 360.0,</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1789</span>: <span class="c">#                               lambda x: 0.0, lambda x: 180.0,</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1790</span>: <span class="c">#                               (i, j, 1, nmax, wavelength, izaDeg, vzaDeg, iaaDeg, vaaDeg, or_pdf))[0] / 360.0</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1791</span>: <span class="c">#</span></pre>
    <pre class="cython line score-0">&#xA0;<span class="">1792</span>: <span class="c">#     return S, Z</span></pre>
</div>
</body>
</html>
